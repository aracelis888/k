var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function s(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n["throw"](t))}catch(e){r(e)}}function l(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(s=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=e.call(t,l)}catch(n){i=[6,n],r=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},service;!function(t){var e=function(){function t(){}return t.getInstance=function(t){var e=this.instanceMap.get(t);return e||(e=new(Function.prototype.bind.call(t,null)),this.instanceMap.set(t,e)),e},t.init=function(){return Promise.all(Const.SERVICE.map(function(t){return t.instance.init()}))},t.onMessage=function(e,i){t.instanceMap.forEach(function(t){return t.onMessage(e,i)})},t.prototype.onMessage=function(t,e){},t.prototype.snapshot=function(t,e,i,n){return util.NetUtil.sendJSON(t,{op:"snapshot",snapshot:e},i,n)},t.prototype.subscribe=function(t,e,i){return util.NetUtil.sendJSON(t,{op:"subscribe"},e,i)},t.prototype.unsubscribe=function(t,e,i){return util.NetUtil.sendJSON(t,{op:"unsubscribe"},e,i)},t.prototype.update=function(t,e,i,n){return util.NetUtil.sendJSON(t,{op:"update",update:e},i,n)},t.prototype.updateWithCatch=function(t,e,i,n,o){return void 0===o&&(o=!0),this.update(t,e,i,n)["catch"](function(t){try{var e=JSON.parse(t.message).code;switch(e){case 1:case 9:util.LogUtil.info("err "+e+" is_kick:"+o+" mainuistage:"+!!ui.MainUI.instance.stage),o&&!ui.MainUI.instance.stage&&util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL,o),ui.dialog.MessageDialog.instance.showAlert(o?"lbl_balance_error2":"lbl_balance_error","lbl_game_comfirm");break;case 16:ui.dialog.MatchDialog.instance.close(),ui.dialog.MessageDialog.instance.showAlert("lbl_game_willserver","lbl_game_comfirm",function(){return!ui.MainUI.instance.stage&&util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL)});break;default:util.LogUtil.warn("err "+e)}}catch(t){}})},t.instanceMap=new Map,t}();t.ServiceBase=e,__reflect(e.prototype,"service.ServiceBase")}(service||(service={}));var topic;!function(t){var e=function(){function t(){}return t}();t.SnapshotBase=e,__reflect(e.prototype,"topic.SnapshotBase");var i=function(){function t(t){var e=this;Object.keys(t).forEach(function(i){return e[i]=t[i]})}return Object.defineProperty(t.prototype,"push",{set:function(t){this.snapshot=t},enumerable:!0,configurable:!0}),t}();t.TopicBase=i,__reflect(i.prototype,"topic.TopicBase")}(topic||(topic={}));var ui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"preloadGroup",{get:function(){return[]},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return this.skin.hasState("square")&&Math.max(window.innerWidth/window.innerHeight,window.innerHeight/window.innerWidth)<=4/3?"square":Main.instance.orientation},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.invalidateState(),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.invalidateState,this),this.skin&&this.stage.addEventListener(egret.Event.RESIZE,function(){return e.getCurrentState()!==e.skin.currentState&&e.invalidateState()},this)},e.prototype.preLoad=function(t,e){var i=this;if(void 0===e&&(e=[]),e.push.apply(e,this.preloadGroup),e.length){var n=0;return t&&t(n++,e.length),Promise.all(e.map(function(o){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return[4,RES.loadGroup(o)];case 1:return i.sent(),t&&t(n++,e.length),[2]}})})}))}},e}(eui.Component);t.Component=e,__reflect(e.prototype,"ui.Component")}(ui||(ui={}));var ui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(t){var e=this.instanceMap.get(t);return e||(e=new(Function.prototype.bind.call(t,null)),this.instanceMap.set(t,e)),e},e.prototype.childrenCreated=function(){if(t.prototype.childrenCreated.call(this),this.percentWidth=this.percentHeight=100,this.hall_bg&&Const.Config.LOBBY_BACKGROUND_IMAGE){var e=new eui.Image("hall_pic_hallbg_jpg");e.width=1920,e.height=2520,e.verticalCenter=e.horizontalCenter=0,this.addChildAt(e,0),this.removeChild(this.hall_bg)}},e.instanceMap=new Map,e}(t.Component);t.HallBase=e,__reflect(e.prototype,"ui.HallBase")}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.checkRegister=function(){return __awaiter(e,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,util.NetUtil.requestWithAuth("GET",Const.Config.DEFAULT_HTTP_HOST+"/login/"+Const.UserInfo.CHANNEL_ID+"/oauth_validation?access_token="+encodeURIComponent(params.accessToken))];case 1:t=e.sent().response;try{t=JSON.parse(t)}catch(i){return util.LogUtil.error(i.message,t),[2,Promise.reject(i)]}return Data.validate({type:"object",properties:{username:{type:"string"}},required:["username"]},t),[2,t]}})})},e.getRecord=function(){return __awaiter(e,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,util.NetUtil.requestWithAuth("GET",Const.Config.DEFAULT_HTTP_HOST+"/record?page_index=1&page_size=100")];case 1:t=e.sent().response;try{t=JSON.parse(t)}catch(i){return util.LogUtil.error(i.message,t),[2,Promise.reject(i)]}return Data.validate({type:"array",items:{type:"object",properties:{room_type:{type:"string"},room_name:{type:"string"},round_id:{type:"string"},valid_bet:{type:"number"},surplus:{type:"number"},payout_time:{type:"number"},repeal_time:{type:"number"}},required:["room_type","room_name","round_id","valid_bet","surplus","payout_time"]}},t),util.LogUtil.debug("[MainService] [getRecord] record => "+JSON.stringify(t)),[2,t]}})})},e.sendFeedback=function(t){return __awaiter(e,void 0,void 0,function(){var e,i;return __generator(this,function(n){switch(n.label){case 0:return i=(e=JSON).parse,[4,util.NetUtil.requestWithAuth("GET",Const.Config.DEFAULT_HTTP_HOST+"/feedback?content="+encodeURIComponent(t))];case 1:return[2,i.apply(e,[n.sent().response])]}})})},e.postLog=function(t){return util.NetUtil.requestWithAuth("POST",Const.Config.DEFAULT_HTTP_HOST+"/mobile_log/normal",JSON.stringify(t))},e.changeAvatar=function(t){return util.NetUtil.requestWithAuth("POST",Const.Config.DEFAULT_HTTP_HOST+"/players/"+Const.UserInfo.USER_ID,JSON.stringify({avatar:t}))},e.subscribeOnline=function(){return e.subscribe(Const.Topic.ONLINE)},e.subscribeWorldMessage=function(){return e.subscribe(Const.Topic.WORLD_MESSAGE)},e.updateOnlinePlayers=function(t,i,n){return e.update(Const.Topic.ONLINE,{action:t?"enter":"leave",room_type:i,room_id:n})},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.subsPool=function(t){var e=Const.Topic.POOL+"/"+t;return util.LogUtil.debug("[MainService] [subsPool] [send] topic => "+e+"/"+Const.UserInfo.CHANNEL_ID),this.subscribe(e+"/"+Const.UserInfo.CHANNEL_ID,e)},e.prototype.unsubsPool=function(t){var e=Const.Topic.POOL+"/"+t+"/"+Const.UserInfo.CHANNEL_ID;return util.LogUtil.debug("[MainService] [unsubsPool] [send] topic => "+e),this.unsubscribe(e)},e.prototype.removePoolNotify=function(t){var e=Const.Topic.POOL+"/"+t+"/"+Const.UserInfo.CHANNEL_ID;util.LogUtil.debug("[MainService] [removePoolNotify] [send] topic => "+e),this.update(e,{action:"remove_notify"})},e.prototype.subsRooms=function(t){var e=""+Const.Topic.ROOMS+t;return util.LogUtil.debug("[MainService] [enterRoom] [send] topic => "+e),this.subscribe(e,e)},e.prototype.unsubsRooms=function(t){var e=""+Const.Topic.ROOMS+t;return util.LogUtil.debug("[MainService] [unsubsRooms] [send] topic => "+e),this.unsubscribe(e)},e.prototype.enterRoom=function(t,e,i,n){void 0===i&&(i={});var o=t+"/"+e;return util.LogUtil.info("[MainService] [enterRoom] [send] topic => "+o),this.updateWithCatch(o,util.ObjectUtil.merge({action:"enter"},i),o,void 0,n)},e.prototype.enterjoinDesk=function(t,e){return util.LogUtil.debug("[MainService] [enterjoinDesk] [send] desk_topic => "+t),this.updateWithCatch(t,{action:"enter"},t,void 0,e)},e.prototype.getVirtualDesk=function(t,e){return util.LogUtil.info("[MainService] [getVirtualDesk] [send] desk_topic => "+t+" is_kick => "+e),this.updateWithCatch(t,{action:"enter"},t,!0,e)},e.prototype.leaveDesk=function(t){return util.LogUtil.debug("[MainService] [leaveDesk] [send] desk_topic => "+t),this.update(t,{action:"leave"})},e.prototype.cancelMatch=function(t,e){return util.LogUtil.info("[MainService] [cancelMatch] [send] topic => "+t+"/"+e+"}"),this.update(t+"/"+e,{action:"cancel"},null,!0)},e.prototype.subsDesk=function(t,e,i){var n=t+"/"+e;return util.LogUtil.debug("[MainService] [subsDesk] [send] topic => "+n),this.subscribe(n,i)},e.prototype.unsubsDesk=function(t,e){var i=t+"/"+e;return util.LogUtil.debug("[MainService] [unsubsDesk] [send] topic => "+i),this.unsubscribe(i)},e.prototype.bet=function(t,e,i){var n=t+"/"+e;return this.update(n,{action:"wager",bet:i},null,!0)},e}(t.ServiceBase);t.MainService=e,__reflect(e.prototype,"service.MainService")}(service||(service={}));var topic;!function(t){var e=function(){function t(){this.playernum=0,this.show_stage=""}return t}();t.RoomItemData=e,__reflect(e.prototype,"topic.RoomItemData");var i=function(){function t(){}return t}();t.JoinDeskRoomSettingData=i,__reflect(i.prototype,"topic.JoinDeskRoomSettingData");var n=function(){function t(){}return t}();t.JoinDeskStageData=n,__reflect(n.prototype,"topic.JoinDeskStageData");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.JoinDeskRoomsTopic=o,__reflect(o.prototype,"topic.JoinDeskRoomsTopic"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{JoinDeskRoomSettingData:{properties:{bet_limit:{properties:{chips:{items:{type:"number"},type:"array"},max:{additionalProperties:{type:"number"},type:"object"},min:{additionalProperties:{type:"number"},type:"object"}},required:["chips","max","min"],type:"object"},channel_id:{type:"number"},road_map:{type:"string"},room_id:{type:"string"},room_name:{type:"string"},stage_topic:{type:"string"},visible:{type:"boolean"}},"if":{properties:{visible:{"const":"true"}}},then:{required:["bet_limit","room_id","visible"]},"else":{required:["room_id","visible"]},type:"object"}},properties:{snapshot:{properties:{last_op_room:{properties:{channel_id:{type:"number"},room_id:{type:"string"},visible:{type:"boolean"}},required:["channel_id","room_id","visible"],type:"object"},online_player_count:{type:"number"},rooms:{additionalProperties:{$ref:"#/definitions/JoinDeskRoomSettingData"},type:"object"}},required:["rooms"],type:"object"}},required:["snapshot"],type:"object"},t.schema1={$schema:"http://json-schema.org/draft-07/schema#",additionalProperties:{$ref:"#/definitions/JoinDeskRoomSettingData"},definitions:{JoinDeskRoomSettingData:{properties:{bet_limit:{properties:{chips:{items:{type:"number"},type:"array"},max:{additionalProperties:{type:"number"},type:"object"},min:{additionalProperties:{type:"number"},type:"object"}},required:["chips","max","min"],type:"object"},channel_id:{type:"number"},road_map:{type:"string"},room_id:{type:"string"},room_name:{type:"string"},stage_topic:{type:"string"},visible:{type:"boolean"}},"if":{properties:{visible:{"const":"true"}}},then:{required:["bet_limit","room_id","visible"]},"else":{required:["room_id","visible"]},type:"object"}},type:"object"}}(o=t.JoinDeskRoomsTopic||(t.JoinDeskRoomsTopic={}))}(topic||(topic={}));var JoinDeskGameController=function(){function t(){var t=this;this.room_bind_data_map=new Map,this.room_setting_map=new Map,this.topic_room_id_map=new Map,this.all_visible_room_id_list=[],this.updateRoom=function(e,i,n){return __awaiter(t,void 0,void 0,function(){var t,o,r,s,a,l=this;return __generator(this,function(u){switch(u.label){case 0:return Data.validate(topic.JoinDeskRoomsTopic.schema,e),util.LogUtil.debug("[JoinDeskGameController] [updateRoomsSetting] [receive] data => "+JSON.stringify(n?e:n)),t=e.snapshot.rooms,i&&ControllerUtil.checkRoomsLastOp(e,i),o=util.ObjectUtil.copy(this.all_visible_room_id_list),r=[],s=[],a=[],Object.keys(t).forEach(function(e){var i=t[e];i.visible&&i.bet_limit&&a.push(i)}),a.length?(a=a.sort(function(t,e){return t.room_id.localeCompare(e.room_id)}),!this.room_id&&(this.room_id=a[0].room_id),a.forEach(function(t){var e=util.ObjectUtil.copy(t),i=e.room_id;e.stage_topic="/"+l.type+"_stage/"+i,e.road_map_topic="/road_map/"+i+"-"+Const.UserInfo.CHANNEL_ID,l.room_setting_map.set(i,e),r.push(i);var n=o.indexOf(i);-1!==n&&o.splice(n,1),-1===l.all_visible_room_id_list.indexOf(i)&&s.push(i)}),this.all_visible_room_id_list=r):this.all_visible_room_id_list=[],s.length||o.length?(util.LogUtil.info("[JoinDeskGameController] [updateRoomsSetting] new_rooms => "+JSON.stringify(s)+" del_rooms => "+JSON.stringify(o)),[4,Promise.all(s.map(function(t){return l.creatNewRoom(t)}).concat(o.map(function(t){return l.deletRoom(t)})))]):[3,2];case 1:u.sent(),this.handleShowRooms(),u.label=2;case 2:return[2]}})})},this.tail_room_id=[],this.updateStage=function(e,i,n){if(util.LogUtil.debug("[JoinDeskGameController] [updateStage] [receive] newRaw => "+JSON.stringify(n?n:e)),e&&e.topic){var o=t.room_bind_data_map.get(t.topic_room_id_map.get(e.topic));t.checkInRoom(o)&&t.updateStageHandler(o,e,i,n)}},this.updateRoadMap=function(e,i,n){if(util.LogUtil.debug("[JoinDeskGameController] [updateRoadMap] [receive] newRaw => "+JSON.stringify(n?n:e)),e&&e.topic){var o=t.room_bind_data_map.get(t.topic_room_id_map.get(e.topic));t.checkInRoom(o)&&t.updateRoadMapHandler(o,e)}},this.deskHandler=function(e,i,n){return ControllerUtil.deskHandlerHelper(e,i,n,t.updateDesk)},this.updateRobotBet=function(e,i,n){util.LogUtil.debug("[JoinDeskGameController] [updateRobotBets] [receive] newRaw => "+JSON.stringify(n?n:e));var o=e.snapshot,r=i.snapshot;util.ObjectUtil.isEqual(o.bets,r.bets)||t.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROBOT_BET,o.bets)},this.sendBet=function(e){util.LogUtil.warn("[JoinDeskGameController] [sendBet] desk_id => "+t.desk_id+" [send] data => "+JSON.stringify(e));var i=GameConst.valid_game_data_map.get(t.type),n=i.cmpt.room_ui;service.MainService.instance.bet(i.topic.desk_topic,t.desk_id,e)["catch"](function(t){try{var e=JSON.parse(t.message),i=e.code,o="";switch(i){case 9:o="lbl_balance_error";break;case 9001:o="lbl_game_limit2";break;case 9002:o="lbl_game_bet_error";break;case 1:o="lbl_balance_error";break;default:util.LogUtil.warn("[receive] bet err "+i)}o&&n.execCommand(Const.UICommand.CMD_BALANCE_HINT,o)}catch(t){}})}}return t.getInstance=function(t){var e=this.instanceMap.get(t);return e||(e=new(Function.prototype.bind.call(t,null)),this.instanceMap.set(t,e)),e},Object.defineProperty(t.prototype,"room_ui",{get:function(){return ControllerUtil.roomUI(this.type)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type_topic",{get:function(){return ControllerUtil.typeTopic(this.type)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desk_topic",{get:function(){return ControllerUtil.deskTopic(this.type)},enumerable:!0,configurable:!0}),t.prototype.registerNotify=function(){util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BET,this.sendBet)},t.prototype.removeRegisterNotify=function(){util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_BET,this.sendBet)},t.prototype.init=function(){this.registerNotify()},t.prototype.clearHall=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return this.removeRegisterNotify(),this.room_id=void 0,[4,Promise.all([ControllerUtil.unsubRooms(this.type),this.all_visible_room_id_list.concat(this.tail_room_id).map(function(e){return t.deletRoom(e)})])];case 1:return e.sent(),this.all_visible_room_id_list=[],this.tail_room_id=[],this.room_setting_map.clear(),this.topic_room_id_map.clear(),this.room_bind_data_map.clear(),[2]}})})},t.prototype.updateOnlinePlayers=function(t){var e=this;ControllerUtil.checkOnlineData(t),this.room_bind_data_map.forEach(function(i){var n=t.base_room_count[i.room_id]||0,o=t.room_count[i.room_id]||0;i.playernum=n+o,i.room_id===e.room_id&&e.room_ui.stage&&(util.LogUtil.info("[HoroscopeController] [updateOnlinePlayers] room_id => "+i.room_id+" base_room_count => "+n+" room_count => "+o),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_PEOPLE,i.playernum))})},t.prototype.creatNewRoom=function(t){return __awaiter(this,void 0,void 0,function(){var e,i=this;return __generator(this,function(n){switch(n.label){case 0:return(e=this.room_setting_map.get(t))?(util.LogUtil.debug("[JoinDeskGameController] [subRoomStageRoad] room_id => "+t+" stage_topic => "+e.stage_topic+" road_map_topic => "+e.road_map_topic),[4,Promise.all([e.stage_topic,e.road_map_topic].map(function(e){return i.topic_room_id_map.set(e,t),service.MainService.instance.subscribe(e,e)}))]):[3,2];case 1:n.sent(),this.addBindData(t),ControllerUtil.registerData([{type:"topic."+e.stage_topic.substring(1),fuc:this.updateStage,fuc_obj:this},{type:"topic."+e.road_map_topic.substring(1),fuc:this.updateRoadMap,fuc_obj:this}],t),n.label=2;case 2:return[2]}})})},t.prototype.addBindData=function(t){var e=this.room_setting_map.get(t),i=Data.getTopic(e.stage_topic),n=Data.getTopic(e.road_map_topic),o=Data.getTopic(Const.Topic.ONLINE),r=new ui.horoscope.RoomItemData;if(o&&o.snapshot){var s=o.snapshot.base_room_count[t]||0,a=o.snapshot.room_count[t]||0;r.playernum=s+a}r.room_id=t,r.room_setting=e,this.room_bind_data_map.set(t,r),this.updateStageHandler(r,i),this.updateRoadMapHandler(r,n)},t.prototype.deletRoom=function(t){return __awaiter(this,void 0,void 0,function(){var e,i=this;return __generator(this,function(n){switch(n.label){case 0:return this.room_ui.stage&&t===this.room_id?(util.LogUtil.warn("[JoinDeskGameController] [unsubRoomStageRoad] deleteroom is cur gameroom room_id => "+t),-1===this.tail_room_id.indexOf(t)&&this.tail_room_id.push(t),[2]):(e=this.room_setting_map.get(t))?(util.LogUtil.debug("[JoinDeskGameController] [unsubRoomStageRoad] room_id => "+t),this.room_setting_map["delete"](t),ControllerUtil.clearRegister(t),this.room_bind_data_map["delete"](t),[4,Promise.all([e.stage_topic,e.road_map_topic].map(function(t){return i.topic_room_id_map["delete"](t),service.MainService.instance.unsubscribe(t)}))]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.checkInRoom=function(t){return t&&(t.room_setting.visible||this.room_ui.stage&&t.room_id===this.room_id)},t.prototype.handleShowRooms=function(){var t=this,e=[];this.all_visible_room_id_list.forEach(function(i){t.room_bind_data_map.forEach(function(t){t.room_id===i&&e.push(t)})}),GameConst.valid_game_data_map.get(this.type).cmpt.hall.updateHallDatas(e)},t.prototype.registerDeskData=function(){util.NotifyUtil.addNotification(ControllerUtil.deskTopicListen(this.type,this.desk_id),this.deskHandler),util.NotifyUtil.addNotification("topic."+this.room_setting_map.get(this.room_id).stage_topic.substring(1),this.updateRobotBet)},t.prototype.removeRegisterDeskData=function(){util.NotifyUtil.removeNotification(ControllerUtil.deskTopicListen(this.type,this.desk_id),this.deskHandler),util.NotifyUtil.removeNotification("topic."+this.room_setting_map.get(this.room_id).stage_topic.substring(1),this.updateRobotBet)},t.prototype.enterGame=function(t,e,i){return void 0===i&&(i=!1),__awaiter(this,void 0,void 0,function(){var n,o,r,s,a,l;return __generator(this,function(u){switch(u.label){case 0:return this.room_id=t,e?(this.desk_id=e,[3,3]):[3,1];case 1:return[4,service.MainService.instance.getVirtualDesk(this.room_setting_map.get(this.room_id).stage_topic,!1)];case 2:n=u.sent(),util.LogUtil.debug("[JoinDeskGameController] [getVirtualDeskId] [receive] topic => "+JSON.stringify(n)),n&&(Data.validate(topic.getVirtualDeskTopic.schema,n),util.LogUtil.info("[getVirtualDeskId] desk_id => "+n.snapshot.desk_id),this.desk_id=n.snapshot.desk_id),u.label=3;case 3:return o=this.desk_id,o?[4,service.MainService.instance.enterjoinDesk(this.desk_topic+"/"+this.desk_id,i)]:[3,5];case 4:o=u.sent(),u.label=5;case 5:return o?(service.MainService.instance.updateOnlinePlayers(!0,this.type,this.room_id),r=ControllerUtil.uniteDeskTopic(this.type,this.desk_id),e?(a=Data.getTopic(r),[3,8]):[3,6]):(util.LogUtil.warn("[JoinDeskGameController] [enterjoinDesk] failed"),this.desk_id=void 0,[2]);case 6:return[4,service.MainService.instance.subscribe(r,r)];case 7:a=u.sent(),u.label=8;case 8:return(s=a)?(l=!this.room_ui.stage,l?[4,Controller.instance.toggleUI(this.room_ui,!0,!1)]:[3,10]):[3,11];case 9:l=u.sent(),u.label=10;case 10:return this.initDesk(s),this.registerDeskData(),[3,12];case 11:util.LogUtil.warn("[JoinDeskGameController] [subscribeDesk] failed"),this.desk_id=void 0,u.label=12;case 12:return[2]}})})},t.prototype.leaveGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.desk_id?(this.removeRegisterDeskData(),[4,Promise.all([service.MainService.instance.leaveDesk(ControllerUtil.uniteDeskTopic(this.type,this.desk_id))["catch"](function(t){return util.LogUtil.warn(t)}),service.MainService.instance.updateOnlinePlayers(!1,this.type,this.room_id)])]):[2];case 1:return t.sent(),this.desk_id=void 0,[2]}})})},t.prototype.checkLeaveGame=function(){var t=Data.getTopic(ControllerUtil.uniteDeskTopic(this.type,this.desk_id)),e=0;if(t&&t.snapshot&&t.snapshot.user_info&&t.snapshot.user_info.bet){var i=t.snapshot.user_info.bet;return Object.keys(i).forEach(function(t){e+=Number(i[t])}),0===e}return!0},t.prototype.checkReBackRoom=function(t){return!0},t.instanceMap=new Map,t}();__reflect(JoinDeskGameController.prototype,"JoinDeskGameController",["IGameController"]);var ui;!function(t){var e;!function(t){var e=function(t){function e(i){void 0===i&&(i=!1);var n=t.call(this)||this;return n.parse_data_map=e.PARSE_THREE_ICON_MAP,n._img_bg_red=new eui.Image,n._img_bg_blue=new eui.Image,n.is_good_road=i,n}return __extends(e,t),Object.defineProperty(e.prototype,"is_good_road",{get:function(){return this._is_good_road},set:function(t){this._is_good_road=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"img_bg_red",{get:function(){return this._img_bg_red},set:function(t){this._img_bg_red=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"img_bg_blue",{get:function(){return this._img_bg_blue},set:function(t){this._img_bg_blue=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.bindParseMap(),this.init()},e.prototype.bindParseMap=function(){},e.prototype.createBg=function(){var t=this;[this.img_bg_red,this.img_bg_blue].forEach(function(e){return t.addBg(e)})},e.prototype.updateSize=function(t){this.is_inited||(this.icon_size=Number(t),this.size_param="_"+this.icon_size,this.createBg(),this.width=this.height=t,this.is_inited=!0)},e.prototype.init=function(){this.hide()},e.prototype.addBg=function(t){t.verticalCenter=t.horizontalCenter=0,t.percentWidth=t.percentHeight=100,this.addChild(t)},e.prototype.hide=function(){this.img_bg_red.visible&&(this.img_bg_red.visible=!1),this.img_bg_blue.visible&&(this.img_bg_blue.visible=!1)},e.prototype.setResult=function(t,e,i){var n=this;this.updateSize(e),this.parse_data_map&&t.forEach(function(t){var e=n.parse_data_map.get(t);e&&e(n)})},e.prototype.reSetSize=function(t){this.icon_size=Number(t),this.size_param="_"+this.icon_size,this.width=this.height=t},e.prototype.setBg=function(t){var e="red"===t?this.img_bg_red:this.img_bg_blue;e&&(e.visible=!0)},e}(eui.Component);t.ResultMarkBase=e,__reflect(e.prototype,"ui.dragontiger.ResultMarkBase")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(t){var e=this.instanceMap.get(t);return e||(e=new(Function.prototype.bind.call(t,null)),this.instanceMap.set(t,e)),e},e.instanceMap=new Map,e}(t.Component);t.DialogBase=e,__reflect(e.prototype,"ui.DialogBase")}(ui||(ui={}));var MatchDeskGameController=function(){function t(){var t=this;this.enter_room_args={},this.updateRoom=function(e,i,n){Data.validate(topic.RoomsTopic.schema,e),util.LogUtil.debug("[MatchDeskGameController] [_updateRoomInfo] [receive] newRaw => "+JSON.stringify(n?n:e)),i&&ControllerUtil.checkRoomsLastOp(e,i),i&&util.ObjectUtil.isEqual(i.snapshot.rooms,e.snapshot.rooms)||GameConst.valid_game_data_map.get(t.type).cmpt.hall.updateHallDatas(Object.keys(e.snapshot.rooms).filter(function(t){var i=e.snapshot.rooms[t];return i.visible&&i.bet_limit}).sort(function(t,e){return t.localeCompare(e)}).map(function(t){return util.ObjectUtil.copy(e.snapshot.rooms[t])}))},this.deskRegisterMap=new Map,this.leaveGame=function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return util.LogUtil.debug("[MatchDeskGameController] [leaveGame] "),this.is_cancel=!0,this.removeRegisterDeskData(),this.room_ui.execCommand(Const.UICommand.CMD_LEAVE_DESK),this.desk_id=void 0,[4,service.MainService.instance.updateOnlinePlayers(!1,this.type,this.room_id)];case 1:return t.sent(),[2]}})})},this.continueMatch=function(){util.LogUtil.debug("[MatchDeskGameController] [continueMatch] "),t.leaveGame(),t.is_continue_match=!0,t.room_ui.execCommand(Const.UICommand.CMD_CONTINUE_MATCH),t.enterGame(t.room_id,void 0,!0)},this.showMatchDialog=function(){return ui.dialog.MatchDialog.instance.show({title:"lbl_game_tip",text:util.LanguageUtil.translate("lbl_game_match")+"\n"+util.LanguageUtil.translate("lbl_game_begin"),onClose:t.canelMatch})},this.canelMatch=function(){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return ui.dialog.MatchDialog.instance.option.onClose=void 0,util.LogUtil.debug("[MatchDeskGameController] [canelMatch]"),this.desk_id?(t=GameConst.valid_game_data_map.get(this.type),[4,service.MainService.instance.cancelMatch(t.topic.desk_topic,this.desk_id)["catch"](function(){return util.LogUtil.warn("[MatchDeskGameController] [canelMatch] already began and cannot be cancelled.")})]):[3,2];case 1:e.sent(),util.LogUtil.info("[MatchDeskGameController] canelMatch cancel_success"),this.is_cancel=!0,this.leaveGame(),t.cmpt.room_ui.execCommand(Const.UICommand.CMD_CANCEL_MATCH),e.label=2;case 2:return[2]}})})},this.deskHandler=function(e,i,n){return ControllerUtil.deskHandlerHelper(e,i,n,t.updateDesk)},this.gameOver=function(){util.LogUtil.debug("[MatchDeskGameController] [gameOver]"),t.desk_id=void 0}}return t.getInstance=function(t){var e=this.instanceMap.get(t);return e||(e=new(Function.prototype.bind.call(t,null)),this.instanceMap.set(t,e)),e},Object.defineProperty(t.prototype,"room_ui",{get:function(){return ControllerUtil.roomUI(this.type)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type_topic",{get:function(){return ControllerUtil.typeTopic(this.type)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desk_topic",{get:function(){return ControllerUtil.deskTopic(this.type)},enumerable:!0,configurable:!0}),t.prototype.registerNotify=function(){util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM,this.gameOver),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH,this.continueMatch)},t.prototype.removeRegisterNotify=function(){util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM,this.gameOver),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH,this.continueMatch)},t.prototype.init=function(){this.registerNotify()},t.prototype.updateOnlinePlayers=function(t){ControllerUtil.checkOnlineData(t)},t.prototype.clearHall=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.removeRegisterNotify(),this.room_id=void 0,[4,ControllerUtil.unsubRooms(this.type)];case 1:return t.sent(),[2]}})})},t.prototype.registerDeskData=function(){var t=ControllerUtil.deskTopicListen(this.type,this.desk_id),e=this.deskHandler;util.LogUtil.debug("[MatchDeskGameController] [registerDeskData] key => "+t),util.NotifyUtil.addNotification(t,e),this.deskRegisterMap.set(t,e)},t.prototype.removeRegisterDeskData=function(){this.deskRegisterMap.forEach(function(t,e){util.LogUtil.debug("[MatchDeskGameController] [removeRegisterDeskData] key => "+e),util.NotifyUtil.removeNotification(e,t)}),this.deskRegisterMap.clear()},t.prototype.enterGame=function(t,e,i){return void 0===i&&(i=!1),__awaiter(this,void 0,void 0,function(){var n,o,r,s,a,l;return __generator(this,function(u){switch(u.label){case 0:return this.is_cancel=!1,this.room_id=t,e?(this.desk_id=e,[3,3]):[3,1];case 1:return[4,service.MainService.instance.enterRoom(this.desk_topic,this.room_id,this.enter_room_args,i)];case 2:if(n=u.sent(),this.is_cancel)return[2];if(!n)return util.LogUtil.warn("[MatchDeskGameController] [MatchDeskID] failed"),[2];Data.validate(topic.DeskTopic.enterDeskSchema,n),o=n.snapshot.topics.desk,this.desk_id=o.substring(o.lastIndexOf("/")+1),util.LogUtil.debug("[MatchDeskGameController] [MatchDeskID] desk_id => "+this.desk_id+" enter_desk_topic => ",n),u.label=3;case 3:return r=ControllerUtil.uniteDeskTopic(this.type,this.desk_id),e?(a=Data.getTopic(r),[3,6]):[3,4];case 4:return[4,service.MainService.instance.subsDesk(this.desk_topic,this.desk_id,r)];case 5:a=u.sent(),u.label=6;case 6:return s=a,util.LogUtil.debug("[MatchDeskGameController] [enterGame] desk_id => "+this.desk_id+" desk_topic_data => ",s),!s||this.is_cancel?[3,9]:(service.MainService.instance.updateOnlinePlayers(!0,this.type,this.room_id),util.LogUtil.info("[MatchDeskGameController] [enterGame] desk_id => "+this.desk_id),l=!this.room_ui.stage,l?[4,Controller.instance.toggleUI(this.room_ui,!0,!1)]:[3,8]);case 7:l=u.sent(),u.label=8;case 8:return this.showMatchDialog(),this.initDesk(s),this.registerDeskData(),[3,10];case 9:util.LogUtil.warn("[MatchDeskGameController] [subscribeDesk] failed or canceled"),this.desk_id=void 0,u.label=10;case 10:return[2]}})})},t.prototype.autoHideMatch=function(){ui.dialog.MatchDialog.instance.option.onClose=void 0,ui.dialog.MatchDialog.instance.close()},t.prototype.checkLeaveGame=function(){return!this.desk_id},t.instanceMap=new Map,t}();__reflect(MatchDeskGameController.prototype,"MatchDeskGameController",["IGameController"]);var service;
!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;return Promise.all([this.checkChannel(),new Promise(function(e,i){util.NotifyUtil.addNotification("topic.account",function(){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return[4,this.subscribe(Const.Topic.TIMESTAMP)["catch"](function(t){return i(new Error(util.LanguageUtil.translate("lbl_game_bookerror",t.message.replace(/\s/g,""))))})];case 1:return t=n.sent(),Data.validate(topic.TimestampTopic.schema,t,refresh),util.TimeUtil.setTime(t.snapshot.timestamp),util.TimeUtil.init(),e(),[2]}})})},!0)})])},e.prototype.onMessage=function(t,e){return __awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(o){switch(o.label){case 0:switch(i=t){case Const.Topic.TIMESTAMP:return[3,1];case Const.Topic.SYSTEM:return[3,3]}return[3,4];case 1:return[4,this.snapshot(t,{g_stats:Main.instance.stats})];case 2:return n=o.sent(),Data.validate(topic.TimestampTopic.schema,n),util.TimeUtil.setTime(n.snapshot.timestamp),[3,4];case 3:return this.onSystemNotify(e),[3,4];case 4:return[2]}})})},e.prototype.checkChannel=function(){return totalTime=Date.now()-totalTime,params.guest||params.username&&params.accessToken||params.params?this.connectServer():(section.style.display="none",Main.instance.addChild(ui.LoginUI.instance),ui.LoginUI.instance.setInitData(!0),util.NotifyUtil.addNotification("Main.instance.fps",function(t){return ui.LoginUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FPS,t)}),void 0)},e.prototype.connectServer=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,o,r,s=this;return __generator(this,function(a){switch(a.label){case 0:return e=Const.Config.DEFAULT_HTTP_HOST+"/token/"+Const.UserInfo.CHANNEL_ID+"/login_token?os="+Const.OS+"&language="+Const.Config.LANGUAGE,i=Const.Config.DEFAULT_SOCKET_HOST,totalTime=Date.now()-totalTime,t?e+="&credential="+encodeURIComponent(Base64.encode(t.username+":"+t.password)):params.guest?(e+="&guest=guest",i+="/guest"):e+=params.params?"&params="+encodeURIComponent(params.params):"&username="+params.username+"&access_token="+encodeURIComponent(params.accessToken),[4,util.NetUtil.request("POST",e)["catch"](function(t){var e,i=/^\d+$/.test(t.message)?t.message:function(){try{return JSON.parse(t.message)}catch(e){return t.message}}();switch(i.type){case"maintenance":e=util.LanguageUtil.translate("lbl_game_server")+"（"+i.message.replace(/\s/g,"")+"）";break;case"bad_password":e="lbl_game_usernamerror";break;case"invalid_token":case"third_part_sign":case"third_part_banned":case"third_part_maintenance":case"third_part":e=i.type;break;case"third_expired":return refresh(location.origin+"/assets/description/redirect.html?lang="+Const.Config.LANGUAGE+"&hide_back=false&callback="+encodeURIComponent(i.message)),Promise.resolve({response:null});default:e=util.LanguageUtil.translate("lbl_game_tokenerror",(i.message||i.type||t.message).replace(/\s/g,""))}return Promise.reject(new Error(e))})];case 1:n=a.sent().response;try{n=JSON.parse(n)}catch(l){return util.LogUtil.error(l.message,n),[2,Promise.reject(l)]}return n?(Data.validate({type:"object",properties:{username:{type:"string"},login_token:{type:"string"},channel_id:{type:"number"},notify:{type:"object",additionalProperties:{type:"object",properties:{type:{type:"string"},payout:{type:"number"},payout_time:{type:"number"}},required:["type","payout","payout_time"]}}},required:["login_token","channel_id"],"if":!params.guest,then:{required:["username"]}},n,refresh),util.LogUtil.debug("[LoginService] [connectServer] login_token => "+JSON.stringify(n)),params.username=n.username,Const.UserInfo.TOKEN=n.login_token,Const.UserInfo.CHANNEL_ID=n.channel_id,Const.Config.POOL_NOTIFY=n.notify,i+="?token="+Const.UserInfo.TOKEN+(params.username?"&username="+params.username:"")+"&channel="+Const.UserInfo.CHANNEL_ID+"&cdn_ip="+(channel&&channel.cdn?channel.cdn.replace(/^https?:\/\//,""):location.host)+"&platform=h5_"+(egret.Capabilities.isMobile?"mobile":"desktop")+"&os="+Const.OS+"&device_model="+encodeURIComponent(ua)+"&resolution_width="+screen.width*window.devicePixelRatio+"&resolution_height="+screen.height*window.devicePixelRatio,[4,util.NetUtil.requestWithAuth("GET",Const.Config.DEFAULT_HTTP_HOST+"/channels/"+Const.UserInfo.CHANNEL_ID)["catch"](function(t){return Promise.reject(new Error(util.LanguageUtil.translate("lbl_game_channelerror",t.message.replace(/\s/g,""))))})]):[3,4];case 2:n=a.sent().response;try{n=JSON.parse(n)}catch(l){return util.LogUtil.error(l.message,n),[2,Promise.reject(l)]}return Data.validate({type:"object",properties:{transfer_in_url_switcher:{type:"number"},transfer_in_url:{type:"string"},open_pool_switcher:{type:"number"},connect_address_switcher:{type:"number"},lobby_background_image:{type:"number"},game_list:{type:"array",items:{type:"string"}},hot_list:{type:"array",items:{type:"string"}},desk_logo:{type:"string"},baicao_chips:{type:"object",properties:{chip1:{type:"string"}}},card_back:{type:"string"}},required:["game_list","hot_list"],"if":{properties:{transfer_in_url_switcher:{"const":1}}},then:{required:["transfer_in_url"]}},n,refresh),util.LogUtil.debug("[LoginService] [connectServer] channels => "+JSON.stringify(n)),Const.Config.TRANSFER_IN_URL_SWITCHER=n.transfer_in_url_switcher,Const.Config.TRANSFER_IN_URL=n.transfer_in_url,Const.Config.OPEN_POOL_SWITCHER=n.open_pool_switcher,Const.Config.CONNECT_ADDRESS_SWITCHER=n.connect_address_switcher,Const.Config.LOBBY_BACKGROUND_IMAGE=n.lobby_background_image,(o=GameConst.game_list).push.apply(o,n.game_list),(r=GameConst.hot_list).push.apply(r,n.hot_list),[4,Promise.all([function(){return __awaiter(s,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,util.NetUtil.requestWithAuth("GET",Const.Config.DEFAULT_HTTP_HOST+"/settings")];case 1:t=i.sent().response;try{t=JSON.parse(t)}catch(n){return util.LogUtil.error(n.message,t),[2,Promise.reject(n)]}return Data.validate({type:"array",items:{type:"object",properties:{code:{type:"string"},value:{type:"string"}},required:["code","value"]}},t,refresh),Const.Config.LOG_SWITCHER=!!t.filter(function(t){return"client_log_switch"===t.code&&"true"===t.value}).length,e=t.filter(function(t){return"connect_address"===t.code}).map(function(t){return t.value})[0],Const.Config.CONNECT_ADDRESS_SWITCHER&&e&&(Const.Config.CONNECT_ADDRESS=[{text:"powered by "+e,style:{href:e}}]),[2]}})})}(),function(){return __awaiter(s,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=Const.Config,[4,RES.getResByUrl((channel&&channel.rs_gss_cdn?channel.rs_gss_cdn+"/"+md5Url(n.desk_logo):""+Const.Config.DEFAULT_HOST+n.desk_logo)+"?t="+Date.now(),null,null,RES.ResourceItem.TYPE_IMAGE)];case 1:return[2,t.DESK_LOGO=e.sent()]}})})}(),function(){return __awaiter(s,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=Const.Config,[4,RES.getResByUrl((channel&&channel.rs_gss_cdn?channel.rs_gss_cdn+"/"+md5Url(n.baicao_chips.chip1):""+Const.Config.DEFAULT_HOST+n.baicao_chips.chip1)+"?t="+Date.now(),null,null,RES.ResourceItem.TYPE_IMAGE)];case 1:return[2,t.CHIP_LOGO=e.sent()]}})})}(),function(){return __awaiter(s,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=Const.Config,[4,RES.getResByUrl((channel&&channel.rs_gss_cdn?channel.rs_gss_cdn+"/"+md5Url(n.card_back):""+Const.Config.DEFAULT_HOST+n.card_back)+"?t="+Date.now(),null,null,RES.ResourceItem.TYPE_IMAGE)];case 1:return[2,t.CARD_BACK=e.sent()]}})})}()])["catch"](function(){return Promise.resolve()})];case 3:return a.sent(),localStorage.removeItem("_guest"),util.UserStorageUtil.setItem("username",params.username),[2,util.NetUtil.connect(i)];case 4:return[2]}})})},e.prototype.onSystemNotify=function(t){switch(Data.validate(topic.SystemNotifyTopic.schema,t,refresh),util.LogUtil.debug("[LoginService] [onSystemNotify] topic => "+JSON.stringify(t)),t.snapshot.type){case"maintenance_notify":ui.dialog.MessageDialog.instance.showAlert("lbl_game_willserver","lbl_game_comfirm");break;case"login_successful":Const.UserInfo.USER_ID=t.snapshot.user_id,Const.UserInfo.NICK=params.guest?t.snapshot.username:params.username,t.snapshot.avatar&&RES.hasRes(t.snapshot.avatar)&&(Const.UserInfo.AVATAR=t.snapshot.avatar),this.subscribe(Const.Topic.ACCOUNT)}},e.prototype.keepAlive=function(){return this.snapshot(Const.Topic.KEEPALIVE,{timestamp:util.TimeUtil.now})},e}(t.ServiceBase);t.LoginService=e,__reflect(e.prototype,"service.LoginService")}(service||(service={}));var ui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(t){var e=this.instanceMap.get(t);return e||(e=new(Function.prototype.bind.call(t,null)),this.instanceMap.set(t,e)),e},e.getMainSize=function(){var t="1"===Main.instance.gameSkin,e=window.innerWidth>window.innerHeight,i=t&&e;return!i&&Math.max(window.innerWidth/window.innerHeight,window.innerHeight/window.innerWidth)>16/9?e?{width:Math.max(Main.instance.stage.stageHeight/9*16,Math.min(Main.instance.stage.stageHeight/9*21,Main.instance.stage.stageWidth-(screen.width/screen.height>16/9?240:0))),height:Main.instance.stage.stageHeight}:{width:Main.instance.stage.stageWidth,height:Math.max(Main.instance.stage.stageWidth/9*16,Math.min(Main.instance.stage.stageWidth/9*21,Main.instance.stage.stageHeight-(screen.height/screen.width>16/9?240:0)))}:!t&&e?{width:Main.instance.stage.stageWidth,height:Math.min(Main.instance.stage.stageHeight,Main.instance.stage.stageWidth)}:{width:Math.min(Main.instance.stage.stageWidth,Main.instance.stage.stageHeight/16*(i?9:16)),height:Main.instance.stage.stageHeight}},e.prototype.childrenCreated=function(){var i=this;if(t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.initUI(),document.addEventListener("keyup",function(t){return i.stage&&i.onKeyUp(t.key)}),this.main){var n=function(){var t=e.getMainSize();i.main.width=t.width,i.main.height=t.height};n(),this.main.verticalCenter=this.main.horizontalCenter=0,this.stage.addEventListener(egret.Event.RESIZE,n,this)}this.addEventListener(egret.Event.ADDED_TO_STAGE,this.initUI,this),this.registerEvent(),this.isComplete=!0,void 0!==this.data&&this.initData()},e.prototype.onKeyUp=function(t){},e.prototype.setInitData=function(t){this.data=t,this.isComplete&&this.initData()},e.instanceMap=new Map,e}(t.Component);t.UIBase=e,__reflect(e.prototype,"ui.UIBase")}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bindData={},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),mouse.setButtonMode(this,!0),this.addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){e.onMouse=!0,e.invalidateState()},this),this.addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){e.onMouse=!1,e.invalidateState(),util.TimeUtil.clearTimeout(e.longTouchTimeout)},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){util.SoundUtil.play("btn_menu_mp3"),util.TimeUtil.clearTimeout(e.longTouchTimeout),e.onLong&&t.stopImmediatePropagation()},this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){util.TimeUtil.clearTimeout(e.longTouchTimeout)},this)},e.prototype.onTouchBegin=function(i){var n=this;t.prototype.onTouchBegin.call(this,i),this.onLong=!1,this.enableLongTouch&&(this.longTouchTimeout=util.TimeUtil.setTimeout(function(){n.dispatchEventWith(e.EVT_LONG_TOUCH),n.onLong=!0},this.longTime||500))},e.prototype.onTouchCancle=function(e){t.prototype.onTouchCancle.call(this,e),this.invalidateState(),util.TimeUtil.clearTimeout(this.longTouchTimeout)},e.prototype.getCurrentState=function(){var e=t.prototype.getCurrentState.call(this),i=""+e+(this.onMouse?"AndHover":"");return this.skin.hasState(i)?i:e},Object.defineProperty(e.prototype,"longTime",{get:function(){return this._longTime},set:function(t){this._longTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableLongTouch",{get:function(){return this._enableLongTouch},set:function(t){this._enableLongTouch=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bindData",{get:function(){return this._bindData},set:function(t){this._bindData=t},enumerable:!0,configurable:!0}),e.EVT_LONG_TOUCH="evt_long_touch",e}(eui.Button);t.Button=e,__reflect(e.prototype,"ui.control.Button")}(e=t.control||(t.control={}))}(ui||(ui={}));var LiengController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enter_room_args={ante:0},e.type="lieng",e.initDesk=function(t){e.hideLoading(t),ui.lieng.RoomUI.instance.desk_id=e.desk_id,ui.lieng.RoomUI.instance.setInitData({ante:e.enter_room_args.ante})},e.updateDesk=function(t,i){Data.validate(topic.liengSchema,t);var n=t.snapshot,o=i.snapshot;e.checkNewData(t,i,"op_info")&&ui.lieng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_BET),e.checkNewData(t,i,"settle")&&ui.lieng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SETTLE),e.checkNewData(t,i,"room_setting")&&ui.lieng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),e.checkNewData(t,i,"user_info")&&ui.lieng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),n.stage!==o.stage&&(ui.lieng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t))},e.checkNewData=function(t,e,i){return!e||!util.ObjectUtil.isEqual(t.snapshot[i],e.snapshot[i])},e.fight=function(t){switch(t.type){case"raise":service.LiengService.instance.raise(e.desk_topic+"/"+e.desk_id,t.value);break;case"call":service.LiengService.instance.call(e.desk_topic+"/"+e.desk_id);break;case"quit":service.LiengService.instance.quit(e.desk_topic+"/"+e.desk_id);break;case"all_in":service.LiengService.instance.all_in(e.desk_topic+"/"+e.desk_id)}},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_FIGHT,this.fight)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_FIGHT,this.fight)},e.prototype.updateOnlinePlayers=function(e){t.prototype.updateOnlinePlayers.call(this,e),ui.lieng.Hall.instance.updataNumber()},e.prototype.checkReBackRoom=function(t){return t&&"settle"!==t.snapshot.stage.toLowerCase()},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&t.snapshot&&t.snapshot.stage&&"none"!==t.snapshot.stage.toLowerCase()&&this.autoHideMatch()},e}(MatchDeskGameController);__reflect(LiengController.prototype,"LiengController");var PaigowController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="pg",e.initDesk=function(t){e.hideLoading(t),ui.paigow.RoomUI.instance.desk_id=e.desk_id,ui.paigow.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i){Data.validate(topic.paigowSchema,t);var n=t.snapshot,o=i.snapshot;n.desk_info.stage!==o.desk_info.stage&&(ui.paigow.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t)),util.ObjectUtil.isEqual(n.room_setting,o.room_setting)||ui.paigow.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),util.ObjectUtil.isEqual(n.user_info,o.user_info)||ui.paigow.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),util.ObjectUtil.isEqual(n.dispute,o.dispute)||ui.paigow.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DISPUTE),util.ObjectUtil.isEqual(n.raise,o.raise)||ui.paigow.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE),util.ObjectUtil.isEqual(n.settle,o.settle)||ui.paigow.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SETTLE)},e.sendDispute=function(t){return service.PaigowService.instance.disputeBanker(e.desk_topic+"/"+e.desk_id,t.rate)},e.sendRasie=function(t){return service.PaigowService.instance.rasie(e.desk_topic+"/"+e.desk_id,t.rate)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie)},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&"init"!==t.snapshot.desk_info.stage.toLowerCase()&&this.autoHideMatch()},e.prototype.checkReBackRoom=function(t){return t&&"end"!==t.snapshot.desk_info.stage.toLowerCase()},e}(MatchDeskGameController);__reflect(PaigowController.prototype,"PaigowController");var PokdengController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="pokdeng",e.initDesk=function(t){Data.validate(topic.PokdengDeskTopic.schema,t),e.hideLoading(t),ui.pokdeng.RoomUI.instance.desk_id=e.desk_id,ui.pokdeng.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i,n){Data.validate(topic.PokdengDeskTopic.schema,t);var o=t.snapshot,r=i.snapshot;util.LogUtil.debug("[updateDesk] [receive] desk_id => "+JSON.stringify(e.desk_id)+" newRaw => "+JSON.stringify(n)),util.ObjectUtil.isEqual(o.room_setting,r.room_setting)||ui.pokdeng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),util.ObjectUtil.isEqual(o.user_info,r.user_info)||ui.pokdeng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),util.ObjectUtil.isEqual(o.raise,r.raise)||ui.pokdeng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE),util.ObjectUtil.isEqual(o.fight_position,r.fight_position)||ui.pokdeng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DECISION_POSITION),util.ObjectUtil.isEqual(o.fight,r.fight)||ui.pokdeng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),util.ObjectUtil.isEqual(o.settle,r.settle)||ui.pokdeng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SETTLE),o.stage!==r.stage&&(util.LogUtil.info("desk_id => "+JSON.stringify(e.desk_id)+" CMD_UPDATE_STAGE:"+JSON.stringify(o.stage)),ui.pokdeng.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t))},e.sendFightDone=function(t){util.LogUtil.info("[PokdengController] [sendFightDone] desk_id => "+e.desk_id+"  desk_topic => "+e.desk_topic+" [send] more_card => "+JSON.stringify(t)),service.PokdengService.instance.fight(e.desk_topic+"/"+e.desk_id,t)},e.sendRasie=function(t){util.LogUtil.info("[PokdengController] [sendRasie] desk_id => "+e.desk_id+"  desk_topic => "+e.desk_topic+" [send] rate => "+JSON.stringify(t)),service.PokdengService.instance.raise(e.desk_topic+"/"+e.desk_id,t)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie)},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&t.snapshot.stage&&"none"!==t.snapshot.stage.toLowerCase()&&this.autoHideMatch()},e.prototype.checkReBackRoom=function(t){var e=t&&"settle"!==t.snapshot.stage.toLowerCase();return!e&&util.LogUtil.warn("[checkReBackRoom] desk_topic:"+!!t+" desk_topic.snapshot.stage:"+t.snapshot.stage),e},e}(MatchDeskGameController);__reflect(PokdengController.prototype,"PokdengController");var SedieController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="button",e.updateDesk=function(t,i,n){var o=t&&t.snapshot,r=i&&i.snapshot,s=n&&n.snapshot;if(util.LogUtil.debug("[SedieController] [updateDesk] newRaw => "+JSON.stringify(s)),util.ObjectUtil.isEqual(o.user_info.bet,r.user_info.bet)||(util.LogUtil.debug("[SedieController] CMD_UPDATE_BET => "+JSON.stringify(o.user_info.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_BET,{own:o.user_info.bet,total:o.bet})),util.ObjectUtil.isEqual(o.bet,r.bet)||(util.LogUtil.debug("[SedieController] CMD_UPDATE_ALL_BET => "+JSON.stringify(o.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ALL_BET,{own:o.user_info.bet,total:o.bet})),!util.ObjectUtil.isEqual(o.open,r.open)&&o.open&&(util.LogUtil.debug("[SedieController] CMD_UPDATE_CARDS => "+JSON.stringify(o.open)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_CARDS,o.open)),o.open&&util.ObjectUtil.isEqual(o.user_info.balance,r.user_info.balance)&&egret.log("settle",JSON.stringify(o,null,"	")),o.open&&util.ObjectUtil.isEqual(o.user_info.balance,r.user_info.balance)){var a={desk_settles:o.desk_settles,own_settle:o.user_info.settle,surplus:o.user_info.surplus};e.old_settle_log&&util.ObjectUtil.isEqual(a,e.old_settle_log)||(e.old_settle_log=a,util.LogUtil.debug("[SedieController] CMD_UPDATE_SETTLE => "+JSON.stringify(a))),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_SETTLE,{open:o.open,total_bet:o.bet,own_bet:o.user_info.bet,desk_settles:o.desk_settles,own_settle:o.user_info.settle,surplus:o.user_info.surplus,result:o.result})}util.ObjectUtil.isEqual(o.user_info,r.user_info)||(util.LogUtil.debug("[SedieController] CMD_UPDATE_USER_INFO"),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO,o.user_info)),util.ObjectUtil.isEqual(o.round_id,r.round_id)&&util.ObjectUtil.isEqual(o.round_number,r.round_number)||(util.LogUtil.debug("[SedieController] CMD_UPDATE_ROUND_INFO"),e.old_settle_log=void 0,e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO,{round_id:o.round_id,round_number:o.round_number}))},e.initDesk=function(t){util.LogUtil.debug("[SedieController] [initDesk]");var i=e.room_setting_map.get(e.room_id),n=Data.getTopic(i.stage_topic);e.room_ui.setInitData({stage:n.snapshot,desk:t.snapshot,desk_item:e.room_bind_data_map.get(e.room_id)}),util.LogUtil.info("[SedieController] [setInitData]"),e.registerDeskData()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.updateRoadMapHandler=function(t,e){t.road_map=util.ObjectUtil.copy(e.snapshot.round_result),t.result_percent=util.ObjectUtil.copy(e.snapshot.result_percent),t.room_id===this.room_id&&ui.sedie.RoomUI.instance.stage&&ui.sedie.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t),ui.sedie.Hall.instance.udpateRoadMap(t)},e.prototype.updateStageHandler=function(t,e,i,n){var o=e.snapshot,r=e.snapshot.bet_limit,s=0,a=0,l="",u="",h=0;if(o.pools&&o.pools[Const.UserInfo.CHANNEL_ID]){var c=o.pools[Const.UserInfo.CHANNEL_ID];h=(c.robot||0)+(c[params.guest?"guest":"player"]||0)}Object.keys(r.min).forEach(function(t){var e=Number(r.min[t]);(0===s||s>e)&&(s=e)}),Object.keys(r.max).forEach(function(t){var e=Number(r.max[t]);(0===a||e>a)&&(a=e)}),l=util.NumberUtil.formatUnit(s),u=util.NumberUtil.formatUnit(a),t.simple_limit=l+"-"+u,t.limit=""+util.LanguageUtil.translate("lbl_room_betlimit")+t.simple_limit+" ",t.stage_timestamp=o.stage_timestamp,t.stage_room_setting=o.room_setting,t.pool=util.NumberUtil.formatUnit(h),o.stage!==t.game_stage&&t.room_id===this.room_id&&this.room_ui.stage&&(t.game_stage=o.stage,"after_settle"===t.game_stage.toLowerCase()&&this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROBOT_SETTEL,e.snapshot.channel_settles[Const.UserInfo.CHANNEL_ID]),this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_STAGE,e.snapshot))},e}(JoinDeskGameController);__reflect(SedieController.prototype,"SedieController");var ThirteenKillController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enter_room_args={ante:0},e.type="tk",e.initDesk=function(t){e.hideLoading(t),ui.thirteenkill.RoomUI.instance.desk_id=e.desk_id,e.room_ui.setInitData({ante:e.enter_room_args.ante})},e.updateDesk=function(t,i){Data.validate(topic.thirteenkillSchema,t);var n=t.snapshot,o=i.snapshot;e.checkNewData(t,i,"desk")&&e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),n.stop_decision_ts!==o.stop_decision_ts&&e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),e.checkNewData(t,i,"dispute")&&e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_DISPUTE),n.desk&&o.desk&&e.checkdeskdata(n.desk,o.desk,"all_kill")&&e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_SETTLE),n.desk&&o.desk&&e.checkdeskdata(n.desk,o.desk,"award")&&e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_BALANCE,n.desk),e.checkNewData(t,i,"room_setting")&&e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),n.stage!==o.stage&&(e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t))},e.checkNewData=function(t,e,i){return!e||!util.ObjectUtil.isEqual(t.snapshot[i],e.snapshot[i])},e.pass=function(){var t=service.ThirteenKillService.instance.pass(e.desk_topic+"/"+e.desk_id);t&&t.then(function(){e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_MYPOKER,{isPass:!0})})},e.play=function(t){var i=service.ThirteenKillService.instance.play(e.desk_topic+"/"+e.desk_id,t);i&&i.then(function(){e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_MYPOKER,{isPass:!1,cards:t})})&&i["catch"](function(){})},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_POKER_PASS,this.pass),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_POKER_PLAY,this.play)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_POKER_PASS,this.pass),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_POKER_PLAY,this.play)},e.prototype.checkdeskdata=function(t,e,i){return t[1][i]!==e[1][i]||t[2][i]!==e[2][i]||t[3][i]!==e[3][i]||t[4][i]!==e[4][i]},e.prototype.checkReBackRoom=function(t){return t&&"payout"!==t.snapshot.stage.toLowerCase()},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&t.snapshot&&t.snapshot.stage&&"none"!==t.snapshot.stage.toLowerCase()&&this.autoHideMatch()},e.prototype.updateOnlinePlayers=function(e){t.prototype.updateOnlinePlayers.call(this,e),ui.thirteenkill.Hall.instance.updataNumber()},e}(MatchDeskGameController);__reflect(ThirteenKillController.prototype,"ThirteenKillController");var ThreeController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="sungung",e.initDesk=function(t){Data.validate(topic.ThreeDeskTopic.schema,t),util.LogUtil.debug("[ThreeController] [enterDesk] desk_topic => "+JSON.stringify(t)),e.hideMath(t.snapshot.stage),!t.snapshot.raise_rate_options&&(t.snapshot.raise_rate_options=void 0),ui.three.RoomUI.instance.setInitData({deskStage:t.snapshot.stage,stage_timestamp:t.snapshot.stage_timestamp,ante:t.snapshot.bet_limit.ante,desk_id:e.desk_id,room_setting:util.ObjectUtil.copy(t.snapshot.room_setting),userInfo:util.ObjectUtil.copy(t.snapshot.user_info),dispute:util.ObjectUtil.copy(t.snapshot.dispute),raise_rate_options:t.snapshot.raise_rate_options,raise:util.ObjectUtil.copy(t.snapshot.raise),fight:util.ObjectUtil.copy(t.snapshot.fight),settle:util.ObjectUtil.copy(t.snapshot.settle)})},e.hideMath=function(t){ui.dialog.MatchDialog.instance.stage&&"NONE"!==t&&e.autoHideMatch()},e.updateStage=function(t){util.LogUtil.info("[ThreeController] [updateStage] stage => "+t),e.hideMath(t),ui.three.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE,t)},e.updateUserInfo=function(t){Data.validate(topic.DeskTopic.UserItem.schema,t),util.LogUtil.info("[ThreeController] [updateUserInfo] userInfo => "+JSON.stringify(t)),ui.three.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO,util.ObjectUtil.copy(t))},e.updateDispute=function(t,e,i,n){Data.validate(topic.DeskTopic.DisputeItem.schema,t),util.LogUtil.warn("[ThreeController] [updateDispute] "+n+" dispute => "+JSON.stringify(t)),ui.three.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DISPUTE,{position:Number(n.replace(/.*\./,"")),dispute:util.ObjectUtil.copy(t)})},e.updateRaiseRateOptions=function(t){util.LogUtil.info("[ThreeController] [updateRaiseRateOptions] raise_rate_options => "+t),ui.three.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE_RATE_OPTIONS,t)},e.updateRaise=function(t,e,i,n){Data.validate(topic.DeskTopic.RaiseItem.schema,t),util.LogUtil.warn("[ThreeController] [updateRaise] "+n+" raise => "+JSON.stringify(t)),ui.three.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE,{position:Number(n.replace(/.*\./,"")),raise:util.ObjectUtil.copy(t)})},e.updateFight=function(t,e,i,n){Data.validate(topic.ThreeDeskTopic.Snapshot.Fight.FightItem.schema,t),util.LogUtil.warn("[ThreeController] [updateFight] "+n+" fight => "+JSON.stringify(t)),ui.three.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT,{position:Number(n.replace(/.*\./,"")),fight:util.ObjectUtil.copy(t)})},e.updateSettle=function(t){Data.validate(topic.ThreeDeskTopic.Snapshot.Settle.schema,t),util.LogUtil.warn("[ThreeController] [updateSettle] settle => "+JSON.stringify(t)),ui.three.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SETTLE,util.ObjectUtil.copy(t))},e.sendDispute=function(t,i){util.LogUtil.warn("[ThreeController] [sendDispute] "+t+" dispute_rate => "+i),service.ThreeService.instance.dispute(e.desk_topic+"/"+e.desk_id,t,i)},e.sendRaise=function(t,i){util.LogUtil.warn("[ThreeController] [sendRaise] "+t+" raise_rate => "+i),service.ThreeService.instance.rasie(e.desk_topic+"/"+e.desk_id,t,i)},e.sendFight=function(t){util.LogUtil.warn("[ThreeController] [sendFight] "+t),service.ThreeService.instance.fight(e.desk_topic+"/"+e.desk_id,t)},e.updateDesk=function(){},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RAISE,this.sendRaise),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_FIGHT,this.sendFight)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_RAISE,this.sendRaise),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_FIGHT,this.sendFight)},e.prototype.registerDeskData=function(){t.prototype.registerDeskData.call(this),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.stage",this.updateStage),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.1",this.updateUserInfo),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.2",this.updateUserInfo),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.3",this.updateUserInfo),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.4",this.updateUserInfo),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.5",this.updateUserInfo),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.1",this.updateDispute),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.2",this.updateDispute),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.3",this.updateDispute),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.4",this.updateDispute),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.5",this.updateDispute),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise_rate_options",this.updateRaiseRateOptions),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.1",this.updateRaise),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.2",this.updateRaise),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.3",this.updateRaise),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.4",this.updateRaise),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.5",this.updateRaise),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.1",this.updateFight),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.2",this.updateFight),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.3",this.updateFight),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.4",this.updateFight),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.5",this.updateFight),util.NotifyUtil.addNotification("topic.sungung_desk/"+this.desk_id+".snapshot.settle",this.updateSettle)
},e.prototype.removeRegisterDeskData=function(){t.prototype.removeRegisterDeskData.call(this),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.stage",this.updateStage),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.1",this.updateUserInfo),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.2",this.updateUserInfo),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.3",this.updateUserInfo),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.4",this.updateUserInfo),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.user_info.5",this.updateUserInfo),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.1",this.updateDispute),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.2",this.updateDispute),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.3",this.updateDispute),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.4",this.updateDispute),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.dispute.5",this.updateDispute),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise_rate_options",this.updateRaiseRateOptions),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.1",this.updateRaise),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.2",this.updateRaise),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.3",this.updateRaise),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.4",this.updateRaise),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.raise.5",this.updateRaise),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.1",this.updateFight),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.2",this.updateFight),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.3",this.updateFight),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.4",this.updateFight),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.fight.5",this.updateFight),util.NotifyUtil.removeNotification("topic.sungung_desk/"+this.desk_id+".snapshot.settle",this.updateSettle)},e.prototype.checkReBackRoom=function(t){return"SETTLE"!==t.snapshot.stage},e}(MatchDeskGameController);__reflect(ThreeController.prototype,"ThreeController");var ThreeFlowerController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="tgf",e.initDesk=function(t){e.hideLoading(t),ui.threeflower.RoomUI.instance.desk_id=e.desk_id,ui.threeflower.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i){Data.validate(topic.threeflowerSchema,t);var n=t.snapshot,o=i.snapshot;e.checkNewData(t,i,"user_info")&&ui.threeflower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),e.checkNewData(t,i,"desk_info")&&ui.threeflower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DESK_INFO),e.checkNewData(t,i,"dispute")&&ui.threeflower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DISPUTE),e.checkNewData(t,i,"deal")&&ui.threeflower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),e.checkNewData(t,i,"room_setting")&&ui.threeflower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),n.desk_info.stage!==o.desk_info.stage&&(ui.threeflower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t))},e.checkNewData=function(t,e,i){return!e||!util.ObjectUtil.isEqual(t.snapshot[i],e.snapshot[i])},e.dispute=function(t){service.ThreeFlowerService.instance.dispute(e.desk_topic+"/"+e.desk_id,t)},e.sendFightDone=function(){service.ThreeFlowerService.instance.fight(e.desk_topic+"/"+e.desk_id)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DISPUTE,this.dispute),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_FIGHT,this.sendFightDone)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DISPUTE,this.dispute),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_FIGHT,this.sendFightDone)},e.prototype.checkReBackRoom=function(t){return t&&"settle"!==t.snapshot.desk_info.stage.toLowerCase()},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&t.snapshot.desk_info&&t.snapshot.desk_info.stage&&"init"!==t.snapshot.desk_info.stage.toLowerCase()&&this.autoHideMatch()},e}(MatchDeskGameController);__reflect(ThreeFlowerController.prototype,"ThreeFlowerController");var TwoEightController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="te",e.initDesk=function(t){Data.validate(topic.TwoEightDeskTopic.schema,t),e.hideLoading(t),ui.twoeight.RoomUI.instance.desk_id=e.desk_id,ui.twoeight.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i,n){Data.validate(topic.TwoEightDeskTopic.schema,t);var o=t.snapshot,r=i.snapshot;util.LogUtil.debug("[updateDesk] [receive] desk_id => "+JSON.stringify(e.desk_id)+" newRaw => "+JSON.stringify(n)),o.desk_info.stage!==r.desk_info.stage&&(util.LogUtil.info("desk_id => "+JSON.stringify(e.desk_id)+" CMD_UPDATE_STAGE:"+JSON.stringify(o.desk_info.stage)),ui.twoeight.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t)),util.ObjectUtil.isEqual(o.room_setting,r.room_setting)||ui.twoeight.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),util.ObjectUtil.isEqual(o.user_info,r.user_info)||ui.twoeight.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),util.ObjectUtil.isEqual(o.dispute,r.dispute)||ui.twoeight.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DISPUTE),util.ObjectUtil.isEqual(o.raise,r.raise)||ui.twoeight.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE),util.ObjectUtil.isEqual(o.settle,r.settle)||ui.twoeight.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SETTLE),util.ObjectUtil.isEqual(o.desk_info,r.desk_info)||ui.twoeight.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DESK_INFO),o.desk_info.round!==r.desk_info.round&&ui.twoeight.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO)},e.sendDispute=function(t){util.LogUtil.info("[TwoEightController] [sendDispute] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic+" rate => "+t.rate),service.TwoEightService.instance.disputeBanker(e.desk_topic+"/"+e.desk_id,t.rate)},e.sendRasie=function(t){util.LogUtil.info("[TwoEightController] [sendRasie] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic+" rate => "+t.rate),service.TwoEightService.instance.rasie(e.desk_topic+"/"+e.desk_id,t.rate)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie)},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&"init"!==t.snapshot.desk_info.stage&&this.autoHideMatch()},e.prototype.checkReBackRoom=function(t){var e=t&&"end"!==t.snapshot.desk_info.stage.toLowerCase();return!e&&util.LogUtil.warn("[checkReBackRoom] desk_topic:"+!!t+" desk_topic.snapshot.desk_info.stage:"+t.snapshot.desk_info.stage),e},e}(MatchDeskGameController);__reflect(TwoEightController.prototype,"TwoEightController");var Const;!function(t){t.SERVICE=[service.LoginService,service.MainService];var e=function(){function t(){}return Object.defineProperty(t,"DEFAULT_SOCKET_HOST",{get:function(){return this.DEFAULT_HOST.replace("http","ws")+"/goral/ws"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DEFAULT_HTTP_HOST",{get:function(){return this.DEFAULT_HOST+"/goral/api"},enumerable:!0,configurable:!0}),t.SKIN=params.skin||"0",t.LANGUAGE=params.lang||"zh_cn",t.SKIP_ASSET=["null_png","top_btn_null_png","menu_pic_null_png","hundreds_road_null_png","tf_pic_card_type_bgnull_png","tf_font_null_png","ho_pic_roadnull_png","b_chip_null_png","hall_iconnull_hilo_png","hilo_roomnull_png","hilo_pic_iconundefined_png","hill_points_undefined_png","hill_points_null_png","hilo_pic_iconnull_png","hall_pic_null_png","fish_roomnull_png"],t.DEFAULT_HOST="http://192.168.5.23:8989",t.CHIP_VALUES=[500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5,1e6,2e6,5e6,1e7,2e7,3e7,5e7,1e8,15e7,2e8,3e8,5e8,75e7],t}();t.Config=e,__reflect(e.prototype,"Const.Config");var i=function(){function t(){}return t.TIMESTAMP="/timestamp",t.KEEPALIVE="/keep_alive",t.SYSTEM="/system_notify",t.ACCOUNT="/account",t.ONLINE="/online_players",t.WORLD_MESSAGE="/world_message",t.POOL="/pool",t.ROOMS="/rooms",t.BULL="/bull",t.DESK_BULL="/desk_bull",t.FLOWER="/gf",t.DESK_FLOWER="/desk_gf",t.CASINO="/tongbi",t.DESK_CASINO="/desk_tongbi",t.DRAGONTIGER="/lunghu",t.DESK_DRAGONTIGER="/lunghu_desk",t.BAIREN="/bairen",t.DESK_BAIREN="/bairen_desk",t.TWOEIGHT_HALL="/te",t.DESK_TWOEIGHT="/desk_te",t.PAIGOW_HALL="/pg",t.DESK_PAIGOW="/desk_pg",t.FOURBULL="/look4",t.DESK_FOURBULL="/desk_look4",t.THREEFLOWER="/tgf",t.DESK_THREEFLOWER="/desk_tgf",t.THREE="/sungung",t.DESK_THREE="/desk_sungung",t.THIRTEENKILL="/tk",t.DESK_THIRTEENKILL="/desk_tk",t.BAICAO_HALL="/baicao",t.DESK_BAICAO="/desk_baicao",t.HOROSCOPE="/horoscope",t.DESK_HOROSCOPE="/horoscope_desk",t.LIENG="/lieng",t.DESK_LIENG="/desk_lieng",t.POKDENG_HALL="/pokdeng",t.DESK_POKDENG="/desk_pokdeng",t.SEDIE="/button",t.DESK_SEDIE="/button_desk",t.HILO="/hilo",t.DESK_HILO="/hilo_desk",t.FANTAN="/fantan",t.DESK_FANTAN="/fantan_desk",t.FISH="/fish",t.DESK_FISH="/fish_desk",t.BLACKJACK="/blackjack",t.DESK_BLACKJACK="/desk_blackj",t}();t.Topic=i,__reflect(i.prototype,"Const.Topic");var n;!function(t){t[t.CMD_SHOW_HINT=0]="CMD_SHOW_HINT",t[t.CMD_UPDATE_FPS=1]="CMD_UPDATE_FPS",t[t.CMD_UPDATE_BALANCE=2]="CMD_UPDATE_BALANCE",t[t.CMD_UPDATE_ONLINE=3]="CMD_UPDATE_ONLINE",t[t.CMD_UPDATE_GAME_ONLINE=4]="CMD_UPDATE_GAME_ONLINE",t[t.CMD_UPDATE_WORLD_MESSAGE=5]="CMD_UPDATE_WORLD_MESSAGE",t[t.CMD_UPDATE_ROOM_INFO=6]="CMD_UPDATE_ROOM_INFO",t[t.CMD_ENTER_SEC_HALL=7]="CMD_ENTER_SEC_HALL",t[t.CMD_BACK_PRI_HALL=8]="CMD_BACK_PRI_HALL",t[t.CMD_UPDATE_ROOM_SETTING=9]="CMD_UPDATE_ROOM_SETTING",t[t.CMD_UPDATE_STAGE=10]="CMD_UPDATE_STAGE",t[t.CMD_UPDATE_USER_INFO=11]="CMD_UPDATE_USER_INFO",t[t.CMD_UPDATE_DISPUTE=12]="CMD_UPDATE_DISPUTE",t[t.CMD_UPDATE_RAISE=13]="CMD_UPDATE_RAISE",t[t.CMD_UPDATE_FIGHT=14]="CMD_UPDATE_FIGHT",t[t.CMD_UPDATE_SETTLE=15]="CMD_UPDATE_SETTLE",t[t.CMD_UPDATE_RAISE_RATE_OPTIONS=16]="CMD_UPDATE_RAISE_RATE_OPTIONS",t[t.CMD_CONTINUE_MATCH=17]="CMD_CONTINUE_MATCH",t[t.CMD_CANCEL_MATCH=18]="CMD_CANCEL_MATCH",t[t.CMD_CHANGE_AVATAR=19]="CMD_CHANGE_AVATAR",t[t.CMD_UPDATE_DESK=20]="CMD_UPDATE_DESK",t[t.CMD_UPDATE_DESK_INFO=21]="CMD_UPDATE_DESK_INFO",t[t.CMD_COMFIRM_HOSTING=22]="CMD_COMFIRM_HOSTING",t[t.CMD_UPDATE_ALL_BET=23]="CMD_UPDATE_ALL_BET",t[t.CMD_UPDATE_CARDS=24]="CMD_UPDATE_CARDS",t[t.CMD_UPDATE_PLAYER_INFO=25]="CMD_UPDATE_PLAYER_INFO",t[t.CMD_UPDATE_ROUND_INFO=26]="CMD_UPDATE_ROUND_INFO",t[t.CMD_UPDATE_SHOE=27]="CMD_UPDATE_SHOE",t[t.CMD_UPDATE_BET=28]="CMD_UPDATE_BET",t[t.CMD_BALANCE_HINT=29]="CMD_BALANCE_HINT",t[t.CMD_UPDATE_ROAD_MAP=30]="CMD_UPDATE_ROAD_MAP",t[t.CMD_UPDATE_ROOM_CATEGORY=31]="CMD_UPDATE_ROOM_CATEGORY",t[t.CMD_INIT_UI=32]="CMD_INIT_UI",t[t.CMD_UPDATE_PEOPLE=33]="CMD_UPDATE_PEOPLE",t[t.CMD_UPDATE_DYNAMIC_MIN=34]="CMD_UPDATE_DYNAMIC_MIN",t[t.CMD_UPDATE_STOP_DECISION=35]="CMD_UPDATE_STOP_DECISION",t[t.CMD_UPDATE_DECISION_POSITION=36]="CMD_UPDATE_DECISION_POSITION",t[t.CMD_UPDATE_CARD_PK=37]="CMD_UPDATE_CARD_PK",t[t.CMD_UPDATE_MYPOKER=38]="CMD_UPDATE_MYPOKER",t[t.CMD_UPDATE_POOL=39]="CMD_UPDATE_POOL",t[t.CMD_LEAVE_DESK=40]="CMD_LEAVE_DESK",t[t.CMD_UPDATE_ROBOT_BET=41]="CMD_UPDATE_ROBOT_BET",t[t.CMD_UPDATE_ROBOT_SETTEL=42]="CMD_UPDATE_ROBOT_SETTEL",t[t.CMD_UPDATE_BANKER=43]="CMD_UPDATE_BANKER",t[t.CMD_UPDATE_INSURANCE=44]="CMD_UPDATE_INSURANCE"}(n=t.UICommand||(t.UICommand={}));var o;!function(t){t[t.NOTIFY_LOGIN=0]="NOTIFY_LOGIN",t[t.NOTIFY_BEGIN_CHECK=1]="NOTIFY_BEGIN_CHECK",t[t.NOTIFY_END_CHECK=2]="NOTIFY_END_CHECK",t[t.NOTIFY_BGM=3]="NOTIFY_BGM",t[t.NOTIFY_POOL=4]="NOTIFY_POOL",t[t.NOTIFY_CHANGE_AVATAR=5]="NOTIFY_CHANGE_AVATAR",t[t.NOTIFY_FEEDBACK=6]="NOTIFY_FEEDBACK",t[t.NOTIFY_RECORD=7]="NOTIFY_RECORD",t[t.NOTIFY_TOGGLEUI=8]="NOTIFY_TOGGLEUI",t[t.NOTIFY_ENTER_SEC_HALL=9]="NOTIFY_ENTER_SEC_HALL",t[t.NOTIFY_BACK_PRI_HALL=10]="NOTIFY_BACK_PRI_HALL",t[t.NOTIFY_ENTER_DESK=11]="NOTIFY_ENTER_DESK",t[t.NOTIFY_BACK_SEC_HALL=12]="NOTIFY_BACK_SEC_HALL",t[t.NOTIFY_LEAVE_DESK=13]="NOTIFY_LEAVE_DESK",t[t.NOTIFY_CONTINUE_MATCH=14]="NOTIFY_CONTINUE_MATCH",t[t.NOTIFY_DISPUTE=15]="NOTIFY_DISPUTE",t[t.NOTIFY_RAISE=16]="NOTIFY_RAISE",t[t.NOTIFY_DONE=17]="NOTIFY_DONE",t[t.NOTIFY_FIGHT=18]="NOTIFY_FIGHT",t[t.NOTIFY_BET=19]="NOTIFY_BET",t[t.NOTIFY_CAN_LEAVE_ROOM=20]="NOTIFY_CAN_LEAVE_ROOM",t[t.NOTIFY_FOLD=21]="NOTIFY_FOLD",t[t.NOTIFY_WATCH=22]="NOTIFY_WATCH",t[t.NOTIFY_TOGGLE=23]="NOTIFY_TOGGLE",t[t.NOTIFY_CANCEL=24]="NOTIFY_CANCEL",t[t.NOTIFY_CHANGE_ROOM_CATEGORY=25]="NOTIFY_CHANGE_ROOM_CATEGORY",t[t.NOTIFY_CHANGE_DESK=26]="NOTIFY_CHANGE_DESK",t[t.NOTIFY_POKER_PASS=27]="NOTIFY_POKER_PASS",t[t.NOTIFY_POKER_PLAY=28]="NOTIFY_POKER_PLAY",t[t.NOTIFY_BJ_HIT=29]="NOTIFY_BJ_HIT",t[t.NOTIFY_BJ_DOUBLE=30]="NOTIFY_BJ_DOUBLE",t[t.NOTIFY_BJ_STOP=31]="NOTIFY_BJ_STOP",t[t.NOTIFY_BJ_SPLIT=32]="NOTIFY_BJ_SPLIT",t[t.NOTIFY_BJ_BUYPROTECT=33]="NOTIFY_BJ_BUYPROTECT"}(o=t.UINotify||(t.UINotify={}))}(Const||(Const={}));var BaicaoController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="baicao",e.initDesk=function(t){Data.validate(topic.BaicaoDeskTopic.schema,t),e.hideLoading(t),ui.baicao.RoomUI.instance.desk_id=e.desk_id,ui.baicao.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i,n){Data.validate(topic.BaicaoDeskTopic.schema,t);var o=t.snapshot,r=i.snapshot;util.LogUtil.debug("[updateDesk] [receive] desk_id => "+JSON.stringify(e.desk_id)+" newRaw => "+JSON.stringify(n)),util.ObjectUtil.isEqual(o.room_setting,r.room_setting)||ui.baicao.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),util.ObjectUtil.isEqual(o.user_info,r.user_info)||ui.baicao.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),util.ObjectUtil.isEqual(o.fight,r.fight)||ui.baicao.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),util.ObjectUtil.isEqual(o.settle,r.settle)||ui.baicao.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SETTLE),o.stage!==r.stage&&(util.LogUtil.info("desk_id => "+JSON.stringify(e.desk_id)+" CMD_UPDATE_STAGE:"+JSON.stringify(o.stage)),ui.baicao.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t))},e.sendFightDone=function(){util.LogUtil.info("[BaicaoController] [sendFightDone] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic),service.BaicaoService.instance.fight(e.desk_topic+"/"+e.desk_id)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone)},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&t.snapshot.stage&&"none"!==t.snapshot.stage.toLowerCase()&&this.autoHideMatch()},e.prototype.checkReBackRoom=function(t){var e=t&&"settle"!==t.snapshot.stage.toLowerCase();return!e&&util.LogUtil.warn("[checkReBackRoom] desk_topic:"+!!t+" desk_topic.snapshot.stage:"+t.snapshot.stage),e},e}(MatchDeskGameController);__reflect(BaicaoController.prototype,"BaicaoController");var BlackjackController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="blackjack",e.initDesk=function(t){e.hideLoading(t),ui.blackjack.RoomUI.instance.desk_id=e.desk_id,ui.blackjack.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i){var n=t.snapshot,o=i.snapshot;e.checkNewData(t,i,"user_info")&&ui.blackjack.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),e.checkNewData(t,i,"raise")&&ui.blackjack.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE),e.checkNewData(t,i,"fight")&&ui.blackjack.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),e.checkNewData(t,i,"room_setting")&&ui.blackjack.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),e.checkNewData(t,i,"banker")&&ui.blackjack.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_BANKER),e.checkNewData(t,i,"insurances")&&ui.blackjack.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_INSURANCE),n.stage!==o.stage&&(ui.blackjack.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t))},e.checkNewData=function(t,e,i){return!e||!util.ObjectUtil.isEqual(t.snapshot[i],e.snapshot[i])},e.bet=function(t){var i=service.BlackjackService.instance.raise(e.desk_topic+"/"+e.desk_id,t);i&&i.then(function(){ui.blackjack.RoomUI.instance.setBetToutch()})},e.split=function(){return service.BlackjackService.instance.split(e.desk_topic+"/"+e.desk_id)},e.hit=function(){return service.BlackjackService.instance.hit(e.desk_topic+"/"+e.desk_id)},e["double"]=function(){return service.BlackjackService.instance["double"](e.desk_topic+"/"+e.desk_id)},e.stop=function(){return service.BlackjackService.instance.stop(e.desk_topic+"/"+e.desk_id)},e.buyProtect=function(t){return service.BlackjackService.instance.buyProtect(e.desk_topic+"/"+e.desk_id,t)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BET,this.bet),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BJ_HIT,this.hit),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BJ_DOUBLE,this["double"]),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BJ_STOP,this.stop),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BJ_SPLIT,this.split),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BJ_BUYPROTECT,this.buyProtect)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_BET,this.bet),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_BJ_HIT,this.hit),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_BJ_DOUBLE,this["double"]),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_BJ_STOP,this.stop),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_BJ_SPLIT,this.split),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_BJ_BUYPROTECT,this.buyProtect)},e.prototype.checkReBackRoom=function(t){var e=t&&"settle"!==t.snapshot.stage.toLowerCase();if(e){var i=t.snapshot.fight[1];if(i&&i.card_info&&i.card_info.length)return 1===i.card_info.length?"burst"!==i.card_info[0].type:"burst"!==i.card_info[0].type||"burst"!==i.card_info[1].type}return e},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&t.snapshot&&t.snapshot.stage&&"none"!==t.snapshot.stage.toLowerCase()&&this.autoHideMatch()},e}(MatchDeskGameController);__reflect(BlackjackController.prototype,"BlackjackController");var BullController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="bull",e.initDesk=function(t){Data.validate(topic.BullDeskTopic.schema,t),util.LogUtil.debug("[BullController] [enterDesk] desk_topic => "+JSON.stringify(t)),e.hideMatchDialog(t),ui.bull.RoomUI.instance.desk_id=e.desk_id,ui.bull.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i,n){Data.validate(topic.BullDeskTopic.schema,t),util.LogUtil.debug("[BullController] [updateDesk] newRaw => "+JSON.stringify(n?t:n),util.ObjectUtil.copy(t));var o=t.snapshot,r=i.snapshot;util.ObjectUtil.isEqual(o.room_setting,r.room_setting)||ui.bull.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),util.ObjectUtil.isEqual(o.raise_rate_options,r.raise_rate_options)||ui.bull.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE_RATE_OPTIONS),util.ObjectUtil.isEqual(o.user_info,r.user_info)||ui.bull.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),util.ObjectUtil.isEqual(o.dispute,r.dispute)||ui.bull.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DISPUTE),util.ObjectUtil.isEqual(o.raise,r.raise)||ui.bull.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE),util.ObjectUtil.isEqual(o.fight,r.fight)||ui.bull.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),util.ObjectUtil.isEqual(o.settle,r.settle)||ui.bull.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),o.stage!==r.stage&&(ui.bull.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideMatchDialog(t))},e.hideMatchDialog=function(t){return ui.dialog.MatchDialog.instance.stage&&t.snapshot.stage&&"none"!==t.snapshot.stage.toLowerCase()&&e.autoHideMatch()},e.sendDispute=function(t){return service.BullService.instance.disputeBanker(e.desk_topic+"/"+e.desk_id,""+t.my_position,t.rate)},e.sendRasie=function(t){return service.BullService.instance.rasie(e.desk_topic+"/"+e.desk_id,""+t.my_position,t.rate)},e.sendFightDone=function(t){return service.BullService.instance.fight(e.desk_topic+"/"+e.desk_id,""+t,!0)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone)},e.prototype.checkReBackRoom=function(t){return"settle"!==t.snapshot.stage.toLowerCase()},e}(MatchDeskGameController);__reflect(BullController.prototype,"BullController");var topic;!function(t){var e;!function(t){t.enterDeskSchema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{topics:{properties:{desk:{type:"string"}},required:["desk"],type:"object"}},required:["topics"],type:"object"}},required:["snapshot"],type:"object"};var e;!function(t){t.schema={type:"object",properties:{user_id:{type:"string"},username:{type:"string"},avatar:{type:"string"},balance:{decimal:!0},position:{type:"string"}},required:["user_id","username","balance","position"]}}(e=t.UserItem||(t.UserItem={}));var i;!function(t){t.schema={type:"object",properties:{is_banker:{type:"boolean"},dispute_rate:{type:"number"},is_done:{type:"boolean"}},required:["is_banker","dispute_rate","is_done"]}}(i=t.DisputeItem||(t.DisputeItem={}));var n;!function(t){t.schema={type:"object",properties:{raise_rate:{type:"number"},is_done:{type:"boolean"}},required:["raise_rate","is_done"]}}(n=t.RaiseItem||(t.RaiseItem={}));var o;!function(t){t.schema={type:"object",properties:{cards:{type:"array",items:{type:"number"}},type:{type:"string"},odds:{type:"number"},is_done:{type:"boolean"}},required:["is_done"],"if":{properties:{is_done:{"const":!0}}},then:{required:["cards","type","odds"]}}}(o=t.FightItem||(t.FightItem={}));var r;!function(t){t.schema={type:"object",properties:{surplus:{type:"number"}},required:["surplus"]}}(r=t.SettleItem||(t.SettleItem={}))}(e=t.DeskTopic||(t.DeskTopic={}));var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.EnterDeskTopic=i,__reflect(i.prototype,"topic.EnterDeskTopic")}(topic||(topic={}));var CasinoController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="tongbi",e.initDesk=function(t){Data.validate(topic.CasinoDeskTopic.schema,t),util.LogUtil.debug("[CasinoController] [enterDesk] desk_topic => "+JSON.stringify(t)),e.hideLoading(t),ui.casino.RoomUI.instance.desk_id=e.desk_id,ui.casino.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i,n){Data.validate(topic.CasinoDeskTopic.schema,t),util.LogUtil.debug("[CasinoController] [updateDesk] newRaw => "+JSON.stringify(n?t:n),util.ObjectUtil.copy(t));var o=t.snapshot,r=i.snapshot;util.ObjectUtil.isEqual(o.room_setting,r.room_setting)||ui.casino.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),util.ObjectUtil.isEqual(o.raise_rate_options,r.raise_rate_options)||ui.casino.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE_RATE_OPTIONS),util.ObjectUtil.isEqual(o.user_info,r.user_info)||ui.casino.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),util.ObjectUtil.isEqual(o.raise,r.raise)||ui.casino.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE),util.ObjectUtil.isEqual(o.fight,r.fight)||ui.casino.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),util.ObjectUtil.isEqual(o.settle,r.settle)||ui.casino.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),o.stage!==r.stage&&(ui.casino.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t))},e.sendRasie=function(t){return service.CasinoService.instance.rasie(e.desk_topic+"/"+e.desk_id,""+t.my_position,t.rate)},e.sendFightDone=function(t){return service.CasinoService.instance.fight(e.desk_topic+"/"+e.desk_id,""+t,!0)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone)},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&t.snapshot.stage&&"none"!==t.snapshot.stage.toLowerCase()&&this.autoHideMatch()},e.prototype.checkReBackRoom=function(t){return t&&"settle"!==t.snapshot.stage.toLowerCase()},e}(MatchDeskGameController);__reflect(CasinoController.prototype,"CasinoController");var DragontigerController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="lunghu",e.cur_show_rooms=[],e.room_type_str="LH1",e.room_type_list=["LH1","LH2","LH3","LH4"],e.changeSelected=function(){return ui.dragontiger.Hall.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_CATEGORY,e.room_type_list.indexOf(e.room_type_str))},e.initDesk=function(t){var i=e.room_setting_map.get(e.room_id),n=t.snapshot,o=Data.getTopic(i.stage_topic).snapshot;Data.getTopic(i.road_map_topic).snapshot;e.room_bind_data_map.forEach(function(t){return t.current=!1}),e.room_bind_data_map.get(e.room_id).current=!0,ui.dragontiger.RoomUI.instance.setInitData({stage:o,desk:n,desk_item:e.room_bind_data_map.get(e.room_id)}),e.registerDeskData()},e.exchangeDesk=function(t){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.checkLeaveGame()?(ui.dialog.MiniLoadingDialog.instance.show(),[4,this.leaveGame()]):[3,3];case 1:return e.sent(),ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_INIT_UI),[4,this.enterGame(t,void 0,!0)];case 2:return e.sent(),this.updateCurRoomCategory(this.room_id.substring(0,3)),ui.dialog.MiniLoadingDialog.instance.close(),[3,4];case 3:ui.dialog.MessageDialog.instance.showHint("lbl_game_cannot_return"),e.label=4;case 4:return[2]}})})},e.updateDesk=function(t,e){var i=t&&t.snapshot,n=e&&e.snapshot;Data.validate(topic.DTDeskSnapshot.schema,i),util.ObjectUtil.isEqual(i.user_info.bet,n.user_info.bet)||ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_BET,{own:i.user_info.bet,total:i.bet}),util.ObjectUtil.isEqual(i.bet,n.bet)||ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ALL_BET,{own:i.user_info.bet,total:i.bet}),util.ObjectUtil.isEqual(i.open,n.open)||ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_CARDS,i.open),i.open&&util.ObjectUtil.isEqual(i.user_info.balance,n.user_info.balance)&&ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SETTLE,i),util.ObjectUtil.isEqual(i.user_info,n.user_info)||ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO,i.user_info),util.ObjectUtil.isEqual(i.player_info,n.player_info)||ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_PLAYER_INFO,i.player_info),util.ObjectUtil.isEqual(i.round_id,n.round_id)&&util.ObjectUtil.isEqual(i.round_number,n.round_number)||ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO,{round_id:i.round_id,round_number:i.round_number}),util.ObjectUtil.isEqual(i.shoe_size,n.shoe_size)||ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SHOE,i.shoe_size)},e._changeRoomCategory=function(t){return e.updateShowDesks(e.room_type_list[t])},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_CHANGE_ROOM_CATEGORY,this._changeRoomCategory),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_CHANGE_DESK,this.exchangeDesk)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_CHANGE_ROOM_CATEGORY,this._changeRoomCategory),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_CHANGE_DESK,this.exchangeDesk)},e.prototype.init=function(){t.prototype.init.call(this),!this._p&&(this._p=new ui.dragontiger.ParseRoadMapData)},e.prototype.handleShowRooms=function(){this.updateShowDesks(this.room_type_str);var t=[];this.room_bind_data_map.forEach(function(e){return t.push(e)}),ui.dragontiger.dialog.ChangeDeskDialog.instance.update(t.sort(function(t,e){return t.room_setting.room_id.localeCompare(e.room_setting.room_id)}))},e.prototype.addBindData=function(t){var e=this.room_setting_map.get(t),i=Data.getTopic(e.stage_topic),n=Data.getTopic(e.road_map_topic),o=Data.getTopic(Const.Topic.ONLINE),r=new ui.dragontiger.DeskItemData;if(o&&o.snapshot){var s=o.snapshot.base_room_count[t]||0,a=o.snapshot.room_count[t]||0;
r.player_count=s+a,r.lunghu_player_count=""+util.LanguageUtil.translate("lbl_game_online")+r.player_count}r.room_id=t,r.room_setting=e,this.room_bind_data_map.set(t,r),this.updateStageHandler(r,i),this.updateRoadMapHandler(r,n)},e.prototype.updateStageHandler=function(t,e,i,n){var o,r,s=e.snapshot,a=this.room_setting_map.get(t.room_id).bet_limit,l="",u="";Data.validate(topic.DTStageTopic.schema,e),Object.keys(a.min).forEach(function(t){var e=a.min[t];(void 0===o||o>e)&&(o=e)}),Object.keys(a.max).forEach(function(t){var e=a.max[t];(void 0===r||e>r)&&(r=e)}),l=util.NumberUtil.formatUnit(o),u=util.NumberUtil.formatUnit(r),t.simple_limit=l+"-"+u,t.limit=""+util.LanguageUtil.translate("lbl_room_betlimit")+t.simple_limit+" ",s.stage!==t.game_stage&&(t.game_stage=s.stage,"AFTER_SETTLE"===t.game_stage&&t.room_id===this.room_id&&ui.dragontiger.RoomUI.instance.stage&&this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROBOT_SETTEL,e.snapshot.channel_settles[Const.UserInfo.CHANNEL_ID]),"STOP_BET"!==t.game_stage&&"AFTER_SETTLE"!==t.game_stage?this.showCountDown(t,Number(s.stage_timestamp),Number(s.room_setting.time[s.stage.toLowerCase()])):t.countdown="0"),t.show_stage=this.exchangeStageText(s.stage),t.stage_timestamp=s.stage_timestamp,t.room_setting.time=s.room_setting.time,t.room_id===this.room_id&&ui.dragontiger.RoomUI.instance.stage&&(util.LogUtil.info("[DragontigerController] [updateStageHandler] [receive] desk_id => "+this.desk_id+" stage => "+s.stage),ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE,e.snapshot))},e.prototype.updateRoadMapHandler=function(t,e){Data.validate(topic.DTRoadMapTopic.schema,e),t.road_map=ui.dragontiger.RoadMap.convertData(e.snapshot.list[0]),ui.dragontiger.dialog.ChangeDeskDialog.instance.itemUpdated(t),this.cur_show_rooms.indexOf(t.room_id)&&ui.dragontiger.Hall.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t),t.room_id===this.room_id&&ui.dragontiger.RoomUI.instance.stage&&ui.dragontiger.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t)},e.prototype.exchangeStageText=function(t){var e="";switch(t.toLowerCase()){case"prepare":e="lbl_game_prepare2";break;case"shuffle":e="lbl_game_shufflecard3";break;case"deal":e="lbl_game_dealcard3";break;case"bet":e="lbl_game_betting3";break;case"open":e="lbl_game_comparecard3";break;case"settle":e="lbl_game_payout3";break;case"after_settle":e="lbl_game_payout3";break;case"stop_bet":e="lbl_game_comparecard3"}return util.LanguageUtil.translate(e)},e.prototype.updateShowDesks=function(t){var e=this,i=[];this.cur_show_rooms=[],this.room_type_str=t,this.room_bind_data_map.forEach(function(n,o){n.room_setting.room_id.startsWith(t)&&(e.cur_show_rooms.push(o),i.push(n))}),i=i.sort(function(t,e){return t.room_setting.room_id.localeCompare(e.room_setting.room_id)}),ui.dragontiger.Hall.instance.updateHallDatas(i)},e.prototype.updateCurRoomCategory=function(t){t!==this.room_type_str&&(this.updateShowDesks(t),ui.dragontiger.Hall.instance.removeEventListener(egret.Event.ADDED_TO_STAGE,this.changeSelected,ui.dragontiger.Hall.instance),ui.dragontiger.Hall.instance.once(egret.Event.ADDED_TO_STAGE,this.changeSelected,ui.dragontiger.Hall.instance))},e.prototype.showCountDown=function(t,e,i){t.setIntervalID&&util.TimeUtil.clearInterval(t.setIntervalID);var n=function(){var n=(i-(util.TimeUtil.now-e))/1e3<<0;n>=0?t.countdown=""+n:(t.countdown="0",util.TimeUtil.clearInterval(t.setIntervalID),t.setIntervalID=void 0)};n(),t.setIntervalID=util.TimeUtil.setInterval(function(){return n()},250)},e}(JoinDeskGameController);__reflect(DragontigerController.prototype,"DragontigerController");var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ROOM_ID_MAP={BC1:"xinshoufang",BC2:"chujifang",BC3:"zhongjifang",BC4:"gaojifang",BC5:"zhizunfang",BC6:"wangzhefang"},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.playAni=function(t){t?[{db:this.btn_xinshoufang.getChildAt(0).getChildAt(1),name:"baicai_room1"},{db:this.btn_chujifang.getChildAt(0).getChildAt(1),name:"baicai_room2"},{db:this.btn_zhongjifang.getChildAt(0).getChildAt(1),name:"baicai_room3"},{db:this.btn_gaojifang.getChildAt(0).getChildAt(1),name:"baicai_room4"},{db:this.btn_zhizunfang.getChildAt(0).getChildAt(1),name:"baicai_room5"},{db:this.btn_wangzhefang.getChildAt(0).getChildAt(1),name:"baicai_room6"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())}):[this.btn_xinshoufang.getChildAt(0).getChildAt(1),this.btn_chujifang.getChildAt(0).getChildAt(1),this.btn_zhongjifang.getChildAt(0).getChildAt(1),this.btn_gaojifang.getChildAt(0).getChildAt(1),this.btn_zhizunfang.getChildAt(0).getChildAt(1),this.btn_wangzhefang.getChildAt(0).getChildAt(1)].forEach(function(t){return t.stop()})},e.prototype.registerEvent=function(){var t=this;[this.gp_xinshoufang,this.gp_chujifang,this.gp_zhongjifang,this.gp_gaojifang,this.gp_zhizunfang,this.gp_wangzhefang].forEach(function(e){return e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.name)},t)}),this.addEventListener(eui.UIEvent.ADDED,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(eui.UIEvent.ADDED_TO_STAGE,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.playAni(!1)},this)},e.prototype.updateHallDatas=function(t){this.rooms=t,this.gp_xinshoufang&&this.updateData(t)},e.prototype.updateData=function(t){var e=this;Object.keys(this.ROOM_ID_MAP).forEach(function(t){e["gp_"+e.ROOM_ID_MAP[t]].visible=!1,e["gp_"+e.ROOM_ID_MAP[t]].includeInLayout=!1}),t.forEach(function(t){var i=t.room_id;e["gp_"+e.ROOM_ID_MAP[i]].visible=!0,e["gp_"+e.ROOM_ID_MAP[i]].includeInLayout=!0,e["gp_"+e.ROOM_ID_MAP[i]].name=i,e["btn_"+e.ROOM_ID_MAP[i]].getChildAt(0).getChildAt(3).text=util.LanguageUtil.translate("lbl_game_basebet")+util.NumberUtil.formatNumber(t.bet_limit.ante),e["btn_"+e.ROOM_ID_MAP[i]].getChildAt(0).getChildAt(4).text=util.LanguageUtil.translate("lbl_game_allowbet")+util.NumberUtil.formatNumber(t.bet_limit.admittance)})},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.baicao.Hall")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.is_init=!1,e.my_position=0,e.ante=0,e.timeout=[],e.time1=0,e.time2=0,e.max_player=0,e.isDone=[],e.startTime=0,e.showCountdown=!1,e.finishDealCard=!1,e.getNetPosition=function(t){return(t+e.my_position-1)%6||6},e.getLocalPosition=function(t){return(t+6-e.my_position+1)%6||6},e.getDeskData=function(){return Data.getTopic("/baicao_desk/"+e.desk_id)},e._sendWatch=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DONE)},e.sleep=function(t){return new Promise(function(i){e.timeout.push(util.TimeUtil.setTimeout(i,t))})},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"desk_id",{get:function(){return this._desk_id},set:function(t){this._desk_id=t},enumerable:!0,configurable:!0}),i.prototype.initUI=function(){this.init(),this.pokerAni=new e.PokerAni(this.gp_pokerAni),this.initOwnUserInfo(),this.beginAnotherGameInit(),Const.Config.DESK_LOGO&&(this.img_logo.source=Const.Config.DESK_LOGO),util.LogUtil.info("baicao [initUI]")},i.prototype.init=function(){this.is_init||(this.is_init=!0)},i.prototype.initData=function(){this.my_position=0,this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatNumber(this.ante),this.topBar.bVal=this.desk_id,this.updateUserInfo(!0),this.isDone=[],this.reconnection(),util.LogUtil.info("baicao [initData]")},i.prototype.reconnection=function(){var t=this.getDeskData().snapshot,e=t.stage;switch(this.updateUserInfo(!0),util.LogUtil.info("baicao [reconnection] stage:"+e),e){case"FIGHT":this.sendAllchip(),this.pokerAni.initPoker();for(var i=1;i<=this.max_player;i++){var n=this["player"+i].pokerList;n.visible=!0,this.time2=util.TimeUtil.now,this.gp_pokerAni.visible=!1,this.finishDealCard=!0,this.updateFight(),util.LogUtil.info("baicao [reconnection] success")}}},i.prototype.registerEvent=function(){var t=this;this.player1.pokerList.addEventListener(e.PokerList.EVT_CHECK,function(){t._sendWatch(),t.player1.pokerList.setCheckButtonVisible(!1)},this),this.matchBtn.addEventListener(e.MatchButton.EVT_SHOW_BTN,function(){t.beginAnotherGameInit()},this)},i.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_UPDATE_USER_INFO:this.updateUserInfo(!1);break;case Const.UICommand.CMD_UPDATE_FIGHT:this.updateFight();break;case Const.UICommand.CMD_CANCEL_MATCH:this.matchBtn.visible=!0,this.matchBtn.cancel(),this.beginAnotherGameInit();break;case Const.UICommand.CMD_CONTINUE_MATCH:this.beginAnotherGameInit();break;case Const.UICommand.CMD_LEAVE_DESK:this.matchBtn.clearInterval()}},i.prototype.initOwnUserInfo=function(){this.player1.visible=!0,this.player1.setName(Const.UserInfo.NICK),this.player1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance,!1),this.player1.setHead(Const.UserInfo.AVATAR)},i.prototype.updateUserInfo=function(t){var e=this,i=this.getDeskData().snapshot;i.user_info&&(0===this.my_position&&Object.keys(i.user_info).forEach(function(t){var n=i.user_info[t];n.user_id===""+Const.UserInfo.USER_ID&&(e.my_position=Number(t)),e.max_player=Object.keys(i.user_info).length}),Object.keys(i.user_info).forEach(function(n){var o=i.user_info[n],r=e.getLocalPosition(Number(n)),s=e["player"+r];o.username?(s.visible=!0,1!==r&&(s.setName(o.username),s.setHead(o.avatar)),t&&s.setBalance(o.balance,"SETTLE"===i.stage)):(s.visible=!1,s.initHead())}))},i.prototype.updateStage=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n=this;return __generator(this,function(o){switch(o.label){case 0:switch(t=this.getDeskData().snapshot,e=t.stage){case"FIGHT":return[3,1];case"SETTLE":return[3,2]}return[3,5];case 1:return this.updateUserInfo(!0),this.time1=util.TimeUtil.now,i=egret.Tween.get(this),this.gp_pokerAni.visible=!1,i.wait(500).call(function(){n.sendAllchip()}).wait(200).call(function(){n.gp_pokerAni.visible=!0,n.pokerAni.shuffle()}).wait(825),this.dealCard(i),[3,5];case 2:return this.countDown.visible=!1,[4,this.turnCards()];case 3:return o.sent(),[4,this.payoutAni()];case 4:return o.sent(),this.matchBtn.visible=!0,this.matchBtn.addToStage(),this.checkbq(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),[3,5];case 5:return[2]}})})},i.prototype.checkbq=function(){this.countDown.visible=!1,this.player1.pokerList.setCheckButtonVisible(!1)},i.prototype.updateFight=function(){var t=this,e=this.getDeskData().snapshot,i=e.fight;this.finishDealCard&&(0===this.startTime&&(this.startTime=util.TimeUtil.now),"FIGHT"===e.stage&&""!==this.deskInfo.chip.text&&("FIGHT"!==e.stage||this.showCountdown||(this.countDown.show(e.stage_timestamp,e.room_setting.time.op+3536,e.room_setting.time.op),this.showCountdown=!0),Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e));if(t.max_player-t.isDone.length!==1&&-1===t.isDone.indexOf(o)&&n.is_done){1===o&&t.player1.pokerList.setCheckButtonVisible(!1);var r=t["player"+o].pokerList;r.showResult(200,n,n.cards),t.isDone.push(o)}})))},i.prototype.turnCards=function(){var t=this;return new Promise(function(e){var i=t.getDeskData().snapshot,n=i.fight;return t.isDone.length===t.max_player?void e():void Object.keys(n).forEach(function(i){return __awaiter(t,void 0,void 0,function(){var t,o,r;return __generator(this,function(s){switch(s.label){case 0:return t=n[i],o=this.getLocalPosition(Number(i)),-1!==this.isDone.indexOf(o)?[3,2]:(r=this["player"+o].pokerList,1===o&&this.player1.pokerList.setCheckButtonVisible(!1),[4,r.showResult(200,t,t.cards)]);case 1:s.sent(),-1===this.isDone.indexOf(o)&&this.isDone.push(o),this.isDone.length===this.max_player&&e(),s.label=2;case 2:return[2]}})})})})},i.prototype.beginAnotherGameInit=function(){for(var t=2;6>=t;t++)this["player"+t].visible=!1,this["player"+t].initHead(),this["player"+t].hideSurplus(),this["player"+t].pokerList.setBack(),this["player"+t].pokerList.visible=!1;this.player1.hideSurplus(),this.player1.pokerList.visible=!1,this.player1.pokerList.setBack(),this.deskInfo.chip.text="",this.clearChip(),this.startTime=0,this.showCountdown=!1,this.gp_pokerAni.visible=!1,this.finishDealCard=!1,this.deskInfo.visible=!1},i.prototype.clearChip=function(){var t=this.gp_chipsArea.getChildByName("landscapeArea"),e=this.gp_chipsArea.getChildByName("portraitArea");t.removeChildren(),e.removeChildren()},i.prototype.updateDeskInfo=function(){var t=util.NumberUtil.formatNumber(this.ante*this.max_player);this.deskInfo.visible=!0,this.deskInfo.setChip(t),util.LogUtil.debug("[updateDeskInfo] ante:"+this.ante+" max_player:"+this.max_player+" chipValue:"+t)},i.prototype.sendAllchip=function(){this.updateDeskInfo();for(var t=1;t<=this.max_player;t++)this.jump(this["player"+t]),this.sendChips(this["player"+t]),this.sendChips(this["player"+t])},i.prototype.jump=function(t){egret.Tween.removeTweens(t),t.y=0,egret.Tween.get(t).to({y:-15},80,egret.Ease.quadOut).to({y:0},80,egret.Ease.quadIn)},i.prototype.payoutAni=function(){var t=this;return new Promise(function(e){return __awaiter(t,void 0,void 0,function(){var t,i=this;return __generator(this,function(n){switch(n.label){case 0:return t=this.getDeskData().snapshot.settle,this.settleSendchips(),[4,this.sleep(200)];case 1:return n.sent(),this.updateUserInfo(!0),Object.keys(t).forEach(function(n){var o=t[n],r=i.getLocalPosition(Number(n)),s=i["player"+r];o.surplus>0?s.scoreAni(1e3,o.surplus):s.showSurplus(o.surplus),o.surplus>0&&s.pokerList.playwinAni(),1===r&&o.surplus>0&&(util.SoundUtil.play("win_mp3"),i.checkbq(),i.db_winAni.visible=!0,i.db_winAni.play("baicai_win",null,0,1),i.db_winAni.alpha=1,i.db_winAni.once(egret.Event.COMPLETE,function(){egret.Tween.get(i.db_winAni).to({alpha:0},500,egret.Ease.circOut).call(function(){i.db_winAni.visible=!1,e()})},i)),1===r&&o.surplus<=0&&(util.SoundUtil.play("dissapoint_mp3"),egret.Tween.get(i).wait(800).call(function(){e()}))}),[2]}})})})},i.prototype.sendChips=function(t){var i=this.gp_chipsArea.getChildByName("landscapeArea"),n=new e.Chip;this.getDeskData().snapshot.room_setting.room_id;n.horizontalCenter=t.parent.horizontalCenter,n.verticalCenter=t.parent.verticalCenter,i.addChild(n),egret.Tween.get(n).to({horizontalCenter:600*(Math.random()-.5),verticalCenter:100*(Math.random()-.5),rotation:360*Math.random()},200),util.SoundUtil.play("Chips_mp3");var o=this.gp_chipsArea.getChildByName("portraitArea");n=new e.Chip,n.horizontalCenter=t.parent.horizontalCenter,n.verticalCenter=t.parent.verticalCenter,o.addChild(n),egret.Tween.get(n).to({horizontalCenter:150*(Math.random()-.5),verticalCenter:300*(Math.random()-.5),rotation:360*Math.random()},200)},i.prototype.settleSendchips=function(){var t=this,e=(this.getDeskData().snapshot,this.getDeskData().snapshot.settle),i=[];Object.keys(e).forEach(function(n){var o=e[n],r=t.getLocalPosition(Number(n));t["player"+r];o.surplus>=0&&i.push(r)});var n=this.gp_chipsArea.getChildByName("portraitArea"),o=n.numChildren,r=Math.floor(o/i.length);i.forEach(function(e,s){var a=0>r*s?0:r*s,l=r*(s+1);s===i.length-1&&(l=o);for(var u=a;l>u;u++){var h=n.getChildAt(u);egret.Tween.get(h).to({horizontalCenter:t["player"+e].horizontalCenter,verticalCenter:t["player"+e].verticalCenter,visible:!1},200)}})},i.prototype.dealCard=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,o,r,s,a,l=this;return __generator(this,function(u){switch(u.label){case 0:for(e=util.TimeUtil.now,i=[],n=1;6>=n;n++)o=this["player"+n].pokerList,o.visible=!1;for(r=Math.floor(Math.random()*(this.max_player-1))+1,s=function(e){t.call(function(){for(var t=1;t<=l.max_player;t++){var n=0;n=t+r>l.max_player?(t+r)%l.max_player:t+r;var o=l["player"+n].pokerList;i.push(l.pokerAni.flyCard(o.getPokerType(e),o.getCardPos(2),n))}}).wait(200)},a=1;3>=a;a++)s(a);return t.wait(200).call(function(){util.SoundUtil.play("fanpai_mp3");for(var t=1;3>=t;t++)for(var e=1;e<=l.max_player;e++){l["player"+e].pokerList;i.push(l.pokerAni.flyCard2())}}).wait(100).call(function(){for(var t=1;3>=t;t++)for(var e=1;e<=l.max_player;e++){l["player"+e].pokerList;i.push(l.pokerAni.flyCard3(t)),1===e&&"FIGHT"===l.getDeskData().snapshot.stage&&l.player1.pokerList.setCheckButtonVisible(!0)}}),[4,Promise.all(i)];case 1:return u.sent(),t.wait(100).call(function(){l.pokerAni.initPoker();for(var t=1;t<=l.max_player;t++){var e=l["player"+t].pokerList;e.visible=!0,l.time2=util.TimeUtil.now,l.gp_pokerAni.visible=!1,l.finishDealCard=!0,l.updateFight()}util.LogUtil.debug("[dealCard] AnimationTime:"+(l.time2-l.time1)+" ")}),[2]}})})},i}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.baicao.RoomUI")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.dp_desks=new eui.ArrayCollection,e.addToStage=function(){e.db_girl.play("hdgirl")},e.removeFromSatge=function(){e.db_girl.stop(!0)},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent(),this.addToStage()},i.prototype.registerEvent=function(){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromSatge,this)},i.prototype.updateHallDatas=function(t){this.dp_desks.replaceAll(t)},i.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.dp_desks.itemUpdated(e)}},i.prototype.getDeskListBindData=function(t){var i="",n=0,o="zh_cn"===Const.Config.LANGUAGE||"zh_hk"===Const.Config.LANGUAGE;switch(t){case e.RoomType.RARE:i="fresh",n=3851929;break;case e.RoomType.M_RARE:i="beginner",n=8174845;break;case e.RoomType.MEDIUM:i="intermediate",n=16227149;break;case e.RoomType.WELL_DOWN:i="advanced",n=15425721}return{whole_bg:"hall_pic_"+i+"bg_hd1_png",title_bg:"hall_pic_"+i+"bg_hd2_png",title:"hall_hundreds_"+i+"_png",road_map_title0:"lbl_game_sky",road_map_title1:"lbl_game_land",road_map_title2:"lbl_game_mysterious",road_map_title3:"lbl_game_yellow",road_map_title_src0:o?"":"hall_"+i+"_tian_png",road_map_title_src1:o?"":"hall_"+i+"_di_png",road_map_title_src2:o?"":"hall_"+i+"_xuan_png",road_map_title_src3:o?"":"hall_"+i+"_huang_png",road_map_title_color:n,road_map_title_txt_visible:o,road_map_title_src_visible:!o}},i}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.bairen.Hall")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.idle=0,t.defaultChips=[200,300,400,500,600,700],t.ownBet={tian:0,di:0,xuan:0,huang:0},t.otherPlayerBet={tian:0,di:0,xuan:0,huang:0},t.robotBet={tian:0,di:0,xuan:0,huang:0},t.AREA_TYPE={tian:0,di:1,xuan:2,huang:3},t.POKER_TYPE={banker:0,tian:1,di:2,xuan:3,huang:4},t.ALL_TYPE=["tian","di","xuan","huang"],t.limit={min:{tian:0,di:0,xuan:0,huang:0},max:{tian:0,di:0,xuan:0,huang:0}},t.STAGE={prepare:"lbl_game_prepare2",shuffle:"lbl_game_shufflecard",deal:"lbl_game_dealcard",bet:"lbl_game_betting",stop_bet:"lbl_game_comparecard",open:"lbl_game_comparecard",settle:"lbl_game_payouting",after_settle:"lbl_game_payouting"},t.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},t}return __extends(n,i),Object.defineProperty(n,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preloadGroup",{get:function(){return Array.apply(void 0,Array(9)).map(function(t,e){return"niu"+(e+1)}).concat("bomb","niuniu","sihuaniu","wuhuaniu","wuniu","wuxiaoniu").map(function(t){return"effect_bull_"+t})},enumerable:!0,configurable:!0}),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.chipAreas=[this.group_tian_chips,this.group_di_chips,this.group_xuan_chips,this.group_huang_chips],this.pokerAni=new e.PokerAni(this.gp_pokerAni)},n.prototype.initUI=function(){this.initChips(),this.com_betArea.init(),this.initPokerList()},n.prototype.initData=function(){var t=this;this.robot_settle_data=this.desk_settle_data=void 0;var e=this.data.desk,i=this.data.stage;this.road_map=this.data.desk_item.road_map,this.idle=0,this.currentStage=this.data.stage.stage.toLowerCase(),this.balance=e.user_info.balance,this.com_bottomPanel.setHead(Const.UserInfo.AVATAR),this.com_bottomPanel.setBalance(e.user_info.balance),this.com_bottomPanel.setName(e.user_info.username),this.com_bottomPanel.setSurplus(Number(e.user_info.surplus)),this.com_bottomPanel.showWin(e.user_info.surplus>0),this.com_bottomPanel.setChips(i.bet_limit.chips),this.com_bottomPanel.updateEnable(this.balance),this.setDefaultChips(i.bet_limit.chips),this.com_betArea.updateBet(e.user_info.bet,!0),this.com_betArea.updateBet(e.bet,!1);var n=e.user_info.bet,o=e.bet,r={tian:0,di:0,xuan:0,huang:0};switch(Object.keys(o).forEach(function(t){r[t]=(Number(o[t])||0)-(Number(n[t])||0)}),this.flyChipAni(n,!0,!1),this.flyChipAni(r,!1,!1),this.ALL_TYPE.forEach(function(e){t.ownBet[e]=Number(n[e]||0),t.otherPlayerBet[e]=Number(r[e]||0)}),this.old_robot_bets=[],this.playerList.update(e.player_info),this.playerList.updateCount(this.data.desk_item&&this.data.desk_item.player_count||0),this.lab_stage.text=this.STAGE[this.currentStage],this.com_countDown.start(Number(i.stage_timestamp)+Number(i.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.com_bottomPanel.updatePeople(this.data.desk_item&&this.data.desk_item.player_count||0),this.com_betArea.setEnable(!1),this.com_bottomPanel.setRoadMapBlink(!1),this.com_bottomPanel.setRoadMap(this.data.desk_item.road_map),this.com_bottomPanel.setRoadMapBlink(!0),this.currentStage){case"deal":this.dealAllCard(!1);break;case"bet":this.dealAllCard(!1),this.com_betArea.setEnable(!0),this.handleRobotbet(i.bets,!1);break;case"open":for(var s=1;5>=s;s++){var a=this.getBetType(s),l=e.open[a];this.turnCards(5!==s?s:0,l.cards,l.type,!1)}this.handleRobotbet(i.bets,!1);break;case"settle":this.handleRobotbet(i.bets,!1);break;case"after_settle":var u=[];this.old_robot_bets=[];for(var s=1;5>=s;s++){var a=this.getBetType(s),l=e.open[a];this.turnCards(5!==s?s:0,l.cards,l.type,!1),l.isWin&&u.push(a)}this.com_betArea.showResult(u);break;case"shuffle":this.pokerAni.init()}this.limit.min=i.bet_limit.min,this.limit.max=i.bet_limit.max;var h=Math.min(this.limit.min.tian,this.limit.min.di,this.limit.min.xuan,this.limit.min.huang),c=Math.max(this.limit.max.tian,this.limit.max.di,this.limit.max.xuan,this.limit.max.huang);this.topBar.aVal=util.NumberUtil.formatNumber(h)+"-"+util.NumberUtil.formatNumber(c),this.topBar.bVal=e.round_id},n.prototype.registerEvent=function(){var t=this;this.com_bottomPanel.addEventListener(e.BottomPanel.EVT_TOGGLE_PEOPLE,function(){return t.playerList.toggle()},this),this.com_betArea.addEventListener(e.BetArea.EVT_BET,function(e){t.onBet(e.data)},this),this.com_betArea.addEventListener(e.BetArea.EVT_SHOW_TIP,function(e){"bet"!==t.currentStage&&t.com_tip.show(util.LanguageUtil.translate("lbl_game_bettip"))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},n.prototype.execCommand=function(t,e){var i=this;switch(t){case Const.UICommand.CMD_UPDATE_ALL_BET:var n=e.own,o=e.total,r={tian:0,di:0,xuan:0,huang:0};this.ALL_TYPE.forEach(function(t){var e=o[t]-n[t];r[t]=e-i.otherPlayerBet[t],i.otherPlayerBet[t]=e}),this.flyChipAni(r,!1,"bet"===this.currentStage),this.updateShowBet();break;case Const.UICommand.CMD_UPDATE_CARDS:!function(){return __awaiter(i,void 0,void 0,function(){var t,i,n;return __generator(this,function(o){switch(o.label){case 0:t=1,o.label=1;case 1:return 5>=t?(i=this.getBetType(t),n=e[i],this.stage?[4,this.turnCards(5!==t?t:0,n.cards,n.type)]:[3,3]):[3,5];case 2:return o.sent(),[3,4];case 3:return[3,5];case 4:return t++,[3,1];case 5:return[2]}})})}();break;case Const.UICommand.CMD_UPDATE_SETTLE:!function(){if("settle"===i.currentStage){i.desk_settle_data=e;for(var t=e.open,n=1;5>=n;n++){var o=i.getBetType(n),r=t[o];i.turnCards(5!==n?n:0,r.cards,r.type,!1)}}}();break;case Const.UICommand.CMD_UPDATE_USER_INFO:!function(){i.balance=e.balance,i.com_bottomPanel.setBalance(e.balance),i.com_bottomPanel.updateEnable(i.balance),i.idle=Number(e.idle)}();break;case Const.UICommand.CMD_UPDATE_BET:!function(){var t=e.own,n={tian:0,di:0,xuan:0,huang:0};"bet"===i.currentStage&&i.com_betArea.setEnable(!0),Object.keys(t).forEach(function(e){n[e]=t[e]-i.ownBet[e],i.ownBet[e]=Number(t[e])}),i.flyChipAni(n,!0,"bet"===i.currentStage),i.updateShowBet(!0)}();break;case Const.UICommand.CMD_UPDATE_PLAYER_INFO:this.playerList.update(e);break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:"shuffle"===this.currentStage&&(this.topBar.bVal=e.round_id);break;case Const.UICommand.CMD_UPDATE_STAGE:!function(){var t=e;i.limit.min=t.bet_limit.min,i.limit.max=t.bet_limit.max;var n=Math.min(i.limit.min.tian,i.limit.min.di,i.limit.min.xuan,i.limit.min.huang),o=Math.max(i.limit.max.tian,i.limit.max.di,i.limit.max.xuan,i.limit.max.huang);i.topBar.aVal=util.NumberUtil.formatNumber(n)+"-"+util.NumberUtil.formatNumber(o);var r=t.stage.toLowerCase();i.currentStage!==r&&(i.currentStage=r,i.onStageChange(t))}();break;case Const.UICommand.CMD_BALANCE_HINT:"bet"===this.currentStage&&this.com_betArea.setEnable(!0),this.com_tip.show(util.LanguageUtil.translate(e));break;case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.road_map=e.road_map,this.com_bottomPanel.setRoadMap(e.road_map);break;case Const.UICommand.CMD_INIT_UI:this.onRemove(),this.initUI();break;case Const.UICommand.CMD_UPDATE_PEOPLE:this.playerList.updateCount(e),this.com_bottomPanel.updatePeople(e);break;case Const.UICommand.CMD_UPDATE_ROBOT_BET:this.handleRobotbet(e,"bet"===this.currentStage);break;case Const.UICommand.CMD_UPDATE_ROBOT_SETTEL:this.robot_settle_data=e}},n.prototype.settleHandler=function(){if(this.desk_settle_data&&this.robot_settle_data){var t=this.desk_settle_data,e=t.open,i=t.own_settle,n=this.robot_settle_data.robot,o=t.desk_settles,r={tian:0,di:0,xuan:0,huang:0},s={tian:0,di:0,xuan:0,huang:0},a=[];Object.keys(e).forEach(function(t){if("banker"!==t){var l=i[t]||{payout:0,rake:0,bet:0},u=o.guest[t]||{payout:0,rake:0,bet:0},h=o.player[t]||{payout:0,rake:0,bet:0},c=n[t]||{payout:0,rake:0,bet:0};r[t]=Number(l.payout)-Number(l.bet),s[t]+=Number(u.payout)-Number(u.bet),s[t]+=Number(h.payout)-Number(h.bet),s[t]+=Number(c.payout)-Number(c.bet),e[t].isWin&&a.push(t)}}),this.com_betArea.showResult(a),this.payoutAni(s,r,a),this.com_bottomPanel.setSurplus(Number(t.surplus)),this.com_bottomPanel.showWin(t.surplus>0)}},n.prototype.handleRobotbet=function(t,e){var i=this;if(this.data&&this.data.stage){var n=util.ObjectUtil.minus(this.old_robot_bets||[],t);this.old_robot_bets=util.ObjectUtil.copy(t);var o={tian:0,di:0,xuan:0,huang:0};n&&n.length&&(n.forEach(function(t){Object.keys(t.bets).forEach(function(e){var n=Number(i.data.stage.bet_limit.max[e])||0,r=Number(i.data.stage.bet_limit.min[e])||0,s=t.bets[e].p,a=t.bets[e].m,l=new Decimal((s*(n-r)+r)*a).divToInt(100).mul(100);if(l.greaterThan(0)){for(var u=l.toNumber(),h=i.defaultChips.length-1;h>=0;h--)u%=i.defaultChips[h],0===h&&u>0&&(l=l.minus(u));i.robotBet[e]=l.add(i.robotBet[e]).toNumber(),o[e]+=l.toNumber()}})}),util.LogUtil.warn("===================================handleRobotbet","robotBet",o),this.flyChipAni(o,!1,"bet"===this.currentStage),this.updateShowBet())}},n.prototype.updateShowBet=function(t){var e=this;if(void 0===t&&(t=!1),t)this.com_betArea.updateBet(this.ownBet,!0);else{var i={tian:0,di:0,xuan:0,huang:0};this.ALL_TYPE.forEach(function(t){i[t]=e.robotBet[t]+e.otherPlayerBet[t]+e.ownBet[t]}),this.com_betArea.updateBet(i,!1)}},n.prototype.getBetType=function(t){var e;switch(t){case 1:e="tian";break;case 2:e="di";break;case 3:e="xuan";break;case 4:e="huang";break;case 5:e="banker"}return e},n.prototype.setDefaultChips=function(t){var e=this;this.defaultChips=[],t.forEach(function(t){e.defaultChips.push(Number(t))})},n.prototype.onStageChange=function(e){var i=this;switch(this.com_betArea.setEnable(!1),"stop_bet"!==this.currentStage&&"after_settle"!==this.currentStage&&(this.com_countDown.start(Number(e.stage_timestamp)+Number(e.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.lab_stage.text=this.STAGE[this.currentStage],this.com_betArea.init()),this.currentStage){case"deal":!function(){i.dealAllCard();var e=Math.min(i.limit.min.tian,i.limit.min.di,i.limit.min.xuan,i.limit.min.huang);i.idle>=5?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_game_nobet2","lbl_game_comfirm")):i.balance&&i.balance.lt(e)?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_balance_error2","lbl_game_comfirm")):3===i.idle&&i.com_tip.show(util.LanguageUtil.translate("lbl_game_nobet"))}();break;case"bet":this.dealAllCard(!1),this.com_betArea.setEnable(!0),util.SoundUtil.play("brnn_beginbet_mp3"),this.showBetHintAni("start"),this.initChips();break;case"open":this.dealAllCard(!1),util.SoundUtil.play("brnn_stopbet_mp3"),this.showBetHintAni("stop");break;case"settle":break;case"after_settle":this.settleHandler();break;case"shuffle":this.pokerAni.shuffle(),this.initPokerList(),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1),this.com_betArea.updateBet({tian:0,di:0,xuan:0,huang:0},!0),this.com_betArea.updateBet({tian:0,di:0,xuan:0,huang:0},!1),this.initChips(),this.robot_settle_data=this.desk_settle_data=void 0}},n.prototype.onBet=function(t){var e={tian:0,di:0,xuan:0,huang:0};e[t]=this.com_bottomPanel.getCurChipValue(),this.checkLimit(t)?(this.com_betArea.setEnable(!1),this.com_bottomPanel.betAni(!0),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BET,e)):this.com_tip.show(util.LanguageUtil.translate("lbl_game_beterror")+"\n"+util.LanguageUtil.translate("lbl_game_beterror_number",util.NumberUtil.formatNumber(this.limit.min[t]),util.NumberUtil.formatNumber(this.limit.max[t])))},n.prototype.checkLimit=function(t){var e=Number(this.ownBet[t])+Number(this.com_bottomPanel.getCurChipValue());return e<=this.limit.max[t]&&e>=this.limit.min[t]},n.prototype.initChips=function(){var e=this;util.TimeUtil.clearTimeout(this.payoutAniTimeout1),util.TimeUtil.clearTimeout(this.payoutAniTimeout2),this.ALL_TYPE.forEach(function(i,n){for(var o=e.chipAreas[n].numChildren-1;o>=0;o--){var r=e.chipAreas[n].getChildAt(o);egret.Tween.removeTweens(r),t.component.SChip.returnChip(r)}e.ownBet[i]=0,e.otherPlayerBet[i]=0,e.robotBet[i]=0})},n.prototype.payoutAni=function(e,i,n){var o=this,r=500,s=!1;this.ALL_TYPE.forEach(function(e){if(-1===n.indexOf(e)){for(var i=o.AREA_TYPE[e],a=o.chipAreas[i],l=o.com_bankerFrame.localToGlobal(),u=a.globalToLocal(l.x+109,l.y+94),h=function(e){var i=a.getChildAt(e);s=!0,egret.Tween.removeTweens(i),egret.Tween.get(i).to({x:u.x,y:u.y},r,egret.Ease.quadOut).call(function(){t.component.SChip.returnChip(i)})},c=a.numChildren-1;c>=0;c--)h(c);o.ownBet[e]=0,o.otherPlayerBet[e]=0,o.robotBet[e]=0}}),s&&util.SoundUtil.play("brnn_chipfly_short_mp3"),this.payoutAniTimeout1=util.TimeUtil.setTimeout(function(){var n=!1;Object.keys(e).forEach(function(s){var a=o.AREA_TYPE[s];if(e[s]>0&&void 0!==a){var l=o.chipAreas[a],u=o.com_bankerFrame.localToGlobal(),h=l.globalToLocal(u.x+109,u.y+94),c=o.getFlyChipList(i[s],!0),p=o.getFlyChipList(e[s]-i[s],!1);
c.forEach(function(e,i){for(var s=0;e>s;s++){n=!0;var u=o.getChipPos(a),c=l.globalToLocal(u.x,u.y),p=o.defaultChips[i],_=t.component.SChip.getOneChip(p);l.addChild(_),_.name="own",_.x=h.x,_.y=h.y,egret.Tween.get(_).to({x:c.x,y:c.y,rotation:360*Math.random()},r,egret.Ease.quadOut)}}),p.forEach(function(e,i){for(var s=0;e>s;s++){n=!0;var u=o.getChipPos(a),c=l.globalToLocal(u.x,u.y),p=o.defaultChips[i],_=t.component.SChip.getOneChip(p);l.addChild(_),_.name="other",_.x=h.x,_.y=h.y,egret.Tween.get(_).to({x:c.x,y:c.y,rotation:360*Math.random()},r,egret.Ease.quadOut)}})}}),n&&util.SoundUtil.play("brnn_chipfly_long_mp3")},r),this.payoutAniTimeout2=util.TimeUtil.setTimeout(function(){var e=!1;n.forEach(function(i){var n=o.AREA_TYPE[i],s=o.com_bottomPanel.getOtherPos(),a=o.chipAreas[n],l=o.com_bottomPanel.getOwnPos();s=a.globalToLocal(s.x,s.y),l=a.globalToLocal(l.x,l.y);for(var u=function(n){e=!0;var u=a.getChildAt(n),h="own"===u.name?l:s;egret.Tween.removeTweens(u),egret.Tween.get(u).to({x:h.x,y:h.y,rotation:360*Math.random()},r,egret.Ease.quadOut).call(function(){o.otherPlayerBet[i]=0,o.robotBet[i]=0,t.component.SChip.returnChip(u)})},h=a.numChildren-1;h>=0;h--)u(h)})},2*r)},n.prototype.flyChipAni=function(e,i,n){var o=this;void 0===n&&(n=!0);var r,s,a,l;Object.keys(e).forEach(function(u){var h=o.AREA_TYPE[u];if(l=e[u],r=i?o.com_bottomPanel.getOwnPos():o.com_bottomPanel.getOtherPos(),s=o.chipAreas[h].globalToLocal(r.x,r.y),l>0){!i&&n&&o.com_bottomPanel.betAni(!1);var c,p=o.getFlyChipList(l,i);if(p.forEach(function(e,r){e>0&&(c=r+1);for(var l=0;e>l;l++){var u=o.getChipPos(h);a=o.chipAreas[h].globalToLocal(u.x,u.y);var p=o.defaultChips[r],_=t.component.SChip.getOneChip(p);o.chipAreas[h].addChild(_),_.name=i?"own":"other",_.x=s.x,_.y=s.y,egret.Tween.get(_).to({x:a.x,y:a.y,rotation:360*Math.random()},n?500:0,egret.Ease.quadOut)}}),i){var _=Math.min(Math.ceil(c/2),3);n&&util.SoundUtil.play("brnn_bet"+_+"_mp3")}else n&&util.SoundUtil.play("brnn_bet_other_mp3")}})},n.prototype.getChipPos=function(t){var e=this.chipAreas[t].localToGlobal();return{x:e.x+Math.random()*this.chipAreas[t].width,y:e.y+Math.random()*this.chipAreas[t].height}},n.prototype.getFlyChipList=function(t,e){for(var i,n=[],o=this.defaultChips.length-1;o>=0;o--){var r=Math.floor(t/this.defaultChips[o]);t%=this.defaultChips[o],n.push(r)}return i=n.reverse()},n.prototype.showBetHintAni=function(t){var e=this;this.com_betHint.show(t),egret.Tween.removeTweens(this.com_betHint),this.com_betHint.horizontalCenter=-1300,this.com_betHint.alpha=.8,egret.Tween.get(this.com_betHint).to({horizontalCenter:0,alpha:1},250,egret.Ease.backOut).to({horizontalCenter:20},300).to({horizontalCenter:600,alpha:0},200,egret.Ease.quadIn).call(function(){e.com_betHint.show()})},n.prototype.dealAllCard=function(t){var e=this;void 0===t&&(t=!0),egret.Tween.removeTweens(this.group_chipAni),this.pokerAni.init();for(var i=0;5>i;i++)this.initPokerList(i);for(var n=egret.Tween.get(this.group_chipAni),o=function(i){n.call(function(){e.dealCard(i,t)}).wait(t?200:0)},i=0;5>i;i++)o(i);n.wait(t?500:0).call(function(){e.pokerAni.hidePoker()})},n.prototype.dealCard=function(t,e,i){return void 0===e&&(e=!0),__awaiter(this,void 0,void 0,function(){var n,o,r;return __generator(this,function(s){switch(s.label){case 0:return n=t?this["com_pokerlist"+t]:this.com_bankerFrame.getPokerList(),n.visible=!1,o=e,o?[4,this.pokerAni.flyCard(t,n.getTopCardPos())]:[3,2];case 1:o=s.sent(),s.label=2;case 2:return this.pokerAni.hidePoker(t),n.visible=!0,i&&n.setCards(i),e?[4,n.dealCardAni()]:[3,4];case 3:return r=s.sent(),[3,5];case 4:r=n.dealCardAni(!1),s.label=5;case 5:return[2]}})})},n.prototype.initPokerList=function(t){if("number"==typeof t){var e=t?this["com_pokerlist"+t]:this.com_bankerFrame.getPokerList();e.init(),e.visible=!1}else for(var i=0;5>i;i++){var e=i?this["com_pokerlist"+i]:this.com_bankerFrame.getPokerList();e.init(),e.visible=!1}},n.prototype.turnCards=function(t,e,i,n){var o=this;return void 0===n&&(n=!0),new Promise(function(r){return __awaiter(o,void 0,void 0,function(){var o;return __generator(this,function(s){switch(s.label){case 0:return o=t?this["com_pokerlist"+t]:this.com_bankerFrame.getPokerList(),o.visible=!0,o.init(),n&&util.SoundUtil.play("brnn_fanpai_mp3"),[4,o.showResult(e,i,n)];case 1:return s.sent(),r(),[2]}})})})},n.prototype.onRemove=function(){this.com_countDown.clearTimer(),this.initUI(),util.SoundUtil.destroy(this.com_pokerlist1.getResultSoundList())},n}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.bairen.RoomUI")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomIds=["BJ1","BJ2","BJ3","BJ4","BJ5","BJ6"],e.copyData=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.copy=function(){for(var t=0;6>t;t++)this.copyData.push(util.ObjectUtil.copy(this.rooms.dataProvider.getItemAt(t)))},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.copy(),this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this)},e.prototype.init=function(){this.updataRooms()},e.prototype.updataRooms=function(){var t=this,e=[];this.roomsData.forEach(function(i,n){var o=t.copyData[t.roomIds.indexOf(i.room_id)];o&&(o.ante=util.NumberUtil.formatUnit(i.bet_limit.ante),o.admittance=util.NumberUtil.formatUnit(i.bet_limit.admittance),o.name=i.room_id,e.push(o))}),this.rooms.dataProvider=new eui.ArrayCollection(e)},e.prototype.updateHallDatas=function(t){this.roomsData=t,this.rooms&&this.updataRooms()},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.blackjack.Hall"),function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){if(e.bindData){if(e.bindData.visible===!1)return e.parent.includeInLayout=!1,void(e.visible=!1);e.visible=!0,e.parent.includeInLayout=!0,e.db.play(e.bindData.db,null,5*Math.random())}},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),eui.Watcher.watch(this,["bindData"],this.datachange,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},e.prototype.onAddStage=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.init()},e.prototype.onRemoveStage=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.db.stop()},e.prototype.onClick=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,this.bindData.name)},e.prototype.datachange=function(){this.init()},e}(t.control.Button);e.HallItemButton=i,__reflect(i.prototype,"ui.blackjack.Hall.HallItemButton")}(i=e.Hall||(e.Hall={}))}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){}return t}();__reflect(i.prototype,"PlayFrame");var n=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.girl_scale=1,t.timer=null,t.girl_standby=function(){t.showGirlAni("daiji")},t.getNetPosition=function(e){return t.seatInfo.indexOf(e)+1},t.getLocalPosition=function(e){return t.seatInfo[e-1]},t.getDeskData=function(){return Data.getTopic("/blackjack_desk/"+t.desk_id)},t.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},t.hideUI=function(t){return t.parent&&t.parent.removeChild(t)},t.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},t.hideUIS=function(t){return t.forEach(function(t){return t.parent&&t.parent.removeChild(t)})},t.showUI=function(e){return t.main.addChild(e)},t}return __extends(n,i),Object.defineProperty(n,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),n.prototype.childrenCreated=function(){this.initView(),i.prototype.childrenCreated.call(this),this.bankerPoker.invalidateState(),this.playerseat4.getPokerFrame(!0).setTopRight(),this.playerseat4.getPokerFrame(!1).setTopRight()},n.prototype.initView=function(){var i=this;this.players=[this.playerseat1,this.playerseat2,this.playerseat3,this.playerseat4,this.playerseat5],this.moneys=[this.safeMoney1,this.safeMoney2,this.safeMoney3,this.safeMoney4,this.safeMoney5],this.pokerAni=new e.PokerAni(this.pokerAniGroup),this.mc=new t.control.MovieClip("",12,1,0,!1),this.mc.visible=!1,this.mc.horizontalCenter=0,this.mc.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return i.reset(i.mc)},this),this.mc_img=new eui.Image,this.mc_img.source="bj_pic_points3_png",this.mc_img2=new eui.Image,this.mc_img2.source="bj_pic_points3_png",this.mc_img2.horizontalCenter=0,this.mc_img2.verticalCenter=0,this.mc_img_btn=new eui.Image,this.mc_img_btn.source="bj_pic_points3a_png",this.mc_img_btn.horizontalCenter=0,this.mc_btn=new t.control.MovieClip("",12,1,0,!1),this.mc_btn.visible=!1,this.mc_btn.horizontalCenter=0,this.mc_btn.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return i.reset(i.mc_btn)},this),this.zhuang_mc=new t.control.MovieClip("",12,1,0,!1),this.zhuang_mc.visible=!1,this.zhuang_mc.horizontalCenter=0,this.zhuang_mc.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return i.reset(i.mc)},this),this.zhuang_img=new eui.Image,this.zhuang_img.source="bj_pic_points3_png"},n.prototype.initUI=function(){this.showGirlAni("daiji"),this.com_countDown.clearTimer(),this.autoMatch.setselected(!0),this.winAni.addEventListener(egret.Event.COMPLETE,this.WinAniCall,this),this.stage.addEventListener(Main.EVT_RE_SHOT,this.reShot,this),this.initMyinfo(),this.proMatch()},n.prototype.WinAniCall=function(){this.hideUI(this.winAni)},n.prototype.registerEvent=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.bet_area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.raise,this),this.btnMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},this)},n.prototype.removeFromStage=function(){this.db_girl.stop(),this.com_countDown.clearTimer(),this.winAni.removeEventListener(egret.Event.COMPLETE,this.WinAniCall,this),this.stage.removeEventListener(Main.EVT_RE_SHOT,this.reShot,this)},n.prototype.reShot=function(){this.players.forEach(function(t){t.reShot()})},n.prototype.proMatch=function(){this.com_countDown.clearTimer(),this.players.forEach(function(t){t.init()}),this.hideUI(this.btnMatch),this.insuranceVisible=!1,this.moneys.forEach(function(t){return t.visible=!1}),this.my_position=0,this.hideUI(this.autoMatch),this.com_countDown.visible=!1,this.chipList.hide(),this.pokerAniGroup.visible=!1,this.seatInfo=[],this.bankerPoker.init(),this.pokerAni.init(),this.issendpoker=!1,this.cleanBlackjAni(),this.com_warnbox.stopCountDown(),this.raiseTime=0,this.isSendingPoker=!1},n.prototype.initData=function(){var t=this,i=this.getDeskData().snapshot;if(util.LogUtil.debug("[blackjack] [initData]"),this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this.desk_id,this.chipList.setChips(i.bet_limit.chips),i&&i.stage&&"none"!==i.stage.toLowerCase()){var n=JSON.parse(util.UserStorageUtil.getItem("blackjack"));if(n&&n.desk_id&&n.desk_id===this.desk_id&&n.seatInfo){this.seatInfo=n.seatInfo;var o=Number(i.first_op);this.seatInfo.forEach(function(e,i){var n=i+2-o;0>=n&&(n+=t.seatInfo.length),t.players[e].getPlayer().setPosition(n)})}switch(this.updatePlayerInfo(),i.stage.toLowerCase()){case"bet":this.raiseTime=i.stage_timestamp+i.room_setting.time.bet,this.bet_area.enabled=!0,this.chipList.show(),this.playerseat1.playAni(),this.com_countDown.visible=!0,this.com_countDown.start(i.stage_timestamp+i.room_setting.time.bet),this.setBetNow();break;case"insurance":this.pokerAniGroup.visible=!0,this.setBetNow(),this.setPokerNow(),this.insuranceVisible=!0,this.updateInsurance(),this.com_warnbox.changeTextContent(e.txtType.isblackjack,i.stage_timestamp+1e4),this.com_warnbox.setRaise(i.raise[1].raise_rate);break;case"start_op":this.pokerAniGroup.visible=!0,this.setBetNow(),this.setPokerNow(),this.players[0].clearAni();break;case"1":case"2":case"3":case"4":case"5":this.pokerAniGroup.visible=!0,this.setBetNow(),this.setPokerNow(),this.setPokerSelect();var r=this.players[this.getLocalPosition(Number(i.stage))];r.getPlayer().countDown(i.stage_timestamp,i.stage_timestamp+i.room_setting.time.op),"1"===i.stage&&this.setFuncbtnStatus();break;case"banker":this.pokerAniGroup.visible=!0,this.setBetNow(),this.setPokerNow()}}},n.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_USER_INFO:this.updatePlayerInfo();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_CANCEL_MATCH:this.autoMatch.setAutoMatch(!1),this.showUI(this.autoMatch);break;case Const.UICommand.CMD_CONTINUE_MATCH:this.showGirlAni("pipei",1),this.proMatch();break;case Const.UICommand.CMD_UPDATE_RAISE:this.updateRaise();break;case Const.UICommand.CMD_UPDATE_FIGHT:this.updateOperate();break;case Const.UICommand.CMD_LEAVE_DESK:this.autoMatch.clearInterval();break;case Const.UICommand.CMD_UPDATE_BANKER:this.bankerOperate();break;case Const.UICommand.CMD_UPDATE_INSURANCE:this.updateInsurance()}},n.prototype.updatePlayerInfo=function(){var t=this,e=this.getDeskData().snapshot;if(e){var i=e.user_info;if(0===this.seatInfo.length){var n=Object.keys(i).length,o=Number(e.first_op);this.seatInfo=5>n?[0].concat(this.getARandon(n-2)):[0,1,2,3,4],this.seatInfo.forEach(function(e,i){var r=i+2-o;0>=r&&(r+=n),t.players[e].getPlayer().setPosition(r)}),util.UserStorageUtil.setItem("blackjack",JSON.stringify({desk_id:this.desk_id,seatInfo:this.seatInfo}))}Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e)),r=t.players[o],s=r.getPlayer();n&&n.username?(s.visible=!0,s.userInfo=n,r.isSat(!0)):(s.visible=!1,r.isSat(!1))})}},n.prototype.getARandon=function(t){var e=[[[1],[2],[3],[4]],[[1,2],[1,3],[1,4],[2,4]],[[2,3,4],[1,3,4],[1,2,4],[1,2,3]]],i=Math.floor(4*Math.random());return e[t][i]},n.prototype.initMyinfo=function(){var t={user_id:Const.UserInfo.USER_ID,avatar:Const.UserInfo.AVATAR,username:Const.UserInfo.NICK,balance:Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance};this.playerseat1.getPlayer().userInfo=t},n.prototype.updateStage=function(){return __awaiter(this,void 0,void 0,function(){var t,i,n,o=this;return __generator(this,function(r){switch(r.label){case 0:switch(t=this.getDeskData().snapshot,util.LogUtil.debug("[blackjack] stage ",t.stage,util.TimeUtil.now),this.bet_area.enabled=!1,this.chipList.hide(),this.playerseat1.clearAni(),util.LogUtil.debug("[[blackjack]] stagedata",JSON.stringify(t)),i=t.stage.toLowerCase()){case"bet":return[3,1];case"insurance":return[3,2];case"start_op":return[3,5];case"1":return[3,7];case"2":return[3,7];case"3":return[3,7];case"4":return[3,7];case"5":return[3,7];case"banker":return[3,13];case"settle":return[3,14]}return[3,15];case 1:return this.raiseTime=t.stage_timestamp+t.room_setting.time.bet,this.showBetAni(e.BetAniType.start,t),this.bet_area.enabled=!0,[3,15];case 2:return this.issendpoker?[2]:(this.isSendingPoker=this.issendpoker=!0,[4,this.showBetAni(e.BetAniType.stop,t)]);case 3:return r.sent(),[4,this.sendpoker()];case 4:return r.sent(),this.players[0].clearAni(),this.insuranceVisible=!0,this.updateInsurance(),this.com_warnbox.changeTextContent(e.txtType.isblackjack,t.stage_timestamp+1e4),this.com_warnbox.setRaise(t.raise[1].raise_rate),[3,15];case 5:return this.issendpoker?[2]:(this.isSendingPoker=this.issendpoker=!0,[4,this.showBetAni(e.BetAniType.stop,t)]);case 6:return r.sent(),this.players[0].clearAni(),this.sendpoker(),[3,15];case 7:return this.isSendingPoker&&(this.isSendingPoker=!1,this.setNowStage()),this.insuranceVisible?(this.insuranceVisible=!1,this.isBuyinsurance()?[4,this.seeCard(!1)]:[3,9]):[3,12];case 8:return r.sent(),[3,12];case 9:return this.isOtherBuyInsurance()?(this.bankerPoker.getGroup().seeCard(),[4,this.sleep(1e3)]):[3,11];case 10:r.sent(),r.label=11;case 11:this.moneys.forEach(function(t,i){t.visible&&o.players[i].settleFlyChip(e.SetGroupEnum.Safe,o.db_girl.localToGlobal())}),this.updateInsurance(),r.label=12;case 12:return this.turnOperate(),[3,15];case 13:return this.isSendingPoker&&(this.isSendingPoker=!1,this.setNowStage()),this.seatInfo.forEach(function(t){o.players[t].getPlayer().stopCountDown()}),this.com_funcbtns.visible=!1,n=this.getLastOperateNum(),this.operate(this.players[this.getLocalPosition(n)],t,n,!1),[3,15];case 14:return this.settle(t),[3,15];case 15:return[2]}})})},n.prototype.settle=function(t){return __awaiter(this,void 0,void 0,function(){var e,i=this;return __generator(this,function(n){switch(n.label){case 0:return this.isSendingPoker&&(this.isSendingPoker=!1,this.setNowStage()),e=0,this.insuranceVisible?(this.insuranceVisible=!1,this.isBuyinsurance()||this.isOtherBuyInsurance()?[4,this.seeCard(!0)]:[3,2]):[3,3];case 1:return n.sent(),e=2e3,[3,3];case 2:this.bankerPoker.getGroup().dealCard(t.banker.card_info[0].cards[1],100),this.showBlackjAni2(),e=100,n.label=3;case 3:return this.payoutAni(),[4,this.sleep(e)];case 4:return n.sent(),this.pokerAniGroup.visible=!1,Object.keys(t.settle).forEach(function(e){var n=i.getLocalPosition(Number(e)),o=t.settle[e];i.players[n].getPlayer().setScore(o.surplus),0===n&&(o.surplus>0?(i.showwinAni(),i.showGirlAni("win",1),util.SoundUtil.play("win_mp3")):o.surplus<0&&(i.showGirlAni("lose",1),util.SoundUtil.play("dissapoint_mp3")))}),[4,this.sleep(2e3)];case 5:return n.sent(),this.showUI(this.autoMatch),this.hideUI(this.btnMatch),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),this.showGirlAni("pipei"),[2]}})})},n.prototype.isBuyinsurance=function(){var t=this.getDeskData().snapshot;return 0!==t.insurances[1].valid_bet},n.prototype.isOtherBuyInsurance=function(){var t=this.getDeskData().snapshot,e=!1;return Object.keys(t.insurances).forEach(function(i){"1"!==i.toString()&&0!==t.insurances[i].valid_bet&&(e=!0)}),e},n.prototype.setBetToutch=function(){this.bet_area.enabled="bet"===this.getDeskData().snapshot.stage.toLowerCase()},n.prototype.seeCard=function(t){var i=this;return new Promise(function(n){if(t){var o=i.getDeskData().snapshot;if(!o)return;i.bankerPoker.getGroup().seeCard(),i.sleep(1900).then(function(){i.bankerPoker.getGroup().dealCard(o.banker.card_info[0].cards[1],100);Object.keys(o.settle).forEach(function(t){var n=i.getLocalPosition(Number(t));if(i.moneys[n].visible){var r=(o.insurances[t],i.players[n]),s=r.safeChipsGroup,a=i.db_girl.localToGlobal(),l=s.globalToLocal(a.x,a.y),u=r.getChipPos(),h=s.globalToLocal(u.x,u.y),c=r.createAChip();s.addChild(c),c.x=l.x,c.y=l.y;var p=360*Math.random();egret.Tween.get(c).to({x:h.x,y:h.y,rotation:p},400,egret.Ease.quadOut).call(function(){i.showBlackjAni2(),util.SoundUtil.play("BlackJack_bj_mp3"),i.updateInsurance(),r.recycleChips(e.SetGroupEnum.Safe)})}}),n()})}else i.bankerPoker.getGroup().seeCard(),i.sleep(1900).then(function(){i.com_warnbox.changeTextContent(e.txtType.notblackjack),i.moneys.forEach(function(t,n){t.visible&&i.players[n].settleFlyChip(e.SetGroupEnum.Safe,i.db_girl.localToGlobal())}),i.updateInsurance(),n()})})},n.prototype.payoutAni=function(){var t=this,i=600,n=this.db_girl.localToGlobal(),o=this.getDeskData().snapshot,r=[];Object.keys(o.settle).forEach(function(i){var s=t.getLocalPosition(Number(i)),a=(o.settle[i],o.fight[i],o.payout[i]),l=t.players[s];a.total_bet===a.lose?(l.settleFlyChip(e.SetGroupEnum.First,n),l.settleFlyChip(e.SetGroupEnum.Secend,n)):a.lose>0&&l.settleFlyChip(a.lose===l.bet1?e.SetGroupEnum.First:e.SetGroupEnum.Secend,n),a.win>0&&r.push(i)}),this.payoutAniTimeout1=util.TimeUtil.setTimeout(function(){var i=!1;r.forEach(function(n){var r=o.payout[n],s=t.getLocalPosition(Number(n)),a=t.players[s],l=a.group_chipAni,u=t.db_girl.localToGlobal(),h=t.main.globalToLocal(u.x,u.y);i=!0;var c=a.getChipPos(),p=t.main.globalToLocal(c.x,c.y),_=l.globalToLocal(c.x,c.y),d=a.createAChip();d.value=r.win,t.main.addChild(d),d.x=h.x,d.y=h.y;var g=360*Math.random();egret.Tween.get(d).to({x:p.x,y:p.y,rotation:g},400,egret.Ease.quadOut).call(function(){d.x=_.x,d.y=_.y,l.addChild(d),a.recycleChips(e.SetGroupEnum.Safe)})}),i&&util.SoundUtil.play("payout_chips_mp3")},i),this.payoutAniTimeout2=util.TimeUtil.setTimeout(function(){var e=!1;Object.keys(o.settle).forEach(function(i){var n=t.getLocalPosition(Number(i));t.players[n].recycleAllChips()&&(e=!0)}),util.SoundUtil.play("payout_chips_mp3")},2*i)},n.prototype.showBetAni=function(t,i){var n=this;return this.betAni.show(t),egret.Tween.removeTweens(this.betAni),this.betAni.horizontalCenter=-1300,this.betAni.alpha=.8,new Promise(function(o){egret.Tween.get(n.betAni).to({horizontalCenter:0,alpha:1},250,egret.Ease.backOut).to({horizontalCenter:20},300).to({horizontalCenter:600,alpha:0},200,egret.Ease.quadIn).call(function(){n.betAni.show(),t===e.BetAniType.start&&(n.com_countDown.visible=!0,n.com_countDown.start(i.stage_timestamp+i.room_setting.time.bet),n.chipList.show(),n.playerseat1.playAni()),o()})})},n.prototype.turnOperate=function(){var t=this,e=this.getDeskData().snapshot,i=this.getLocalPosition(Number(e.stage));util.LogUtil.debug("[blackjack] [turnOperate] pos=>"+i),this.seatInfo.forEach(function(e){t.players[e].getPlayer().stopCountDown()});var n=this.players[i];if(n.getPlayer().countDown(e.stage_timestamp,e.stage_timestamp+e.room_setting.time.op),"1"===e.stage?(util.SoundUtil.play("BlackJack_Turn_mp3"),this.com_funcbtns.visible=!0,this.com_funcbtns.isHavesplit(e.fight[1].card_info[0].can_split)):this.com_funcbtns.visible=!1,e.first_op!==e.stage){var o=this.getLastOperateNum();this.operate(this.players[this.getLocalPosition(o)],e,o,!1)}},n.prototype.raise=function(){if(!(this.raiseTime<util.TimeUtil.now)){util.LogUtil.debug("[blackjack] raise value",this.chipList.cur_chip.value);var t=this.chipList.cur_chip.value;Number(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance.toString())<t?ui.dialog.MessageDialog.instance.showAlert("lbl_balance_error","lbl_game_comfirm"):(this.bet_area.enabled=!1,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BET,this.chipList.cur_chip.value))}},n.prototype.showBlackjAni2=function(t){void 0===t&&(t=!1),t?this.players[0].otherBlackjAni():(this.zhuang_mc.group="effect_blackjack_blackjack2",this.zhuang_mc.currentFrame=0,this.zhuang_mc.playTimes=-1,this.zhuang_mc.visible=!0,this.zhuang_mc.isPlaying=!0,this.zhuang_mc.scaleX=1.74,this.zhuang_mc.scaleY=1.6,this.main.addChild(this.zhuang_mc),this.zhuang_mc.verticalCenter=-405,this.zhuang_img.horizontalCenter=0,this.zhuang_img.verticalCenter=-330,this.zhuang_img.scaleX=this.zhuang_img.scaleY=.24,this.main.addChildAt(this.zhuang_img,-1))},n.prototype.showBlackjAni=function(){var t=this;this.mc_btn.group="effect_blackjack_blackjack",this.mc_btn.currentFrame=0,this.mc_btn.playTimes=-1,this.mc_btn.visible=!0,this.mc_btn.isPlaying=!0,this.mc_btn.horizontalCenter=0,this.mc_btn.bottom=0,this.mc_btn.scaleX=3,this.mc_btn.scaleY=4,this.main.addChild(this.mc_btn),this.timer=new egret.Timer(500,3),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer.start(),this.main.addChild(this.mc_img2),this.mc_img.horizontalCenter=0,this.mc_img.verticalCenter=0,this.main.addChild(this.mc_img),this.mc_img_btn.verticalCenter=320,this.main.addChild(this.mc_img_btn),egret.Tween.get(this.mc_img).set({scaleX:2.5,scaleY:2.5}).to({scaleX:1,scaleY:1},300).call(function(){egret.Tween.removeTweens(t.mc_img)}),egret.Tween.get(this.mc_img_btn).set({scaleX:2.5,scaleY:2.5}).to({scaleX:1,scaleY:1},300).call(function(){egret.Tween.removeTweens(t.mc_img_btn)}),egret.Tween.get(this.mc_img2).to({scaleX:2,scaleY:2,alpha:0},800).call(function(){egret.Tween.removeTweens(t.mc_img2),t.mc_img2.scaleX=1,t.mc_img2.scaleY=1,t.mc_img2.alpha=1,t.mc_img2.parent&&t.mc_img2.parent.removeChild(t.mc_img2)})},n.prototype.reset=function(t){t.parent&&(t.parent.removeChild(t),t.isPlaying=!1,t.visible=!1,t.group="",t.source=null)},n.prototype.timerComFunc=function(){var t=this;this.reset(this.mc_btn),this.mc_img_btn.parent&&this.mc_img_btn.parent.removeChild(this.mc_img_btn),this.timer&&(this.timer.stop(),this.timer=null),this.mc_img.verticalCenter=0,egret.Tween.get(this.mc_img).to({scaleX:.24,scaleY:.24,verticalCenter:500},250).call(function(){egret.Tween.removeTweens(t.mc_img),t.mc_img.parent&&t.mc_img.parent.removeChild(t.mc_img),t.showBlackjAni2(!0)})},n.prototype.cleanBlackjAni=function(){this.mc_img.parent&&this.mc_img.parent.removeChild(this.mc_img),this.mc.parent&&this.mc.parent.removeChild(this.mc),this.zhuang_img.parent&&this.zhuang_img.parent.removeChild(this.zhuang_img),this.zhuang_mc.parent&&this.zhuang_mc.parent.removeChild(this.zhuang_mc),this.reset(this.mc),this.reset(this.zhuang_mc)},n.prototype.showwinAni=function(){this.showUI(this.winAni),this.winAni.play("thirteen-win",null,0,1)},n.prototype.showGirlAni=function(t,e){void 0===e&&(e=0),this.db_girl.play("bj_girl",t,0,e),0!==e&&this.db_girl.once(dragonBones.AnimationEvent.COMPLETE,this.girl_standby,this)},n.prototype.onRemove=function(){this.com_countDown.clearTimer(),this.initUI()},n.prototype.sendpoker=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o,r,s,i,n,o;return __generator(this,function(a){switch(a.label){case 0:return util.LogUtil.info("[blackjack] [sendpoker]"),this.pokerAniGroup.visible=!0,t=this.getDeskData().snapshot,"insurance"!==this.getDeskData().snapshot.stage.toLowerCase()&&"start_op"!==this.getDeskData().snapshot.stage.toLowerCase()?[2]:(util.SoundUtil.play("fp_mp3"),this.pokerAni.shuffle(),[4,this.sleep(800)]);case 1:if(a.sent(),"insurance"!==this.getDeskData().snapshot.stage.toLowerCase()&&"start_op"!==this.getDeskData().snapshot.stage.toLowerCase())return[2];e=0,a.label=2;case 2:if(!(2>e))return[3,9];i=0,a.label=3;case 3:return i<this.seatInfo.length?(n=this.seatInfo[i],o=t.fight[this.getNetPosition(n)],r=this.players[n],[4,this.pokerAni.sendCard(r.getPokerFrame(!0).getGroup(),o.card_info[0].cards[e])]):[3,6];case 4:a.sent(),a.label=5;case 5:return i++,[3,3];case 6:return[4,this.pokerAni.sendCard(this.bankerPoker.getGroup(),0===e?t.banker.card_info[0].cards[0]:null)];case 7:a.sent(),a.label=8;case 8:return e++,[3,2];case 9:for(s=!1,i=0;i<this.seatInfo.length;i++)n=this.seatInfo[i],o=t.fight[this.getNetPosition(n)],this.setPokerValue(this.players[n].getPokerFrame(!0),o.card_info[0],0===n),0!==n&&"black_jack"===o.card_info[0].type&&(this.players[n].otherBlackjAni(),s=!0);return s&&util.SoundUtil.play("BlackJack_bj_mp3"),this.isSendingPoker=!1,[2]}})})},n.prototype.updateOperate=function(){var t=this.getDeskData().snapshot,e=Number(t.stage);e&&(this.operate(this.players[this.getLocalPosition(e)],t,e,!0),this.players[this.getLocalPosition(e)].getPlayer().countDown(t.stage_timestamp,t.stage_timestamp+t.room_setting.time.op))},n.prototype.booms=function(t,e){t.getPlayer().addScore(0===e?-t.bet1:-t.bet2),t.settleFlyChip(e,this.db_girl.localToGlobal())},n.prototype.operate=function(t,i,n,o){return __awaiter(this,void 0,void 0,function(){var r,s,a,l,u,h,c,p;return __generator(this,function(_){switch(_.label){case 0:if(void 0===n)return[2];switch(r=i.fight[n],s=r.op_index,a=r.card_info[s].cards,util.LogUtil.debug("[blackjack] [operate] turn =>"+n+" fight=>"+JSON.stringify(r)),l=r.op){case"hit":return[3,1];case"redouble":return[3,2];case"none":return[3,3];case"stand":return[3,4];case"split":return[3,5]}return[3,9];case 1:return this.pokerAni.sendCard(t.getPokerFrame(0===s).getGroup(),a[a.length-1],100),this.setPokerValue(t.getPokerFrame(0===s),r.card_info[s],1===n),"burst"===r.card_info[s].type&&this.booms(t,s),[3,9];case 2:return t.getPokerFrame(0===r.op_index).showDouble(!0),u=i.raise[n],t.flyAddChips(u.raise_rate,s),this.pokerAni.sendCard(t.getPokerFrame(0===s).getGroup(),a[a.length-1],100),this.setPokerValue(t.getPokerFrame(0===s),r.card_info[s],1===n),"burst"===r.card_info[s].type&&this.booms(t,s),[3,9];case 3:return[3,9];case 4:return[3,9];case 5:return h=r.card_info[0].cards,c=r.card_info[1].cards,[4,this.pokerAni.split(t.getPokerFrame(!0).getGroup(),t.getPokerFrame(!1).getGroup())];case 6:return _.sent(),[4,this.pokerAni.sendCard(t.getPokerFrame(!0).getGroup(),h[h.length-1],100)];case 7:return _.sent(),this.setPokerValue(t.getPokerFrame(!0),r.card_info[0],1===n),[4,this.pokerAni.sendCard(t.getPokerFrame(!1).getGroup(),c[c.length-1],100)];case 8:return _.sent(),this.setPokerValue(t.getPokerFrame(!1),r.card_info[1],1===n),p=i.raise[n],t.flyAddChips(p.raise_rate,e.SetGroupEnum.Secend),[3,9];case 9:return 1===n&&this.setFuncbtnStatus(),o&&2===r.card_info.length?(t.getPokerFrame(!0).setSelecte(!1),t.getPokerFrame(!1).setSelecte(!1),this.setPokerSelect()):(t.getPokerFrame(!0).setSelecte(!1),t.getPokerFrame(!1).setSelecte(!1)),[2]}})})},n.prototype.setPokerValue=function(t,i,n,o){switch(void 0===o&&(o=!1),util.LogUtil.debug("[blackjack] [setPokerValue] card_info=>"+JSON.stringify(i)),i.type){case"point":t.setPokerNum(i.max_point>21?i.min_point:i.max_point);break;case"straight":util.SoundUtil.play("BlackJack_straight_mp3"),t.setPokerType(e.pokertype.straight);break;case"three_of_a_kind":util.SoundUtil.play("BlackJack_three7_mp3"),t.setPokerType(e.pokertype.three7);break;case"black_jack":n&&(this.showBlackjAni(),util.SoundUtil.play("BlackJack_bj_mp3"));break;case"burst":n&&this.checkPlayerBoom()&&(this.showUI(this.btnMatch),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM)),util.SoundUtil.play("BlackJack_baopai_mp3"),t.setPokerNum(i.max_point>21?i.min_point:i.max_point),!o&&t.blastAni(),t.getGroup().masked=!0}},n.prototype.updateRaise=function(){var t=this,i=this.getDeskData().snapshot;Object.keys(i.raise).forEach(function(n){var o=t.getLocalPosition(Number(n));t.players[o].flyAllChips(i.raise[n].raise_rate,e.SetGroupEnum.First)})},n.prototype.bankerOperate=function(){var t=this,e=this.getDeskData().snapshot;if(util.LogUtil.debug("[blackjack] [bankerOperate] snapshot =>"+JSON.stringify(e)),"banker"===e.stage.toLowerCase()){var i=e.banker;if("black_jack"!==i.card_info[0].type||!i.card_info[0].has_ace)switch(i.op){case"hit":var n=i.card_info[0].cards;this.pokerAni.sendCard(this.bankerPoker.getGroup(),n[n.length-1],100),this.setPokerValue(this.bankerPoker,i.card_info[0],!1);break;case"none":var o=i.card_info[0].cards,r=this.bankerPoker.getGroup().dealCard(o[o.length-1],100);r.turnPromise.then(function(){return t.setPokerValue(t.bankerPoker,i.card_info[0],!1)});break;case"stand":}}},n.prototype.updateInsurance=function(){var t=this;if(!this.insuranceVisible)return void this.moneys.forEach(function(t){t.visible=!1});var i=this.getDeskData().snapshot;Object.keys(i.insurances).forEach(function(n){var o=t.getLocalPosition(Number(n)),r=t.moneys[o],s=i.insurances[n];s.valid_bet&&!r.visible&&(r.visible=!0,r.setmoney(s.valid_bet),t.players[o].flyAddChips(s.valid_bet,e.SetGroupEnum.Safe))})},n.prototype.setNowStage=function(){this.pokerAni.setNow(),this.setPokerNow()},n.prototype.setPokerNow=function(){var t=this,e=this.getDeskData().snapshot;util.LogUtil.debug("[blackjack] [setPokerNow] snapshot =>"+JSON.stringify(e)),this.pokerAni.setNow(),Object.keys(e.fight).forEach(function(i){var n=t.getLocalPosition(Number(i)),o=e.fight[i],r=t.players[n],s=r.getPokerFrame(!0);if(s.setPokerNow(o.card_info[0].cards),s.showDouble(o.card_info[0].redouble),t.setPokerValue(s,o.card_info[0],"1"===i,!0),"burst"===o.card_info[0].type&&t.booms(r,0),2===o.card_info.length){var a=r.getPokerFrame(!0);a.setPokerNow(o.card_info[1].cards),a.showDouble(o.card_info[1].redouble),t.setPokerValue(s,o.card_info[1],"1"===i,!0),"burst"===o.card_info[1].type&&t.booms(r,1)}"1"!==i&&"black_jack"===o.card_info[0].type&&r.otherBlackjAni()});var i=e.banker.card_info[0];i.cards.length>1?(this.bankerPoker.setPokerNow(i.cards),"black_jack"===i.type?this.showBlackjAni2():this.setPokerValue(this.bankerPoker,i,!1)):this.bankerPoker.setPokerNow([i.cards[0],null])
},n.prototype.getLastOperateNum=function(){var t,e=this.getDeskData().snapshot,i=Number(e.first_op),n=[];Object.keys(e.fight).forEach(function(o,r){var s=e.fight[o];i===Number(o)&&(t=n.length),"black_jack"!==s.card_info[0].type&&n.push(Number(o))});var o;switch(e.stage.toLowerCase()){case"banker":case"settle":var r=t||n.length;o=n[r-1];break;case"1":case"2":case"3":case"4":case"5":var s=Number(e.stage);if(s!==i){var a=n.indexOf(s)||n.length;o=n[a-1]}}return o},n.prototype.setBetNow=function(){var t=this,i=this.getDeskData().snapshot;Object.keys(i.raise).forEach(function(n){var o=(i.payout[n],i.raise[n]),r=t.players[t.getLocalPosition(Number(n))],s=i.fight[n];if(s&&s.card_info.length){var a=s.card_info[0].redouble?2:1;if(r.flyAllChips(o.raise_rate*a,e.SetGroupEnum.First),s.card_info[1]){var l=s.card_info[0].redouble?2:1;r.flyAllChips(o.raise_rate*l,e.SetGroupEnum.Secend)}}else r.flyAllChips(o.raise_rate,e.SetGroupEnum.First)})},n.prototype.setFuncbtnStatus=function(){var t=this.getDeskData().snapshot;if("1"!==t.stage)return this.com_funcbtns.visible=!1,void this.com_funcbtns.setDoubleBtnStatus(!0);this.com_funcbtns.visible=!0;var e=t.fight[1];if(this.com_funcbtns.isHavesplit(e.card_info[0].can_split),1===e.card_info.length)this.com_funcbtns.setDoubleBtnStatus(2===e.card_info[0].cards.length);else if(1===e.op_index)this.com_funcbtns.setDoubleBtnStatus(!1);else switch(e.op){case"redouble":case"split":case"stand":this.com_funcbtns.setDoubleBtnStatus(!0);break;case"hit":"point"!==e.card_info[0].type?this.com_funcbtns.setDoubleBtnStatus(!0):this.com_funcbtns.setDoubleBtnStatus(21===e.card_info[0].max_point||21===e.card_info[0].min_point)}},n.prototype.setPokerSelect=function(){var t=this.getDeskData().snapshot,e=Number(t.stage);if(e){var i=this.players[this.getLocalPosition(e)],n=t.fight[e];if(1!==n.card_info.length)if(1===n.op_index)i.getPokerFrame(!1).setSelecte(!0);else switch(n.op){case"redouble":case"stand":i.getPokerFrame(!1).setSelecte(!0);break;case"split":case"hit":"point"!==n.card_info[0].type?i.getPokerFrame(!1).setSelecte(!0):i.getPokerFrame(21!==n.card_info[0].max_point&&21!==n.card_info[0].min_point).setSelecte(!0);break;default:i.getPokerFrame(!0).setSelecte(!0)}}},n.prototype.checkPlayerBoom=function(){var t=this.getDeskData().snapshot;if(!t)return!1;var e=t.fight[1];return 1===e.card_info.length?"burst"===e.card_info[0].type:"burst"===e.card_info[0].type&&"burst"===e.card_info[1].type},n.prototype.setInsuranceNow=function(){var t=this.getDeskData().snapshot;t.banker&&t.banker.card_info&&t.banker.card_info[0].has_ace&&"insurance"===t.stage.toLowerCase()&&(this.insuranceVisible=!0,this.updateInsurance())},n}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.blackjack.RoomUI")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ROOM_ID_MAP={BU1:"xinshoufang",BU2:"chujifang",BU3:"zhongjifang",BU4:"gaojifang",BU5:"zhizunfang",BU6:"wangzhefang"},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.playAni=function(t){t?(this.db_girl.play("girl"),[{db:this.db_xinshoufang,name:"xinshoufang"},{db:this.db_chujifang,name:"chujifang"},{db:this.db_zhongjifang,name:"zhongjifang"},{db:this.db_gaojifang,name:"gaojifang"},{db:this.db_zhizunfang,name:"zhizunfang"},{db:this.db_wangzhefang,name:"wangzhefang"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())})):(this.db_girl.stop(),[this.db_xinshoufang,this.db_chujifang,this.db_zhongjifang,this.db_gaojifang,this.db_zhizunfang,this.db_wangzhefang].forEach(function(t){return t.stop()}))},e.prototype.registerEvent=function(){var t=this;[this.gp_xinshoufang,this.gp_chujifang,this.gp_zhongjifang,this.gp_gaojifang,this.gp_zhizunfang,this.gp_wangzhefang].forEach(function(e){return e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.name)},t)}),this.addEventListener(eui.UIEvent.ADDED,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(eui.UIEvent.ADDED_TO_STAGE,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.playAni(!1)},this)},e.prototype.updateHallDatas=function(t){this.rooms=t,this.gp_xinshoufang&&this.updateData(t)},e.prototype.updateData=function(t){var e=this;Object.keys(this.ROOM_ID_MAP).forEach(function(t){e["gp_"+e.ROOM_ID_MAP[t]].visible=!1,e["gp_"+e.ROOM_ID_MAP[t]].includeInLayout=!1}),t.forEach(function(t){var i=t.room_id;e["gp_"+e.ROOM_ID_MAP[i]].visible=!0,e["gp_"+e.ROOM_ID_MAP[i]].includeInLayout=!0,e["gp_"+e.ROOM_ID_MAP[i]].name=i,e["lb_"+e.ROOM_ID_MAP[i]+"_ante"].text=util.NumberUtil.formatUnit(t.bet_limit.ante),e["lb_"+e.ROOM_ID_MAP[i]+"_admittance"].text=util.NumberUtil.formatUnit(t.bet_limit.admittance)})},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.bull.Hall")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.com_pokers=[],e.com_frames=[],e.lb_cal_points=[],e.new_uis=[],e.showUI=function(t){return e.main.addChild(t)},e.hideUIS=function(t){return t.forEach(function(t){return e.main.contains(t)&&e.main.removeChild(t)})},e.changeCurOrientationMode=function(t){util.LogUtil.debug("[Bull] [RoomUI] [changeCurOrientationMode]]"),util.TimeUtil.clearTimeout(e.winTimeout),e.chips.hideChip(),e.new_uis.forEach(function(e){return e.resetMode(t.data)})},e.getNetPosition=function(t){return(t+e.my_position-1)%4||4},e.getLocalPosition=function(t){return(t+4-e.my_position+1)%4||4},e.getDeskData=function(){return Data.getTopic("/bull_desk/"+e.desk_id)},e._sendDispute=function(t){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DISPUTE,{my_position:e.my_position,rate:t.data})},e._sendRaise=function(t){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,{my_position:e.my_position,rate:t.data})},e.flaychip=function(t,i,n){return e.chips.flyChip(t,i,25)},e.showResultDBAni=function(t){return e.result_ani.show(t)},e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e.resize=function(){var t=e.main.width/e.main.height;t>1.55?e.com_pokerlist1.verticalCenter=e.com_frame1.verticalCenter=390:1.55>t&&t>=1&&(e.com_pokerlist1.verticalCenter=e.com_frame1.verticalCenter=450),t>1&&(e.gp_cal.verticalCenter=e.com_pokerlist1.verticalCenter-210,e.gp_err.verticalCenter=e.com_pokerlist1.verticalCenter-160,e.gp_check_bull.verticalCenter=e.gp_err.verticalCenter+170)},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"desk_id",{get:function(){return this._desk_id},set:function(t){this._desk_id=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"preloadGroup",{get:function(){return Array.apply(void 0,Array(9)).map(function(t,e){return"niu"+(e+1)}).concat("bomb","niuniu","sihuaniu","wuhuaniu","wuniu","wuxiaoniu").map(function(t){return"effect_bull_"+t})},enumerable:!0,configurable:!0}),i.prototype.initUI=function(){this.init(),this.initOwnUserInfo(),this.registUIEventListener(),this.changeCurOrientationMode({data:Main.instance.orientation})},i.prototype.init=function(){var t=this;this.is_init||(util.LogUtil.debug("[Bull] [RoomUI] [init]]"),this.is_init=!0,[1,2,3,4].forEach(function(e){t.com_pokers.push(t["com_pokerlist"+e]),t.com_frames.push(t["com_frame"+e])}),this.gp_cal.$children.forEach(function(e){return e instanceof ui.control.BitmapLabel&&t.lb_cal_points.push(e)}),this.beginAni=new e.BeginAni,this.hog_btns=new e.HogButtons,this.mult_btns=new e.MultButtons,this.match_canle=new e.MatchButton,this.count_down=new e.CountDown,this.chips=new e.Chips(this.main),this.pokerAni=new e.PokerAni(this.gp_pokerAni),this.result_ani=new e.ResultMC(this.main),this.new_uis=[this.beginAni,this.hog_btns,this.mult_btns,this.match_canle,this.count_down,this.chips,this.result_ani])},i.prototype.initData=function(){util.LogUtil.debug("[Bull] [RoomUI] [initData]]"),this.my_position=0,this.is_banker=!1,this.is_have_bull=!1,this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this.desk_id,this.updateUserInfo(!0),this.updateDispute(!0);var t=this.getDeskData().snapshot;if("settle"===t.stage.toLowerCase())for(var e=5;e>1;e--){var i=5===e?1:e,n=this.getNetPosition(Number(i));t.fight[n];this.dealCard(i,null,!1)}this.updateRaise(),("settle"===t.stage.toLowerCase()||"fight"===t.stage.toLowerCase())&&this.updateFight(),this.updateStage(!0)},i.prototype.registerEvent=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.prototype.registUIEventListener=function(){this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.changeCurOrientationMode,this),this.com_pokerlist1.addEventListener(e.PokerList.EVT_SELECT,this.udpateCalPoint,this),this.main.addEventListener(egret.Event.RESIZE,this.resize,this)},i.prototype.removeFromStage=function(){this.changeStageHideUIS(),this.initPlayers(),this.stage.removeEventListener(Main.EVT_ORIENTATION_CHANGE,this.changeCurOrientationMode,this),this.com_pokerlist1.removeEventListener(e.PokerList.EVT_SELECT,this.udpateCalPoint,this),this.main.removeEventListener(egret.Event.RESIZE,this.resize,this)},i.prototype.execCommand=function(t,e){switch(util.LogUtil.debug("bull.RoomUI [execCommand] cmd => "+Const.UICommand[t]),t){case Const.UICommand.CMD_UPDATE_ROOM_SETTING:this.updateRoomSetting();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_UPDATE_RAISE_RATE_OPTIONS:this.updateRaiseRateOptions();break;case Const.UICommand.CMD_UPDATE_USER_INFO:this.updateUserInfo("settle"!==this.getDeskData().snapshot.stage.toLowerCase());break;case Const.UICommand.CMD_UPDATE_DISPUTE:this.updateDispute();break;case Const.UICommand.CMD_UPDATE_RAISE:this.updateRaise();break;case Const.UICommand.CMD_UPDATE_FIGHT:this.updateFight();break;case Const.UICommand.CMD_UPDATE_SETTLE:this.updateSettle();break;case Const.UICommand.CMD_CONTINUE_MATCH:this.beforeContinueMatch();break;case Const.UICommand.CMD_CANCEL_MATCH:this.match_canle.setAutoMatch(!1),this.showUI(this.match_canle),this.initPlayers();break;case Const.UICommand.CMD_LEAVE_DESK:this.match_canle.clearInterval()}},i.prototype.beforeContinueMatch=function(){this.initPlayers()},i.prototype.updateRaiseRateOptions=function(){},i.prototype.updateSettle=function(){},i.prototype.initPlayers=function(){var t=this;[1,2,3,4].forEach(function(e){var i=t.com_pokers[e-1],n=t.com_frames[e-1];1!==e&&(n.visible=!1),n.initHead(),n.hideBet(),n.showSurplus(!1),n.showBanker(!1),n.showSnatch(!1),1===e&&(i.type="own"),i.init(),i.visible=!1})},i.prototype.updateFight=function(){var t=this,e=this.getDeskData();Data.validate(topic.BullDeskTopic.fight_schema,e);var i=e.snapshot.fight;util.LogUtil.warn("bull.RoomUI [updateFight] fight => "+JSON.stringify(i)),Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e));if(n.is_done){var r=t["com_pokerlist"+o];r.finish(e!==""+t.my_position)}e===""+t.my_position&&(t.is_have_bull=n.is_have_bull,t.card_type=n.type)})},i.prototype.updateRaise=function(){var t=this,e=this.getDeskData().snapshot.raise,i=this.getDeskData().snapshot.dispute;util.LogUtil.warn("bull.RoomUI [updateRaise] raise => "+JSON.stringify(e)),e&&Object.keys(e).forEach(function(n){var o=e[n],r=i[n],s=t.getLocalPosition(Number(n)),a=t["com_frame"+s];r.is_banker===!1&&o.is_done&&a.setRaise(Number(o.raise_rate)),util.LogUtil.warn("bull.RoomUI [updateRaise] net_position => "+n+" raise => "+o.raise_rate)})},i.prototype.updateDispute=function(t){var e=this;void 0===t&&(t=!1),this.is_banker=!!this.getDeskData().snapshot.dispute[this.my_position].is_banker;var i=this.getDeskData().snapshot.dispute;if(util.LogUtil.warn("bull.RoomUI [updateDispute] dispute => "+JSON.stringify(i)),i){var n=0,o=0;if(Object.keys(i).forEach(function(t){var r=i[t],s=e.getLocalPosition(Number(t)),a=e["com_frame"+s];r.is_done&&a.setBet(r.dispute_rate),r.is_banker&&(o=s,e.cur_banker_rate=n=r.dispute_rate)}),n){var r=[];if(Object.keys(i).forEach(function(t){var o=i[t],s=e.getLocalPosition(Number(t));n===o.dispute_rate&&r.push(s)}),r.length>1&&!t)this.playFrameAni(r,o);else{var s=this["com_frame"+o];util.SoundUtil.play("nn_banker_mp3"),s.showBanker(!0),s.showSnatch(!0)}}}},i.prototype.initOwnUserInfo=function(){util.LogUtil.debug("[Bull] [RoomUI] [initOwnUserInfo]]"),this.com_frame1.visible=!0,this.com_frame1.setName(Const.UserInfo.NICK),this.com_frame1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance),this.com_frame1.setHead(Const.UserInfo.AVATAR)},i.prototype.updateUserInfo=function(t){var e=this,i=this.getDeskData().snapshot;i.user_info&&(0===this.my_position&&Object.keys(i.user_info).forEach(function(t){var n=i.user_info[t];n.user_id===""+Const.UserInfo.USER_ID&&(e.my_position=Number(t))}),Object.keys(i.user_info).forEach(function(n){var o=i.user_info[n],r=e.getLocalPosition(Number(n)),s=e["com_frame"+r];o.username?(s.visible=!0,1!==r&&(s.setName(o.username),s.setHead(o.avatar)),t&&s.setBalance(o.balance)):(s.visible=!1,s.initHead())}))},i.prototype.updateRoomSetting=function(){},i.prototype.updateStage=function(t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,function(){var i,n,o,r,s,a,l,u,h,c,p=this;return __generator(this,function(_){switch(_.label){case 0:switch(i=this.getDeskData().snapshot,n=function(t,e){p.showUI(p.count_down),p.count_down.show(t,e)},this.changeStageHideUIS(),o=i.stage.toLowerCase()){case"dispute":return[3,1];case"raise":return[3,2];case"fight":return[3,4];case"settle":return[3,9]}return[3,14];case 1:return r=function(){p.getDeskData().snapshot.stage===i.stage&&(p.showUI(p.hog_btns),p.hog_btns.init(i.room_setting.dispute_factor),p.hog_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,p._sendDispute,p),p.hog_btns.once(e.MultButtonsBase.EVT_SEND_MULT,p._sendDispute,p),n(i.stage_timestamp,i.room_setting.time.dispute))},t?r():(this.showUI(this.beginAni),this.beginAni.once(e.BeginAni.EVT_SHOW_BTN,function(){return r()},this)),[3,14];case 2:return[4,this.sleep(2e3)];case 3:return _.sent(),this.getDeskData().snapshot.stage!==i.stage?[2]:(this.is_banker?this.gp_wait_raise.visible=!0:(this.showUI(this.mult_btns),this.mult_btns.init(i.raise_rate_options,this.ante,this.cur_banker_rate),this.mult_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,this._sendRaise,this),this.mult_btns.once(e.MultButtonsBase.EVT_SEND_MULT,this._sendRaise,this)),s=this.getDeskData().snapshot.dispute,Object.keys(s).forEach(function(t){var e=s[t],i=p.getLocalPosition(Number(t)),n=p["com_frame"+i];e.is_banker||n.hideBet()}),n(i.stage_timestamp,i.room_setting.time.raise),[3,14]);case 4:this.showHideCalPoint(!0),n(i.stage_timestamp,i.room_setting.time.op),a=5,_.label=5;case 5:return a>1?(l=5===a?1:a,u=this.getNetPosition(Number(l)),h=i.fight[u],this.dealCard(l,this.my_position===Number(u)?h.cards:null,!t),[4,this.sleep(200)]):[3,8];case 6:_.sent(),_.label=7;case 7:return a--,[3,5];case 8:return[3,14];case 9:return util.LogUtil.warn("bull.RoomUI [updateStage] settle => "+JSON.stringify(this.getDeskData().snapshot.settle)),c=!t,c?[4,this.sleep(800)]:[3,11];case 10:c=_.sent(),_.label=11;case 11:return[4,this.turnCards()];case 12:return _.sent(),[4,this.payoutAni()];case 13:return _.sent(),this.showUI(this.match_canle),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),[3,14];case 14:return[2]}})})},i.prototype.changeStageHideUIS=function(){this.hideUIS(this.new_uis),this.gp_cal.visible&&this.showHideCalPoint(!1),this.gp_wait_raise.visible&&(this.gp_wait_raise.visible=!1)},i.prototype.payoutAni=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.checkDBAni(),this.chipAni(),this.surplusAni()])];case 1:return t.sent(),this.updateUserInfo(!0),[4,this.sleep(1e3)];case 2:return t.sent(),[2]}})})},i.prototype.turnCards=function(){var t=this;return new Promise(function(e){return __awaiter(t,void 0,void 0,function(){var t,i,n,o,r,s,a,l,u,h,c,p=this;return __generator(this,function(_){switch(_.label){case 0:t=0,i=this.getDeskData().snapshot.dispute,Object.keys(i).forEach(function(e){var n=i[e],o=p.getLocalPosition(Number(e));n.is_banker!==!1&&(t=o)}),n=5,_.label=1;case 1:return n>1?(o=5===n?1:n,r=this.getDeskData().snapshot.fight,s=r[this.getNetPosition(n)],o===t?[3,3]:(a=this["com_pokerlist"+o],[4,a.showResult(s.cards,s.type)])):[3,4];case 2:_.sent(),_.label=3;case 3:return n--,[3,1];case 4:return l=this.getDeskData().snapshot.fight,u=this.getNetPosition(t),h=l[u],c=this["com_pokerlist"+t],[4,c.showResult(h.cards,h.type)];case 5:return _.sent(),e(),[2]}})})})},i.prototype.checkDBAni=function(){var t=this,i=this.getDeskData().snapshot,n=[0,0];if(this.is_banker){if([1,2,3,4].forEach(function(e){e!==t.my_position&&(i.settle[e].surplus>0?n[0]++:n[1]++)}),0===n[0])return this.showResultDBAni(e.ResultEnum.take_all);if(0===n[1])return this.showResultDBAni(e.ResultEnum.lose_all)}return i.settle[this.my_position].surplus>0?this.showResultDBAni(e.ResultEnum.win):void 0},i.prototype.surplusAni=function(){var t=this,e=this.getDeskData().snapshot.settle;Object.keys(e).forEach(function(i){var n=e[i],o=t.getLocalPosition(Number(i)),r=t["com_frame"+o];1===o&&n.surplus>0&&util.SoundUtil.play("nn_scrollnumber_mp3"),r.showSurplus(!0,n.surplus)})},i.prototype.chipAni=function(){var t=this;return new Promise(function(e){var i=t.getDeskData().snapshot.settle,n=t.getDeskData().snapshot.dispute,o=0,r=[],s=[];Object.keys(n).forEach(function(e){var a=n[e],l=i[e],u=t.getLocalPosition(Number(e));a.is_banker!==!1&&(o=u),l.surplus>0?s.push(u):l.surplus<0&&r.push(u)});var a=10;r.forEach(function(e){var i=t["com_frame"+o],n=t["com_frame"+e];util.SoundUtil.play("nn_collectgold_mp3"),t.flaychip(n.getChipPosition(),i.getChipPosition(),a)});var l=10;t.winTimeout=util.TimeUtil.setTimeout(function(){s.forEach(function(e){var i=10,n=t["com_frame"+o],r=t["com_frame"+e];util.SoundUtil.play("nn_collectgold_mp3"),t.flaychip(n.getChipPosition(),r.getChipPosition(),i)})},30*a+500),util.TimeUtil.setTimeout(e,30*(a+l)+1e3)})},i.prototype.udpateCalPoint=function(t){var e=t.data,i=0;this.lb_cal_points.forEach(function(t,n){var o=e[n];o?(t.text=""+o,i+=o):t.text="",3===n&&(t.text=i?""+i:"")})},i.prototype.showHideCalPoint=function(t){var e=this;t?(this.udpateCalPoint({data:[0,0,0]}),[this.btn_have,this.btn_havent].forEach(function(t){t.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.checkHave,e),t.addEventListener(egret.TouchEvent.TOUCH_TAP,e.checkHave,e)}),"bomb"===this.card_type||"wuxiaoniu"===this.card_type?(this.btn_have.label="bomb"===this.card_type?"lbl_game_bomb":"lbl_game_fivecattle",this.btn_havent.visible=!1,this.btn_havent.height=0):(this.btn_havent.height=0/0,this.btn_havent.visible=!0),this.gp_check_bull.visible=!0,this.gp_cal.visible=!0):([this.btn_have,this.btn_havent].forEach(function(t){return t.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.checkHave,e)}),this.gp_cal.visible=this.gp_err.visible=this.gp_check_bull.visible=!1,this.udpateCalPoint({data:[0,0,0]}),this.btn_have.label="lbl_game_cattle")},i.prototype.checkHave=function(t){t.target===this.btn_have&&this.is_have_bull&&""!==this.lb_cal_points[2].text&&""!==this.lb_cal_points[3].text&&Number(this.lb_cal_points[3].text)%10===0||t.target!==this.btn_have&&!this.is_have_bull||"bomb"===this.card_type||"wuxiaoniu"===this.card_type?(util.SoundUtil.play("qznn_great_mp3"),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DONE,this.my_position),this.showHideCalPoint(!1)):(util.SoundUtil.play("qznn_carderror_mp3"),this.gp_err.visible=!0)},i.prototype.dealCard=function(t,e,i){return void 0===i&&(i=!0),__awaiter(this,void 0,void 0,function(){var n,o;return __generator(this,function(r){switch(r.label){case 0:return n=this["com_pokerlist"+t],n.visible=!1,o=i,o?[4,this.pokerAni.flyCard(t,n.getTopCardPos(),n.getPokerSize())]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return this.pokerAni.hidePoker(t),n.visible=!0,e&&n.setCards(e),[4,n.dealCardAni(i)];case 3:return r.sent(),1===t&&(n.enabled=!0),[2]}})})},i.prototype.playFrameAni=function(t,e){var i=this;egret.Tween.removeTweens(this.com_frame1),this.com_frame1.showSnatch(!1),this.com_frame2.showSnatch(!1),this.com_frame3.showSnatch(!1),this.com_frame4.showSnatch(!1);var n=15;n=n-n%t.length+t.indexOf(e)+1;var o=egret.Tween.get(this.com_frame1);Array.apply(void 0,Array(n)).forEach(function(e,n){var r=n*n*n/15;o.call(function(){var e=n%t.length;i["com_frame"+t[0===e?t.length-1:e-1]].showSnatch(!1);var o=i["com_frame"+t[e]];util.SoundUtil.play("nn_bankerrun_mp3"),o.showSnatch(!0)}).wait(r)}),o.call(function(){util.SoundUtil.play("nn_banker_mp3"),i["com_frame"+e].showBanker(!0)})},i}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.bull.RoomUI")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.hor_layout=new eui.HorizontalLayout,t.ver_layout=new eui.VerticalLayout,t.horizontalCenter=0,t.hor_layout.gap=10,t.ver_layout.gap=20,t.ver_layout.horizontalAlign=egret.HorizontalAlign.CENTER,t.visible=!1,t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.registEvent(),this.gp_btns.layout=430===this.verticalCenter?this.ver_layout:this.hor_layout,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.registEvent,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeEvent,this)},i.prototype.registEvent=function(){this.gp_mult_btns.addEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.removeEvent=function(){this.visible=!1,this.gp_mult_btns.removeEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.sendMult=function(t){t.stopImmediatePropagation(),this.dispatchEventWith(i.EVT_SEND_MULT,!1,t.data),this.parent&&this.parent.removeChild(this)},i.prototype.resetMode=function(t){t===egret.OrientationMode.PORTRAIT?(this.gp_btns&&(this.gp_btns.layout=this.ver_layout),this.verticalCenter=430):(this.gp_btns&&(this.gp_btns.layout=this.hor_layout),this.verticalCenter=140)},i.EVT_SEND_MULT="evt_send_mult",i}(eui.Component);t.MultButtonsBase=e,__reflect(e.prototype,"ui.bull.MultButtonsBase")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ROOM_ID_MAP={TB1:"xinshoufang",TB2:"chujifang",TB3:"zhongjifang",TB4:"gaojifang",TB5:"zhizunfang",TB6:"wangzhefang"},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.playAni=function(t){t?(this.db_girl.play("casino-girl"),[{db:this.db_xinshoufang,name:"casino-xinshoufang"},{db:this.db_chujifang,name:"casino-chujifang"},{db:this.db_zhongjifang,name:"casino-zhongjifang"},{db:this.db_gaojifang,name:"casino-gaojifang"},{db:this.db_zhizunfang,name:"zhizunfang"},{db:this.db_wangzhefang,name:"wangzhefang"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())})):(this.db_girl.stop(),[this.db_xinshoufang,this.db_chujifang,this.db_zhongjifang,this.db_gaojifang,this.db_zhizunfang,this.db_wangzhefang].forEach(function(t){return t.stop()}))},e.prototype.registerEvent=function(){var t=this;[{db:this.db_xinshoufang,gp:this.gp_xinshoufang,image:this.img_light1},{db:this.db_chujifang,gp:this.gp_chujifang,image:this.img_light2},{db:this.db_zhongjifang,gp:this.gp_zhongjifang,image:this.img_light3},{db:this.db_gaojifang,gp:this.gp_gaojifang,image:this.img_light4},{db:this.db_zhizunfang,gp:this.gp_zhizunfang,image:this.img_light5},{db:this.db_wangzhefang,gp:this.gp_wangzhefang,image:this.img_light6}].forEach(function(e){e.gp.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){util.SoundUtil.play("btn_menu_mp3"),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.gp.name)},t),e.gp.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){return e.gp.scaleX=e.gp.scaleY=.9},t),e.gp.addEventListener(egret.TouchEvent.TOUCH_END,function(){return e.gp.scaleX=e.gp.scaleY=1},t),e.gp.addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){return e.image.visible=!0},t),e.gp.addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){return e.image.visible=!1},t)}),this.addEventListener(eui.UIEvent.ADDED,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(eui.UIEvent.ADDED_TO_STAGE,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.playAni(!1)},this)},e.prototype.updateHallDatas=function(t){this.rooms=t,this.gp_xinshoufang&&this.updateData(this.rooms)},e.prototype.updateData=function(t){var e=this;Object.keys(this.ROOM_ID_MAP).forEach(function(t){e["gp_"+e.ROOM_ID_MAP[t]].visible=!1,e["gp_"+e.ROOM_ID_MAP[t]].includeInLayout=!1}),t.forEach(function(t){var i=t.room_id;e["gp_"+e.ROOM_ID_MAP[i]].visible=!0,e["gp_"+e.ROOM_ID_MAP[i]].includeInLayout=!0,e["gp_"+e.ROOM_ID_MAP[i]].name=i,e["lb_"+e.ROOM_ID_MAP[i]+"_ante"].text=util.NumberUtil.formatUnit(t.bet_limit.ante),e["lb_"+e.ROOM_ID_MAP[i]+"_admittance"].text=util.NumberUtil.formatUnit(t.bet_limit.admittance)})},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.casino.Hall")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.com_pokers=[],e.com_players=[],e.com_multInfos=[],e.com_winLoseInfos=[],e.new_uis=[],e.isDone=[],e.showUI=function(t){return e.main.addChild(t)},e.hideUIS=function(t){return t.forEach(function(t){return e.main.contains(t)&&e.main.removeChild(t)})},e.changeCurOrientationMode=function(t){util.TimeUtil.clearTimeout(e.winTimeout),e.chips.hideChip()},e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e.getNetPosition=function(t){return(t+e.my_position-1)%6||6},e.getLocalPosition=function(t){return(t+6-e.my_position+1)%6||6},e._sendRaise=function(t){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,{my_position:e.my_position,rate:t.data})},e._sendMult=function(t){e.canHostingSend=!1,e.gp_wait_raise.visible=!0,e._sendRaise(t)},e._sendDone=function(){e.com_showDown.visible=!1,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DONE,e.my_position)},e.flaychip=function(t,i,n){return e.chips.flyChip(t,i,25)},e.showResultDBAni=function(t){return e.result_ani.show(t)},e.getDeskData=function(){return Data.getTopic("/tongbi_desk/"+e.desk_id)},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"desk_id",{get:function(){return this._desk_id},set:function(t){this._desk_id=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"preloadGroup",{get:function(){return Array.apply(void 0,Array(9)).map(function(t,e){return"niu"+(e+1)}).concat("bomb","niuniu","sihuaniu","wuhuaniu","wuniu","wuxiaoniu").map(function(t){return"effect_bull_"+t})},enumerable:!0,configurable:!0}),i.prototype.initUI=function(){this.init(),this.initOwnUserInfo(),this.registUIEventListener()},i.prototype.init=function(){var t=this;this.is_init||(this.is_init=!0,[1,2,3,4,5,6].forEach(function(e){t.com_pokers.push(t["com_pokerlist"+e]),t.com_players.push(t["com_player"+e]),t.com_multInfos.push(t["com_multInfo"+e]),t.com_winLoseInfos.push(t["com_winLoseInfo"+e])}),this.beginAni=new ui.bull.BeginAni,this.beginAni.horizontalCenter=this.beginAni.verticalCenter=0,this.mc_win.isPlaying=!1,this.mc_win.visible=!1,this.result_ani=new e.ResultMC(this.main),this.pokerAni=new e.PokerAni(this.gp_pokerAni),this.chips=new e.Chips(this.main),this.com_hosting_btn.currentState="hosting",this.new_uis=[this.beginAni,this.com_mult_btns,this.com_countDown,this.com_match_btn,this.result_ani,this.chips])},i.prototype.initData=function(){this.initSnapshot=this.getDeskData().snapshot,this.my_position=0,this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this.desk_id,this.updateStage(!0),this.isDone=[],this.com_showDown.visible=!1,this.canInitSelect=!0,this.canHostingSend=!1,this.canSendMatch=!1,this.updateUserInfo(!0);var t=this.getDeskData().snapshot;if("settle"===t.stage.toLowerCase())for(var e=7;e>1;e--){var i=7===e?1:e,n=this.getNetPosition(Number(i));t.fight[n];this.dealCard(i,null,!1)}this.updateRaise(),("settle"===t.stage.toLowerCase()||"fight"===t.stage.toLowerCase())&&this.updateFight(),this.updateStage(!0)},i.prototype.registerEvent=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.prototype.registUIEventListener=function(){this.com_hosting_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hostingBtnTap,this),this.com_showDown.addEventListener(egret.TouchEvent.TOUCH_TAP,this._sendDone,this)},i.prototype.removeFromStage=function(){this.changeStageHideUIS(),this.initPlayers(),this.com_hosting_btn.currentState="hosting",this.com_hosting_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hostingBtnTap,this),this.com_showDown.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._sendDone,this)},i.prototype.execCommand=function(t,e){switch(util.LogUtil.debug("casino.RoomUI [execCommand] cmd => "+Const.UICommand[t]),t){case Const.UICommand.CMD_UPDATE_ROOM_SETTING:this.updateRoomSetting();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_UPDATE_RAISE_RATE_OPTIONS:this.updateRaiseRateOptions();break;case Const.UICommand.CMD_UPDATE_USER_INFO:this.updateUserInfo("settle"!==this.getDeskData().snapshot.stage.toLowerCase());break;case Const.UICommand.CMD_UPDATE_RAISE:this.updateRaise();break;case Const.UICommand.CMD_UPDATE_FIGHT:this.updateFight();break;case Const.UICommand.CMD_UPDATE_SETTLE:this.updateSettle();break;case Const.UICommand.CMD_CONTINUE_MATCH:this.beforeContinueMatch();break;case Const.UICommand.CMD_CANCEL_MATCH:this.com_match_btn.setAutoMatch(!1),this.showUI(this.com_match_btn),this.initPlayers(),this.com_hosting_btn.currentState="hosting",this.canSendMatch=!0;break;case Const.UICommand.CMD_COMFIRM_HOSTING:util.LogUtil.warn("casino.RoomUI [CMD_COMFIRM_HOSTING] data => "+e),this.com_hosting_btn.currentState="cancel",this.main.contains(this.com_mult_btns)&&this.main.removeChild(this.com_mult_btns),this.checkAutoHostingVal(e),this.canHostingSend?(util.LogUtil.info("casino.RoomUI [CMD_COMFIRM_HOSTING] NOTIFY_RAISE data => "+JSON.stringify({my_position:this.my_position,rate:this.hostingRate})),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,{my_position:this.my_position,rate:this.hostingRate})):this.canSendMatch&&(util.LogUtil.info("casino.RoomUI [CMD_COMFIRM_HOSTING] NOTIFY_CONTINUE_MATCH}"),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH));break;case Const.UICommand.CMD_LEAVE_DESK:this.com_match_btn.clearInterval()}},i.prototype.updateRoomSetting=function(){this.getDeskData().snapshot.room_setting},i.prototype.updateStage=function(t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,function(){var i,n,o,r,s,a,l,u,h=this;return __generator(this,function(c){switch(c.label){case 0:switch(i=this.getDeskData().snapshot,n=function(t,e){h.showUI(h.com_countDown),h.com_countDown.show(t,e)},this.changeStageHideUIS(),o=i.stage.toLowerCase()){case"raise":return[3,1];case"fight":return[3,2];
case"settle":return[3,7]}return[3,11];case 1:return r=function(){h.getDeskData().snapshot.stage===i.stage&&(n(i.stage_timestamp,i.room_setting.time.raise),"hosting"===h.com_hosting_btn.currentState?(h.showUI(h.com_mult_btns),h.com_mult_btns.init(i.raise_rate_options,h.ante),h.com_mult_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,h._sendMult,h),h.com_mult_btns.once(e.MultButtonsBase.EVT_SEND_MULT,h._sendMult,h)):h.canHostingSend&&(h.canHostingSend=!1,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,{my_position:h.my_position,rate:h.hostingRate})))},this.canHostingSend=!0,t?r():(this.showUI(this.beginAni),this.beginAni.once(ui.bull.BeginAni.EVT_SHOW_BTN,function(){return r()},this)),[3,11];case 2:this.canHostingSend=!1,n(i.stage_timestamp,i.room_setting.time.op),s=7,c.label=3;case 3:return s>1?(a=7===s?1:s,l=this.getNetPosition(Number(a)),u=i.fight[l],this.dealCard(a,this.my_position===Number(l)?u.cards:null),[4,this.sleep(1e3)]):[3,6];case 4:c.sent(),this.my_position===a&&(this.com_showDown.visible=!0,"cancel"===this.com_hosting_btn.currentState&&this._sendDone()),c.label=5;case 5:return s--,[3,3];case 6:return[3,11];case 7:return util.LogUtil.warn("casino.RoomUI [updateStage] settle => "+JSON.stringify(this.getDeskData().snapshot.settle)),this.com_showDown.visible=!1,[4,this.turnCards()];case 8:return c.sent(),[4,this.sleep(1e3)];case 9:return c.sent(),[4,this.payoutAni()];case 10:return c.sent(),this.canSendMatch=!0,this.showUI(this.com_match_btn),"cancel"===this.com_hosting_btn.currentState?util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH):util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),[3,11];case 11:return[2]}})})},i.prototype.changeStageHideUIS=function(){this.hideUIS(this.new_uis),this.gp_wait_raise.visible&&(this.gp_wait_raise.visible=!1)},i.prototype.payoutAni=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.checkDBAni(),this.chipAni()])];case 1:return t.sent(),this.updateUserInfo(!0),[4,this.sleep(1e3)];case 2:return t.sent(),[2]}})})},i.prototype.turnCards=function(){var t=this;return new Promise(function(e){return __awaiter(t,void 0,void 0,function(){var t,i,n,o,r;return __generator(this,function(s){switch(s.label){case 0:t=7,s.label=1;case 1:return t>1?(i=7===t?1:t,n=this.getDeskData().snapshot.fight,o=n[this.getNetPosition(t)],r=this["com_pokerlist"+i],-1!==this.isDone.indexOf(i)?[3,5]:this.my_position!==i?[3,3]:(r.setBack(),[4,r.showResult(o.cards,o.type)])):[3,6];case 2:return s.sent(),[3,5];case 3:return[4,r.showResult(o.cards,o.type)];case 4:s.sent(),s.label=5;case 5:return t--,[3,1];case 6:return e(),[2]}})})})},i.prototype.checkDBAni=function(){for(var t=this.getDeskData().snapshot,i=7;i>1;i--){var n=7===i?1:i,o=this.getDeskData().snapshot.settle,r=o[this.getNetPosition(i)];r.surplus>0?(this["com_winLoseInfo"+n].currentState="win",this["com_winLoseInfo"+n].setScore(r.surplus,"win")):(this["com_winLoseInfo"+n].currentState="lose",this["com_winLoseInfo"+n].setScore(r.surplus)),this["com_winLoseInfo"+n].visible=!0}return t.settle[this.my_position].surplus>0?this.showResultDBAni(e.ResultEnum.win):void 0},i.prototype.chipAni=function(){var t=this;return new Promise(function(e){var i=t.getDeskData().snapshot.settle,n=0,o=[],r=[];Object.keys(i).forEach(function(e){var s=i[e],a=t.getLocalPosition(Number(e));s.surplus>0?(n=a,r.push(a)):s.surplus<0&&o.push(a)});var s=10;o.forEach(function(e){var i=t["com_player"+n],o=t["com_player"+e];util.SoundUtil.play("nn_collectgold_mp3"),t.flaychip(o.getChipPosition(),i.getChipPosition(),s)});var a=10;t.winTimeout=util.TimeUtil.setTimeout(function(){r.forEach(function(e){var i=10,o=t["com_player"+n],r=t["com_player"+e];util.SoundUtil.play("nn_collectgold_mp3"),t.flaychip(o.getChipPosition(),r.getChipPosition(),i)})},30*s+500),util.TimeUtil.setTimeout(e,30*(s+a)+500)})},i.prototype.updateRaiseRateOptions=function(){},i.prototype.updateUserInfo=function(t){var e=this,i=this.getDeskData().snapshot;i.user_info&&(0===this.my_position&&Object.keys(i.user_info).forEach(function(t){var n=i.user_info[t];n.user_id===""+Const.UserInfo.USER_ID&&(e.my_position=Number(t))}),Object.keys(i.user_info).forEach(function(n){var o=i.user_info[n],r=e.getLocalPosition(Number(n)),s=e["com_player"+r];o.username?(s.visible=!0,1!==r&&(s.setName(o.username),s.setHead(o.avatar)),t&&s.setBalance(o.balance)):(s.visible=!1,s.initHead())}))},i.prototype.updateRaise=function(){var t=this.getDeskData().snapshot.raise;if(util.LogUtil.warn("casino.RoomUI [updateRaise] raise => "+JSON.stringify(t)),t)for(var e=7;e>1;e--){var i=7===e?1:e,n=this.getDeskData().snapshot.raise,o=n[this.getNetPosition(e)];o.is_done&&(this["com_multInfo"+i].setRaiseMult(o.raise_rate),this["com_multInfo"+i].visible=!0)}},i.prototype.updateFight=function(){var t=this,e=this.getDeskData();Data.validate(topic.CasinoDeskTopic.fight_schema,e);var i=e.snapshot.fight;util.LogUtil.warn("casino.RoomUI [updateFight] fight => "+JSON.stringify(i)),Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e));if(-1===t.isDone.indexOf(o)&&n.is_done){var r=t["com_pokerlist"+o];t.my_position===o?(r.setBack(),r.showResult(n.cards,n.type)):r.showResult(n.cards,n.type),t.isDone.push(o)}})},i.prototype.updateSettle=function(){},i.prototype.beforeContinueMatch=function(){this.initPlayers()},i.prototype.initPlayers=function(){var t=this;[1,2,3,4,5,6].forEach(function(e){var i=t.com_pokers[e-1],n=t.com_players[e-1],o=t.com_multInfos[e-1],r=t.com_winLoseInfos[e-1];1!==e&&(n.visible=!1),n.initHead(),o.visible=!1,r.visible=!1,1===e&&(i.type="own"),i.init(),i.visible=!1})},i.prototype.initOwnUserInfo=function(){this.com_player1.visible=!0,this.com_player1.setName(Const.UserInfo.NICK),this.com_player1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance),this.com_player1.setHead(Const.UserInfo.AVATAR)},i.prototype.dealCard=function(t,e,i){return void 0===i&&(i=!0),__awaiter(this,void 0,void 0,function(){var n,o;return __generator(this,function(r){switch(r.label){case 0:return n=this["com_pokerlist"+t],n.visible=!1,o=i,o?[4,this.pokerAni.flyCard(t,n.getTopCardPos(),n.getPokerSize())]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return this.pokerAni.hidePoker(t),n.visible=!0,e&&n.setCards(e),[4,n.dealCardAni(i)];case 3:return r.sent(),[2]}})})},i.prototype.hostingBtnTap=function(){"cancel"===this.com_hosting_btn.currentState?this.com_hosting_btn.currentState="hosting":(ui.casino.dialog.HostingDialog.instance.show(),ui.casino.dialog.HostingDialog.instance.setRaise(this.initSnapshot.raise_rate_options),this.canInitSelect&&(ui.casino.dialog.HostingDialog.instance.initSelect(),this.canInitSelect=!1))},i.prototype.checkAutoHostingVal=function(t){var e=Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance,i=new Decimal(this.ante);if(i.mul(t).greaterThan(e)){for(var n=this.initSnapshot.raise_rate_options,o=4;o>=0;o--)if(e.greaterThanOrEqualTo(i.mul(n[o]))){this.hostingRate=n[o];break}}else this.hostingRate=t},i}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.casino.RoomUI")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=t.call(this)||this;return e.visible=!1,e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registEvent(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.registEvent,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeEvent,this)},i.prototype.registEvent=function(){this.gp_mult_btns.addEventListener(e.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.removeEvent=function(){this.visible=!1,this.gp_mult_btns.removeEventListener(e.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.sendMult=function(t){t.stopImmediatePropagation(),this.dispatchEventWith(i.EVT_SEND_MULT,!1,t.data),this.parent&&this.parent.removeChild(this)},i.EVT_SEND_MULT="evt_send_mult",i}(t.Component);e.MultButtonsBase=i,__reflect(i.prototype,"ui.casino.MultButtonsBase")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.anchorOffsetX=37.5,t.anchorOffsetY=38,t}return __extends(i,e),i.getOneChip=function(e,n){var o=i.CHIP_POOL.shift();if(o||(o=new t.component.SChip),n)o.type=n;else{var r=Const.Config.CHIP_VALUES.indexOf(e);o.type=-1===r?"player":""+(r+1)}return o.value=e,o},i.returnChip=function(t){i.CHIP_POOL.push(t),t.parent&&t.parent.removeChild(t)},Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t,this.displayValue=util.NumberUtil.formatUnit(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t.endsWith("_png")||t.endsWith("_jpg")?t:"s_chip_"+t+"_png"},enumerable:!0,configurable:!0}),i.CHIP_POOL=[],i}(eui.Component);e.SChip=i,__reflect(i.prototype,"ui.component.SChip")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var n=e.call(this)||this;return n.lb_messages=[],n.count=0,n._showTitle={},n.tapFeedback=function(){return t.dialog.FeedbackDialog.instance.show()},n.tapSetting=function(){return t.dialog.SettingDialog.instance.show()},n.playNotice=function(){return n.stage&&n._playNotice()},n._playNotice=function(t,e){if(void 0===t&&(t=0),!n.count||e){var o=i.message.shift();if(o){n.count++;var r=n.getOneLabel();n.initMessage(r),n.gp_message.addChild(r),r.textFlow=o,r.right=0-r.width+t;var s=r.width+n.gp_message.width-t,a=n.gp_message.width/1e4,l=s/a;egret.Tween.get(r,{onChange:function(){n.stage&&r.right>250&&"triggered"!==r.name&&(r.name="triggered",n._playNotice(r.right-250,!0))}}).to({right:n.gp_message.width},l).call(function(){n.count--,r.parent&&r.parent.removeChild(r),n.lb_messages.push(r),0===i.message.length&&(n.noticeGroup.visible=!1)})}}},n.initMessage=function(t){t.name="",t.size=28,t.verticalCenter=0,n.noticeGroup.visible=!0},n.getOneLabel=function(){var e=n.lb_messages.shift();return e||new t.control.Label},n.updateNick=function(t){return n.nick.text=t},n.updateAvatar=function(t){return n.profile.icon=t},n.updateBalance=function(t){return n.balance.text=t},n.updateOnline=function(t){var e=[t.base_count,t.game_count].map(function(t){return Object.keys(t).map(function(e){return t[e]})}).reduce(function(t,e){return t.concat(e)}).reduce(function(t,e){return t+e});n.online&&(n.online.label=""+e),n.onlineLabel&&(n.onlineLabel.text=util.LanguageUtil.translate("lbl_game_online_tip",""+e))},i.instanceArr.push(n),i.updateFps(Main.instance.fps),n}return __extends(i,e),Object.defineProperty(i.prototype,"fps",{get:function(){return this._fps},set:function(t){this._fps=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"game",{get:function(){return i._game},set:function(t){i._game=t,this.showTitle=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"titleSource",{get:function(){return this._titleSource},set:function(t){this._titleSource=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showTitle",{get:function(){return this._showTitle},set:function(t){this.showTitle.not=!(this.showTitle.is=!!t),this.showTitle.back=this.showTitle.is||!!params.callback_url},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){var i=this;e.prototype.childrenCreated.call(this),this.percentWidth=100,this.showTitle=!!this.game,this.link&&(this.link.textFlow=Const.Config.CONNECT_ADDRESS,mouse.setButtonMode(this.link,!0)),this.playNotice(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.playNotice,this),this.profile&&this.profile.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dialog.ProfileDialog.instance.show(i.profile.icon)},this),this.recharge&&(this.recharge.includeInLayout=this.recharge.visible=!params.guest&&!!Const.Config.TRANSFER_IN_URL_SWITCHER,this.recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dialog.IframeDialog.instance.show({title:" ",url:Const.Config.TRANSFER_IN_URL+"?username="+params.username})},this)),this.online&&this.online.addEventListener(egret.Event.CHANGE,function(){util.TimeUtil.clearTimeout(i.timeout),i.online.selected&&(i.timeout=util.TimeUtil.setTimeout(function(){return i.online.selected=!1},3e3))},this),this.help.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dialog.IframeDialog.instance.show({title:"lbl_game_help",url:Const.Config.DEFAULT_HOST+"/assets/description/help.html?game_list="+GameConst.game_list+(i.game?"&game="+i.game:"")+"&channel="+Const.UserInfo.CHANNEL_ID+"&lang="+Const.Config.LANGUAGE+"&authorization="+util.NetUtil.generateAuth()})},this),this.feedback&&this.feedback.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapFeedback,this),this.record.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RECORD)},this),this.setting&&this.setting.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapSetting,this),this.home&&this.home.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_PRI_HALL)},this),this.fullscreen&&this.fullscreen.addEventListener(egret.Event.CHANGE,function(){return i.fullscreen.selected?requestFullscreen.call(document.documentElement):exitFullscreen.call(document)},this),this.back&&this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.game?util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_PRI_HALL):refresh(params.callback_url)},this)},i.instanceArr=[],i.message=[],i.updateFps=function(t){return i.instanceArr.forEach(function(e){return e.fps="Fps "+t})},i.updateNotice=function(t){(e=i.message).push.apply(e,t),i.instanceArr.forEach(function(t){return t.playNotice()});var e},i}(t.Component);e.TopBar=i,__reflect(i.prototype,"ui.component.TopBar")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.show=function(t){util.TimeUtil.clearTimeout(e.timeout),e.ani&&e.ani.clean(),e.dialog&&e.dialog.init(),t.usernameText=t.user_id===Const.UserInfo.USER_ID?"lbl_jackpot_tip2":util.LanguageUtil.translate("lbl_jackpot_tip1",t.username),t.payoutText=util.LanguageUtil.translate("lbl_jackpot_tip3",util.LanguageUtil.translate(t.game),util.NumberUtil.formatNumber(t.payout)),t.autoHide>0&&(e.timeout=util.TimeUtil.setTimeout(function(){return e.close()},t.autoHide)),e.option=t,Main.instance.addChild(e,!0)},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"option",{get:function(){return this._option},set:function(t){this._option=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.ani?(this.dialog.animation={show:function(t,e){return e},close:function(t,e){return e}},this.dialog.onInit=function(){return e.ani.play(util.LanguageUtil.translate("lbl_jackpot_tip4",util.LanguageUtil.translate(e.option.game)),e.option.payout)},this.dialog.onClose=function(){return e.ani.clean()}):this.dialog.animation={show:function(t,i){var n=function(){return i._target.top=i._target._tweenTop+"%"};return i.addEventListener(egret.Event.CHANGE,n,e),i.set({_tweenTop:-100}).to({_tweenTop:0},300,egret.Ease.backOut).call(function(){n(),i.removeEventListener(egret.Event.CHANGE,n,e)})},close:function(t,i){var n=function(){return i._target.top=i._target._tweenTop+"%"};return i.addEventListener(egret.Event.CHANGE,n,e),i.to({_tweenTop:-100},300,egret.Ease.backIn).call(function(){n(),i.removeEventListener(egret.Event.CHANGE,n,e)})}},this.dialog.init()},e}(t.DialogBase);e.PoolDialog=i,__reflect(i.prototype,"ui.dialog.PoolDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rbtn_group=new eui.RadioButtonGroup,e.dp_desks=new eui.ArrayCollection,e.addToStage=function(){e.db_girl.play("dtgirl1"),e.rbtn_group.addEventListener(egret.Event.CHANGE,e.changeIndex,e)},e.removeFromSatge=function(){e.db_girl.stop(!0),e.rbtn_group.removeEventListener(egret.Event.CHANGE,e.changeIndex,e)},e.changeIndex=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CHANGE_ROOM_CATEGORY,Number(e.rbtn_group.selectedValue))},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.gp_btns.$children.forEach(function(t){return t.group=e.rbtn_group}),this.registerEvent(),this.addToStage()},e.prototype.registerEvent=function(){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromSatge,this)},e.prototype.updateHallDatas=function(t){this.dp_desks.replaceAll(t)},e.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.dp_desks.itemUpdated(e);break;case Const.UICommand.CMD_UPDATE_ROOM_CATEGORY:this.rbtn_group.getRadioButtonAt(e).selected=!0}},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.dragontiger.Hall")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var BaiRenController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="bairen",e.initDesk=function(t){var i=e.room_setting_map.get(e.room_id),n=t.snapshot,o=Data.getTopic(i.stage_topic).snapshot;Data.getTopic(i.road_map_topic).snapshot;ui.bairen.RoomUI.instance.setInitData({stage:o,desk:n,desk_item:e.room_bind_data_map.get(e.room_id)}),e.registerDeskData()},e.updateDesk=function(t,e){var i=t&&t.snapshot,n=e&&e.snapshot;Data.validate(topic.BRDeskSnapshot.schema,i),util.ObjectUtil.isEqual(i.user_info.bet,n.user_info.bet)||ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_BET,{own:i.user_info.bet,total:i.bet}),util.ObjectUtil.isEqual(i.bet,n.bet)||ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ALL_BET,{own:i.user_info.bet,total:i.bet}),!util.ObjectUtil.isEqual(i.open,n.open)&&i.open&&ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_CARDS,i.open),i.open&&util.ObjectUtil.isEqual(i.user_info.balance,n.user_info.balance)&&ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_SETTLE,{open:i.open,total_bet:i.bet,own_bet:i.user_info.bet,desk_settles:i.desk_settles,own_settle:i.user_info.settle,surplus:i.user_info.surplus}),util.ObjectUtil.isEqual(i.user_info,n.user_info)||ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO,i.user_info),util.ObjectUtil.isEqual(i.player_info,n.player_info)||ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_PLAYER_INFO,i.player_info),util.ObjectUtil.isEqual(i.round_id,n.round_id)&&util.ObjectUtil.isEqual(i.round_number,n.round_number)||ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO,{round_id:i.round_id,round_number:i.round_number})},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.addBindData=function(t){var e=this.room_setting_map.get(t),i=Data.getTopic(e.stage_topic),n=Data.getTopic(e.road_map_topic),o=Data.getTopic(Const.Topic.ONLINE),r=new ui.bairen.RoomItemData;if(o&&o.snapshot){var s=o.snapshot.base_room_count[t]||0,a=o.snapshot.room_count[t]||0;r.player_count=s+a}r.room_id=t,r.room_setting=e,this.room_bind_data_map.set(t,r),this.updateStageHandler(r,i),this.updateRoadMapHandler(r,n)},e.prototype.updateStageHandler=function(t,e,i,n){var o,r,s=e.snapshot,a=this.room_setting_map.get(t.room_id).bet_limit,l="",u="";Data.validate(topic.BRStageTopic.schema,e),Object.keys(a.min).forEach(function(t){var e=Number(a.min[t]);(void 0===o||o>e)&&(o=e)}),Object.keys(a.max).forEach(function(t){var e=Number(a.max[t]);(void 0===r||e>r)&&(r=e)}),l=util.NumberUtil.formatUnit(o),u=util.NumberUtil.formatUnit(r),t.simple_limit=l+"-"+u,t.limit=""+util.LanguageUtil.translate("lbl_room_betlimit")+t.simple_limit+" ",t.stage_timestamp=s.stage_timestamp,t.room_setting.time=s.room_setting.time,s.stage!==t.game_stage&&(t.game_stage=s.stage,"AFTER_SETTLE"===t.game_stage&&t.room_id===this.room_id&&ui.bairen.RoomUI.instance.stage&&this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROBOT_SETTEL,e.snapshot.channel_settles[Const.UserInfo.CHANNEL_ID]),"STOP_BET"!==t.game_stage&&"AFTER_SETTLE"!==t.game_stage?this.showCountDown(t,Number(s.stage_timestamp),Number(s.room_setting.time[s.stage.toLowerCase()])):(t.countdown="0",t.show_stage=this.exchangeStageText(t.game_stage,t.countdown)||"")),t.room_id===this.room_id&&ui.bairen.RoomUI.instance.stage&&ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE,e.snapshot)},e.prototype.updateRoadMapHandler=function(t,e){Data.validate(topic.BRRoadMapTopic.schema,e),t.road_map=util.ObjectUtil.copy(e.snapshot.round_result),ui.bairen.Hall.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t),t.room_id===this.room_id&&ui.bairen.RoomUI.instance.stage&&ui.bairen.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t)},e.prototype.exchangeStageText=function(t,e){void 0===e&&(e="0");var i="";switch(t.toLowerCase()){case"shuffle":i="lbl_room_shufflecard";break;case"deal":i="lbl_room_dealcard";break;case"bet":i="lbl_room_betting";break;case"open":i="lbl_room_comparecard";break;case"settle":i="lbl_room_payout";break;case"after_settle":i="lbl_room_payout";break;case"stop_bet":i="lbl_room_comparecard"}return util.LanguageUtil.translate(i,e)},e.prototype.handleShowRooms=function(){this.room_bind_data_map.forEach(function(t,e){t.room_type=["BR1","BR2","BR3","BR4"].indexOf(t.room_setting.room_id),t.item_bind_data=ui.bairen.Hall.instance.getDeskListBindData(t.room_type),util.LogUtil.debug("[BaiRenController] [handleShowRooms] room_id => "+e+" room_type => "+ui.bairen.RoomType[t.room_type])}),this.updateShowDesks()},e.prototype.updateShowDesks=function(){var t=this,e=[];this.all_visible_room_id_list.forEach(function(i){t.room_bind_data_map.forEach(function(t){t.room_setting.room_id===i&&e.push(t)})}),ui.bairen.Hall.instance.updateHallDatas(e)},e.prototype.showCountDown=function(t,e,i){var n=this;t.setIntervalID&&util.TimeUtil.clearInterval(t.setIntervalID);var o=function(){var o=(i-(util.TimeUtil.now-e))/1e3<<0;o>=0?t.countdown=""+o:(t.countdown="0",util.TimeUtil.clearInterval(t.setIntervalID),t.setIntervalID=void 0),t.show_stage=n.exchangeStageText(t.game_stage,t.countdown)||""};o(),t.setIntervalID=util.TimeUtil.setInterval(function(){return o()},250)},e}(JoinDeskGameController);__reflect(BaiRenController.prototype,"BaiRenController");var ui;!function(t){var e;!function(e){var i=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.idle=0,t.defaultChips=[200,300,400,500,600,700],t.ALL_TYPE=["dragon","tiger","tie"],t.ownBet={dragon:0,tiger:0,tie:0},t.otherPlayerBet={dragon:0,tiger:0,tie:0},t.robotBet={dragon:0,tiger:0,tie:0},t.AREA_TYPE={dragon:0,tie:1,tiger:2},t.limit={min:{dragon:0,tiger:0,tie:0},max:{dragon:0,tiger:0,tie:0}},t.STAGE={prepare:"lbl_game_prepare2",shuffle:"lbl_game_shufflecard",deal:"lbl_game_dealcard",bet:"lbl_game_betting",open:"lbl_game_comparecard",stop_bet:"lbl_game_comparecard",settle:"lbl_game_payouting",after_settle:"lbl_game_payout"},t.hideShuffle=function(){return t.mc_shuffle.visible=!1},t}return __extends(n,i),Object.defineProperty(n,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.chipAreas=[this.group_dragon_chips,this.group_tie_chips,this.group_tiger_chips]},n.prototype.initUI=function(){this.com_bottomPanel.initRoad(),this.initChips(),this.com_betArea.init(),this.pokerArea.init(),this.showResultAni(),this.showShuffleAni(!1)},n.prototype.initData=function(){var t=this;this.stage_settle_data=this.desk_settle_data=void 0;var e=this.data.desk,i=this.data.stage;this.road_map=this.data.desk_item.road_map,this.idle=0,this.currentStage=this.data.stage.stage.toLowerCase(),this.balance=e.user_info.balance,this.com_bottomPanel.setHead(Const.UserInfo.AVATAR),this.com_bottomPanel.setBalance(e.user_info.balance),this.com_bottomPanel.setName(e.user_info.username),this.com_bottomPanel.setSurplus(e.user_info.surplus),this.com_bottomPanel.showWin(e.user_info.surplus>0),this.com_bottomPanel.setChips(i.bet_limit.chips),this.com_bottomPanel.updateEnable(this.balance),this.setDefaultChips(i.bet_limit.chips),this.com_betArea.updateBet(e.user_info.bet,!0),this.com_betArea.updateBet(e.bet,!1);var n=e.user_info.bet,o=e.bet,r={dragon:0,tie:0,tiger:0};switch(Object.keys(o).forEach(function(t){r[t]=Number(o[t])-Number(n[t])}),this.flyChipAni(n,!0,!1),this.flyChipAni(r,!1,!1),["dragon","tiger","tie"].forEach(function(e){t.ownBet[e]=Number(n[e])||0,t.otherPlayerBet[e]=Number(r[e])||0}),this.old_robot_bets=[],this.playerArea.update(e.player_info.slice(0,6)),this.playerList.update(e.player_info),this.playerList.updateCount(this.data.desk_item&&this.data.desk_item.player_count||0),this.lab_stage.text=this.STAGE[this.currentStage],this.com_countDown.start(Number(i.stage_timestamp)+Number(i.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.com_bottomPanel.updatePeople(this.data.desk_item&&this.data.desk_item.player_count||0),this.com_betArea.setEnable(!1),this.com_bottomPanel.setRoadMap(this.data.desk_item.road_map),this.currentStage){case"deal":this.pokerArea.deal(e.shoe_size+3,0);break;case"bet":this.com_betArea.setEnable(!0),this.pokerArea.deal(e.shoe_size+3,0),this.handleRobotbet(i.bets,!1);break;case"open":this.pokerArea.deal(e.shoe_size+3,0),this.pokerArea.open(e.open,0),this.handleRobotbet(i.bets,!1);break;case"settle":this.handleRobotbet(i.bets,!1);break;case"after_settle":this.pokerArea.deal(e.shoe_size+3,0),this.pokerArea.open(e.open,0),this.com_betArea.showResult(e.open.winner);break;default:this.pokerArea.init(e.shoe_size)}this.limit.min=i.bet_limit.min,this.limit.max=i.bet_limit.max;var s=Math.min(this.limit.min.dragon,this.limit.min.tiger,this.limit.min.tie),a=Math.max(this.limit.max.dragon,this.limit.max.tiger,this.limit.max.tie);this.topBar.aVal=util.NumberUtil.formatNumber(s)+"-"+util.NumberUtil.formatNumber(a),this.topBar.bVal=e.round_id},n.prototype.registerEvent=function(){var t=this;this.com_bottomPanel.addEventListener(e.BottomPanel.EVT_TOGGLE_PEOPLE,function(){return t.playerList.toggle()},this),this.com_bottomPanel.addEventListener(e.BottomPanel.EVT_OPEN_DESK,function(){return e.dialog.ChangeDeskDialog.instance.show()},this),this.com_betArea.addEventListener(e.BetArea.EVT_BET,function(e){t.onBet(e.data)},this),this.com_betArea.addEventListener(e.BetArea.EVT_SHOW_TIP,function(e){"bet"!==t.currentStage&&t.com_tip.show(util.LanguageUtil.translate("lbl_game_bettip"))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},n.prototype.execCommand=function(t,e){var i=this;switch(t){case Const.UICommand.CMD_UPDATE_ALL_BET:var n=e.own,o=e.total,r={dragon:0,tie:0,tiger:0};this.ALL_TYPE.forEach(function(t){var e=(o[t]||0)-(n[t]||0);r[t]=e-i.otherPlayerBet[t],i.otherPlayerBet[t]=e}),this.flyChipAni(r,!1,"bet"===this.currentStage),this.updateShowBet();break;case Const.UICommand.CMD_UPDATE_CARDS:"open"===this.currentStage&&e&&this.pokerArea.open(e);break;case Const.UICommand.CMD_UPDATE_SETTLE:!function(){"settle"===i.currentStage&&(i.desk_settle_data={winner:e.open.winner,desk_settles:e.desk_settles,own_settle:e.user_info.settle,surplus:e.user_info.surplus})}();break;case Const.UICommand.CMD_UPDATE_USER_INFO:!function(){i.balance=e.balance,i.com_bottomPanel.setBalance(e.balance),i.com_bottomPanel.updateEnable(i.balance),i.idle=Number(e.idle)}();break;case Const.UICommand.CMD_UPDATE_BET:!function(){var t=e.own;"bet"===i.currentStage&&i.com_betArea.setEnable(!0);var n={dragon:0,tie:0,tiger:0};i.ALL_TYPE.forEach(function(e){n[e]=(t[e]||0)-i.ownBet[e],i.ownBet[e]=t[e]||0}),i.flyChipAni(n,!0,"bet"===i.currentStage),i.updateShowBet(!0)}();break;case Const.UICommand.CMD_UPDATE_PLAYER_INFO:this.playerArea.update(e.slice(0,6)),this.playerList.update(e);break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:"prepare"===this.currentStage&&(this.com_openRound.play(e.round_number),this.topBar.bVal=e.round_id);break;case Const.UICommand.CMD_UPDATE_SHOE:!function(){"deal"===i.currentStage?i.pokerArea.deal(e+3):i.pokerArea.init(e)}();break;case Const.UICommand.CMD_UPDATE_STAGE:!function(){var t=e,n=t.stage.toLowerCase();i.currentStage!==n&&(i.currentStage=n,i.onStageChange(t))}();break;case Const.UICommand.CMD_BALANCE_HINT:!function(){"bet"===i.currentStage&&i.com_betArea.setEnable(!0),i.com_tip.show(util.LanguageUtil.translate("lbl_balance_error"))}();break;case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.road_map=e.road_map,this.com_bottomPanel.setRoadMap(e.road_map);break;case Const.UICommand.CMD_INIT_UI:this.onRemove(),this.initUI();break;case Const.UICommand.CMD_UPDATE_ROBOT_BET:this.handleRobotbet(e,"bet"===this.currentStage);break;case Const.UICommand.CMD_UPDATE_ROBOT_SETTEL:this.stage_settle_data=e;break;case Const.UICommand.CMD_UPDATE_PEOPLE:this.playerList.updateCount(e),this.com_bottomPanel.updatePeople(e)}},n.prototype.settleHandler=function(){if(this.stage_settle_data&&this.desk_settle_data){var t=this.desk_settle_data,e=0,i=0,n=t.winner,o=t.own_settle[n]||{payout:0,bet:0},r=t.desk_settles.guest[n]||{payout:0,bet:0},s=t.desk_settles.player[n]||{payout:0,bet:0},a=this.stage_settle_data.robot[n]||{payout:0,bet:0};e=o.payout-o.bet,[r,s,a].forEach(function(t){i+=t.payout-t.bet}),this.com_betArea.showResult(n),this.showResultAni(n),this.payoutAni(i,e,n),this.com_bottomPanel.setSurplus(t.surplus),this.com_bottomPanel.showWin(t.surplus>0)}},n.prototype.handleRobotbet=function(t,e){var i=this;if(this.data&&this.data.stage){var n=util.ObjectUtil.minus(this.old_robot_bets||[],t);this.old_robot_bets=util.ObjectUtil.copy(t);var o={dragon:0,tiger:0,tie:0};n&&n.length&&(n.forEach(function(t){Object.keys(t.bets).forEach(function(e){var n=Number(i.data.stage.bet_limit.max[e])||0,r=Number(i.data.stage.bet_limit.min[e])||0,s=t.bets[e].p,a=t.bets[e].m,l=new Decimal((s*(n-r)+r)*a).divToInt(100).mul(100);if(l.greaterThan(0)){for(var u=l.toNumber(),h=i.defaultChips.length-1;h>=0;h--)u%=i.defaultChips[h],0===h&&u>0&&(l=l.minus(u));i.robotBet[e]=l.add(i.robotBet[e]).toNumber(),o[e]+=l.toNumber()}})}),util.LogUtil.warn("===================================handleRobotbet","robotBet",o),this.flyChipAni(o,!1,"bet"===this.currentStage),this.updateShowBet())}},n.prototype.updateShowBet=function(t){var e=this;if(void 0===t&&(t=!1),t)this.com_betArea.updateBet(this.ownBet,!0);else{var i={dragon:0,tiger:0,tie:0};this.ALL_TYPE.forEach(function(t){return i[t]=e.robotBet[t]+e.otherPlayerBet[t]+e.ownBet[t]}),this.com_betArea.updateBet(i,!1)}},n.prototype.setDefaultChips=function(t){var e=this;this.defaultChips=[],t.forEach(function(t){e.defaultChips.push(Number(t))})},n.prototype.onStageChange=function(e){var i=this;switch(this.com_betArea.setEnable(!1),"stop_bet"!==this.currentStage&&"after_settle"!==this.currentStage&&(this.com_countDown.start(Number(e.stage_timestamp)+Number(e.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.lab_stage.text=this.STAGE[this.currentStage],this.showResultAni(),this.com_betArea.init()),this.currentStage){case"deal":!function(){var e=Math.min(i.limit.min.dragon,i.limit.min.tiger,i.limit.min.tie);i.idle>=5?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_game_nobet2","lbl_game_comfirm")):i.balance&&i.balance.lt(e)?i.stage&&(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_balance_error2","lbl_game_comfirm")):3===i.idle&&i.com_tip.show(util.LanguageUtil.translate("lbl_game_nobet"))
}();break;case"bet":this.com_betArea.setEnable(!0),util.SoundUtil.play("longhu_start_mp3"),this.showBetHintAni("start"),this.initChips();break;case"open":util.SoundUtil.play("longhu_stop_mp3"),this.showBetHintAni("stop");break;case"settle":break;case"after_settle":this.old_robot_bets=[],this.settleHandler();break;case"shuffle":this.stage_settle_data=this.desk_settle_data=void 0,this.showShuffleAni(!0),this.pokerArea.init(),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1);case"prepare":this.pokerArea.init(),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1),this.com_betArea.updateBet({dragon:0,tiger:0,tie:0},!0),this.com_betArea.updateBet({dragon:0,tiger:0,tie:0},!1),this.initChips()}},n.prototype.onBet=function(t){var e=this,i={dragon:0,tie:0,tiger:0};i[t]=this.com_bottomPanel.getCurChipValue();var n;["dragon","tiger"].forEach(function(t){e.ownBet[t]>0&&(n=t)}),n&&t!==n&&"tie"!==t?this.com_tip.show(util.LanguageUtil.translate("lbl_game_bettip2")):this.checkLimit(t)?(this.com_betArea.setEnable(!1),this.com_bottomPanel.betAni(!0),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BET,i)):this.com_tip.show(util.LanguageUtil.translate("lbl_game_beterror")+"\n"+util.LanguageUtil.translate("lbl_game_beterror_number",util.NumberUtil.formatNumber(this.limit.min[t]),util.NumberUtil.formatNumber(this.limit.max[t])))},n.prototype.checkLimit=function(t){var e=Number(this.ownBet[t])+Number(this.com_bottomPanel.getCurChipValue());return e<=this.limit.max[t]&&e>=this.limit.min[t]},n.prototype.initChips=function(){var e=this;util.TimeUtil.clearTimeout(this.payoutAniTimeout1),util.TimeUtil.clearTimeout(this.payoutAniTimeout2),["dragon","tiger","tie"].forEach(function(i,n){for(var o=e.chipAreas[n].numChildren-1;o>=0;o--){var r=e.chipAreas[n].getChildAt(o);egret.Tween.removeTweens(r),t.component.SChip.returnChip(r)}e.ownBet[i]=0,e.otherPlayerBet[i]=0,e.robotBet[i]=0})},n.prototype.payoutAni=function(e,i,n){var o=this,r=500,s=this.com_countDown.localToGlobal(),a=this.com_bottomPanel.getOtherPos(),l=this.com_bottomPanel.getOwnPos(),u=!1;["dragon","tiger","tie"].forEach(function(e){if(e!==n){for(var i=o.AREA_TYPE[e],a=o.chipAreas[i],l=a.globalToLocal(s.x+o.com_countDown.width/2,s.y+o.com_countDown.height/2),h=function(e){var i=a.getChildAt(e);u=!0,egret.Tween.removeTweens(i),egret.Tween.get(i).to({x:l.x,y:l.y},r,egret.Ease.quadOut).call(function(){t.component.SChip.returnChip(i)})},c=a.numChildren-1;c>=0;c--)h(c);o.ownBet[e]=0,o.otherPlayerBet[e]=0,o.robotBet[e]=0}}),u&&util.SoundUtil.play("longhu_chipfly_short_mp3");var h=this.AREA_TYPE[n],c=this.getFlyChipList(i,!0),p=this.getFlyChipList(e-i,!1),_=this.chipAreas[h],d=_.globalToLocal(s.x+this.com_countDown.width/2,s.y+this.com_countDown.height/2);a=_.globalToLocal(a.x,a.y),l=_.globalToLocal(l.x,l.y),this.payoutAniTimeout1=util.TimeUtil.setTimeout(function(){var e=!1;c.forEach(function(i,n){for(var s=0;i>s;s++){e=!0;var a=o.getChipPos(h),l=_.globalToLocal(a.x,a.y),u=o.defaultChips[n],c=t.component.SChip.getOneChip(u);_.addChild(c),c.name="own",c.x=d.x,c.y=d.y,egret.Tween.get(c).to({x:l.x,y:l.y,rotation:360*Math.random()},r,egret.Ease.quadOut)}}),p.forEach(function(i,n){for(var s=0;i>s;s++){e=!0;var a=o.getChipPos(h),l=_.globalToLocal(a.x,a.y),u=o.defaultChips[n],c=t.component.SChip.getOneChip(u);_.addChild(c),c.name="other",c.x=d.x,c.y=d.y,egret.Tween.get(c).to({x:l.x,y:l.y,rotation:360*Math.random()},r,egret.Ease.quadOut)}}),e&&util.SoundUtil.play("longhu_chipfly_long_mp3")},r),this.payoutAniTimeout2=util.TimeUtil.setTimeout(function(){for(var e=!1,i=function(i){e=!0;var s=_.getChildAt(i),u="own"===s.name?l:a;egret.Tween.removeTweens(s),egret.Tween.get(s).to({x:u.x,y:u.y,rotation:360*Math.random()},r,egret.Ease.quadOut).call(function(){o.otherPlayerBet[n]=0,o.robotBet[n]=0,t.component.SChip.returnChip(s)})},s=_.numChildren-1;s>=0;s--)i(s);e&&util.SoundUtil.play("longhu_win_bet_mp3")},2*r)},n.prototype.flyChipAni=function(e,i,n){var o=this;void 0===n&&(n=!0);var r,s,a,l;Object.keys(e).forEach(function(u){var h=o.AREA_TYPE[u];if(l=Number(e[u]),r=i?o.com_bottomPanel.getOwnPos():o.com_bottomPanel.getOtherPos(),s=o.chipAreas[h].globalToLocal(r.x,r.y),l>0){!i&&n&&o.com_bottomPanel.betAni(!1);var c,p=o.getFlyChipList(l,i);if(p.forEach(function(e,r){e>0&&(c=r+1);for(var l=0;e>l;l++){var u=o.getChipPos(h);a=o.chipAreas[h].globalToLocal(u.x,u.y);var p=o.defaultChips[r],_=t.component.SChip.getOneChip(p);o.chipAreas[h].addChild(_),_.name=i?"own":"other",_.x=s.x,_.y=s.y,egret.Tween.get(_).to({x:a.x,y:a.y,rotation:360*Math.random()},n?500:0,egret.Ease.quadOut)}}),i){var _=Math.ceil(c/2);n&&util.SoundUtil.play("longhu_other_bet"+_+"_mp3")}else n&&util.SoundUtil.play("longhu_bet_other_mp3")}})},n.prototype.getChipPos=function(t){var e=this.chipAreas[t].localToGlobal();return{x:e.x+Math.random()*this.chipAreas[t].width,y:e.y+Math.random()*this.chipAreas[t].height}},n.prototype.getFlyChipList=function(t,e){var i;if(e){for(var n=[],o=this.defaultChips.length-1;o>=0;o--){var r=Math.floor(t/this.defaultChips[o]);t%=this.defaultChips[o],n.push(r)}i=n.reverse()}else{for(var n=[],o=this.defaultChips.length-1;o>=0;o--)n.push(0);for(var s=0;t>=this.defaultChips[0];)t-this.defaultChips[s]>=0&&(t-=this.defaultChips[s],n[s]=n[s]+1),s=s<this.defaultChips.length-1?s+1:0;i=n}return i},n.prototype.showBetHintAni=function(t){var e=this;this.com_betHint.show(t),egret.Tween.removeTweens(this.com_betHint),this.com_betHint.horizontalCenter=-1300,this.com_betHint.alpha=.8,egret.Tween.get(this.com_betHint).to({horizontalCenter:0,alpha:1},250,egret.Ease.backOut).to({horizontalCenter:20},300).to({horizontalCenter:600,alpha:0},200,egret.Ease.quadIn).call(function(){e.com_betHint.show()})},n.prototype.showResultAni=function(t){switch(t){case"dragon":util.SoundUtil.play("longhu_win_long_mp3");break;case"tiger":util.SoundUtil.play("longhu_win_hu_mp3");break;case"tie":util.SoundUtil.play("longhu_win_he_mp3")}this.com_result.show(t)},n.prototype.showShuffleAni=function(t){this.mc_shuffle.removeEventListener(egret.Event.COMPLETE,this.hideShuffle,!0),this.mc_shuffle.visible=t,t&&(this.mc_shuffle.currentFrame=0,this.mc_shuffle.playTimes=1,this.mc_shuffle.isPlaying=!0,this.mc_shuffle.once(egret.Event.COMPLETE,this.hideShuffle,!0))},n.prototype.onRemove=function(){this.com_countDown.clearTimer(),util.SoundUtil.destroy(["longhu_start_mp3","longhu_win_long_mp3","longhu_win_hu_mp3","longhu_win_he_mp3","longhu_end_bet_mp3"].concat(Array.apply(void 0,Array(13)).map(function(t,e){return"longhu_n0"+(e+1)+"_mp3"})))},n}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.dragontiger.RoomUI")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._img_bg_green=new eui.Image,e}return __extends(e,t),Object.defineProperty(e.prototype,"img_bg_green",{get:function(){return this._img_bg_green},set:function(t){this._img_bg_green=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.hide=function(){t.prototype.hide.call(this),this.img_bg_green.visible&&(this.img_bg_green.visible=!1)},e.prototype.createBg=function(){t.prototype.createBg.call(this),this.addBg(this.img_bg_green)},e.prototype.setBg=function(t){var e="red"===t?this.img_bg_red:"blue"===t?this.img_bg_blue:this.img_bg_green;e&&(e.visible=!0)},e}(t.ResultMarkBase);t.BBResultMarkBase=e,__reflect(e.prototype,"ui.dragontiger.BBResultMarkBase")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var FantanController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="fantan",e.updateDesk=function(t,i,n){var o=t&&t.snapshot,r=i&&i.snapshot,s=n&&n.snapshot;if(util.LogUtil.debug("[fantanController] [updateDesk] newRaw => "+JSON.stringify(s)),util.ObjectUtil.isEqual(o.user_info.bet,r.user_info.bet)||(util.LogUtil.debug("[fantanController] CMD_UPDATE_BET => "+JSON.stringify(o.user_info.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_BET,{own:o.user_info.bet,total:o.bet})),util.ObjectUtil.isEqual(o.bet,r.bet)||(util.LogUtil.debug("[fantanController] CMD_UPDATE_ALL_BET => "+JSON.stringify(o.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ALL_BET,{own:o.user_info.bet,total:o.bet})),!util.ObjectUtil.isEqual(o.open,r.open)&&o.open&&(util.LogUtil.debug("[fantanController] CMD_UPDATE_CARDS => "+JSON.stringify(o.open)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_CARDS,o.open)),o.open&&util.ObjectUtil.isEqual(o.user_info.balance,r.user_info.balance)&&egret.log("settle",JSON.stringify(o,null,"	")),o.open&&util.ObjectUtil.isEqual(o.user_info.balance,r.user_info.balance)){var a={desk_settles:o.desk_settles,own_settle:o.user_info.settle,surplus:o.user_info.surplus};e.old_settle_log&&util.ObjectUtil.isEqual(a,e.old_settle_log)||(e.old_settle_log=a,util.LogUtil.debug("[fantanController] CMD_UPDATE_SETTLE => "+JSON.stringify(a))),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_SETTLE,{open:o.open,total_bet:o.bet,own_bet:o.user_info.bet,desk_settles:o.desk_settles,own_settle:o.user_info.settle,surplus:o.user_info.surplus})}util.ObjectUtil.isEqual(o.user_info,r.user_info)||(util.LogUtil.debug("[fantanController] CMD_UPDATE_USER_INFO"),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO,o.user_info)),util.ObjectUtil.isEqual(o.round_id,r.round_id)&&util.ObjectUtil.isEqual(o.round_number,r.round_number)||(util.LogUtil.debug("[fantanController] CMD_UPDATE_ROUND_INFO"),e.old_settle_log=void 0,e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO,{round_id:o.round_id,round_number:o.round_number}))},e.initDesk=function(t){util.LogUtil.debug("[fantanController] [initDesk]");var i=e.room_setting_map.get(e.room_id),n=Data.getTopic(i.stage_topic);e.room_ui.setInitData({stage:n.snapshot,desk:t.snapshot,desk_item:e.room_bind_data_map.get(e.room_id)}),util.LogUtil.info("[fantanController] [setInitData]"),e.registerDeskData()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.updateRoadMapHandler=function(t,e){t.road_map=util.ObjectUtil.copy(e.snapshot.round_result),t.result_percent=util.ObjectUtil.copy(e.snapshot.result_percent),t.list=util.ObjectUtil.copy(e.snapshot.list),t.room_id===this.room_id&&ui.fantan.RoomUI.instance.stage&&ui.fantan.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t),ui.fantan.Hall.instance.udpateRoadMap(t)},e.prototype.updateStageHandler=function(t,e,i,n){var o=e.snapshot,r=e.snapshot.bet_limit,s=0,a=0,l="",u="",h=0;if(o.pools&&o.pools[Const.UserInfo.CHANNEL_ID]){var c=o.pools[Const.UserInfo.CHANNEL_ID];h=(c.robot||0)+(c[params.guest?"guest":"player"]||0)}Object.keys(r.min).forEach(function(t){var e=Number(r.min[t]);(0===s||s>e)&&(s=e)}),Object.keys(r.max).forEach(function(t){var e=Number(r.max[t]);(0===a||e>a)&&(a=e)}),l=util.NumberUtil.formatUnit(s),u=util.NumberUtil.formatUnit(a),t.simple_limit=l+"-"+u,t.limit=""+util.LanguageUtil.translate("lbl_room_betlimit")+t.simple_limit+" ",t.stage_timestamp=o.stage_timestamp,t.stage_room_setting=o.room_setting,t.pool=util.NumberUtil.formatUnit(h),o.stage!==t.game_stage&&t.room_id===this.room_id&&this.room_ui.stage&&(t.game_stage=o.stage,"after_settle"===t.game_stage.toLowerCase()&&this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROBOT_SETTEL,e.snapshot.channel_settles[Const.UserInfo.CHANNEL_ID]),this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_STAGE,e.snapshot))},e}(JoinDeskGameController);__reflect(FantanController.prototype,"FantanController");var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pool="",e}return __extends(e,t),e}(topic.RoomItemData);e.RoomItemData=i,__reflect(i.prototype,"ui.fantan.RoomItemData");var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomIds=["FT1","FT2","FT3","FT4"],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btns=[this.btn1,this.btn2,this.btn3,this.btn4],this.updateRooms()},e.prototype.updateHallDatas=function(t){this.data=t,this.btn1&&this.updateRooms()},e.prototype.updateRooms=function(){var t=this;this.btns.forEach(function(t){t.visible=!1,t.includeInLayout=!1}),this.data&&this.data.forEach(function(e){var i=t.roomIds.indexOf(e.room_setting.room_id),n=t.btns[i];n.visible=!0,n.includeInLayout=!0,n.bindData=e,n.update()})},e.prototype.udpateRoadMap=function(t){if(this.btn1){var e=this.roomIds.indexOf(t.room_setting.room_id),i=this.btns[e];i.update()}},e}(t.HallBase);e.Hall=n,__reflect(n.prototype,"ui.fantan.Hall"),function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shot=function(){egret.callLater(function(){egret.callLater(function(){var t=new egret.RenderTexture;t.drawToTexture(e.group_lushu),e.img_shot.source=t},e)},e)},e}return __extends(e,t),Object.defineProperty(e.prototype,"nameImg",{get:function(){return this._nameImg},set:function(t){this._nameImg=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.bindData.room_setting.room_id)},this),this.addEventListener(egret.Event.RESIZE,this.resize,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return e.resize()},this),this.imgs=[];for(var i=0;24>i;i++){var n=new eui.Image;n.height=n.width=74,this.imgs.push(n)}},e.prototype.resize=function(){if(this.roadData){var t=75,e=Math.floor((this.width-39)/t);this.root.width=e*t+39;var i=e*t,n=this.roadData.length*t;this.scroller.viewport.scrollH=n>i?n-i:0,this.bg_light.x=this.roadData.length?75*(this.roadData.length-1):0,this.roadData.length?this.bg_light.visible=!0:this.bg_light.visible=!1,this.shot()}},e.prototype.dealNumber=function(t){switch(t.toString()){case"one":return 1;case"two":return 2;case"three":return 3;case"four":return 4}},e.prototype.update=function(){var t=this;if(this.bindData&&!util.ObjectUtil.isEqual(this.bindData.road_map,this.roadMapoldData)){var e=util.ObjectUtil.copy(this.bindData.road_map);this.roadMapoldData=util.ObjectUtil.copy(this.bindData.road_map),this.bindData.road_map.length>24?this.roadData=e.slice(e.length-24):this.roadData=e,this.group_lushu.removeChildren(),this.roadData.forEach(function(e,i){t.imgs[i].source="ft_pic_road"+t.dealNumber(e[0])+"_png",t.group_lushu.addChild(t.imgs[i])}),this.intervalId&&util.TimeUtil.clearInterval(this.intervalId),this.intervalId=void 0,this.roadData.length&&this._init&&(this.times=0,this.intervalId=util.TimeUtil.setInterval(function(){t.bg_light.visible=t.times%2===0,t.times++,t.times>4&&(t.intervalId&&util.TimeUtil.clearInterval(t.intervalId),t.intervalId=void 0,t.bg_light.visible=!0)},200)),this._init=!0,this.resize()}},e}(t.control.Button);e.HallItemButton=i,__reflect(i.prototype,"ui.fantan.Hall.HallItemButton")}(n=e.Hall||(e.Hall={}))}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){this.one_two_four=0,this.one_three_four=0,this.two_three_four=0,this.one_two_three=0,this.one_two=0,this.two_three=0,this.three_four=0,this.four_one=0,this.one=0,this.two=0,this.three=0,this.four=0,this.single=0,this["double"]=0}return t}();e.AreaMark=i,__reflect(i.prototype,"ui.fantan.AreaMark");var n=function(n){function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.girl_scale=1,t.ownBet=new i,t.otherBet=new i,t.robotBet=new i,t.idle=0,t.ALL_TYPE=["one_two_four","one_three_four","two_three_four","one_two_three","one_two","two_three","three_four","four_one","one","two","three","four","single","double"],t.defaultChips=[500,1e3,2e3,5e3,1e4,2e4],t.limit={min:new i,max:new i},t.AREA_TYPE={1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8,10:9,11:10,12:11,13:12,14:13},t._winGroup=[],t._whereBet="",t.STAGE={prepare:"lbl_game_wait",shuffle:"lbl_game_wait",deal:"lbl_game_wait",bet:"lbl_game_betting",open:"lbl_game_payout_wait",settle:"lbl_game_payout_wait",pool:"lbl_game_payout_wait"},t.stones=[],t.hide_stones=[],t.gaiziPos=[{x:-57,y:177},{x:-380,y:35}],t._exchange_db=function(t,e){return egret.Point.create(t+540.4,e+399.11)},t._call=function(){t.bone_bolizhao?t.rs.updateGlassPosition(t._exchange_db(t.bone_bolizhao.global.x,t.bone_bolizhao.global.y)):t.rs.updateGlassPosition(egret.Point.create(890,474))},t.delayTime=10,t.girl_standbyCenter=function(){t.showGirlAni("1"),t.gaizi.visible=!0,t.gaizi.x=t.gaiziPos[0].x,t.gaizi.y=t.gaiziPos[0].y,t.stoneGroup.addChild(t.gaizi)},t.getMinLimit=function(){return Math.min.apply(Math,Object.keys(t.limit.min).map(function(e){return t.limit.min[e]}))},t.shot=function(e,i){egret.callLater(function(){var t=new egret.RenderTexture;t.drawToTexture(e),i.source=t},t)},t}return __extends(o,n),Object.defineProperty(o,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"cur_stage",{get:function(){return this.STAGE[this.currentStage]},enumerable:!0,configurable:!0}),o.prototype.createChildren=function(){n.prototype.createChildren.call(this),this._winGroup=[this.win0,this.win1,this.win2,this.win3,this.win4,this.win5,this.win6,this.win7,this.win8,this.win9,this.win10,this.win11,this.win12,this.win13];for(var t=0;68>t;t++){var e=new eui.Image("ft_pic_stone_png");this.stones.push(e)}this.gaizi=new eui.Image("ft_pic_bowl_png"),this.result=new eui.Image("ft_pic_road1_png"),this.result.x=-240,this.result.y=250,this.createRollingStone()},o.prototype.createRollingStone=function(){var t=this;this.rs=new e.RollingStones(this.gp_stones,egret.Point.create(890,474)),this.rs.initStones(110),this.rs.initStones(20,"p"),this.rs.runWorld(),this.stop_world_timeout=util.TimeUtil.setTimeout(function(){return t.rs.stopWorld()},3e3)},o.prototype.dealDB=function(){var t=this,e=0,i=(this.hide_stones.length/6<<0,function(n){if("washitou"===n.frameLabel)util.LogUtil.debug("washitou");else if("yaoshitou"===n.frameLabel)util.SoundUtil.play("yaowan_mp3");else if("yaoshitou2"===n.frameLabel)util.SoundUtil.destroy(["yaowan_mp3"]);else if("shoushitou"===n.frameLabel){if(util.LogUtil.debug("shoushitou",e),t.resultData){for(var o=t.resultData.result_index,r=o%4||4,s=(o-r)/4,a=s/6,l=s-1;l>=a*(5-e);l--)for(var u=0;4>u;u++){var h=t.stones[4*l+u];h.parent&&h.parent.removeChild(h)}if(2===e)for(var l=0;r>l;l++){var h=t.stones[o-l-1];h.parent&&h.parent.removeChild(h)}}e++}else"daowei"===n.frameLabel&&(util.LogUtil.debug("daowei"),t.removeEventListener(egret.Event.ENTER_FRAME,t._call,t),t.armature.removeEventListener(dragonBones.EgretEvent.FRAME_EVENT,i,t),t.rs.updateGlassPosition(egret.Point.create(890,474)))});this.addEventListener(egret.Event.ENTER_FRAME,this._call,this),this.armature.addEventListener(dragonBones.EgretEvent.FRAME_EVENT,i,this)},o.prototype.getStonePos1=function(t){for(var e=330,i=20,n=8,o=[],r=t*n,s=0;t>s;s++){var a=s*n-r/2;o.push({x:a,y:e+Math.random()*i})}return o},o.prototype.getStonePos2=function(t){for(var e=210,i=13,n=12,o=t%4||4,r=Math.floor((t-o)/4),s=110*Math.PI/180,a=s/(r-1),l=[],u=0;r>u;u++)for(var h=u*a-s/2,c=0;4>c;c++){var p=e+c*(n+i),_=p*Math.sin(h),d=p*Math.cos(h);l.push({x:_,y:d})}switch(o){case 1:l.push({x:0,y:320});break;case 2:l.push({x:-37,y:320}),l.push({x:37,y:320});break;case 3:l.push({x:-62,y:320}),l.push({x:0,y:320}),l.push({x:62,y:320});break;case 4:l.push({x:-93,y:320}),l.push({x:-31,y:320}),l.push({x:31,y:320}),l.push({x:93,y:320})}return l},o.prototype.setPosition=function(t){var e=45,i=234,n=0;this.gaizi.visible=!0,this.result.visible=!1;for(var o=t-1;o>=0;o--){var r=Math.random()*e,s=Math.random()*Math.PI*2,a=this.stones[o];a.x=Math.sin(s)*r+n-6,a.y=Math.cos(s)*r+i-6.5,this.stoneGroup.addChild(a)}this.stoneGroup.addChild(this.result),this.stoneGroup.addChild(this.gaizi)},o.prototype.stoneAni1=function(){for(var t=this,e=this.resultData.result_index,i=this.getStonePos1(e),n=function(n){egret.Tween.get(o.stones[n]).wait(o.delayTime*n).to(i[n],200).call(function(){n===e-1&&t.stoneAni2(e)})},o=this,r=0;e>r;r++)n(r)},o.prototype.stoneAni2=function(t){var e=this,i=100;this.stonePos=this.getStonePos2(t),Array.apply(void 0,Array(Math.ceil(t/4))).forEach(function(n,o){util.TimeUtil.setTimeout(function(){return util.SoundUtil.play("fangshitou_mp3")},(i+e.delayTime)*o),egret.Tween.get(e.stones[4*o]).wait(i*o+e.delayTime*o).to(e.stonePos[4*o],i).call(function(){4*o===t-1&&e.openResultCall()}),e.stones[4*o+1].stage&&egret.Tween.get(e.stones[4*o+1]).wait(i*o+e.delayTime*o).to(e.stonePos[4*o+1],i).call(function(){4*o+1===t-1&&e.openResultCall()}),e.stones[4*o+2].stage&&egret.Tween.get(e.stones[4*o+2]).wait(i*o+e.delayTime*o).to(e.stonePos[4*o+2],i).call(function(){4*o+2===t-1&&e.openResultCall()}),e.stones[4*o+3].stage&&egret.Tween.get(e.stones[4*o+3]).wait(i*o+e.delayTime*o).to(e.stonePos[4*o+3],i).call(function(){4*o+3===t-1&&e.openResultCall()})})},o.prototype.openResultCall=function(){var t=this,e=this.resultData.result_index%4||4;this.result.source="ft_pic_road"+e+"_png";var i=200,n=1.4;util.SoundUtil.play("jieguo_mp3");for(var o=function(){t.result.visible=!0,t.result.alpha=0,egret.Tween.get(t.result).to({alpha:1},300)},r=function(t){var r=s.stones[s.resultData.result_index-e+t],a={x:r.x,y:r.y};egret.Tween.get(r).wait(t*i).to({scaleX:n,scaleY:n,x:a.x-12*(n-1),y:a.y-13*(n-1)},i/2).to({scaleX:1,scaleY:1,x:a.x,y:a.y},i/2).call(function(){t===e-1&&o()})},s=this,a=0;e>a;a++)r(a)},o.prototype.cleanStone=function(){for(var t=0;t<this.stones.length;t++){var e=this.stones[t];e.parent&&e.parent.removeChild(e)}this.result.visible=!1},o.prototype.initUI=function(){this.initChips(),this.com_countDown.clearTimer(),this.com_betArea.init(),this.clearbetchips(),this.showGirlAni("1"),this.cleanStone()},o.prototype.initData=function(){var t=this,e=this.data.desk,n=this.data.stage;this.showGirlAni("1"),this.idle=0,this.channel_settles=this.desk_settle_data=void 0,this.currentStage=this.data.stage.stage.toLowerCase(),this.com_tip.show(this.cur_stage),this.balance=e.user_info.balance,this.com_bottomPanel.setHead(Const.UserInfo.AVATAR),this.com_bottomPanel.setBalance(this.balance),this.com_bottomPanel.setName(Const.UserInfo.NICK),this.com_bottomPanel.setSurplus(Number(e.user_info.surplus)),this.com_bottomPanel.showWin(e.user_info.surplus>0),this.com_bottomPanel.setChips(n.bet_limit.chips),this.com_bottomPanel.updateEnable(this.balance),this.setDefaultChips(n.bet_limit.chips);var o=e.user_info.bet,r=e.bet,s=new i;switch(Object.keys(r).forEach(function(t){s[t]=Number(r[t]||0)-Number(o[t]||0)}),this.ALL_TYPE.forEach(function(e){t.otherBet[e]=Number(s[e]||0),t.ownBet[e]=Number(o[e]||0)}),this.old_robot_bets=[],this.flyChipAni(this.ownBet,"own",!1),this.flyChipAni(this.otherBet,"other",!1),this.btn_people.label=String(this.data.desk_item&&this.data.desk_item.playernum||0),this.com_betArea.setEnable(!1),this.currentStage){case"prepare":this.gaizi.visible=!1,this.stop_world_timeout&&util.TimeUtil.clearTimeout(this.stop_world_timeout),this.rs.runWorld(),this.showGirlAni("3"),this.db_girl.once(egret.Event.LOOP_COMPLETE,function(){t.girl_standbyCenter(),t.stop_world_timeout=util.TimeUtil.setTimeout(function(){return t.rs.stopWorld()},1e3)},this);break;case"bet":this.showGirlAni("1"),this.gaizi.visible=!0,this.gaizi.x=this.gaiziPos[0].x,this.gaizi.y=this.gaiziPos[0].y,this.stoneGroup.addChild(this.gaizi),this.com_betArea.setEnable(!0),this.com_countDown.start(Number(n.stage_timestamp)+Number(n.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.handleRobotbet(n.bets,!1),this.updateBet(this.ownBet);break;case"open":this.resultData=util.ObjectUtil.copy(this.data.desk.open),this.dealStoneData(),this.kaipai(),this.handleRobotbet(n.bets,!1);break;case"settle":this.handleRobotbet(n.bets,!1);break;case"after_settle":this.settle(e.desk_settles);break;case"shuffle":this.gaizi.visible=!1,this.stop_world_timeout&&util.TimeUtil.clearTimeout(this.stop_world_timeout),this.rs.runWorld(),this.showGirlAni("3"),this.db_girl.once(egret.Event.LOOP_COMPLETE,function(){t.girl_standbyCenter(),t.stop_world_timeout=util.TimeUtil.setTimeout(function(){return t.rs.stopWorld()},1e3)},this)}this.updatelimit(n.bet_limit),this.topBar.bVal=e.round_id,this.roadMap.updateRoadMap(this.data.desk_item)},o.prototype.setDefaultChips=function(t){var e=this;this.defaultChips=[],t.forEach(function(t){e.defaultChips.push(Number(t))})},o.prototype.registerEvent=function(){var t=this;this.com_betArea.addEventListener(e.BetArea.EVT_BET,function(e){t.onBet(e.data)},this),this.com_betArea.addEventListener(e.BetArea.EVT_SHOW_TIP,function(e){"bet"!==t.currentStage&&(t.cur_stage&&t.com_tip.show(t.cur_stage),util.SoundUtil.play("xiazhushibai_mp3"))},this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){t.rs&&(t.rs.runWorld(),t.stop_world_timeout=util.TimeUtil.setTimeout(function(){return t.rs.stopWorld()},3e3))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},o.prototype.execCommand=function(t,e){var n=this;switch(t){case Const.UICommand.CMD_UPDATE_ROBOT_BET:this.handleRobotbet(e,"bet"===this.currentStage);break;case Const.UICommand.CMD_UPDATE_ALL_BET:var o=e.own,r=e.total,s=new i;this.ALL_TYPE.forEach(function(t,e){var i=(r[t]||0)-(o[t]||0);s[t]=i-n.otherBet[t],n.otherBet[t]=i}),this.flyChipAni(s,"other","bet"===this.currentStage);break;case Const.UICommand.CMD_UPDATE_SETTLE:"settle"===this.currentStage&&(this.desk_settle_data=e,util.LogUtil.warn(this.topBar.bVal+" => SETTLE STAGE"));break;case Const.UICommand.CMD_UPDATE_USER_INFO:!function(){n.balance=e.balance,n.com_bottomPanel.setBalance(n.balance),n.com_bottomPanel.updateEnable(n.balance),n.idle=Number(e.idle)}();break;case Const.UICommand.CMD_UPDATE_BET:!function(){var t=e.own;"bet"===n.currentStage&&n.com_betArea.setEnable(!0);var o=new i;n.ALL_TYPE.forEach(function(e,i){o[e]=(t[e]||0)-n.ownBet[e],n.ownBet[e]=t[e]||0}),n.updateBet(n.ownBet),n.flyChipAni(o,"own","bet"===n.currentStage)}();break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:"prepare"===this.currentStage&&(this.topBar.bVal=e.round_id,util.LogUtil.warn(this.topBar.bVal+" => SHUFFLE STAGE"),this.desk_settle_data=void 0,this.stop_world_timeout&&util.TimeUtil.clearTimeout(this.stop_world_timeout),this.rs.runWorld(),this.showGirlAni("3"),this.db_girl.once(egret.Event.LOOP_COMPLETE,function(){n.girl_standbyCenter(),n.stop_world_timeout=util.TimeUtil.setTimeout(function(){return n.rs.stopWorld()},1e3)},this),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1),this.initChips());break;case Const.UICommand.CMD_UPDATE_STAGE:!function(){var t=e;n.data&&(n.data.stage=t),n.updatelimit(t.bet_limit);var i=t.stage.toLowerCase();n.currentStage!==i&&(n.currentStage=i,n.onStageChange(t))}();break;case Const.UICommand.CMD_UPDATE_CARDS:"open"===this.currentStage&&(this.resultData=util.ObjectUtil.copy(e),this.dealStoneData(),this.kaipai());break;case Const.UICommand.CMD_BALANCE_HINT:"bet"===this.currentStage&&this.com_betArea.setEnable(!0),this.com_tip.show(util.LanguageUtil.translate("lbl_balance_error"));break;case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.roadMap.updateRoadMap(e);break;case Const.UICommand.CMD_INIT_UI:this.onRemove(),this.initUI();break;case Const.UICommand.CMD_UPDATE_PEOPLE:this.btn_people.label=e.toString();break;case Const.UICommand.CMD_UPDATE_ROBOT_SETTEL:this.channel_settles=e}},o.prototype.dealStoneData=function(){if(this.resultData.result_index>68){var t=this.resultData.result_index%4||4;this.resultData.result_index=64+t}},o.prototype.onStageChange=function(e){var i=this;switch(this.com_betArea.setEnable(!1),"settle"!==this.currentStage&&"after_settle"!==this.currentStage&&this.com_betArea.init(),this.currentStage){case"prepare":this.gaizi.visible=!1,this.result.visible=!1,function(){util.LogUtil.warn(i.topBar.bVal+" => DEAL STAGE"),i.stop_world_timeout&&util.TimeUtil.clearTimeout(i.stop_world_timeout),i.rs.runWorld(),i.showGirlAni("3"),i.db_girl.once(egret.Event.LOOP_COMPLETE,function(){i.girl_standbyCenter(),i.stop_world_timeout=util.TimeUtil.setTimeout(function(){return i.rs.stopWorld()},1e3)},i);var e=i.getMinLimit();i.idle>=5?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_game_nobet2","lbl_game_comfirm")):i.balance&&i.balance.lt(e)?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL,!0),t.dialog.MessageDialog.instance.showAlert("lbl_balance_error2","lbl_game_comfirm")):3===i.idle&&i.com_tip.show(util.LanguageUtil.translate("lbl_game_nobet"))}();break;case"bet":this.cleanStone(),util.LogUtil.warn(this.topBar.bVal+" => BET STAGE"),this.com_countDown.start(Number(e.stage_timestamp)+Number(e.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.com_betArea.setEnable(!0),util.SoundUtil.play("start_mp3"),this.showBetHintAni("start"),this.initChips();break;case"stop_bet":break;case"open":util.LogUtil.warn(this.topBar.bVal+" => OPEN STAGE"),this.showBetHintAni("stop");break;case"settle":util.LogUtil.warn(this.topBar.bVal+" => SETTLE STAGE");break;case"after_settle":this.settleHandler();break;case"shuffle":util.LogUtil.warn(this.topBar.bVal+" => SHUFFLE STAGE"),this.initChips()}},o.prototype.handleRobotbet=function(t,e){var n=this;if(this.data&&this.data.stage){var o=util.ObjectUtil.minus(this.old_robot_bets||[],t);this.old_robot_bets=util.ObjectUtil.copy(t);var r=new i;o&&o.length&&(o.forEach(function(t){n.ALL_TYPE.forEach(function(e){var i=Number(n.data.stage.bet_limit.max[e])||0,o=Number(n.data.stage.bet_limit.min[e])||0,s=t.bets[""+e]&&t.bets[""+e].p||0,a=t.bets[""+e]&&t.bets[""+e].m||0,l=new Decimal((s*(i-o)+o)*a).divToInt(100).mul(100);if(l.greaterThan(0))for(var u=l.toNumber(),h=n.defaultChips.length-1;h>=0;h--)u%=n.defaultChips[h],0===h&&u>0&&(l=l.minus(u));n.robotBet[e]=l.add(n.robotBet[e]).toNumber(),r[e]+=l.toNumber()})}),this.flyChipAni(r,"other","bet"===this.currentStage),util.LogUtil.debug("===================================handleRobotbet","increment",r))}},o.prototype.payoutAni=function(e,i,n){var o=this,r=600,s=!1;util.LogUtil.warn(this.topBar.bVal+" => total surplus "+JSON.stringify(e)+" own surplus "+JSON.stringify(i)),this.ALL_TYPE.forEach(function(e,i){if("lose"===n[e]){o.ownbetGroup.getChildAt(i).visible=!1;var s=o.group_chipbet.getChildAt(i),a=o.group_chipbet0.getChildAt(i),l=s.getCopyImg(o.group_chipAni);s.initChips(),egret.Tween.get(l).set({scaleX:.77,scaleY:.77}).to({alpha:0},r/2).call(function(){l.alpha=1,egret.Tween.removeTweens(l),t.component.ChipStacked.returnImg(l)});var u=a.getCopyImg(o.group_chipAni0);a.initChips(),egret.Tween.get(u).set({scaleX:.77,scaleY:.77}).to({alpha:0},r/2).call(function(){u.alpha=1,egret.Tween.removeTweens(u),t.component.ChipStacked.returnImg(u)}),o.ownBet[e]=0,o.otherBet[e]=0,o.robotBet[e]=0}}),s&&util.SoundUtil.play("payout_chips_mp3"),this.payoutAniTimeout1=util.TimeUtil.setTimeout(function(){var n=!1;Object.keys(e).forEach(function(r,s){var a=o.AREA_TYPE[s+1];if(e[r]>0&&void 0!==a){var l=o.group_chipbet.getChildAt(a),u=o.db_girl.localToGlobal(),h=o.group_chipAni.globalToLocal(u.x,u.y),c=i[r],p=e[r]-i[r];if(c>0){n=!0;var _=l.getFlyChipGlobalPos(),d=o.group_chipAni.globalToLocal(_.x,_.y),g=t.component.SChip.getOneChip(c,"1");g.scaleX=g.scaleY=.77;l.globalToLocal(_.x,_.y);o.group_chipAni.addChild(g),g.name="own",g.x=h.x,g.y=h.y,egret.Tween.get(g).to({x:d.x,y:d.y},400,egret.Ease.quadOut).call(function(){egret.Tween.removeTweens(g),l.addChip(g.value,"s_chip_1_png"),t.component.SChip.returnChip(g)})}var m=o.group_chipbet0.getChildAt(a);if(p>0){n=!0;var _=m.getFlyChipGlobalPos(),d=o.group_chipAni0.globalToLocal(_.x,_.y),f=t.component.SChip.getOneChip(p,"player");f.scaleX=f.scaleY=.77;m.globalToLocal(_.x,_.y);
o.group_chipAni0.addChild(f),f.name="other",f.x=h.x,f.y=h.y,egret.Tween.get(f).to({x:d.x,y:d.y},400,egret.Ease.quadOut).call(function(){egret.Tween.removeTweens(f),m.addChip(f.value,"s_chip_player_png"),t.component.SChip.returnChip(f)})}}}),n&&util.SoundUtil.play("payout_chips_mp3"),o.updateBet(o.ownBet)},r),this.payoutAniTimeout2=util.TimeUtil.setTimeout(function(){o.ALL_TYPE.forEach(function(e,i){if("lose"!==n[i]){o.ownbetGroup.getChildAt(i).visible=!1;var s=o.getOtherPos(),a=o.com_bottomPanel.getOwnPos(),l=o.group_chipbet.getChildAt(i),u=o.group_chipbet0.getChildAt(i);s=o.group_chipAni0.globalToLocal(s.x,s.y),a=o.group_chipAni.globalToLocal(a.x,a.y);var h=l.getCopyImg(o.group_chipAni);h.scaleX=h.scaleY=.77,l.initChips(),egret.Tween.get(h).to({y:h.y-20},200).wait(200).to({x:a.x,y:a.y},r,egret.Ease.quadOut).call(function(){o.otherBet[e]=0,o.robotBet[e]=0,egret.Tween.removeTweens(h),t.component.ChipStacked.returnImg(h)});var c=u.getCopyImg(o.group_chipAni0);c.scaleX=c.scaleY=.77,u.initChips(),egret.Tween.get(c).to({y:c.y-20},200).wait(200).to({x:s.x,y:s.y},r,egret.Ease.quadOut).call(function(){o.otherBet[e]=0,o.robotBet[e]=0,egret.Tween.removeTweens(c),t.component.ChipStacked.returnImg(c)})}})},2*r)},o.prototype.flyChipAni=function(e,i,n){var o=this;void 0===n&&(n=!0);var r,s,a,l,u="own"===i;Promise.all(Object.keys(e).map(function(h,c){var p=o.AREA_TYPE[c+1],_=u?o.group_chipbet.getChildAt(p):o.group_chipbet0.getChildAt(p);if(l=Number(e[h]),r=u?o.com_bottomPanel.getOwnPos():o.getOtherPos(),s=u?o.group_chipAni.globalToLocal(r.x,r.y):o.group_chipAni0.globalToLocal(r.x,r.y),l>0){if(!u&&n){var d=-516;o.btn_people.verticalCenter=d,egret.Tween.get(o.btn_people).to({verticalCenter:d-15},80,egret.Ease.quadOut).to({verticalCenter:d},80,egret.Ease.quadIn)}util.LogUtil.warn(o.topBar.bVal+" => "+i+" bet "+l+" on "+h),n&&util.SoundUtil.play("fangchouma_mp3");var g=o.getFlyChipList(l);return Promise.all(g.map(function(e,i){return new Promise(function(i){var r=u?o.group_chipbet.getChildAt(p):o.group_chipbet0.getChildAt(p),l=r.getFlyChipGlobalPos();a=u?o.group_chipAni.globalToLocal(l.x,l.y):o.group_chipAni0.globalToLocal(l.x,l.y);var h=t.component.SChip.getOneChip(e,u?void 0:"player");h.scaleX=h.scaleY=.77;var c=(_.globalToLocal(l.x,l.y),function(){egret.Tween.removeTweens(h),_.addChip(e,u?h.type:void 0),t.component.SChip.returnChip(h),i({chip:h})});u?o.group_chipAni.addChild(h):o.group_chipAni0.addChild(h),h.name=u?"own":"other",h.x=s.x,h.y=s.y,egret.Tween.get(h).to({x:a.x,y:a.y},n?500-200*Math.random():0,egret.Ease.quadOut).call(c)})}))}return[]}))},o.prototype.getChipPos=function(t){var e=t.localToGlobal();return{x:e.x+util.NumberUtil.getRandom(29,t.width-29),y:e.y+util.NumberUtil.getRandom(29,t.height-29)}},o.prototype.getOtherPos=function(){var t=this.btn_people.localToGlobal();return{x:t.x+this.btn_people.width/2,y:t.y+this.btn_people.height/2}},o.prototype.getFlyChipList=function(t){for(var e,i=[],n=this.defaultChips.length-1;n>=0;n--)for(;t>=this.defaultChips[n];)i.push(this.defaultChips[n]),t-=this.defaultChips[n];return e=i.reverse()},o.prototype.onBet=function(t){var e=new i;return e[t]=this.com_bottomPanel.getCurChipValue(),this._whereBet=t,this.balance.add(this.ownBet[t]).lt(this.limit.min[t])?(this.com_tip.show(util.LanguageUtil.translate("lbl_balance_error")),void util.SoundUtil.play("xiazhushibai_mp3")):void(this.checkLimit(t)?(this.com_betArea.setEnable(!1),this.com_bottomPanel.betAni(!0),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BET,e)):(this.com_tip.show(util.LanguageUtil.translate("lbl_game_beterror")+"\n"+util.LanguageUtil.translate("lbl_game_beterror_number",util.NumberUtil.formatNumber(this.limit.min[t]),util.NumberUtil.formatNumber(this.limit.max[t]))),util.SoundUtil.play("xiazhushibai_mp3")))},o.prototype.checkLimit=function(t){var e=Number(this.ownBet[t])+Number(this.com_bottomPanel.getCurChipValue());return e<=this.limit.max[t]&&e>=this.limit.min[t]},o.prototype.onRemove=function(){this.db_girl.stop(!0),this.com_countDown.clearTimer(),this.initUI(),this.rs.stopWorld()},o.prototype.settle=function(t){for(var e=[],i=t.open,n=0;14>n;n++){var o=this.getBetType(n),r=i?i.winner:"111";-1!==o.indexOf(r)?e.push(n):"double"!==o||"two"!==r&&"four"!==r?"single"!==o||"one"!==r&&"three"!==r||e.push(12):e.push(13)}this.com_betArea.showResult(e),this.playwinAni(e)},o.prototype.settleHandler=function(){if(this.desk_settle_data&&this.channel_settles){this.com_bottomPanel.showWin(this.desk_settle_data.surplus>0),this.desk_settle_data.surplus>0&&this.playWinAni(),this.settle(this.desk_settle_data),this.com_bottomPanel.setSurplus(this.desk_settle_data.surplus);for(var t=new i,e=new i,n=[],o=this.desk_settle_data.open,r=0;14>r;r++){var s=this.getBetType(r),a=this.channel_settles.robot[s]?this.channel_settles.robot[s].payout:0,l=this.desk_settle_data.desk_settles.guest[s]?this.desk_settle_data.desk_settles.guest[s].payout:0,u=this.desk_settle_data.desk_settles.player[s]?this.desk_settle_data.desk_settles.player[s].payout:0;t[s]=a+l+u;var h=this.desk_settle_data.own_settle[s]?this.desk_settle_data.own_settle[s].payout:0;e[s]=h;var c=o?o.winner:"111";-1!==s.indexOf(c)?n[s]="win":("double"!==s||"two"!==c&&"four"!==c)&&("single"!==s||"one"!==c&&"three"!==c)?n[s]="lose":n[s]="win"}this.payoutAni(t,e,n)}},o.prototype.getBetType=function(t){var e;switch(t){case 0:e="one_two_four";break;case 1:e="one_three_four";break;case 2:e="two_three_four";break;case 3:e="one_two_three";break;case 4:e="one_two";break;case 5:e="two_three";break;case 6:e="three_four";break;case 7:e="four_one";break;case 8:e="one";break;case 9:e="two";break;case 10:e="three";break;case 11:e="four";break;case 12:e="double";break;case 13:e="single"}return e},o.prototype.showGirlAni=function(t,e){return void 0===e&&(e=0),__awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(o){switch(o.label){case 0:return[4,this.db_girl.play("fan_tan_girl",t,0,e)];case 1:return i=o.sent(),i.armature&&(n=i.armature.getBone("bolizhao1"),this.armature=i,n&&(this.bone_bolizhao=n,"3"===t&&this.dealDB())),[2]}})})},o.prototype.kaipai=function(){var t=this;this.setPosition(this.resultData.result_index),this.showGirlAni("2",1),this.gaizi.visible=!1,util.SoundUtil.play("dakai_mp3"),this.db_girl.once(dragonBones.AnimationEvent.COMPLETE,function(){t.showGirlAni("1"),t.gaizi.visible=!0,t.gaizi.x=t.gaiziPos[1].x,t.gaizi.y=t.gaiziPos[1].y,t.stoneAni1()},this)},o.prototype.showBetHintAni=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,o,r=this;return __generator(this,function(s){switch(s.label){case 0:return[4,this.db_bet_tip.play("horoscope_"+t+"_betting")];case 1:return e=s.sent(),i=e.armature.getSlot("font"),n=RES.getRes("ho_font_"+t+"_betting_png"),o=new egret.Bitmap(n),o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,i.setDisplay(o),i.invalidUpdate(),this.db_bet_tip.visible=!0,this.db_bet_tip.once(egret.Event.LOOP_COMPLETE,function(){r.db_bet_tip.stop(!0),r.db_bet_tip.visible=!1},this),[2]}})})},o.prototype.updateBet=function(t){var e=this;this.ALL_TYPE.forEach(function(i,n){if(void 0===t[i]||t[i]<=0)e.ownbetGroup.getChildAt(Number(n)).visible=!1;else{e.ownbetGroup.getChildAt(Number(n)).visible=!0;var o=e.ownbetGroup.getChildAt(Number(n));o.getChildAt(1).text=util.NumberUtil.formatUnit(t[i]),i===e._whereBet&&egret.Tween.get(e.ownbetGroup.getChildAt(Number(n))).to({scaleX:1.1,scaleY:1.1},200).to({scaleX:1,scaleY:1},100).call(function(){egret.Tween.removeTweens(e.ownbetGroup.getChildAt(Number(n)))})}})},o.prototype.clearbetchips=function(){var t=this;this.ALL_TYPE.forEach(function(e,i){t.ownbetGroup.getChildAt(Number(i)).visible=!1})},o.prototype.playwinAni=function(t){var e=this;t.forEach(function(t){e._winGroup[t].group="effect_1_bc_win",e._winGroup[t].currentFrame=0,e._winGroup[t].playTimes=1,e._winGroup[t].visible=!0,e._winGroup[t].isPlaying=!0,e._winGroup[t].once(egret.Event.COMPLETE,function(){e.reset(t)},e)})},o.prototype.reset=function(t){this._winGroup[t].isPlaying=!1,this._winGroup[t].visible=!1,this._winGroup[t].group="",this._winGroup[t].source=null},o.prototype.initChips=function(){var e=this;util.TimeUtil.clearTimeout(this.payoutAniTimeout1),util.TimeUtil.clearTimeout(this.payoutAniTimeout2),this.ALL_TYPE.forEach(function(i,n){var o=e.group_chipbet.getChildAt(n);o.initChips(),o=e.group_chipbet0.getChildAt(n),o.initChips();for(var r=e.group_chipAni,s=r.numChildren-1;s>=0;s--){var a=r.getChildAt(s);void 0===a.source?t.component.SChip.returnChip(a):t.component.ChipStacked.returnImg(a)}for(var l=e.group_chipAni0,u=l.numChildren-1;u>=0;u--){var a=l.getChildAt(u);void 0===a.source?t.component.SChip.returnChip(a):t.component.ChipStacked.returnImg(a)}e.ownBet[i]=0,e.otherBet[i]=0,e.robotBet[i]=0}),this.updateBet(this.ownBet),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1)},o.prototype.playWinAni=function(){var t=this;this.db_winAni.visible=!0,this.db_winAni.play("baicai_win",null,0,1),this.db_winAni.alpha=1,this.db_winAni.once(egret.Event.COMPLETE,function(){egret.Tween.get(t.db_winAni).to({alpha:0},500,egret.Ease.circOut).call(function(){t.db_winAni.visible=!1})},this)},o.prototype.updatelimit=function(t){var e=this;this.limit.min=t.min,this.limit.max=t.max;var i=Math.min.apply(Math,Object.keys(this.limit.min).map(function(t){return e.limit.min[t]})),n=Math.max.apply(Math,Object.keys(this.limit.max).map(function(t){return e.limit.max[t]}));this.topBar.aVal=util.NumberUtil.formatUnit(i)+"-"+util.NumberUtil.formatUnit(n)},o}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.fantan.RoomUI")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomIds=["FI1","FI2","FI3","FI4"],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btns=[this.btn1,this.btn2,this.btn3,this.btn4],this.data&&this.updateRooms()},e.prototype.updateHallDatas=function(t){this.data=t,this.btn1&&this.updateRooms()},e.prototype.updateRooms=function(){var t=this;this.btns.forEach(function(t){t.visible=!1,t.includeInLayout=!1}),this.data.forEach(function(e){var i=t.roomIds.indexOf(e.room_setting.room_id),n=t.btns[i];n.includeInLayout=!0,n.visible=!0,n.data=e})},e.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_ROAD_MAP:util.LogUtil.debug("-----CMD_UPDATE_ROAD_MAP-----",e)}},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.fish.Hall")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){this.fish=0,this.shrimp=0,this.gourd=0,this.copper=0,this.crab=0,this.cock=0,this.combination_fish_shrimp=0,this.combination_fish_gourd=0,this.combination_fish_copper=0,this.combination_fish_crab=0,this.combination_fish_cock=0,this.combination_shrimp_gourd=0,this.combination_shrimp_copper=0,this.combination_shrimp_crab=0,this.combination_shrimp_cock=0,this.combination_gourd_copper=0,this.combination_gourd_crab=0,this.combination_gourd_cock=0,this.combination_copper_crab=0,this.combination_copper_cock=0,this.combination_crab_cock=0,this.pair_fish=0,this.pair_shrimp=0,this.pair_gourd=0,this.pair_copper=0,this.pair_crab=0,this.pair_cock=0,this.triple_fish=0,this.triple_copper=0,this.triple_shrimp=0,this.triple_crab=0,this.triple_gourd=0,this.triple_cock=0,this.triple=0,this.one_red=0,this.one_blue=0,this.one_green=0,this.two_red=0,this.two_blue=0,this.two_green=0,this.three_red=0,this.three_blue=0,this.three_green=0,this.three=0}return t}();e.Bets=i,__reflect(i.prototype,"ui.fish.Bets");var n=function(n){function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.isScrollerTouched=!1,t.girl_scale=1,t.idle=0,t.currentStage="deal",t.defaultChips=[],t.own_bets=new i,t.other_player_bets=new i,t.robot_bets=new i,t.limit={min:{any_three:0,any_triple:0,combination:0,one:0,pair:0,single:0,three:0,triple:0,two:0},max:{any_three:0,any_triple:0,combination:0,one:0,pair:0,single:0,three:0,triple:0,two:0}},t.STAGE={shuffle:"lbl_game_wait",deal:"lbl_game_wait",bet:"lbl_game_betting",open:"lbl_game_payout_wait",stop_bet:"lbl_game_payout_wait",settle:"lbl_game_payout_wait",after_settle:"lbl_game_payout_wait"},t.settleData={fish:{payout:0,rake:0,bet:0},shrimp:{payout:0,rake:0,bet:0},gourd:{payout:0,rake:0,bet:0},copper:{payout:0,rake:0,bet:0},crab:{payout:0,rake:0,bet:0},cock:{payout:0,rake:0,bet:0},combination_fish_shrimp:{payout:0,rake:0,bet:0},combination_fish_gourd:{payout:0,rake:0,bet:0},combination_fish_copper:{payout:0,rake:0,bet:0},combination_fish_crab:{payout:0,rake:0,bet:0},combination_fish_cock:{payout:0,rake:0,bet:0},combination_shrimp_gourd:{payout:0,rake:0,bet:0},combination_shrimp_copper:{payout:0,rake:0,bet:0},combination_shrimp_crab:{payout:0,rake:0,bet:0},combination_shrimp_cock:{payout:0,rake:0,bet:0},combination_gourd_copper:{payout:0,rake:0,bet:0},combination_gourd_crab:{payout:0,rake:0,bet:0},combination_gourd_cock:{payout:0,rake:0,bet:0},combination_copper_crab:{payout:0,rake:0,bet:0},combination_copper_cock:{payout:0,rake:0,bet:0},combination_crab_cock:{payout:0,rake:0,bet:0},pair_fish:{payout:0,rake:0,bet:0},pair_shrimp:{payout:0,rake:0,bet:0},pair_gourd:{payout:0,rake:0,bet:0},pair_copper:{payout:0,rake:0,bet:0},pair_crab:{payout:0,rake:0,bet:0},pair_cock:{payout:0,rake:0,bet:0},triple_fish:{payout:0,rake:0,bet:0},triple_copper:{payout:0,rake:0,bet:0},triple_shrimp:{payout:0,rake:0,bet:0},triple_crab:{payout:0,rake:0,bet:0},triple_gourd:{payout:0,rake:0,bet:0},triple_cock:{payout:0,rake:0,bet:0},triple:{payout:0,rake:0,bet:0},one_red:{payout:0,rake:0,bet:0},one_blue:{payout:0,rake:0,bet:0},one_green:{payout:0,rake:0,bet:0},two_red:{payout:0,rake:0,bet:0},two_blue:{payout:0,rake:0,bet:0},two_green:{payout:0,rake:0,bet:0},three_red:{payout:0,rake:0,bet:0},three_blue:{payout:0,rake:0,bet:0},three_green:{payout:0,rake:0,bet:0},three:{payout:0,rake:0,bet:0}},t.all_bets=new i,t.notAwardIndexArr=[],t.getMinLimit=function(){return Math.min.apply(Math,Object.keys(t.limit.min).map(function(e){return t.limit.min[e]}))},t.getMaxLimit=function(){return Math.max.apply(Math,Object.keys(t.limit.max).map(function(e){return t.limit.max[e]}))},t}return __extends(o,n),Object.defineProperty(o,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"cur_stage",{get:function(){return this.STAGE[this.currentStage]},enumerable:!0,configurable:!0}),o.prototype.initUI=function(){this.main.contains(this.com_betHint)&&this.main.removeChild(this.com_betHint),this.winAni.visible=!1,this.com_cup.visible=!0,this.com_betArea.init(),this.com_cup.init(),this.com_countDown.clearTimer(),this.playGirlAction("daiji",0,1),this.com_betArea.chipArea=this.chipArea,this.updateBetAreaScorller(),this.betNumberText.text="0"},o.prototype.initData=function(){var t=this;this.com_betArea.resetBetAreaUI(),this.playGirlAction("daiji",0,0),this.com_cup.visible=!0,this.idle=0,this.com_betArea.chipArea=this.chipArea,this.oldBetsDataClear();var e=this.data.desk,n=this.data.stage;if(this.currentStage=this.data.stage.stage.toLowerCase(),this.com_tip.show(this.cur_stage),this.balance=e.user_info.balance,this.road_map=this.data.desk_item.road_map,this.com_bottomPanel.setHead(Const.UserInfo.AVATAR),this.com_bottomPanel.setBalance(e.user_info.balance),this.com_bottomPanel.setName(e.user_info.username),this.com_bottomPanel.setSurplus(Number(e.user_info.surplus)),this.com_bottomPanel.showWin(e.user_info.surplus>0),this.com_bottomPanel.setChips(n.bet_limit.chips),this.com_bottomPanel.updateEnable(this.balance),this.setDefaultChips(n.bet_limit.chips),this.btn_people.label=String(this.data.desk_item&&this.data.desk_item.playernum||0),this.updatelimit(n.bet_limit),util.LogUtil.debug("-------------currentStage----",this.currentStage,e,n),e.user_info.bet){var o=new i;this.computeBet(o,e.user_info.bet),this.updateMyBetNumberText(o)}switch(this.currentStage){case"deal":break;case"bet":this.com_betArea.setEnable(!0),this.com_countDown.start(Number(n.stage_timestamp)+Number(n.room_setting.time[this.currentStage]),"bet"===this.currentStage);break;case"stop_bet":this.com_cup.updateDicePoint(e.open);break;case"open":this.com_cup.updateDicePoint(e.open),this.DiceMoveToCenter(!1);break;case"settle":this.com_cup.updateDicePoint(e.open);break;case"after_settle":this.com_cup.updateDicePoint(e.open);break;case"shuffle":this.com_betArea.resetBetAreaUI()}("bet"===this.currentStage||"stop_bet"===this.currentStage||"open"===this.currentStage||"settle"===this.currentStage)&&(this.totalPlayerBetsHandler(e,!0),this.robotbetsHandler(n.bets,!0)),("after_settle"===this.currentStage||"settle"===this.currentStage)&&n.channel_settles&&Object.keys(n.channel_settles).length>0&&Object.keys(n.channel_settles).forEach(function(i){var o=n.channel_settles[i];Object.keys(o).length>0&&(t.com_cup.updateDicePoint(e.open),t.com_cup.resetDiceCup(),t.showHighLight(e.result),t.awardHandler(e.user_info.settle,o.player,o.robot))}),this.topBar.bVal=e.round_id,this.com_bottomPanel.setRoadMap(this.road_map)},o.prototype.setDefaultChips=function(t){var e=this;this.defaultChips=[],t.forEach(function(t){e.defaultChips.push(Number(t))})},o.prototype.updateBetAreaScorller=function(){this.currentPage||(this.currentPage=1);var t=(this.betAreaScroller.viewport.contentWidth-this.betAreaScroller.viewport.width)*(this.currentPage-1);this.betAreaScroller.viewport.scrollH=t,this.oldScrollerH=t,this.page1.visible=this.page2.visible=!1,1===this.currentPage?this.page1.visible=!0:this.page2.visible=!0,this.isScrollerTouched=!1},o.prototype.registerEvent=function(){var t=this;this.db_girl.addEventListener(egret.Event.COMPLETE,function(e){"yaotouzi"===t.currentAction&&(t.com_cup.visible=!0),t.playGirlAction("daiji",0,0)},this),this.winAni.addEventListener(egret.Event.COMPLETE,function(){return t.winAni.visible=!1},this),this.com_betArea.addEventListener(e.BetArea.EVT_BET,function(e){t.onBet(e.data)},this),this.com_betArea.addEventListener(e.BetArea.EVT_SHOW_TIP,function(e){"bet"!==t.currentStage&&(t.com_tip.show(t.cur_stage),util.SoundUtil.play("xiazhushibai_mp3"))},this),this.betAreaScroller.addEventListener(eui.UIEvent.CHANGE,this.scrollerChange,this),this.betAreaScroller.addEventListener(eui.UIEvent.CHANGE_END,this.scrollerEnd,this),this.turnLeftButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.turnLeft,this),this.turnRightButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.turnRight,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.addEventListener(egret.Event.RESIZE,this.resize,this)},o.prototype.scrollerChange=function(){this.betAreaScroller.touchChildren=!1,this.betAreaScroller.horizontalScrollBar.visible=!1,this.com_betArea.showChipResultPos(),this.isScrollerTouched=!0},o.prototype.turnLeft=function(){1!==this.currentPage&&(this.currentPage=1,this.updateBetAreaScorller())},o.prototype.turnRight=function(){2!==this.currentPage&&(this.currentPage=2,this.updateBetAreaScorller())},o.prototype.scrollerEnd=function(){this.betAreaScroller.touchChildren=!0;var t=this.betAreaScroller.viewport.scrollH;this.oldScrollerH>t?this.oldScrollerH-t>120&&(this.currentPage-=1):t-this.oldScrollerH>120&&(this.currentPage+=1),this.updateBetAreaScorller()},o.prototype.onBet=function(t){if(this.balance.lt(this.com_bottomPanel.getCurChipValue()))return this.com_tip.show(util.LanguageUtil.translate("lbl_balance_error")),void util.SoundUtil.play("xiazhushibai_mp3");if(this.checkLimit(t.type)){util.SoundUtil.play("Chips_mp3");var e={};e[t.type]=this.com_bottomPanel.getCurChipValue(),this.com_betArea.setEnable(!1),this.com_bottomPanel.betAni(!0),this.lastBetType=t.type,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BET,e)}else{util.SoundUtil.play("xiazhushibai_mp3");var i=this.getBetLimitByBetArea(t.type);this.com_tip.show(util.LanguageUtil.translate("lbl_game_beterror")+"\n"+util.LanguageUtil.translate("lbl_game_beterror_number",util.NumberUtil.formatNumber(i.min),util.NumberUtil.formatNumber(i.max)))}},o.prototype.checkLimit=function(t){var e=Number(this.own_bets[t])+this.com_bottomPanel.getCurChipValue(),i=this.getBetLimitByBetArea(t);return e<=i.max&&e>=i.min},o.prototype.execCommand=function(t,e){var i=this;switch(util.LogUtil.debug("------cmd--------",e),t){case Const.UICommand.CMD_UPDATE_USER_INFO:this.com_cup.init(),this.balance=e.balance,this.com_bottomPanel.setBalance(e.balance),this.com_bottomPanel.updateEnable(this.balance),this.idle=Number(e.idle);break;case Const.UICommand.CMD_UPDATE_BET:!function(){"bet"===i.currentStage&&i.com_betArea.setEnable(!0),i.ownBetsHandler(e)}();break;case Const.UICommand.CMD_UPDATE_ALL_BET:this.totalPlayerBetsHandler(e);break;case Const.UICommand.CMD_UPDATE_ROBOT_BET:this.robotbetsHandler(e);break;case Const.UICommand.CMD_BALANCE_HINT:!function(){"bet"===i.currentStage&&i.com_betArea.setEnable(!0),i.com_tip.show(util.LanguageUtil.translate(e))}();break;case Const.UICommand.CMD_UPDATE_STAGE:!function(){var t=e;i.updatelimit(t.bet_limit);var n=t.stage.toLowerCase();i.currentStage!==n&&(i.currentStage=n,i.onStageChange(t))}();break;case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.road_map=e.road_map,this.com_bottomPanel.setRoadMap(e.road_map);break;case Const.UICommand.CMD_INIT_UI:this.onRemove();break;case Const.UICommand.CMD_UPDATE_PEOPLE:this.btn_people.label=e.toString();break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:!function(){"shuffle"===i.currentStage&&(i.topBar.bVal=e.round_id)}();break;case Const.UICommand.CMD_UPDATE_CARDS:if("open"===this.currentStage){var n=e;this.com_cup.updateDicePoint(n)}break;case Const.UICommand.CMD_UPDATE_SETTLE:if("settle"===this.currentStage){this.desk_settle_data=e;var o=this.desk_settle_data.result;this.tmpResult=o}break;case Const.UICommand.CMD_UPDATE_ROBOT_SETTEL:this.tmpBetData=e}},o.prototype.showHighLight=function(t){var e=this;if(util.LogUtil.debug("-----showHightLight----",t),t){var i=[],n=[];t.forEach(function(t){var n=e.com_betArea.ALL_TYPE.indexOf(t);i.push(n)});for(var o=0;44>o;o++)-1===i.indexOf(o)&&n.push(o);this.notAwardIndexArr=n,this.com_betArea.showWinLight(i),this.com_betArea.removeSomeChips(n)}},o.prototype.onStageChange=function(e){switch(util.LogUtil.warn("RoomUIonStageChange",e),this.com_betArea.setEnable("bet"===this.currentStage?!0:!1),this.currentStage){case"deal":this.cleanBowlAni(),this.betNumberText.text="0",this.com_betArea.resetBetAreaUI();var i=this.getMinLimit();this.idle>=5?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_game_nobet2","lbl_game_comfirm"),this.onRemove()):this.balance&&this.balance.lt(i)?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_balance_error2","lbl_game_comfirm")):3===this.idle&&this.com_tip.show(util.LanguageUtil.translate("lbl_game_nobet"));break;case"bet":this.cleanBowlAni(),this.com_betArea.resetBetAreaUI(),util.SoundUtil.play("start_mp3"),this.showBetHintAni(util.LanguageUtil.translate("ng_horoscope_start"),!0),this.com_countDown.start(Number(e.stage_timestamp)+Number(e.room_setting.time[this.currentStage]),"bet"===this.currentStage);break;case"stop_bet":this.cleanBowlAni("stop_bet"),this.showBetHintAni(util.LanguageUtil.translate("ng_horoscope_stop"),!1);case"open":this.cleanBowlAni("open"),this.DiceMoveToCenter();break;case"settle":util.LogUtil.debug("------Stage==>settle----",e);break;case"after_settle":util.LogUtil.debug("------Stage==>settle----",e),this.showHighLight(this.tmpResult),this.settleHandler(this.tmpBetData);break;case"shuffle":this.cleanBowlAni(),this.com_betArea.resetBetAreaUI(),this.playGirlAction("yaotouzi",0,1),util.SoundUtil.play("yaotouzi_mp3"),this.com_cup.visible=!1,this.oldBetsDataClear(),this.com_betArea.updateAreaBetNumber(this.all_bets),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1),this.desk_settle_data=void 0,this.tmpBetData=void 0,this.tmpResult=void 0,this.currentBetType=this.lastBetType=null}},o.prototype.settleHandler=function(t){if(("settle"===this.currentStage||"after_settle"===this.currentStage)&&this.desk_settle_data){var e=t.robot,i=this.desk_settle_data.own_settle,n=(this.desk_settle_data.desk_settles.guest,this.desk_settle_data.desk_settles.player),o=this.desk_settle_data.own_total_surplus;this.awardHandler(i,n,e),o>0?(this.playGirlAction("win",0,2),this.playWinAni()):util.SoundUtil.play("dissapoint_mp3"),this.com_bottomPanel.setSurplus(o),this.com_bottomPanel.showWin(o>0),this.com_bottomPanel.setBalance(this.balance)}},o.prototype.playWinAni=function(){var t=this;util.SoundUtil.play("win_mp3"),this.db_winAni.visible=!0,this.db_winAni.play("thirteen-win",null,0,1),this.db_winAni.alpha=1,this.db_winAni.once(egret.Event.COMPLETE,function(){egret.Tween.get(t.db_winAni).to({alpha:0},500,egret.Ease.circOut).call(function(){t.db_winAni.visible=!1})},this)},o.prototype.awardHandler=function(t,e,n){var o=new i,r=new i,s=new i,a=new i;this.computeSettle(o,t),this.computeSettle(r,e),this.computeSettle(s,n),Object.keys(this.settleData).forEach(function(t){a[t]=r[t]+s[t]}),this.betAreaScroller.touchEnabled=!1,util.LogUtil.debug("----award-----",a,o),this.flyChip(o,this.db_girl,!1,3),this.flyChip(a,this.db_girl,!1,4)},o.prototype.computeSettle=function(t,e){Object.keys(this.settleData).forEach(function(i){e&&e[i]?t[i]=e[i].payout+e[i].rake:t[i]=0})},o.prototype.computeBet=function(t,e){Object.keys(this.settleData).forEach(function(i){e&&e[i]?t[i]=Number(e[i]):t[i]=0})},o.prototype.showBetHintAni=function(t,e){var i=this;void 0===e&&(e=!0),this.main.addChild(this.com_betHint),e?this.com_betHint.showBegin(t):this.com_betHint.showStop(t),egret.Tween.removeTweens(this.com_betHint),this.com_betHint.horizontalCenter=-1300,this.com_betHint.alpha=.8,egret.Tween.get(this.com_betHint).to({horizontalCenter:0,alpha:1},250,egret.Ease.backOut).to({horizontalCenter:20},600).to({horizontalCenter:600,alpha:0},500,egret.Ease.quadIn).call(function(){return i.main.contains(i.com_betHint)&&i.main.removeChild(i.com_betHint)})},o.prototype.robotbetsHandler=function(t,e){var n=this;if(void 0===e&&(e=!1),this.data&&this.data.stage){var o=util.ObjectUtil.minus(this.old_robot_bets||[],t);this.old_robot_bets=util.ObjectUtil.copy(t);var r=new i,s=0;if(o&&o.length){if(o.forEach(function(t){Object.keys(t.bets).forEach(function(e){var i=n.getBetLimitByBetArea(e),o=i.max,a=i.min,l=t.bets[e].p,u=t.bets[e].m,h=new Decimal((l*(o-a)+a)*u).divToInt(100).mul(100);if(h.greaterThan(0)){for(var c=h.toNumber(),p=n.defaultChips.length-1;p>=0;p--)c%=n.defaultChips[p],0===p&&c>0&&(h=h.minus(c));n.robot_bets[e]=h.add(n.robot_bets[e]).toNumber(),r[e]+=h.toNumber(),s+=h.toNumber()}})}),util.LogUtil.warn("===================================handleRobotbet","robotBet",r),0>=s)return;this.peopleBetAni(),this.flyChip(r,this.btn_people,e,2)}}},o.prototype.totalPlayerBetsHandler=function(t,e){void 0===e&&(e=!1),this.ownBetsHandler(t,e);var n=t.bet,o=new i;this.calBetsDiff(o,n,this.own_bets);var r=new i;this.calBetsDiff(r,o,this.own_bets),this.copyBets(o,this.other_player_bets),util.LogUtil.warn("===================================totalPlayerBetsHandler","other_player_bet",r),this.flyChip(r,this.btn_people,!1,2)},o.prototype.peopleBetAni=function(){egret.Tween.get(this.btn_people).to({verticalCenter:-495},80,egret.Ease.quadOut).to({verticalCenter:-509},80,egret.Ease.quadIn)},o.prototype.ownBetsHandler=function(t,e){void 0===e&&(e=!1);var n=t.user_info.bet,o=new i;this.calBetsDiff(o,n,this.own_bets),this.copyBets(n,this.own_bets),util.LogUtil.warn("===================================ownBetsHandler","own_bet",o),this.flyChip(o,this.com_bottomPanel.com_head,e,1),this.updateMyBetNumberText()},o.prototype.flyChip=function(e,i,n,o){var r=this,s=-1,a=[];Object.keys(e).forEach(function(l){var u=e[l];if(u>0){var h,c=r.com_betArea.ALL_TYPE.indexOf(l),p=r.getBetPageInfo(c),_=void 0;_=o>2?[{chipValue:u,count:1}]:r.getFlyChipList(u),o>1&&(h=3===o?"1":"player"),_.forEach(function(e){2===o&&(e.count=Math.min(e.count,3));for(var l=0;l<e.count;l++){var u=t.component.SChip.getOneChip(e.chipValue,h),_=r.com_betArea.flyChip(u,i,c,!n,o,p);a.push(_),1===o&&(r.all_bets[r.com_betArea.ALL_TYPE[c]]+=e.chipValue,s=c)}})}}),Promise.all(a).then(function(){util.TimeUtil.setTimeout(function(){util.SoundUtil.play("fangchouma_mp3"),3===o?r.com_betArea.flyChips(r.com_bottomPanel.com_head,r.btn_people,{currentPage:r.currentPage,leftButton:r.turnLeftButton,rightButton:r.turnRightButton},"own"):4===o&&(r.com_betArea.flyChips(r.com_bottomPanel.com_head,r.btn_people,{currentPage:r.currentPage,leftButton:r.turnLeftButton,rightButton:r.turnRightButton},"other"),r.oldBetsDataClear(),r.com_betArea.updateAreaBetNumber(r.all_bets),util.TimeUtil.setTimeout(function(){r.betAreaScroller&&(r.betAreaScroller.touchEnabled=!0)},500))},400)}),n?1===o&&this.com_betArea.updateAreaBetNumber(this.all_bets,!1,s):util.TimeUtil.setTimeout(function(){var t=r.lastBetType===r.currentBetType?!0:!1;1===o&&(r.currentBetType=r.lastBetType,r.com_betArea.updateAreaBetNumber(r.all_bets,t,s))},400)},o.prototype.updateMyBetNumberText=function(t){var e;e=t?t:this.all_bets;var i=0;Object.keys(e).forEach(function(t){i+=e[t]}),this.betNumberText.text=util.NumberUtil.formatNumber(i)},o.prototype.getBetPageInfo=function(t){var e,i,n,o=this.currentPage,r=t>=27?2:1;return o!==r?(1===o?(e=this.turnRightButton.x+this.turnRightButton.width,i=this.turnRightButton.y+50,n=this.turnRightButton):(e=this.turnLeftButton.x,i=this.turnLeftButton.y+50,n=this.turnLeftButton),{currentPage:o,betPage:r,pageX:e,pageY:i,currentBtn:n}):null},o.prototype.getFlyChipList=function(t){for(var e=[],i=this.defaultChips.length-1;i>=0;i--){var n=Math.floor(t/this.defaultChips[i]);t%=this.defaultChips[i],e.push({chipValue:this.defaultChips[i],count:n})}return e},o.prototype.calBetsDiff=function(t,e,i){Object.keys(t).forEach(function(n){return t[n]=(Number(e[n])||0)-(Number(i[n])||0)})},o.prototype.copyBets=function(t,e){Object.keys(t).forEach(function(i){return e[i]=Number(t[i])||0})},o.prototype.getBetLimitByBetArea=function(t){var e=0,i=0;return t.startsWith("one")?(e=this.limit.min.one,i=this.limit.max.one):t.startsWith("two")?(e=this.limit.min.two,i=this.limit.max.two):t.startsWith("three_")?(e=this.limit.min.three,i=this.limit.max.three):"three"===t?(e=this.limit.min.any_three,i=this.limit.max.any_three):t.startsWith("triple_")?(e=this.limit.min.triple,i=this.limit.max.triple):"triple"===t?(e=this.limit.min.any_triple,i=this.limit.max.any_triple):t.startsWith("pair")?(e=this.limit.min.pair,i=this.limit.max.pair):t.startsWith("combination")?(e=this.limit.min.combination,i=this.limit.max.combination):(e=this.limit.min.single,i=this.limit.max.single),{min:e,max:i}},o.prototype.oldBetsDataClear=function(){this.old_robot_bets=[],[this.own_bets,this.other_player_bets,this.robot_bets,this.all_bets].forEach(function(t){return Object.keys(t).forEach(function(e){return t[e]=0})})},o.prototype.onRemove=function(){this.com_countDown.clearTimer(),this.com_betArea.resetBetAreaUI(),this.initUI()},o.prototype.playGirlAction=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=1),this.db_girl.play("fish_girl",t,e,i),util.LogUtil.debug("db_ani------",this.db_girl),this.currentAction=t},o.prototype.DiceMoveToCenter=function(t){var e=this;void 0===t&&(t=!0),t?egret.Tween.get(this.com_cup).wait(200).to({verticalCenter:-100,scaleX:1,scaleY:1},500).call(function(){e.com_cup.runOpenAni(function(){e.com_cup.centerState(),e.com_cup.runOpenAni2()})}):(this.com_cup.verticalCenter=-100,this.com_cup.scaleX=this.com_cup.scaleY=1,this.com_cup.runOpenAni(null,!1))},o.prototype.cleanBowlAni=function(t){this.com_cup.init(),t||this.com_betArea.removeTw()},o.prototype.updatelimit=function(t){var e=this,i=util.ObjectUtil.copy(t.min),n=util.ObjectUtil.copy(t.max);Object.keys(i).forEach(function(t){return e.limit.min[t]=Number(i[t])
}),Object.keys(n).forEach(function(t){return e.limit.max[t]=Number(n[t])});var o=this.getMinLimit(),r=this.getMaxLimit();this.topBar.aVal=util.NumberUtil.formatUnit(o)+"-"+util.NumberUtil.formatUnit(r)},o.prototype.resize=function(){this.com_bottomPanel.resize()},o}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.fish.RoomUI")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ROOM_ID_MAP={GF1:"xinshoufang",GF2:"chujifang",GF3:"zhongjifang",GF4:"gaojifang"},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.playAni=function(t){t?(this.db_woman.play("woman"),[{db:this.db_xinshoufang,name:"fresh_room"},{db:this.db_chujifang,name:"beginnr_room"},{db:this.db_zhongjifang,name:"intermediate_room"},{db:this.db_gaojifang,name:"advanced_room"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())})):(this.db_woman.stop(),[this.db_xinshoufang,this.db_chujifang,this.db_zhongjifang,this.db_gaojifang].forEach(function(t){return t.stop()}))},e.prototype.registerEvent=function(){var t=this;[this.gp_xinshoufang,this.gp_chujifang,this.gp_zhongjifang,this.gp_gaojifang].forEach(function(e){return e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.name)},t)}),this.addEventListener(eui.UIEvent.ADDED,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(eui.UIEvent.ADDED_TO_STAGE,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.playAni(!1)},this)},e.prototype.updateHallDatas=function(t){this.rooms=t,this.gp_xinshoufang&&this.updateData(this.rooms)},e.prototype.updateData=function(t){var e=this;Object.keys(this.ROOM_ID_MAP).forEach(function(t){e["gp_"+e.ROOM_ID_MAP[t]].visible=!1,e["gp_"+e.ROOM_ID_MAP[t]].includeInLayout=!1}),t.forEach(function(t){var i=t.room_id;e["gp_"+e.ROOM_ID_MAP[i]].visible=!0,e["gp_"+e.ROOM_ID_MAP[i]].includeInLayout=!0,e["gp_"+e.ROOM_ID_MAP[i]].name=i,e["lb_"+e.ROOM_ID_MAP[i]+"_ante"].text=util.NumberUtil.formatUnit(t.bet_limit.ante),e["lb_"+e.ROOM_ID_MAP[i]+"_admittance"].text=util.NumberUtil.formatUnit(t.bet_limit.admittance)})},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.flower.Hall")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.isResult=!1,e.wacth_card=!1,e.currentPos=0,e.currentChipValue=0,e.roundEndTime=0,e.chipsListDefaultValues=[2,3,4,5,6,7],e.balanceRecord=[void 0,new Decimal(0),new Decimal(0),new Decimal(0),new Decimal(0),new Decimal(0)],e.horizontalCenterlandscape=[-301,845,512,-512,-845],e.verticalCenterlandscape=[220,16,-320,-320,16],e.horizontalCenterportrait=[-348,436,436,-436,-436],e.verticalCenterportrait=[530,120,-400,-400,120],e.isFinishGame=!1,e.checkPkIndex=[5,4,1,3,2],e.isNap=!1,e.cantFight=[],e.lastPkLoserPos=0,e.restPeople=[],e.isNaping=!1,e.napValue=0,e.deskChipNum=0,e.round2=!1,e.lastTime=0,e.showGrenn=!1,e.ispk=!1,e.Dynamic_min=0,e.showTsAni=!1,e.changeCurOrientationMode=function(t){for(var i=1;5>=i;i++)egret.Tween.removeTweens(e["playerInfo"+i])},e.result_sound={gf_Bet:["zjh_gf_Bet_mp3"],gf_goldchip:["zjh_gf_goldchip_mp3"],effect_fapai:["zjh_effect_fapai_mp3"],gf_fapai3:["zjh_gf_fapai3_mp3"],gf_myturn:["zjh_gf_myturn_mp3"],boy_watch:["zjh_boy_watch_mp3"],girl_watch:["zjh_girl_watch_mp3"],boy_follow2:["zjh_boy_follow2_mp3"],boy_follow1:["zjh_boy_follow1_mp3"],girl_follow2:["zjh_girl_follow2_mp3"],girl_follow1:["zjh_girl_follow1_mp3"],boy_add:["zjh_boy_add_mp3"],girl_add:["zjh_girl_add_mp3"],boy_giveup:["zjh_boy_giveup_mp3"],boy_giveup2:["zjh_boy_giveup2_mp3"],girl_giveup:["zjh_girl_giveup_mp3"],girl_giveup2:["zjh_girl_giveup2_mp3"],boy_cmp:["zjh_boy_cmp_mp3"],boy_cmp2:["zjh_boy_cmp2_mp3"],girl_cmp:["zjh_girl_cmp_mp3"],girl_cmp2:["zjh_girl_cmp2_mp3"],gf_ZHADAN:["zjh_gf_zhadan_mp3"],gf_guzhuyizhi_man:["zjh_gf_guzhuyizhi_man_mp3"],gf_guzhuyizhi_wom:["zjh_gf_guzhuyizhi_wom_mp3"],gf_shou:["zjh_gf_shou_mp3"],gf_win:["zjh_gf_win_mp3"],gf_baozi:["zjh_gf_baozi._mp3"],gf_tonghuashun:["zjh_gf_tonghuashun_mp3"],gf_jinhua:["zjh_gf_jinhua_mp3"]},e.getNetPosition=function(t){return(t+e.my_position-1)%e.max_player||e.max_player},e.getLocalPosition=function(t){return(t+e.max_player-e.my_position+1)%e.max_player||e.max_player},e.getDeskData=function(){return Data.getTopic("/gf_desk/"+e.desk_id)},e._sendRaise=function(t){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,t)},e._sendWatch=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_WATCH)},e._sendFold=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FOLD)},e._leave=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM)},e._sendFight=function(t){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FIGHT,t)},e._sendToggle=function(t){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_TOGGLE,t)},e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"desk_id",{get:function(){return this._desk_id},set:function(t){this._desk_id=t},enumerable:!0,configurable:!0}),i.prototype.initUI=function(){var t=this;this.pokerAni=new e.PokerAni(this.gp_pokerAni),[1,2,3,4,5].forEach(function(e){t["playerInfo"+e].visible=!1,t["pokerList"+e].visible=!1});for(var i=2;6>i;i++)this["compareSelect"+i].visible=!1;this.compareValueSet(),this.registUIEventListener(),this.currentState===egret.OrientationMode.LANDSCAPE?this.initLandscapePoint():this.initPortraitPoint(),this.changeCurOrientationMode({data:Main.instance.orientation}),this.beginAnotherGame(),this.match.type="match",this.match.visible=!1,this.controlBtns.setCallButtonState(e.CallButtonState.AUTO_FOLLOW),util.LogUtil.info("flower [initUI]")},i.prototype.initLandscapePoint=function(){var t=this;[1,2,3,4,5].forEach(function(e){t["playerInfo"+e].horizontalCenter=t.horizontalCenterlandscape[e-1],t["playerInfo"+e].verticalCenter=t.verticalCenterlandscape[e-1]})},i.prototype.initPortraitPoint=function(){var t=this;[1,2,3,4,5].forEach(function(e){t["playerInfo"+e].horizontalCenter=t.horizontalCenterportrait[e-1],t["playerInfo"+e].verticalCenter=t.verticalCenterportrait[e-1]})},i.prototype.initData=function(){this.my_position=-1,this.checkMyPosion(),this.isFinishGame=!1,this.ante=this.data.ante,this.currentChipValue=this.ante,this.controlBtns.setLabelsNum(util.NumberUtil.formatUnit(this.currentChipValue)),this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this.desk_id,this.cantFight=[],this.restPeople=[],this.lastPkLoserPos=0,this.isResult=!1,this.toggle.enabled=!1,this.reconnection(),util.LogUtil.info("flower [initData]")},i.prototype.reconnection=function(){var t=this;this.toggle.enabled=!0;var i=this.getDeskData().snapshot;this.max_player=Object.keys(i.desk).length,this.updateUserState(!0),this.initOwnUserInfo(),this.updateChipsListDefaultValues(this.ante),[1,2,3,4,5].forEach(function(e){t.hideGreen(e);var i=t["playerInfo"+e];i.showReset()});var n=i.stage;if("deal_card"!==n){for(var o=1;o<=this.max_player;o++){var r=this["pokerList"+o];r.visible=!0}this.updateDynamicMin(),this.updateDecisionPosition(),this.updateStopDecision(),this.controlBtns.visible=!0,this.deskInfo.setRound(this.getDeskData().snapshot.round),this.deskInfo.setTotalBet(this.getDeskData().snapshot.total_bet);for(var o=1;o<=this.max_player;o++)for(var s=i.desk[o],a=0;a<s.bet.length;a++)this.showchip(s.bet[a]);this.Dynamic_min===7*this.ante&&this.controlBtns.setButtonsEnable(null,!1,null,null),i.desk[this.my_position].watch_card&&this.pokerList1.setCheckButtonVisible(!1),Object.keys(i.desk).forEach(function(n){var o=i.desk[n],r=t.getLocalPosition(Number(n)),s=(t["playerInfo"+r],t["pokerList"+r]);"surrender"===o.status&&(1===r?s.setFailed(!0):s.visible=!1),"fall"===o.status&&1!==r&&(s.setFailed(!0),t["playerInfo"+r].setTop(e.PlayerInfoTopType.LOSE)),"surrender"===o.status&&1!==r&&t["playerInfo"+r].setTop(e.PlayerInfoTopType.FOLD)})}},i.prototype.showchip=function(t){var i=this.gp_chipsArea.getChildByName("landscapeArea"),n=new e.Chip;n.chipValue=util.NumberUtil.formatUnit(t.toString()),this.deskChipNum=Number(n.chipValue),"0"!==n.chipValue&&(i.addChild(n),n.horizontalCenter=600*(Math.random()-.5),n.verticalCenter=100*(Math.random()-.5),n.rotation=360*Math.random());var o=this.gp_chipsArea.getChildByName("portraitArea");n=new e.Chip,n.chipValue=util.NumberUtil.formatUnit(t.toString()),"0"!==n.chipValue&&(o.addChild(n),n.horizontalCenter=500*(Math.random()-.5),n.verticalCenter=200*(Math.random()-.5)-100,n.rotation=360*Math.random())},i.prototype.registerEvent=function(){var t=this;this.pokerList1.addEventListener(e.PokerList.EVT_CHECK,function(){t._sendWatch(),Math.random()<.5?util.SoundUtil.play("zjh_boy_watch_mp3"):util.SoundUtil.play("zjh_girl_watch_mp3"),t.pokerList1.setCheckButtonVisible(!1),t.chipList.setChipsValue(t.chipsListDefaultValues.map(function(t){return 2*t})),t.currentChipValue*=2,t.controlBtns.setLabelsNum(util.NumberUtil.formatUnit(t.currentChipValue)),t.wacth_card=!0;var e=t.getDeskData().snapshot.desk[t.my_position];e.balance.lte(t.currentChipValue)&&t.isNap===!1&&(t.isNap=!0,t.napValue=e.balance.toNumber())},this),this.controlBtns.addEventListener(e.ControlButtons.EVT_FOLD,function(){t.controlBtns.visible=!1,t._sendFold()},this),this.controlBtns.addEventListener(e.ControlButtons.EVT_RAISE,function(){return t.chipList.visible=!0},this),this.controlBtns.addEventListener(e.ControlButtons.EVT_COMPARE,function(e){if(e.data?t.compareSelectShow():t.compareSelectReset(),1===t.restPeople.length){t.compareSelectReset();var i=t.restPeople[0];i=t.getNetPosition(i),t._sendFight(i),t.controlBtns.visible=!1}},this),this.controlBtns.addEventListener(e.ControlButtons.EVT_CALL,function(i){switch(i.data){case e.CallButtonState.FOLLOW:t.compareSelectReset(),t.isNap||t._sendRaise(t.currentChipValue),t.controlBtns.setCallButtonState(e.CallButtonState.AUTO_FOLLOW);var n=t.getDeskData().snapshot.desk,o=n[t.my_position];o.balance.lte(t.currentChipValue+t.currentChipValue)&&t.controlBtns.setCallButtonState(e.CallButtonState.FOLLOW),t.controlBtns.setButtonsEnable(!0,!1,!1,null),t.isNap&&t.napCompare();break;case e.CallButtonState.AUTO_FOLLOW:t.controlBtns.setCallButtonState(e.CallButtonState.CANCEL);break;case e.CallButtonState.CANCEL:t.controlBtns.setCallButtonState(e.CallButtonState.AUTO_FOLLOW)}},this),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){t.chipList.visible=!1},this,!0),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){for(var i=2;6>i;i++)t["compareSelect"+i].visible=!1},this,!0),this.chipList.addEventListener(e.ChipsList.EVT_SELECT_CHIP,function(i){t._sendRaise(100*i.data),t.chipList.visible=!1,t.controlBtns.setButtonsEnable(null,!1,!1,null),t.controlBtns.setLabelsNum(i.data),t.controlBtns.setCallButtonState(e.CallButtonState.AUTO_FOLLOW)},this),this.toggle.addEventListener(e.PreventToggle.EVT_TOGGLE_CHANGE,function(e){t._sendToggle(e.data?"true":"false"),e.data?t.toggle.changeSelected(!0):t.toggle.changeSelected(!1),t.desktips.showLabel(e.data?"lbl_game_timeout_open":"lbl_game_timeout_close")},this);for(var i=function(e){n["compareSelect"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t._sendFight(t.getNetPosition(t["compareSelect"+e].getValue())),t.compareSelectReset(),t.controlBtns.resetCompareToggle()},n)},n=this,o=2;6>o;o++)i(o);this.match.setOnMatch(function(){t.beginAnotherGame();for(var i=1;6>i;i++){var n=t["playerInfo"+i],o=t["pokerList"+i];n.visible=!1,o.visible=!1}t.controlBtns.setCallButtonState(e.CallButtonState.AUTO_FOLLOW)}),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.prototype.registUIEventListener=function(){this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.changeCurOrientationMode,this)},i.prototype.removeFromStage=function(){this.stage.removeEventListener(Main.EVT_ORIENTATION_CHANGE,this.changeCurOrientationMode,this),this.beginAnotherGame()},i.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_DESK:-1===this.my_position&&this.checkMyPosion(),this.updateDesk();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_CANCEL_MATCH:this.match.type="match",this.match.visible=!0,this.beginAnotherGame();break;case Const.UICommand.CMD_UPDATE_BET:this.deskInfo.setTotalBet(this.getDeskData().snapshot.total_bet);break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:this.deskInfo.setRound(this.getDeskData().snapshot.round);break;case Const.UICommand.CMD_UPDATE_STOP_DECISION:this.updateStopDecision();break;case Const.UICommand.CMD_UPDATE_DECISION_POSITION:this.updateDecisionPosition();break;case Const.UICommand.CMD_UPDATE_CARD_PK:this.updateCardPk();break;case Const.UICommand.CMD_UPDATE_DYNAMIC_MIN:this.updateDynamicMin();break;case Const.UICommand.CMD_LEAVE_DESK:this.match.stopCountDown()}},i.prototype.initOwnUserInfo=function(){this.playerInfo1.setName(Const.UserInfo.NICK),this.playerInfo1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance),this.playerInfo1.setHead(Const.UserInfo.AVATAR),this.playerInfo1.setTop(e.PlayerInfoTopType.PLAYER_ID),this.playerInfo1.visible=!0},i.prototype.updateSendChip=function(){var t=this,e=this.getDeskData().snapshot.desk;Object.keys(e).forEach(function(i){var n=e[i];if(n.bet&&!(n.bet.length<1)){var o=(e[t.my_position],t.getLocalPosition(Number(i))),r=t["playerInfo"+o],s=e[i],a=s.watch_card?2*t.Dynamic_min:t.Dynamic_min,l=n.bet[n.bet.length-1],u=l>a?!1:!0;!n.balance.eq(t.balanceRecord[o])&&t.balanceRecord[o].sub(n.balance).eq(l)&&n.bet.length>1&&t.sendChips(r,l,o,!1,u),t.balanceRecord[o]=n.balance}})},i.prototype.checkMyPosion=function(){var t=this,e=this.getDeskData().snapshot.desk;e&&Object.keys(e).forEach(function(i){var n=e[i];-1===t.my_position&&n.user_id===""+Const.UserInfo.USER_ID&&(t.my_position=Number(i))})},i.prototype.updateUserState=function(t){var i=this,n=this.getDeskData().snapshot.desk;if(Object.keys(n).forEach(function(o){return __awaiter(i,void 0,void 0,function(){var i,r,s,a;return __generator(this,function(l){switch(l.label){case 0:return i=n[o],r=this.getLocalPosition(Number(o)),s=this["playerInfo"+r],a=this["pokerList"+r],i.username&&(s.visible=!0,1!==r&&(i.watch_card?(a.expandCards(!0,t),"fall"!==i.status&&"surrender"!==i.status&&s.setTop(e.PlayerInfoTopType.CHECKED)):(a.expandCards(!1,t),s.setName(i.username),"fall"!==i.status&&"surrender"!==i.status&&s.setTop(e.PlayerInfoTopType.PLAYER_ID))),s.setBalance(i.balance),("fall"===i.status||"surrender"===i.status)&&(this.cantFight.push(r),1===r&&(this.toggle.enabled=!1)),this.playerFold(i,s)),"surrender"===i.status&&(1===r?a.setFailed(!0):a.visible=!1),"fall"===i.status&&a.setFailed(!0),1===r&&i.cards?[4,a.showResult(!0,i.cards.cards)]:[3,2];case 1:l.sent(),a.showStatus(i.cards.type),l.label=2;case 2:return 1===r&&"surrender"===i.status&&i.cards?[4,a.showResult(!0,i.cards.cards)]:[3,4];case 3:l.sent(),a.showStatus(i.cards.type),this.onFinsihGame(),this.showMatch(),l.label=4;case 4:return[2]}})})}),this.getDeskData()&&0===this.getDeskData().snapshot.decision_position){for(var o=1;5>=o;o++){var r=this["playerInfo"+o];this["pokerList"+o];r.showCountDown(!1),r.stopCountDown()}this.onFinsihGame()}},i.prototype.playerFold=function(t,i){"surrender"===t.status&&i.head_fold.visible===!1&&(i.setTop(e.PlayerInfoTopType.FOLD),util.SoundUtil.play("zjh_"+(Math.random()<.5?"boy":"girl")+"_giveup"+(Math.random()<.5?"":"2")+"_mp3",1))},i.prototype.statusEnd=function(t){1===t&&(this.onFinsihGame(),this.showMatch())},i.prototype.onFinsihGame=function(){this.isFinishGame||(this._leave(),this.compareSelectReset(),this.isFinishGame=!0,this.controlBtns.visible=!1)},i.prototype.sendCard=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,e,i;return __generator(this,function(o){switch(o.label){case 0:for(t=this.getDeskData().snapshot,this.toggle.enabled=!0,this.isNaping=!1,this.restPeople=[],this.updateOthersHead(),this.initOwnUserInfo(),this.playerInfo1.setBalance(t.desk[this.my_position].balance),this.pokerList1.setCheckButtonVisible(!0),this.controlBtns.visible=!0,this.updateChipsListDefaultValues(this.currentChipValue),this.chipList.reset(),this.match.visible=!1,this.isNap=!1,this.compareSelectReset(),this.beginAnotherGame(),e=1;5>=e;e++)i=this["playerInfo"+e],n=this["pokerList"+e],i.showReset(),i.showCountDown(!1),i.stopCountDown(),n.setFailed(!1),n.setCards(null),n.init(),n.visible=!0;return[4,this.dealCard()];case 1:for(o.sent(),e=1;e<=this.max_player;e++)i=this["playerInfo"+e],this.sendChips(i,this.currentChipValue,e,!0,!0);return this.setRaiseBtnEnable(),[2]}})})},i.prototype.updateStage=function(){var t=this.getDeskData().snapshot,e=t.stage;switch(e){case"decision":this.sendCard();break;case"payout":this.toggle.enabled=!1;for(var i=1;5>=i;i++){var n=this["playerInfo"+i];n.stopCountDown(),n.removeCountDown()}this.roundEndInfo(),this.turnCardsAndPayout(),this.pokerList1.setCheckButtonVisible(!1),this.showMatch(),this.onFinsihGame()}},i.prototype.updateDesk=function(){if(-1!==this.my_position){var t=this.getDeskData().snapshot.desk;this.max_player=Object.keys(t).length,this.updateSendChip(),this.updateUserState(!1),this.setRaiseBtnEnable()}},i.prototype.updateDecisionPosition=function(){if(0!==this.getDeskData().snapshot.decision_position){var t=this.getDeskData().snapshot,i=t.desk[this.getDeskData().snapshot.decision_position];this.chipList.setButtonEnabler(this.currentChipValue),!this.chipList.chip6.enabled&&this.controlBtns.setButtonsEnable(null,!1,null,null),this.currentPos=this.getLocalPosition(Number(t.decision_position)),util.LogUtil.info("flower [updateDecisionPosition][receive] decision_position => "+t.decision_position+" local_position => "+this.currentPos),"string"==typeof this.lastTime&&(this.lastTime=Number(this.lastTime)),"string"==typeof this.roundEndTime&&(this.roundEndTime=Number(this.roundEndTime)),this.lastTime!==this.roundEndTime?this.countDown():this.showGrenn=!0,1===this.currentPos?(i.balance.lte(this.currentChipValue)&&this.isNap===!1&&(this.isNap=!0),this.isNap&&(this.napValue=i.balance.toNumber(),!this.isNaping&&this.controlBtns.setButtonsEnable(!0,!1,!1,!0)),this.autoFlow()):(!this.isNaping&&this.controlBtns.setButtonsEnable(!0,!1,!1,null),this.chipList.visible=!1,this.controlBtns.getButtonState()!==e.CallButtonState.CANCEL&&this.controlBtns.setCallButtonState(e.CallButtonState.AUTO_FOLLOW)),this.roundIsOne(),this.Dynamic_min=this.getDeskData().snapshot.dynamic_min,(this.Dynamic_min===7*this.ante||this.isNap)&&this.controlBtns.setButtonsEnable(null,!1,null,null)}},i.prototype.autoFlow=function(){if(this.controlBtns.getButtonState()===e.CallButtonState.CANCEL){var t=this.getDeskData().snapshot.desk[this.my_position].status;"fall"===t||"surrender"===t?(this.onFinsihGame(),this.controlBtns.visible=!1):this.isNap?this.napCompare():this._sendRaise(this.currentChipValue)}else{this.controlBtns.setCallButtonState(e.CallButtonState.FOLLOW);var i=this.chipList.chip6.enabled,n=this.getDeskData().snapshot;n.round>=2||2===this.max_player?!this.isNap&&this.controlBtns.setButtonsEnable(!0,i,!0,!0):!this.isNap&&this.controlBtns.setButtonsEnable(!0,i,!1,!0)}},i.prototype.roundIsOne=function(){var t=this.getDeskData().snapshot;1===t.round&&(1===this.currentPos?(this.controlBtns.getButtonState()!==e.CallButtonState.CANCEL&&this.controlBtns.setCallButtonState(e.CallButtonState.FOLLOW),!this.isNaping&&this.controlBtns.setButtonsEnable(!0,!0,!1,!0),this.controlBtns.resetCompareToggle()):(this.controlBtns.getButtonState()!==e.CallButtonState.CANCEL&&this.controlBtns.setCallButtonState(e.CallButtonState.AUTO_FOLLOW),!this.isNaping&&this.controlBtns.setButtonsEnable(!0,!1,!1,!0)))},i.prototype.countDown=function(){for(var t=1;t<=this.max_player;t++){var e=this["playerInfo"+t];this.currentPos===t?(e.showCountDown(!0),1===this.currentPos&&util.SoundUtil.play("zjh_gf_myturn_mp3"),e.initGraphics(),this.lastTime=this.roundEndTime,e.changeGraphics(this.roundEndTime,this.getDeskData().snapshot.room_setting.time.op)):(e.showCountDown(!1),e.stopCountDown())}},i.prototype.dealCard=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,e,i,e,i;return __generator(this,function(o){switch(o.label){case 0:for(t=[],e=1;5>=e;e++)i=this["pokerList"+e],util.SoundUtil.play("zjh_effect_fapai_mp3"),i.visible=!1;n=1,o.label=1;case 1:if(!(3>=n))return[3,4];for(e=1;e<=this.max_player;e++)i=this["pokerList"+e],t.push(this.pokerAni.flyCard(i.getPokerType(n),i.getCardPos(n),i.getPokerSize(n)));return[4,this.sleep(200)];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[4,Promise.all(t)];case 5:for(o.sent(),this.pokerAni.initPoker(),e=1;e<=this.max_player;e++)util.SoundUtil.play("zjh_gf_fapai3_mp3"),i=this["pokerList"+e],i.visible=!0;return this.deskInfo.setTotalBet(this.getDeskData().snapshot.total_bet),[2]}})})},i.prototype.sendChips=function(t,i,n,o,r){return __awaiter(this,void 0,void 0,function(){var s,a,l,u;return __generator(this,function(h){switch(h.label){case 0:return s=this.gp_chipsArea.getChildByName("landscapeArea"),a=new e.Chip,a.chipValue=util.NumberUtil.formatUnit(i.toString()),this.deskChipNum=Number(a.chipValue),l=this.getDeskData().snapshot.desk[this.getNetPosition(n)].balance,[4,this.sleep(100)];case 1:return h.sent(),0>=l&&!this.isNaping&&(this.isNaping=!0,this.pokerList1.setCheckButtonVisible(!1),this.controlBtns.setButtonsEnable(!1,!1,!1,!1),this.payoutAni.show(e.PayoutAniType.NAP)),!o&&!this.ispk&&l>0&&(r?this.getDeskData().snapshot.round>1?util.SoundUtil.play("zjh_"+(Math.random()<.5?"boy":"girl")+"_follow"+(Math.random()<.5?"1":"2")+"_mp3",1):util.SoundUtil.play("zjh_"+(Math.random()<.5?"boy":"girl")+"_follow2_mp3",1):util.SoundUtil.play("zjh_"+(Math.random()<.5?"boy":"girl")+"_add_mp3",1)),"0"!==a.chipValue&&(Number(i)>=1e4?util.SoundUtil.play("zjh_gf_goldchip_mp3"):util.SoundUtil.play("zjh_gf_Bet_mp3"),a.horizontalCenter=t.horizontalCenter,a.verticalCenter=t.verticalCenter,s.addChild(a),egret.Tween.get(a).to({horizontalCenter:600*(Math.random()-.5),verticalCenter:100*(Math.random()-.5),rotation:360*Math.random()},200)),u=this.gp_chipsArea.getChildByName("portraitArea"),a=new e.Chip,a.chipValue=util.NumberUtil.formatUnit(i.toString()),"0"!==a.chipValue&&(a.horizontalCenter=t.horizontalCenter,a.verticalCenter=t.verticalCenter,u.addChild(a),egret.Tween.get(a).to({horizontalCenter:500*(Math.random()-.5),verticalCenter:200*(Math.random()-.5)-100,rotation:360*Math.random()},200)),[2]}})})},i.prototype.turnCardsAndPayout=function(){var t=this,i=this.getDeskData().snapshot.desk;Object.keys(i).forEach(function(n){return __awaiter(t,void 0,void 0,function(){var t,o,r,s;return __generator(this,function(a){switch(a.label){case 0:return t=i[n],o=this.getLocalPosition(Number(n)),r=this["pokerList"+o],t.cards?(util.LogUtil.info("flower [turnCardsAndPayout][receive] user_data.cards => "+JSON.stringify(t.cards)+" local_position => "+o),[4,r.showResult(n===""+this.my_position,t.cards.cards)]):[3,2];case 1:if(a.sent(),r.showresult(n===""+this.my_position,t.cards.cards),r.showStatus(t.cards.type),t.surplus>0){if(this.showTsAni===!1)switch(this.showTsAni=!0,util.SoundUtil.play("zjh_gf_shou_mp3"),util.SoundUtil.play("zjh_gf_win_mp3"),t.cards.type){case"three_of_a_kind":this.payoutAni.show(e.PayoutAniType.LEO,r);break;case"straight_flush":this.payoutAni.show(e.PayoutAniType.SF,r);break;case"golden_flower":this.payoutAni.show(e.PayoutAniType.GF,r);break;case"high_card":1===o&&this.payoutAni.show(e.PayoutAniType.WIN);break;case"two_pairs":1===o&&this.payoutAni.show(e.PayoutAniType.WIN);break;case"straight":1===o&&this.payoutAni.show(e.PayoutAniType.WIN)}s="fall"===t.status,1===o?r.setFailed(s):r.setOtherFailed(s)}else r.setOtherFailed(!0);a.label=2;case 2:return[2]}})})})},i.prototype.roundEndInfo=function(){var t=this,e=this.getDeskData().snapshot.desk;Object.keys(e).forEach(function(i){var n=e[i],o=t.getLocalPosition(Number(i)),r=t["playerInfo"+o];util.LogUtil.info("flower [roundEndInfo][receive] localPos => "+o+" surplus => "+n.surplus+" happy_money => "+n.happy_money),n.surplus>0?r.showEnd(n.surplus,"win",n.happy_money):r.showEnd(n.surplus,"lose",n.happy_money)})},i.prototype.checkPK=function(t,i){util.LogUtil.info("flower [checkPK][receive] winnerPos => "+t+" loserPos => "+i),this.ispk=!0,this.lastPkLoserPos=i,this["playerInfo"+t].setTop(e.PlayerInfoTopType.PLAYER_ID),this["playerInfo"+i].setTop(e.PlayerInfoTopType.PLAYER_ID);var n=this.checkPkIndex.indexOf(t)-this.checkPkIndex.indexOf(i);this.pkSwitch(t,"winner",n>0),this.pkSwitch(i,"loser",n>0),this.playAni(i,t)},i.prototype.pkSwitch=function(t,e,i){var n=this["playerInfo"+t];egret.Tween.removeTweens(n);var o=n.horizontalCenter,r=n.verticalCenter,s=n.parent.getChildIndex(n),a=n.parent.numChildren,l=i?350:-350,u=i?-30:30;switch(e){case"winner":n.parent.setChildIndex(n,a),egret.Tween.get(n).to({horizontalCenter:l,verticalCenter:u},800).wait(1500).to({horizontalCenter:o,verticalCenter:r},800).call(function(){n.parent.setChildIndex(n,s)});break;case"loser":n.parent.setChildIndex(n,a-1),egret.Tween.get(n).to({horizontalCenter:-l,verticalCenter:-u},800).wait(1500).to({horizontalCenter:o,verticalCenter:r},800).call(function(){n.parent.setChildIndex(n,s)})}},i.prototype.compareSelectShow=function(){this.restPeople=[];for(var t=2;t<=this.max_player;t++)-1===this.cantFight.indexOf(t)&&(this["compareSelect"+t].visible=!0,this.restPeople.push(t))},i.prototype.compareSelectReset=function(){for(var t=2;6>t;t++)this["compareSelect"+t].visible=!1},i.prototype.compareValueSet=function(){for(var t=2;6>t;t++)this["compareSelect"+t].setValue(t)},i.prototype.updateChipsListDefaultValues=function(t){var e=t;this.chipsListDefaultValues=[2*e,3*e,4*e,5*e,6*e,7*e],this.chipList.setChipsValue(this.chipsListDefaultValues)},i.prototype.updateOthersHead=function(){var t=this,e=this.getDeskData().snapshot.desk;Object.keys(e).forEach(function(i){var n=e[i],o=t.getLocalPosition(Number(i)),r=t["playerInfo"+o];r.visible=!0,n.username&&1!==o&&r.setHead(n.avatar)})},i.prototype.getIsLess=function(){var t=this.getDeskData().snapshot.desk,e=t[this.my_position];return e.balance.lte(this.currentChipValue)},i.prototype.napCompare=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return t=this.getDeskData().snapshot.desk[this.my_position],"fall"===t.status||"surrender"===t.status?[2]:(this.isNaping=!0,this.compareSelectReset(),this._sendRaise(this.napValue),this.pokerList1.setCheckButtonVisible(!1),this.controlBtns.setButtonsEnable(!1,!1,!1,!1),[4,this.isNap&&this.isNaping&&this.payoutAni.show(e.PayoutAniType.NAP)]);case 1:return i.sent(),[2]}})})},i.prototype.playAni=function(t,i){var n=this;return util.SoundUtil.play("zjh_"+(Math.random()<.5?"boy":"girl")+"_cmp"+(Math.random()<.5?"":"2")+"_mp3"),this.com_pkAni.visible=!0,this.com_pkAni.gp_pk_ani.alpha=1,this.com_pkAni.parent.setChildIndex(this.com_pkAni,this.com_pkAni.parent.numChildren-2),this.com_pkAni.parent.setChildIndex(this["playerInfo"+i],this.com_pkAni.parent.numChildren),new Promise(function(i){n.com_pkAni.db_pk.play("pk",null,0,1);for(var o=1;5>=o;o++)n["playerInfo"+o].burst_left&&(n["playerInfo"+o].burst_left.isPlaying=!1,n["playerInfo"+o].burst_left.currentFrame=0,n["playerInfo"+o].burst_left.visible=!1);n.com_pkAni.db_pk.once(egret.Event.COMPLETE,function(){n["playerInfo"+t].burst_left.currentFrame=0,n["playerInfo"+t].burst_left.visible=!0,n["playerInfo"+t].burst_left.playTimes=1,n["playerInfo"+t].burst_left.isPlaying=!0,n.com_pkAni.visible&&util.SoundUtil.play("zjh_gf_zhadan_mp3"),n["playerInfo"+t].burst_left.once(egret.Event.COMPLETE,r,n),n["playerInfo"+t].setTop(e.PlayerInfoTopType.LOSE),n.ispk=!1,n.getDeskData()&&n.updateUserState(!1)},n);var r=function(){egret.Tween.get(n.com_pkAni.gp_pk_ani).to({alpha:0},500,egret.Ease.circOut).call(function(){n.com_pkAni.visible=!1,n.statusEnd(t),i()})}})},i.prototype.setRaiseBtnEnable=function(){this.chipList.setChipListButtonEnabler(Number(this.playerInfo1.getBalance())),Number(this.playerInfo1.getBalance())<=this.chipList.chipsListValues[1]&&this.controlBtns.setButtonsEnable(null,!1,null,null)},i.prototype.updateStopDecision=function(){var t=this.getDeskData().snapshot;this.roundEndTime=t.stop_decision_ts,this.showGrenn&&(this.countDown(),this.showGrenn=!1)},i.prototype.updateCardPk=function(){var t,e,i,n=this,o=0,r=0,s=this.getDeskData().snapshot.desk,a=this.getDeskData().snapshot.card_pk;a.length>0&&(Object.keys(a[a.length-1]).forEach(function(e){"winner"===e&&(t=a[a.length-1][e]),"between"===e&&(i=a[a.length-1][e])}),e=i[0]===t?i[1]:i[0],Object.keys(s).forEach(function(i){var a=s[i],l=Number(i);String(a.user_id)===String(e)&&(r=n.getLocalPosition(l)),String(a.user_id)===String(t)&&(o=n.getLocalPosition(l))}),0!==o&&r!==this.lastPkLoserPos&&(this.checkPK(o,r),this.hideGreen(o),this.hideGreen(r)))},i.prototype.updateDynamicMin=function(){var t=this.getDeskData().snapshot.desk[this.my_position];this.Dynamic_min=this.getDeskData().snapshot.dynamic_min,t.watch_card?this.currentChipValue=2*this.Dynamic_min:this.currentChipValue=this.Dynamic_min,t.balance.lte(this.currentChipValue)&&this.isNap===!1&&(this.isNap=!0),this.controlBtns.setLabelsNum(util.NumberUtil.formatUnit(this.currentChipValue)),this.Dynamic_min===7*this.ante&&this.controlBtns.setButtonsEnable(null,!1,null,null)},i.prototype.showMatch=function(){this.match.visible=!0,this.isResult!==!0&&(this.isResult=!0,this.match.type=this.match.isAuto()?"cancel":"match",this.match.isAuto()&&this.match.startCountDown())},i.prototype.hideGreen=function(t){var e=this["playerInfo"+t];e.showCountDown(!1),e.stopCountDown()},i.prototype.destroySound=function(){var t=this,e=[];Object.keys(this.result_sound).forEach(function(i){e=e.concat(t.result_sound[i])}),util.SoundUtil.destroy(e)},i.prototype.beginAnotherGame=function(){this.destroySound();var t=this.gp_chipsArea.getChildByName("landscapeArea"),e=this.gp_chipsArea.getChildByName("portraitArea");t.removeChildren(),e.removeChildren(),this.deskInfo.setRound(0),this.deskInfo.setTotalBet(0),this.payoutAni.reset(),this.toggle.changeSelected(!0),this.com_pkAni.visible=!1,this.showTsAni=!1},i}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.flower.RoomUI")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.playAni=function(t){t?(this.db_girl.play("4cbull-girl"),[{db:this.db_LF1,name:"4cbull-xinshou"},{db:this.db_LF2,name:"4cbull-chuji"},{db:this.db_LF3,name:"4cbull-zhongji"},{db:this.db_LF4,name:"4cbull-gaoji"},{db:this.db_LF5,name:"4cbull-zhizun"},{db:this.db_LF6,name:"4cbull-wangzhe"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())})):(this.db_girl.stop(),[this.db_LF1,this.db_LF2,this.db_LF3,this.db_LF4,this.db_LF5,this.db_LF6].forEach(function(t){return t.stop()}))},e.prototype.registerEvent=function(){var t=this;[this.gp_LF1,this.gp_LF2,this.gp_LF3,this.gp_LF4,this.gp_LF5,this.gp_LF6].forEach(function(e){e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.name)
},t),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){return e.scaleX=e.scaleY=.9},t),e.addEventListener(egret.TouchEvent.TOUCH_END,function(){return e.scaleX=e.scaleY=1},t)}),this.addEventListener(eui.UIEvent.ADDED,function(e){return e.target===t&&(t.updateHallData(t.roomsData),t.playAni(!0))},this),this.addEventListener(eui.UIEvent.ADDED_TO_STAGE,function(e){return e.target===t&&(t.updateHallData(t.roomsData),t.playAni(!0))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.playAni(!1)},this)},e.prototype.updateHallDatas=function(t){this.roomsData=t,this.gp_LF1&&this.updateHallData(t)},e.prototype.updateHallData=function(t){var e=this;[this.gp_LF1,this.gp_LF2,this.gp_LF3,this.gp_LF4,this.gp_LF5,this.gp_LF6].forEach(function(t){t.visible=!1,t.includeInLayout=!1}),t.forEach(function(t){e["gp_"+t.room_id].name=t.room_id,e["gp_"+t.room_id].visible=!0,e["gp_"+t.room_id].includeInLayout=!0,e["lb_"+t.room_id+"_ante"].text=util.NumberUtil.formatUnit(t.bet_limit.ante),e["lb_"+t.room_id+"_admittance"].text=util.NumberUtil.formatUnit(t.bet_limit.admittance)})},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.four.Hall")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){}return t}();__reflect(i.prototype,"PlayFrame");var n=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.playerinfo=[],t.uis=[],t.showUI=function(e){return t.main.addChild(e)},t.getNetPosition=function(e){return(e+t.my_position-1)%6||6},t.getLocalPosition=function(e){return(e-t.my_position+1)%6||6},t.getDeskData=function(){return Data.getTopic("/look4_desk/"+t.desk_id)},t._sendRaise=function(e){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,{my_position:t.my_position,rate:e.data})},t.flaychip=function(e,i,n){return t.chips.flyChip(e,i,25)},t.showResultDBAni=function(e){return t.result_ani.show(e)},t.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},t.hideUI=function(e){return t.main.contains(e)&&t.main.removeChild(e)},t.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},t.MiPoker=function(){var e=t.getDeskData().snapshot;t.watch.initPoker(t.myCard),t.watch.show(e.stage_timestamp,e.room_setting.time.op-1),t.showUI(t.watch)},t.count_down=function(e,i){t.showUI(t.countDown),t.countDown.show(e,i)},t}return __extends(n,i),Object.defineProperty(n,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preloadGroup",{get:function(){return Array.apply(void 0,Array(9)).map(function(t,e){return"niu"+(e+1)}).concat("bomb","niuniu","sihuaniu","wuhuaniu","wuniu","wuxiaoniu").map(function(t){return"effect_bull_"+t})},enumerable:!0,configurable:!0}),n.prototype.childrenCreated=function(){this.initView(),i.prototype.childrenCreated.call(this)},n.prototype.initView=function(){this.beginAni=new t.bull.BeginAni,this.beginAni.verticalCenter=0,this.chips=new t.bull.Chips(this.main),this.pokerAni=new e.PokerAni(this.gp_pokerAni),this.result_ani=new e.ResultMC(this.main),this.uis=[this.autoMatch,this.beginAni,this.result_ani,this.qiangzhuangBtns,this.multBtns,this.tips,this.countDown,this.watchButtons],this.playerinfo=[{player:this.player1,poker:this.poker1,state:this.state1,snatch:this.snatch1},{player:this.player2,poker:this.poker2,state:this.state2,snatch:this.snatch2},{player:this.player3,poker:this.poker3,state:this.state3,snatch:this.snatch3},{player:this.player4,poker:this.poker4,state:this.state4,snatch:this.snatch4},{player:this.player5,poker:this.poker5,state:this.state5,snatch:this.snatch5},{player:this.player6,poker:this.poker6,state:this.state6,snatch:this.snatch6}],this.hideUI(this.watch),this.watchButtons.setCall(this.MiPoker)},n.prototype.initUI=function(){this.proMatch(),this.initMyinfo(),this.initPoker(),this.hideUIs()},n.prototype.clearData=function(){this.my_position=0,this.playerinfo.forEach(function(t,e){t.player.visible=0===e,t.player.setXiaoguo(!1),t.player.isBanker=!1,t.poker.visible=!1,t.poker.initPoker(),t.snatch.visible=!1,t.state.visible=!1})},n.prototype.initPoker=function(){this.playerinfo.forEach(function(t,e){t.poker.initPoker(),t.poker.type=0===e?"own":"other"})},n.prototype.proMatch=function(){this.myCard=void 0,this.clearData()},n.prototype.initData=function(){this.clearData(),this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this.desk_id,this.updataPlayerInfo();var t=this.getDeskData();Data.validate(topic.fourSchema,t);var e=t.snapshot;switch(e&&e.stage&&"init"!==e.stage.toLowerCase()&&"none"!==e.stage.toLowerCase()&&(util.LogUtil.info("[four] [initData] reconnect successfully!"),util.LogUtil.info("[four] [initData] my_position => "+this.my_position),util.LogUtil.info("[four] [initData] snapshot => "+JSON.stringify(e))),e.stage.toLowerCase()){case"dispute":var i=e.dispute;this.setPokers(e,!0),this.updateDispute(),i[this.getNetPosition(this.my_position)].is_done||(this.showUI(this.qiangzhuangBtns),this.qiangzhuangBtns.init(e.room_setting.dispute_factor,this.my_position)),this.count_down(e.stage_timestamp,e.room_setting.time.dispute);break;case"raise":var n=e.raise;this.setBanker(e),this.setPokers(e,!1),this.poker1.showPoker5(),this.is_banker?this.showUI(this.tips):n[this.getNetPosition(this.my_position)].is_done||(this.showUI(this.multBtns),this.multBtns.init(e.raise_rate_options,this.ante,this.cur_banker_rate,this.my_position)),this.updateRaiseRateOptions(),this.count_down(e.stage_timestamp,e.room_setting.time.raise);break;case"fight":this.setPokers(e,!1),this.poker1.showPoker5(),this.setBanker(e),this.count_down(e.stage_timestamp,e.room_setting.time.op),e.fight[this.getNetPosition(this.my_position)].is_done||this.showUI(this.watchButtons),this.updateRaiseRateOptions(),this.updateFight(),this.hideUI(this.tips);break;case"settle":this.setPokers(e,!1),this.setBanker(e),this.updateRaiseRateOptions(),this.updateFight(),this.surplus(),this.showUI(this.autoMatch),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM)}},n.prototype.setBanker=function(t){var e=this,i=t.dispute;this.is_banker=t.dispute[this.my_position].is_banker,Object.keys(i).forEach(function(t){var n=i[t],o=e.getLocalPosition(Number(t)),r=e.playerinfo[o-1].snatch;if(n.is_banker){e.cur_banker_rate=n.dispute_rate,r.visible=!0,r.type="snatch",r.setSnatchNumber(e.cur_banker_rate);var s=e.playerinfo[e.getLocalPosition(Number(t))-1].player;s.setXiaoguo(!0),s.isBanker=!0}else r.visible=!1})},n.prototype.setPokers=function(t,e){var i=this;this.playerinfo.forEach(function(n,o){if(n.player.visible){var r=n.poker;r.visible=!0,r.initPoker(),0===o&&(i.myCard=util.ObjectUtil.copy(t.fight[i.my_position].cards),r.setCards(i.myCard)),e&&r.hidePoker5()}})},n.prototype.initMyinfo=function(){this.player1.setName(Const.UserInfo.NICK),this.player1.setHead(Const.UserInfo.AVATAR),this.player1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance)},n.prototype.registerEvent=function(){},n.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_CANCEL_MATCH:this.autoMatch.setAutoMatch(!1),this.showUI(this.autoMatch);break;case Const.UICommand.CMD_UPDATE_USER_INFO:this.updataPlayerInfo();break;case Const.UICommand.CMD_CONTINUE_MATCH:this.proMatch();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_UPDATE_DISPUTE:this.updateDispute();break;case Const.UICommand.CMD_UPDATE_RAISE:this.updateRaiseRateOptions();break;case Const.UICommand.CMD_UPDATE_FIGHT:this.updateFight();break;case Const.UICommand.CMD_LEAVE_DESK:this.autoMatch.clearInterval()}},n.prototype.updateFight=function(){this.pokerAni.isSending()&&this.sleep(700);for(var t=this.getDeskData().snapshot,e=6;e>0;e--){var i=e,n=t.fight,o=this.getNetPosition(e),r=n[o],s=this.playerinfo[i-1].poker,a=this.playerinfo[i-1].player;a.visible&&r.is_done&&!s.isShowCardResult()&&(!s.visible&&(s.visible=!0),util.LogUtil.info("[four] [updateFight] "+t.user_info[o].username+" cards =>"+r.cards+"  fight_data.type =>"+r.type),i===this.my_position?s.showMyResult(this.myCard,r.type):s.showResult(r.cards,r.type))}},n.prototype.playFlyPokerAni=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,o;return __generator(this,function(r){switch(r.label){case 0:e=1,r.label=1;case 1:return 7>e?(i=e,this.playerinfo[i-1].player.visible?(n=this.getNetPosition(Number(i)),o=t.fight[n],i===this.my_position&&(this.myCard=util.ObjectUtil.copy(o.cards)),this.dealCard(i,this.my_position===Number(n)?o.cards:null),[4,this.sleep(200)]):[3,3]):[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},n.prototype.dispute=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this.getDeskData().snapshot,[4,this.playFlyPokerAni(t)];case 1:return e.sent(),this.showUI(this.qiangzhuangBtns),this.qiangzhuangBtns.init(t.room_setting.dispute_factor,this.my_position),this.count_down(t.stage_timestamp,t.room_setting.time.dispute),[2]}})})},n.prototype.inRaise=function(t){var e=this;this.poker4.visible||Object.keys(t.fight).forEach(function(i){var n=t.user_info[i];if(n.username){var o=e.getLocalPosition(Number(i)),r=e.playerinfo[o-1].poker;r.visible=!0;var s=t.fight[i];e.my_position===o&&(e.myCard=util.ObjectUtil.copy(s.cards),r.setCards(s.cards)),r.hidePoker5()}})},n.prototype.inSettle=function(t){var e=this;this.poker4.pokerEndIsHide&&Object.keys(t.fight).forEach(function(i){var n=t.user_info[i];if(n.username){var o=e.getLocalPosition(Number(i)),r=e.playerinfo[o-1].poker;r.visible=!0;var s=t.fight[i];e.my_position===o?r.showPoker5(e.myCard[4]):r.showPoker5(s.cards[4])}})},n.prototype.updateStage=function(e){return void 0===e&&(e=!1),__awaiter(this,void 0,void 0,function(){var e,i,n,o=this;return __generator(this,function(r){switch(r.label){case 0:switch(e=this.getDeskData().snapshot,this.hideUIs(),i=e.stage.toLowerCase()){case"dispute":return[3,1];case"raise":return[3,2];case"fight":return[3,4];case"settle":return[3,8]}return[3,11];case 1:return util.LogUtil.info("[four] [updateStage] dispute"),this.showUI(this.beginAni),this.beginAni.once(t.bull.BeginAni.EVT_SHOW_BTN,function(){o.getDeskData().snapshot.stage===e.stage&&o.dispute()},this),[3,11];case 2:return util.LogUtil.info("[four] [updateStage] raise"),[4,this.sleep(2e3)];case 3:return r.sent(),this.getDeskData().snapshot.stage!==e.stage?[2]:this.calRemainMill(e.stage_timestamp,e.room_setting.time.raise)/1e3<0?[2]:(this.inRaise(e),n=this.getDeskData().snapshot.dispute,this.setBanker(e),this.is_banker?this.showUI(this.tips):(this.showUI(this.multBtns),this.multBtns.init(e.raise_rate_options,this.ante,this.cur_banker_rate,this.my_position)),this.count_down(e.stage_timestamp,e.room_setting.time.raise),[3,11]);case 4:return util.LogUtil.info("[four] [updateStage] fight"),[4,this.inRaise(e)];case 5:return r.sent(),[4,this.updateMycard(e)];case 6:return r.sent(),[4,this.fightPlayCardAni()];case 7:return r.sent(),this.hideUI(this.tips),this.count_down(e.stage_timestamp,e.room_setting.time.op),this.calRemainMill(e.stage_timestamp,e.room_setting.time.op)/1e3>0&&this.showUI(this.watchButtons),[3,11];case 8:return util.LogUtil.info("[four] [updateStage] settle"),[4,this.sleep(800)];case 9:return r.sent(),[4,this.payoutAni()];case 10:return r.sent(),this.showUI(this.autoMatch),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),[3,11];case 11:return[2]}})})},n.prototype.hideUIs=function(){var t=this;this.uis.forEach(function(e){return t.hideUI(e)})},n.prototype.payoutAni=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.updateFight(),this.checkDBAni(),this.chipAni(),this.surplus()])];case 1:return t.sent(),this.updataPlayerInfo(),[4,this.sleep(1e3)];case 2:return t.sent(),[2]}})})},n.prototype.checkDBAni=function(){var e=this,i=this.getDeskData().snapshot,n=[0,0];if(this.is_banker){if([1,2,3,4,5,6].forEach(function(t){t!==e.getNetPosition(e.my_position)&&e.playerinfo[e.getLocalPosition(t)-1].player.visible&&(i.settle[t].surplus>0?n[0]++:n[1]++)}),0===n[0])return this.showResultDBAni(t.bull.ResultEnum.take_all);if(0===n[1])return this.showResultDBAni(t.bull.ResultEnum.lose_all)}return i.settle[this.my_position].surplus>0?this.showResultDBAni(t.bull.ResultEnum.win):void 0},n.prototype.chipAni=function(){var t=this;return new Promise(function(e){var i=t.getDeskData().snapshot.settle,n=t.getDeskData().snapshot.dispute,o=0,r=[],s=[];Object.keys(n).forEach(function(e){var a=n[e],l=i[e],u=t.getLocalPosition(Number(e));a.is_banker!==!1&&(o=u),l.surplus>0?s.push(u):l.surplus<0&&r.push(u)});var a=10;r.forEach(function(e){var i=t.playerinfo[o-1].player,n=t.playerinfo[e-1].player;util.SoundUtil.play("nn_collectgold_mp3"),t.flaychip(n.getChipPosition(),i.getChipPosition(),a)});var l=10;t.winTimeout=util.TimeUtil.setTimeout(function(){s.forEach(function(e){var i=10,n=t.playerinfo[e-1].player,r=t.playerinfo[o-1].player;util.SoundUtil.play("nn_collectgold_mp3"),t.flaychip(r.getChipPosition(),n.getChipPosition(),i)})},30*a+500),util.TimeUtil.setTimeout(e,30*(a+l)+1e3)})},n.prototype.surplus=function(){var t=this,e=this.getDeskData().snapshot,i=e.settle,n=e.user_info;util.LogUtil.info("[four] [surplus] my_position =>"+this.my_position),Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e)),r=t.playerinfo[o-1].state,s=t.playerinfo[o-1].player;1===o&&n.surplus>0&&util.SoundUtil.play("nn_scrollnumber_mp3"),s.visible&&(r.visible=!0,r.setScore(n.surplus),util.LogUtil.warn("[four] [surplus] net_position =>"+e+"  surplus => "+n.surplus))}),Object.keys(n).forEach(function(e){var i=n[e],o=t.getLocalPosition(Number(e)),r=t.playerinfo[o-1].player;i.username&&r.setBalance(i.balance)})},n.prototype.updataPlayerInfo=function(){var t=this,e=this.getDeskData().snapshot;if(e&&"settle"!==e.stage.toLowerCase()){var i=e.user_info;0===this.my_position&&Object.keys(i).forEach(function(e){var n=i[e];n.user_id===""+Const.UserInfo.USER_ID&&(t.my_position=Number(e))}),Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e)),r=t.playerinfo[o-1].player;n.username?(r.visible=!0,1!==o&&(r.setName(n.username),r.setHead(n.avatar)),r.setBalance(n.balance)):r.visible=!1})}},n.prototype.updateDispute=function(){var t=this;if(!this.poker4.visible)return void egret.setTimeout(this.updateDispute,this,300);var e=this.getDeskData().snapshot;this.is_banker=!!e.dispute[this.my_position].is_banker;var i=e.dispute,n=0,o=0;if(Object.keys(i).forEach(function(r){var s=i[r],a=t.getLocalPosition(Number(r)),l=t.playerinfo[a-1].snatch;s.is_done&&!l.visible&&(l.visible=!0,l.setSnatchNumber(s.dispute_rate),util.LogUtil.info("[four] [updateDispute] "+e.user_info[r].username+"'s dispute_rate=>"+s.dispute_rate)),s.is_banker&&(o=a-1,t.cur_banker_rate=n=s.dispute_rate)}),n){var r=[];if(Object.keys(i).forEach(function(e){var o=i[e],s=t.getLocalPosition(Number(e));n===o.dispute_rate&&r.push(s-1)}),util.LogUtil.info("[four] [updateDispute] candidateList =>"+r+"  banker_pos=>"+o),r.length>1)this.playFrameAni(r,o);else{var s=this.playerinfo[o].player;util.SoundUtil.play("nn_banker_mp3"),s.isBanker=!0,s.setXiaoguo(!0)}}},n.prototype.playFrameAni=function(t,e){var i=this,n=15;n=n-n%t.length+t.indexOf(e)+1,egret.Tween.removeTweens(this.player1);var o=egret.Tween.get(this.player1);Array.apply(void 0,Array(n)).forEach(function(e,n){var r=n*n*n/15;o.call(function(){var e=n%t.length;i.playerinfo[t[0===e?t.length-1:e-1]].player.setXiaoguo(!1),i.playerinfo[t[e]].player.setXiaoguo(!0),util.SoundUtil.play("nn_bankerrun_mp3")}).wait(r)}),o.call(function(){util.SoundUtil.play("nn_banker_mp3");var t=i.playerinfo[e].player;t.isBanker=!0,t.setXiaoguo(!0)})},n.prototype.updateRaiseRateOptions=function(){var t=this,e=this.getDeskData().snapshot,i=e.raise,n=e.dispute;Object.keys(i).forEach(function(o){var r=t.getLocalPosition(Number(o)),s=i[o],a=n[o],l=t.playerinfo[r-1].snatch;a.is_banker||!s.is_done||l.visible||(l.type="bet",l.visible=!0,l.setBetNumber(s.raise_rate),util.LogUtil.info("[four] [updateRaiseRateOptions] "+e.user_info[o].username+"'s  raise_rate=>"+s.raise_rate),r===t.my_position&&t.showUI(t.tips))})},n.prototype.dealCard=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(n){switch(n.label){case 0:return i=this.playerinfo[t-1].poker,[4,this.pokerAni.flyCard(t,i.getTopCardPos(),i.getPokerSize(),4)];case 1:return n.sent(),this.pokerAni.hidePoker(t),i.visible=!0,i.hidePoker5(),e&&i.setCards(e),[4,i.dealCardAni()];case 2:return n.sent(),[2]}})})},n.prototype.dealCard2=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return e=this.playerinfo[t-1].poker,[4,this.pokerAni.flyCard(t,e.getEndCardPos(),e.getPokerSize(),1)];case 1:return i.sent(),e.showPoker5(),this.pokerAni.hide2edPoker(),[2]}})})},n.prototype.updateMycard=function(t){var e=t.fight[this.getNetPosition(this.my_position)].cards.slice();this.myCard?(this.myCard.forEach(function(t){e.splice(e.indexOf(t),1)}),this.myCard.push(e[0])):this.myCard=e,util.LogUtil.info("[four] [updateMycard] myCard => "+this.myCard)},n.prototype.fightPlayCardAni=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o;return __generator(this,function(r){switch(r.label){case 0:t=this.getDeskData().snapshot,e=1,r.label=1;case 1:return 7>e?(i=e,this.playerinfo[i-1].player.visible?(n=this.getNetPosition(Number(i)),o=t.fight[n],this.dealCard2(i),[4,this.sleep(100)]):[3,3]):[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},n}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.four.RoomUI")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomIds=["HL1","HL2","HL3","HL4"],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btns=[this.btn1,this.btn2,this.btn3,this.btn4],this.data&&this.updateRooms()},e.prototype.updateHallDatas=function(t){this.data=t,this.btn1&&this.updateRooms()},e.prototype.updateRooms=function(){var t=this;this.btns.forEach(function(t){t.visible=!1,t.includeInLayout=!1}),this.data.forEach(function(e){var i=t.roomIds.indexOf(e.room_setting.room_id),n=t.btns[i];n.includeInLayout=!0,n.visible=!0,n.data=e})},e.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_ROAD_MAP:util.LogUtil.debug("-----CMD_UPDATE_ROAD_MAP-----",e)}},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.hilo.Hall")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){this.fixed_123=0,this.fixed_456=0,this.great=0,this.equal=0,this.less=0,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=0,this[6]=0,this.combination_1_2=0,this.combination_1_3=0,this.combination_1_4=0,this.combination_1_5=0,this.combination_1_6=0,this.combination_2_3=0,this.combination_2_4=0,this.combination_2_5=0,this.combination_2_6=0,this.combination_3_4=0,this.combination_3_5=0,this.combination_3_6=0,this.combination_4_5=0,this.combination_4_6=0,this.combination_5_6=0,this.less_1=0,this.less_2=0,this.less_3=0,this.less_4=0,this.less_5=0,this.less_6=0,this.great_3=0,this.great_4=0,this.great_5=0,this.great_6=0}return t}();e.Bets=i,__reflect(i.prototype,"ui.hilo.Bets");var n=function(n){function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.girl_scale=1,t.idle=0,t.currentStage="deal",t.defaultChips=[],t.own_bets=new i,t.other_player_bets=new i,t.robot_bets=new i,t.limit={min:{combination:0,equal:0,fixed_123:0,fixed_456:0,great:0,great_3:0,great_4:0,great_5:0,great_6:0,less:0,less_1:0,less_2:0,less_3:0,less_4:0,less_5:0,less_6:0,point:0},max:{combination:0,equal:0,fixed_123:0,fixed_456:0,great:0,great_3:0,great_4:0,great_5:0,great_6:0,less:0,less_1:0,less_2:0,less_3:0,less_4:0,less_5:0,less_6:0,point:0}},t.STAGE={shuffle:"lbl_game_wait",deal:"lbl_game_wait",bet:"lbl_game_betting",open:"lbl_game_payout_wait",stop_bet:"lbl_game_payout_wait",settle:"lbl_game_payout_wait",after_settle:"lbl_game_payout_wait"},t.betData={fixed_123:0,fixed_456:0,great:0,equal:0,less:0,1:0,2:0,3:0,4:0,5:0,6:0,combination_1_2:0,combination_1_3:0,combination_1_4:0,combination_1_5:0,combination_1_6:0,combination_2_3:0,combination_2_4:0,combination_2_5:0,combination_2_6:0,combination_3_4:0,combination_3_5:0,combination_3_6:0,combination_4_5:0,combination_4_6:0,combination_5_6:0,less_1:0,less_2:0,less_3:0,less_4:0,less_5:0,less_6:0,great_3:0,great_4:0,great_5:0,great_6:0},t.settleData={1:{payout:0,rake:0,bet:0},2:{payout:0,rake:0,bet:0},3:{payout:0,rake:0,bet:0},4:{payout:0,rake:0,bet:0},5:{payout:0,rake:0,bet:0},6:{payout:0,rake:0,bet:0},combination_1_2:{payout:0,rake:0,bet:0},combination_1_3:{payout:0,rake:0,bet:0},combination_1_4:{payout:0,rake:0,bet:0},combination_1_5:{payout:0,rake:0,bet:0},combination_1_6:{payout:0,rake:0,bet:0},combination_2_3:{payout:0,rake:0,bet:0},combination_2_4:{payout:0,rake:0,bet:0},combination_2_5:{payout:0,rake:0,bet:0},combination_2_6:{payout:0,rake:0,bet:0},combination_3_4:{payout:0,rake:0,bet:0},combination_3_5:{payout:0,rake:0,bet:0},combination_3_6:{payout:0,rake:0,bet:0},combination_4_5:{payout:0,rake:0,bet:0},combination_4_6:{payout:0,rake:0,bet:0},combination_5_6:{payout:0,rake:0,bet:0},equal:{payout:0,rake:0,bet:0},fixed_123:{payout:0,rake:0,bet:0},fixed_456:{payout:0,rake:0,bet:0},great:{payout:0,rake:0,bet:0},great_3:{payout:0,rake:0,bet:0},great_4:{payout:0,rake:0,bet:0},great_5:{payout:0,rake:0,bet:0},great_6:{payout:0,rake:0,bet:0},less:{payout:0,rake:0,bet:0},less_1:{payout:0,rake:0,bet:0},less_2:{payout:0,rake:0,bet:0},less_3:{payout:0,rake:0,bet:0},less_4:{payout:0,rake:0,bet:0},less_5:{payout:0,rake:0,bet:0},less_6:{payout:0,rake:0,bet:0}},t.all_bets=new i,t.notAwardIndexArr=[],t.getMinLimit=function(){return Math.min.apply(Math,Object.keys(t.limit.min).map(function(e){return t.limit.min[e]}))},t.getMaxLimit=function(){return Math.max.apply(Math,Object.keys(t.limit.max).map(function(e){return t.limit.max[e]}))},t}return __extends(o,n),Object.defineProperty(o,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"cur_stage",{get:function(){return this.STAGE[this.currentStage]},enumerable:!0,configurable:!0}),o.prototype.initUI=function(){this.main.contains(this.com_betHint)&&this.main.removeChild(this.com_betHint),this.winAni.visible=!1,this.com_cup.visible=!0,this.com_betArea.init(),this.com_cup.init(),this.com_countDown.clearTimer(),this.com_betArea.chipArea=this.chipArea,this.playGirlAction("daiji",0,1)},o.prototype.initData=function(){var t=this;this.com_betArea.resetBetAreaUI(),this.playGirlAction("daiji",0,0),this.idle=0,this.oldBetsDataClear();var e=this.data.desk,i=this.data.stage;switch(this.currentStage=this.data.stage.stage.toLowerCase(),this.com_tip.show(this.cur_stage),this.balance=e.user_info.balance,this.road_map=this.data.desk_item.road_map,this.com_bottomPanel.setRoadMap(this.road_map),this.com_bottomPanel.setHead(Const.UserInfo.AVATAR),this.com_bottomPanel.setBalance(e.user_info.balance),this.com_bottomPanel.setName(e.user_info.username),this.com_bottomPanel.setSurplus(Number(e.user_info.surplus)),this.com_bottomPanel.showWin(e.user_info.surplus>0),this.com_bottomPanel.setChips(i.bet_limit.chips),this.com_bottomPanel.updateEnable(this.balance),this.setDefaultChips(i.bet_limit.chips),this.btn_people.label=String(this.data.desk_item&&this.data.desk_item.playernum||0),this.updatelimit(i.bet_limit),util.LogUtil.warn("-------------currentStage----",this.currentStage,e.result,i),this.currentStage){case"deal":break;case"bet":this.com_betArea.setEnable(!0),this.com_countDown.start(Number(i.stage_timestamp)+Number(i.room_setting.time[this.currentStage]),"bet"===this.currentStage);break;case"stop_bet":break;case"open":this.com_cup.updateDicePoint(e.open),this.DiceMoveToCenter(!1);break;case"settle":this.com_cup.updateDicePoint(e.open);break;case"after_settle":this.com_cup.updateDicePoint(e.open);break;case"shuffle":this.com_betArea.resetBetAreaUI()}("bet"===this.currentStage||"stop_bet"===this.currentStage||"open"===this.currentStage||"settle"===this.currentStage)&&(this.totalPlayerBetsHandler(e,!0),this.robotbetsHandler(i.bets,!0)),"after_settle"===this.currentStage&&i.channel_settles&&Object.keys(i.channel_settles).length>0&&Object.keys(i.channel_settles).forEach(function(n){var o=i.channel_settles[n];Object.keys(o).length>0&&(t.com_cup.updateDicePoint(e.open),t.com_cup.resetDiceCup(),t.showHighLight(e.result),t.awardHandler(e.user_info.settle,o.player,o.robot))}),this.topBar.bVal=e.round_id},o.prototype.setDefaultChips=function(t){var e=this;this.defaultChips=[],t.forEach(function(t){e.defaultChips.push(Number(t))})},o.prototype.registerEvent=function(){var t=this;this.db_girl.addEventListener(egret.Event.COMPLETE,function(e){"yaotougu"===t.currentAction&&(t.com_cup.visible=!0),t.playGirlAction("daiji",0,0)},this),this.winAni.addEventListener(egret.Event.COMPLETE,function(){return t.winAni.visible=!1},this),this.com_betArea.addEventListener(e.BetArea.EVT_BET,function(e){t.onBet(e.data)},this),this.com_betArea.addEventListener(e.BetArea.EVT_SHOW_TIP,function(e){"bet"!==t.currentStage&&(t.com_tip.show(t.cur_stage),util.SoundUtil.play("xiazhushibai_mp3"))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.addEventListener(egret.Event.RESIZE,this.resize,this)},o.prototype.onBet=function(t){if(this.balance.lt(this.com_bottomPanel.getCurChipValue()))return this.com_tip.show(util.LanguageUtil.translate("lbl_balance_error")),void util.SoundUtil.play("xiazhushibai_mp3");if(this.checkLimit(t.type)){util.SoundUtil.play("Chips_mp3");var e=util.ObjectUtil.copy(this.betData);e[t.type]=this.com_bottomPanel.getCurChipValue(),this.com_betArea.setEnable(!1),this.com_bottomPanel.betAni(!0),this.lastBetType=t.type,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BET,e)}else{util.SoundUtil.play("xiazhushibai_mp3");var i=this.getBetLimitByBetArea(t.type);this.com_tip.show(util.LanguageUtil.translate("lbl_game_beterror")+"\n"+util.LanguageUtil.translate("lbl_game_beterror_number",util.NumberUtil.formatNumber(i.min),util.NumberUtil.formatNumber(i.max)))}},o.prototype.checkLimit=function(t){var e=Number(this.own_bets[t])+this.com_bottomPanel.getCurChipValue(),i=this.getBetLimitByBetArea(t);return e<=i.max&&e>=i.min},o.prototype.execCommand=function(t,e){var i=this;switch(t){case Const.UICommand.CMD_UPDATE_USER_INFO:this.com_cup.init(),this.balance=e.balance,this.com_bottomPanel.setBalance(e.balance),this.com_bottomPanel.updateEnable(this.balance),this.idle=Number(e.idle);break;case Const.UICommand.CMD_UPDATE_BET:!function(){"bet"===i.currentStage&&i.com_betArea.setEnable(!0),i.ownBetsHandler(e)}();break;case Const.UICommand.CMD_UPDATE_ALL_BET:this.totalPlayerBetsHandler(e);break;case Const.UICommand.CMD_UPDATE_ROBOT_BET:this.robotbetsHandler(e);break;case Const.UICommand.CMD_BALANCE_HINT:!function(){"bet"===i.currentStage&&i.com_betArea.setEnable(!0),i.com_tip.show(util.LanguageUtil.translate(e))}();break;case Const.UICommand.CMD_UPDATE_STAGE:!function(){var t=e;i.updatelimit(t.bet_limit);var n=t.stage.toLowerCase();i.currentStage!==n&&(i.currentStage=n,i.onStageChange(t))}();break;case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.road_map=e.road_map,this.com_bottomPanel.setRoadMap(e.road_map);break;case Const.UICommand.CMD_INIT_UI:this.onRemove();break;case Const.UICommand.CMD_UPDATE_PEOPLE:this.btn_people.label=e.toString();break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:!function(){"shuffle"===i.currentStage&&(i.topBar.bVal=e.round_id)}();break;case Const.UICommand.CMD_UPDATE_CARDS:if("open"===this.currentStage){var n=e;this.com_cup.updateDicePoint(n)}break;case Const.UICommand.CMD_UPDATE_SETTLE:if("settle"===this.currentStage){this.desk_settle_data=e;var o=this.desk_settle_data.result;this.tmpResult=o}break;case Const.UICommand.CMD_UPDATE_ROBOT_SETTEL:this.tmpBetData=e}},o.prototype.showHighLight=function(t){var e=this;if(t){var i=[],n=[];t.forEach(function(t){var n=e.com_betArea.ALL_TYPE.indexOf(t);i.push(n)});for(var o=0;36>o;o++)-1===i.indexOf(o)&&n.push(o);this.notAwardIndexArr=n,this.com_betArea.removeSomeChips(n),this.com_betArea.showWinLight(i)}},o.prototype.onStageChange=function(e){switch(util.LogUtil.debug("RoomUIonStageChange",e),this.com_betArea.setEnable("bet"===this.currentStage?!0:!1),this.currentStage){case"deal":this.cleanBowlAni(),this.com_betArea.resetBetAreaUI();var i=this.getMinLimit();this.idle>=5?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_game_nobet2","lbl_game_comfirm"),this.onRemove()):this.balance&&this.balance.lt(i)?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_balance_error2","lbl_game_comfirm")):3===this.idle&&this.com_tip.show(util.LanguageUtil.translate("lbl_game_nobet"));break;case"bet":this.cleanBowlAni(),this.com_betArea.resetBetAreaUI(),util.SoundUtil.play("start_mp3"),this.showBetHintAni("start"),this.com_countDown.start(Number(e.stage_timestamp)+Number(e.room_setting.time[this.currentStage]),"bet"===this.currentStage);break;case"stop_bet":this.cleanBowlAni("stop_bet"),this.showBetHintAni("stop");case"open":this.cleanBowlAni("open"),this.DiceMoveToCenter();break;case"settle":break;case"after_settle":this.settleHandler(this.tmpBetData),this.showHighLight(this.tmpResult);break;case"shuffle":this.cleanBowlAni(),this.com_betArea.resetBetAreaUI(),this.playGirlAction("yaotougu",0,1),util.SoundUtil.play("yaotouzi_mp3"),this.com_cup.visible=!1,this.oldBetsDataClear(),this.com_betArea.updateAreaBetNumber(this.all_bets),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1),this.desk_settle_data=void 0,this.tmpBetData=void 0,this.tmpResult=void 0,this.currentBetType=this.lastBetType=null}},o.prototype.settleHandler=function(t){if(this.desk_settle_data){var e=t.robot,i=this.desk_settle_data.own_settle,n=(this.desk_settle_data.desk_settles.guest,this.desk_settle_data.desk_settles.player),o=this.desk_settle_data.own_total_surplus;this.awardHandler(i,n,e),o>0?(this.playGirlAction("win",0,2),this.playWinAni()):util.SoundUtil.play("dissapoint_mp3"),this.com_bottomPanel.setSurplus(o),this.com_bottomPanel.showWin(o>0)}},o.prototype.playWinAni=function(){var t=this;util.SoundUtil.play("win_mp3"),this.db_winAni.visible=!0,this.db_winAni.play("thirteen-win",null,0,1),this.db_winAni.alpha=1,this.db_winAni.once(egret.Event.COMPLETE,function(){egret.Tween.get(t.db_winAni).to({alpha:0},500,egret.Ease.circOut).call(function(){t.db_winAni.visible=!1})},this)},o.prototype.awardHandler=function(t,e,n){var o=new i,r=new i,s=new i,a=new i;this.computeSettle(o,t),this.computeSettle(r,e),this.computeSettle(s,n),Object.keys(this.settleData).forEach(function(t){a[t]=r[t]+s[t]}),this.flyChip(o,this.db_girl,!1,3),this.flyChip(a,this.db_girl,!1,4)},o.prototype.computeSettle=function(t,e){Object.keys(this.settleData).forEach(function(i){e&&e[i]?t[i]=e[i].payout+e[i].rake:t[i]=0})},o.prototype.showBetHintAni=function(t){var e=this;this.main.addChild(this.com_betHint),this.com_betHint.show(t),egret.Tween.removeTweens(this.com_betHint),this.com_betHint.horizontalCenter=-1300,this.com_betHint.alpha=.8,egret.Tween.get(this.com_betHint).to({horizontalCenter:0,alpha:1},250,egret.Ease.backOut).to({horizontalCenter:20},300).to({horizontalCenter:600,alpha:0},200,egret.Ease.quadIn).call(function(){return e.main.contains(e.com_betHint)&&e.main.removeChild(e.com_betHint)})},o.prototype.robotbetsHandler=function(t,e){var n=this;
if(void 0===e&&(e=!1),this.data&&this.data.stage){var o=util.ObjectUtil.minus(this.old_robot_bets||[],t);this.old_robot_bets=util.ObjectUtil.copy(t);var r=new i,s=0;if(o&&o.length){if(o.forEach(function(t){Object.keys(t.bets).forEach(function(e){var i=n.getBetLimitByBetArea(e),o=i.max,a=i.min,l=t.bets[e].p,u=t.bets[e].m,h=new Decimal((l*(o-a)+a)*u).divToInt(100).mul(100);if(h.greaterThan(0)){for(var c=h.toNumber(),p=n.defaultChips.length-1;p>=0;p--)c%=n.defaultChips[p],0===p&&c>0&&(h=h.minus(c));n.robot_bets[e]=h.add(n.robot_bets[e]).toNumber(),r[e]+=h.toNumber(),s+=h.toNumber()}})}),util.LogUtil.warn("handleRobotbet","robotBet",r),0>=s)return;this.peopleBetAni(),this.flyChip(r,this.btn_people,e,2)}}},o.prototype.totalPlayerBetsHandler=function(t,e){void 0===e&&(e=!1),this.ownBetsHandler(t,e);var n=t.bet,o=new i;this.calBetsDiff(o,n,this.own_bets);var r=new i;this.calBetsDiff(r,o,this.own_bets),this.copyBets(o,this.other_player_bets),util.LogUtil.warn("totalPlayerBetsHandler","other_player_bet",r),this.flyChip(r,this.btn_people,!1,2)},o.prototype.peopleBetAni=function(){egret.Tween.get(this.btn_people).to({verticalCenter:-630},80,egret.Ease.quadOut).to({verticalCenter:-644},80,egret.Ease.quadIn)},o.prototype.ownBetsHandler=function(t,e){void 0===e&&(e=!1);var n=t.user_info.bet,o=new i;this.calBetsDiff(o,n,this.own_bets),this.copyBets(n,this.own_bets),util.LogUtil.warn("ownBetsHandler","own_bet",o),this.flyChip(o,this.com_bottomPanel.com_head,e,1)},o.prototype.flyChip=function(e,i,n,o,r){var s=this,a=-1,l=[];Object.keys(e).forEach(function(u){var h,c=e[u],p=s.com_betArea.ALL_TYPE.indexOf(u);if(c>0){var _;h=o>2?[{chipValue:c,count:1}]:s.getFlyChipList(c),o>1&&(_=3===o?"1":"player"),h.forEach(function(e){2===o&&(e.count=Math.min(e.count,3));for(var u=0;u<e.count;u++){var h=t.component.SChip.getOneChip(e.chipValue,_),c=s.com_betArea.flyChip(h,i,p,!n,o,r);l.push(c),1===o&&(s.all_bets[s.com_betArea.ALL_TYPE[p]]+=e.chipValue,a=p)}})}}),Promise.all(l).then(function(){util.TimeUtil.setTimeout(function(){util.SoundUtil.play("fangchouma_mp3"),3===o?s.com_betArea.flyChips(s.com_bottomPanel.com_head,s.btn_people,"own"):4===o&&(s.com_betArea.flyChips(s.com_bottomPanel.com_head,s.btn_people,"other"),s.oldBetsDataClear(),s.com_betArea.updateAreaBetNumber(s.all_bets))},400)}),n?1===o&&this.com_betArea.updateAreaBetNumber(this.all_bets,!1,a):util.TimeUtil.setTimeout(function(){var t=s.lastBetType===s.currentBetType?!0:!1;1===o&&(s.currentBetType=s.lastBetType,s.com_betArea.updateAreaBetNumber(s.all_bets,t,a))},400)},o.prototype.getFlyChipList=function(t){for(var e=[],i=this.defaultChips.length-1;i>=0;i--){var n=Math.floor(t/this.defaultChips[i]);t%=this.defaultChips[i],n&&e.push({chipValue:this.defaultChips[i],count:n})}return e},o.prototype.calBetsDiff=function(t,e,i){Object.keys(t).forEach(function(n){return t[n]=(Number(e[n])||0)-(Number(i[n])||0)})},o.prototype.copyBets=function(t,e){Object.keys(t).forEach(function(i){return e[i]=Number(t[i])||0})},o.prototype.getBetLimitByBetArea=function(t){var e=0,i=0;return Number(t)?(e=this.limit.min.point,i=this.limit.max.point):t.startsWith("combination")?(e=this.limit.min.combination,i=this.limit.max.combination):(e=this.limit.min[t]||0,i=this.limit.max[t]||0),{min:e,max:i}},o.prototype.oldBetsDataClear=function(){this.old_robot_bets=[],[this.own_bets,this.other_player_bets,this.robot_bets,this.all_bets].forEach(function(t){return Object.keys(t).forEach(function(e){return t[e]=0})})},o.prototype.onRemove=function(){this.com_countDown.clearTimer(),this.com_betArea.resetBetAreaUI(),this.initUI()},o.prototype.playGirlAction=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=1),this.db_girl.play("hilo_girl",t,e,i),this.currentAction=t},o.prototype.DiceMoveToCenter=function(t){var e=this;void 0===t&&(t=!0),t?egret.Tween.get(this.com_cup).to({verticalCenter:-100,scaleX:1,scaleY:1},500).call(function(){e.com_cup.runOpenAni(function(){e.com_cup.centerState(),e.com_cup.runOpenAni2()})}):(this.com_cup.verticalCenter=-100,this.com_cup.scaleX=this.com_cup.scaleY=1,this.com_cup.runOpenAni(null,!1))},o.prototype.cleanBowlAni=function(t){this.com_cup.init(),t||this.com_betArea.removeTw()},o.prototype.updatelimit=function(t){var e=this,i=util.ObjectUtil.copy(t.min),n=util.ObjectUtil.copy(t.max);Object.keys(i).forEach(function(t){return e.limit.min[t]=Number(i[t])}),Object.keys(n).forEach(function(t){return e.limit.max[t]=Number(n[t])});var o=this.getMinLimit(),r=this.getMaxLimit();this.topBar.aVal=util.NumberUtil.formatUnit(o)+"-"+util.NumberUtil.formatUnit(r)},o.prototype.resize=function(){this.com_bottomPanel.resize()},o}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.hilo.RoomUI")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentIndex=0,e.allImage=[],e}return __extends(e,t),e.prototype.startWinEff=function(){var t=this;this.clearWinEff(),this.visible=!0,this.allImage=[this.eff_1,this.eff_2,this.eff_3,this.eff_4],this.timer=util.TimeUtil.setInterval(function(){for(var e=t.currentIndex%4,i=0;4>i;i++)i===e?t.allImage[i].visible=!0:t.allImage[i].visible=!1;t.currentIndex++},120)},e.prototype.clearWinEff=function(){this.visible=!1,this.currentIndex=0,util.TimeUtil.clearInterval(this.timer)},e}(t.Component);e.WinEff=i,__reflect(i.prototype,"ui.hilo.WinEff")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pool="",e}return __extends(e,t),e}(topic.RoomItemData);e.RoomItemData=i,__reflect(i.prototype,"ui.horoscope.RoomItemData");var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataProvider=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.updateHallDatas=function(t){this.dataProvider.replaceAll(t.map(function(t){var e=t.room_id.substr(2),i="horoscope_room"+e,n="ho_font_room"+e+"_png";return t.title=n,t.db=i,t.title_y=Const.Config.LANGUAGE.startsWith("en")?200:230,t}))},e}(t.HallBase);e.Hall=n,__reflect(n.prototype,"ui.horoscope.Hall"),function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){return e.bindData&&e.db.play(e.bindData.db,null,5*Math.random())},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),eui.Watcher.watch(this,["bindData","db"],this.init,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.db.stop()},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.bindData.room_id)},this)},e}(t.control.Button);e.HallItemButton=i,__reflect(i.prototype,"ui.horoscope.Hall.HallItemButton")}(n=e.Hall||(e.Hall={}))}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){this[1]=0,this[2]=0,this[3]=0,this[4]=0}return t}();e.AreaMark=i,__reflect(i.prototype,"ui.horoscope.AreaMark");var n=function(n){function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.is_playing_standby=!1,t.girl_scale=.58,t.idle=0,t.defaultChips=[200,300,400,500,600,700],t.ownBet=new i,t.otherPlayerBet=new i,t.robotBet=new i,t.AREA_TYPE={1:0,2:1,3:2,4:3},t.POKER_TYPE={banker:0,1:1,2:2,3:3,4:4},t.ALL_TYPE=["1","2","3","4"],t.limit={min:new i,max:new i},t.STAGE={prepare:"lbl_game_prepare2",shuffle:"lbl_game_shufflecard",deal:"lbl_game_dealcard",bet:"lbl_game_betting",stop_bet:"lbl_game_payout",open:"lbl_game_payout",settle:"lbl_game_payout",after_settle:"lbl_game_payout",pool:"lbl_game_payout"},t.girl_standby=function(){t.is_playing_standby||(t.is_playing_standby=!0,t.db_girl.play("horoscope_girl","03standby"))},t.payoutAniStep1=function(e,i,n){var o=!1,r=Promise.all(Object.keys(e).map(function(r){var s=t.AREA_TYPE[r];if(e[r]>0&&void 0!==s){var a=t.com_bankerFrame.localToGlobal(),l=t.group_chipAni.globalToLocal(a.x+109,a.y+94),u=t.getFlyChipList(i[r]),h=t.getFlyChipList(e[r]-i[r]);return Promise.all([Promise.all(u.map(function(e,i){return Promise.all(Array.apply(void 0,Array(e)).map(function(){return o=!0,new Promise(function(e){var o=t.getChipPos(s),r=t.group_chipAni.globalToLocal(o.x,o.y),a=t.aniChips.getOneChip(t.defaultChips[i]);t.group_chipAni.addChild(a),a.name="own",a.x=l.x,a.y=l.y,egret.Tween.get(a).to({x:r.x,y:r.y,rotation:360*Math.random()},n,egret.Ease.quadOut).call(e)})}))})),Promise.all(h.map(function(e,i){return Promise.all(Array.apply(void 0,Array(e)).map(function(){return o=!0,new Promise(function(e){var o=t.getChipPos(s),r=t.group_chipAni.globalToLocal(o.x,o.y),a=t.aniChips.getOneChip(t.defaultChips[i]);t.group_chipAni.addChild(a),a.name="other",a.x=l.x,a.y=l.y,egret.Tween.get(a).to({x:r.x,y:r.y,rotation:360*Math.random()},n,egret.Ease.quadOut).call(e)})}))}))])}return Promise.resolve()}));return o&&util.SoundUtil.play("Chips_mp3"),r},t.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},t.getMinLimit=function(){return Math.min.apply(Math,Object.keys(t.limit.min).map(function(e){return t.limit.min[e]}))},t.shot=function(){egret.callLater(function(){var e=new egret.RenderTexture;e.drawToTexture(t.content),t.cache.source=e},t)},t}return __extends(o,n),Object.defineProperty(o,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"cur_stage",{get:function(){return this.STAGE[this.currentStage]},enumerable:!0,configurable:!0}),o.prototype.createChildren=function(){n.prototype.createChildren.call(this),mouse.setButtonMode(this.btn_people,!1),this.aniChips=new e.AniChips,this.chipAreas=[this.group_tian_chips,this.group_di_chips,this.group_xuan_chips,this.group_huang_chips],this.pokerAni=new e.PokerAni(this.gp_pokerAni)},o.prototype.initUI=function(){Const.Config.DESK_LOGO&&(this.img_logo.source=Const.Config.DESK_LOGO),this.initChips(),this.com_betArea.init(),this.initPokerList(),this.com_countDown.clearTimer(),this.db_girl.play("horoscope_girl","01breathe")},o.prototype.initData=function(){var t=this;util.LogUtil.warn(this.topBar.bVal+" => player enter room"),this.channel_settles=this.desk_settle_data=void 0;var e=this.data.desk,n=this.data.stage;this.idle=0,this.currentStage=this.data.stage.stage.toLowerCase(),this.com_tip.show(this.cur_stage),this.balance=e.user_info.balance,this.com_bottomPanel.setHead(Const.UserInfo.AVATAR),this.com_bottomPanel.setBalance(e.user_info.balance),this.com_bottomPanel.setName(e.user_info.username),this.com_bottomPanel.setSurplus(Number(e.user_info.surplus)),this.com_bottomPanel.showWin(e.user_info.surplus>0),this.com_bottomPanel.setChips(n.bet_limit.chips),this.com_bottomPanel.updateEnable(this.balance),this.setDefaultChips(n.bet_limit.chips),this.com_betArea.updateBet(e.user_info.bet,!0),this.com_betArea.updateBet(e.bet,!1);var o=e.user_info.bet,r=e.bet,s=new i;switch(Object.keys(r).forEach(function(t){s[t]=Number(r[t])-Number(o[t])}),this.flyChipAni(o,!0,!1),this.flyChipAni(s,!1,!1),this.ALL_TYPE.forEach(function(e){t.otherPlayerBet[e]=Number(s[e]),t.ownBet[e]=Number(o[e])}),this.old_robot_bets=[],this.btn_people.label=String(this.data.desk_item&&this.data.desk_item.playernum||0),this.com_betArea.setEnable(!1),this.com_betArea.updateRoadmap(this.data.desk_item&&this.data.desk_item.road_map,!0),this.currentStage){case"deal":this.db_girl.play("horoscope_girl","02action"),this.is_playing_standby=!1,this.db_girl.once(egret.Event.LOOP_COMPLETE,this.girl_standby,this),this.dealAllCard(!1);break;case"bet":this.girl_standby(),this.dealAllCard(!1),this.com_betArea.setEnable(!0),this.com_countDown.start(Number(n.stage_timestamp)+Number(n.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.handleRobotbet(n.bets,!1);break;case"open":this.girl_standby();for(var a=1;5>=a;a++){var l=this.getBetType(a),u=e.open[l];this.turnCards(5!==a?a:0,u,"point"===e.open.banker.type,!1)}this.handleRobotbet(n.bets,!1);break;case"settle":this.handleRobotbet(n.bets,!1);break;case"pool":this.settle(e);break;case"shuffle":this.db_girl.play("horoscope_girl","01breathe"),this.is_playing_standby=!1,this.pokerAni.init()}this.updatelimit(n.bet_limit),this.topBar.bVal=e.round_id},o.prototype.settle=function(t){for(var e=[],i=new Decimal(0),n="point"===t.open.banker.type,o=1;5>=o;o++){var r=this.getBetType(o),s=t.open[r];this.turnCards(5!==o?o:0,s,n,!1),"win"===s.result&&e.push(r)}this.com_betArea.showResult(e),this.ALL_TYPE.forEach(function(e){return i=i.plus(new Decimal(t.settle[e]))}),this.db_girl.play("horoscope_girl",i.gt(0)?"05lose":"04win")},o.prototype.registerEvent=function(){var t=this;this.com_betArea.addEventListener(e.BetArea.EVT_BET,function(e){t.onBet(e.data)},this),this.com_betArea.addEventListener(e.BetArea.EVT_SHOW_TIP,function(e){"bet"!==t.currentStage&&t.cur_stage&&t.com_tip.show(t.cur_stage)},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.main.addEventListener(eui.UIEvent.RESIZE,function(){if(t.main.height>t.main.width){var e=t.main.height/t.main.width;16/9>=e?t.girl_scale=.58:t.girl_scale=Math.max((e-16/9)*(.75-.58)/(21/9-16/9)+.58,.75)}},this)},o.prototype.execCommand=function(t,e){var n=this;switch(t){case Const.UICommand.CMD_UPDATE_ROBOT_BET:this.handleRobotbet(e,"bet"===this.currentStage);break;case Const.UICommand.CMD_UPDATE_ALL_BET:var o=e.own,r=e.total,s=new i;this.ALL_TYPE.forEach(function(t){var e=r[t]-o[t];s[t]=e-n.otherPlayerBet[t],n.otherPlayerBet[t]=e}),this.flyChipAni(s,!1,"bet"===this.currentStage),this.updateShowBet();break;case Const.UICommand.CMD_UPDATE_CARDS:!function(){return __awaiter(n,void 0,void 0,function(){var t,i,n,o;return __generator(this,function(r){switch(r.label){case 0:t="point"===e.banker.type,i=1,r.label=1;case 1:return 5>=i?(n=this.getBetType(i),o=e[n],this.stage?[4,this.turnCards(5!==i?i:0,o,t)]:[3,3]):[3,5];case 2:return r.sent(),[3,4];case 3:return[3,5];case 4:return i++,[3,1];case 5:return[2]}})})}();break;case Const.UICommand.CMD_UPDATE_SETTLE:!function(){if("settle"===n.currentStage){n.desk_settle_data=e;for(var t=e.open,i="point"===t.banker.type,o=1;5>=o;o++){var r=n.getBetType(o),s=t[r];n.turnCards(5!==o?o:0,s,i,!1)}}}();break;case Const.UICommand.CMD_UPDATE_USER_INFO:!function(){n.balance=e.balance,n.com_bottomPanel.setBalance(e.balance),n.com_bottomPanel.updateEnable(n.balance),n.idle=Number(e.idle)}();break;case Const.UICommand.CMD_UPDATE_BET:!function(){var t=e.own;"bet"===n.currentStage&&n.com_betArea.setEnable(!0);var o=new i;n.ALL_TYPE.forEach(function(e){o[e]=t[e]-n.ownBet[e],n.ownBet[e]=t[e]}),n.flyChipAni(o,!0,"bet"===n.currentStage),n.updateShowBet(!0)}();break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:"shuffle"===this.currentStage&&(this.topBar.bVal=e.round_id);break;case Const.UICommand.CMD_UPDATE_STAGE:!function(){var t=e;n.data&&(n.data.stage=t),n.updatelimit(t.bet_limit);var i=t.stage.toLowerCase();n.currentStage!==i&&(n.currentStage=i,n.onStageChange(t))}();break;case Const.UICommand.CMD_BALANCE_HINT:"bet"===this.currentStage&&this.com_betArea.setEnable(!0),this.com_tip.show(util.LanguageUtil.translate(e));break;case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.com_betArea.updateRoadmap(e.road_map);break;case Const.UICommand.CMD_INIT_UI:this.onRemove(),this.initUI();break;case Const.UICommand.CMD_UPDATE_PEOPLE:this.btn_people.label=e.toString();break;case Const.UICommand.CMD_UPDATE_ROBOT_SETTEL:this.channel_settles=e}},o.prototype.settleHandler=function(){var t=this;if(this.desk_settle_data&&this.channel_settles){var e=this.desk_settle_data,n=e.open,o=e.own_bet,r=e.own_settle,s=this.channel_settles.robot,a=e.desk_settles.guest,l=e.desk_settles.player,u=new i,h=new i,c=new i,p=new i,_=[],d=[],g=new Decimal(0);Object.keys(n).forEach(function(t){if("banker"!==t){var i=n[t].result;u[t]=new Decimal(r[t]).minus(new Decimal(o[t])).toNumber(),h[t]=new Decimal(u[t]).toNumber(),c[t]=new Decimal(r[t]).toNumber(),i?("win"===i&&_.push(t),d.push(i)):util.LogUtil.warn("CMD_UPDATE_SETTLE open no result data = > "+JSON.stringify(e)),p[t]=new Decimal(s[t]).add(a[t]).add(l[t]).toNumber()}}),util.LogUtil.warn(this.topBar.bVal+" => win area "+_),this.com_betArea.showResult(_),this.payoutAni(p,c,d),this.com_bottomPanel.setSurplus(Number(e.surplus)),this.com_bottomPanel.showWin(e.surplus>0),this.com_betArea.updateBet(p,!1),this.ALL_TYPE.forEach(function(e){if(o[e]>0){var i=t["btp_surplus_"+e],n=h[e];i.font=n>=0?"bc_font_win_money_fnt":"public_lose_fnt",i.text="",i.visible=!0,util.NumberUtil.tweenNumber(i,n).then(function(){return i.text=""+(n>0?"+":"")+util.NumberUtil.formatNumber(n)})}g=g.plus(new Decimal(p[e]))}),this.db_girl.play("horoscope_girl",g.gt(0)?"05lose":"04win")}},o.prototype.handleRobotbet=function(t,e){var n=this;if(this.data&&this.data.stage){var o=util.ObjectUtil.minus(this.old_robot_bets||[],t);this.old_robot_bets=util.ObjectUtil.copy(t);var r=new i;o&&o.length&&(o.forEach(function(t){Object.keys(t.bets).forEach(function(e){var i=Number(n.data.stage.bet_limit.max[e])||0,o=Number(n.data.stage.bet_limit.min[e])||0,s=t.bets[e].p,a=t.bets[e].m,l=new Decimal((s*(i-o)+o)*a).divToInt(100).mul(100);if(l.greaterThan(0)){for(var u=l.toNumber(),h=n.defaultChips.length-1;h>=0;h--)u%=n.defaultChips[h],0===h&&u>0&&(l=l.minus(u));n.robotBet[e]=l.add(n.robotBet[e]).toNumber(),r[e]+=l.toNumber()}})}),util.LogUtil.warn("===================================handleRobotbet","robotBet",r),this.flyChipAni(r,!1,"bet"===this.currentStage),this.updateShowBet())}},o.prototype.updateShowBet=function(t){var e=this;if(void 0===t&&(t=!1),t)this.com_betArea.updateBet(this.ownBet,!0);else{var n=new i;this.ALL_TYPE.forEach(function(t){return n[t]=e.robotBet[t]+e.otherPlayerBet[t]+e.ownBet[t]}),this.com_betArea.updateBet(n,!1)}},o.prototype.getBetType=function(t){var e;switch(t){case 1:e="1";break;case 2:e="2";break;case 3:e="3";break;case 4:e="4";break;case 5:e="banker"}return e},o.prototype.setDefaultChips=function(t){var e=this;this.defaultChips=[],t.forEach(function(t){e.defaultChips.push(Number(t))})},o.prototype.onStageChange=function(e){var n=this;if("stop_bet"!==this.currentStage)switch(this.com_betArea.setEnable(!1),this.com_betArea.init(),this.db_girl.removeEventListener(egret.Event.LOOP_COMPLETE,this.girl_standby,this),this.currentStage){case"deal":!function(){util.LogUtil.warn(n.topBar.bVal+" => DEAL STAGE"),n.db_girl.play("horoscope_girl","02action"),n.is_playing_standby=!1,n.db_girl.once(egret.Event.LOOP_COMPLETE,n.girl_standby,n),n.dealAllCard();var e=n.getMinLimit();n.idle>=5?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_game_nobet2","lbl_game_comfirm")):n.balance&&n.balance.lt(e)?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_balance_error2","lbl_game_comfirm")):3===n.idle&&n.com_tip.show(util.LanguageUtil.translate("lbl_game_nobet"))}();break;case"bet":util.LogUtil.warn(this.topBar.bVal+" => BET STAGE"),this.girl_standby(),this.com_countDown.start(Number(e.stage_timestamp)+Number(e.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.dealAllCard(!1),this.com_betArea.setEnable(!0),util.SoundUtil.play("start_mp3"),this.showBetHintAni("start"),this.initChips();break;case"open":util.LogUtil.warn(this.topBar.bVal+" => OPEN STAGE"),this.girl_standby(),this.dealAllCard(!1),this.showBetHintAni("stop");break;case"settle":this.old_robot_bets=[],util.LogUtil.warn(this.topBar.bVal+" => SETTLE STAGE");break;case"pool":this.settleHandler();break;case"shuffle":util.LogUtil.warn(this.topBar.bVal+" => SHUFFLE STAGE"),this.channel_settles=this.desk_settle_data=void 0,this.db_girl.play("horoscope_girl","01breathe"),this.is_playing_standby=!1,this.pokerAni.shuffle(),this.initPokerList(),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1),this.com_betArea.updateBet(new i,!0),this.com_betArea.updateBet(new i,!1),this.ALL_TYPE.forEach(function(t){return n["btp_surplus_"+t].visible=!1}),this.initChips()}},o.prototype.onBet=function(t){var e=new i;e[t]=this.com_bottomPanel.getCurChipValue(),this.checkLimit(t)?(this.com_betArea.setEnable(!1),this.com_bottomPanel.betAni(!0),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BET,e)):this.com_tip.show(util.LanguageUtil.translate("lbl_game_beterror")+"\n"+util.LanguageUtil.translate("lbl_game_beterror_number",util.NumberUtil.formatNumber(this.limit.min[t]),util.NumberUtil.formatNumber(this.limit.max[t])))},o.prototype.checkLimit=function(t){var e=Number(this.ownBet[t])+Number(this.com_bottomPanel.getCurChipValue());return e<=this.limit.max[t]&&e>=this.limit.min[t]},o.prototype.initChips=function(){var t=this;this.aniChips.returnAllChips(),this.shot(),this.ALL_TYPE.forEach(function(e,i){t.ownBet[e]=0,t.otherPlayerBet[e]=0,t.robotBet[e]=0})},o.prototype.payoutAni=function(t,e,i){var n=this,o=500,r=!1;util.LogUtil.warn(this.topBar.bVal+" => total surplus "+JSON.stringify(t)+" own surplus "+JSON.stringify(e));var s=this.com_bankerFrame.localToGlobal(),a=this.group_chipAni.globalToLocal(s.x+109,s.y+94);this.aniChips.returnAllChips(function(t){var e=t.target;return e&&"lose"===i[n.chipAreas.indexOf(e)]?(egret.Tween.removeTweens(t),t.parent?(r=!0,new Promise(function(e){var i=t.parent.localToGlobal(t.x,t.y);i=n.group_chipAni.globalToLocal(i.x,i.y),n.group_chipAni.addChild(t),t.x=i.x,t.y=i.y,egret.Tween.get(t).to({x:a.x,y:a.y},o,egret.Ease.quadOut).call(e)})):!1):!0}).then(function(){n.ALL_TYPE.forEach(function(t){n.ownBet[t]=0,n.otherPlayerBet[t]=0,n.robotBet[t]=0}),n.payoutAniStep1(t,e,o).then(function(){var t=n.getOtherPos(),e=n.com_bottomPanel.getOwnPos();t=n.group_chipAni.globalToLocal(t.x,t.y),e=n.group_chipAni.globalToLocal(e.x,e.y),n.aniChips.returnAllChips(function(i){return egret.Tween.removeTweens(i),i.parent?new Promise(function(r){var s=i.parent.localToGlobal(i.x,i.y),a="own"===i.name?e:t;s=n.group_chipAni.globalToLocal(s.x,s.y),n.group_chipAni.addChild(i),i.x=s.x,i.y=s.y,egret.Tween.get(i).to({x:a.x,y:a.y,rotation:360*Math.random()},o,egret.Ease.quadOut).call(r)}):!1}),n.shot()})}),this.shot(),r&&util.SoundUtil.play("Chips_mp3")},o.prototype.getOtherPos=function(){var t=this.btn_people.localToGlobal();return{x:t.x+this.btn_people.width/2,y:t.y+this.btn_people.height/2}},o.prototype.flyChipAni=function(t,e,i){var n=this;void 0===i&&(i=!0);var o,r;o=e?this.com_bottomPanel.getOwnPos():this.getOtherPos(),r=this.group_chipAni.globalToLocal(o.x,o.y),Promise.all(Object.keys(t).map(function(o){var s=Number(t[o]),a=n.AREA_TYPE[o],l=n.chipAreas[a];if(s>0){if(!e&&i){var u=-516;n.btn_people.verticalCenter=u,egret.Tween.get(n.btn_people).to({verticalCenter:u-15},80,egret.Ease.quadOut).to({verticalCenter:u},80,egret.Ease.quadIn)}return util.LogUtil.warn(n.topBar.bVal+" => "+(e?"player":"others")+" bet "+s+" on "+o),i&&util.SoundUtil.play("Chips_mp3"),Promise.all(n.getFlyChipList(s).map(function(t,o){return Promise.all(Array.apply(void 0,Array(t)).map(function(){return new Promise(function(t){var s=n.getChipPos(a),u=n.group_chipAni.globalToLocal(s.x,s.y),h=l.globalToLocal(s.x,s.y),c=n.aniChips.getOneChip(n.defaultChips[o]),p=function(){return t({endPos:h,chip:c})};n.group_chipAni.addChild(c),c.name=e?"own":"other",c.x=r.x,c.y=r.y,c.target=l,egret.Tween.get(c).to({x:u.x,y:u.y,rotation:360*Math.random()},i?500:0,egret.Ease.quadOut).call(p)})}))}))}return[]})).then(function(t){t.reduce(function(t,e){return t.concat(e)}).reduce(function(t,e){return t.concat(e)},[]).forEach(function(t){t.chip.target.addChild(t.chip),t.chip.target=null,t.chip.x=t.endPos.x,t.chip.y=t.endPos.y}),n.shot()})},o.prototype.getChipPos=function(t){var e=this.chipAreas[t].localToGlobal();return{x:e.x+util.NumberUtil.getRandom(38,this.chipAreas[t].width-38),y:e.y+util.NumberUtil.getRandom(37.5,this.chipAreas[t].height-37.5)}},o.prototype.getFlyChipList=function(t){for(var e=[],i=this.defaultChips.length-1;i>=0;i--){var n=Math.floor(t/this.defaultChips[i]);t%=this.defaultChips[i],e.push(n)}return e.reverse()},o.prototype.showBetHintAni=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,o,r=this;return __generator(this,function(s){switch(s.label){case 0:return[4,this.db_bet_tip.play("horoscope_"+t+"_betting")];case 1:return e=s.sent(),i=e.armature.getSlot("font"),n=RES.getRes("ho_font_"+t+"_betting_png"),o=new egret.Bitmap(n),o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,i.setDisplay(o),i.invalidUpdate(),this.db_bet_tip.visible=!0,this.db_bet_tip.once(egret.Event.LOOP_COMPLETE,function(){r.db_bet_tip.stop(!0),r.db_bet_tip.visible=!1},this),[2]}})})},o.prototype.dealAllCard=function(t){var e=this;void 0===t&&(t=!0),egret.Tween.removeTweens(this.group_chipAni),this.pokerAni.init();for(var i=0;5>i;i++)this.initPokerList(i);for(var n=egret.Tween.get(this.group_chipAni),o=function(i){n.call(function(){e.dealCard(i,t)}).wait(t?200:0)},i=0;5>i;i++)o(i);n.wait(t?500:0).call(function(){e.pokerAni.hidePoker()})},o.prototype.dealCard=function(t,e,i){return void 0===e&&(e=!0),__awaiter(this,void 0,void 0,function(){var n,o,r;return __generator(this,function(s){switch(s.label){case 0:return n=t?this["com_pokerlist"+t]:this.com_bankerFrame.getPokerList(),n.visible=!1,o=e,o?[4,this.pokerAni.flyCard(t,n.getTopCardPos())]:[3,2];case 1:o=s.sent(),s.label=2;case 2:return this.pokerAni.hidePoker(t),n.visible=!0,i&&n.setCards(i),e?[4,n.dealCardAni()]:[3,4];case 3:return r=s.sent(),[3,5];case 4:r=n.dealCardAni(!1),s.label=5;case 5:return[2]}})})},o.prototype.initPokerList=function(t){if("number"==typeof t){var e=t?this["com_pokerlist"+t]:this.com_bankerFrame.getPokerList();e.init(),e.visible=!1}else for(var i=0;5>i;i++){var e=i?this["com_pokerlist"+i]:this.com_bankerFrame.getPokerList();e.init(),e.visible=!1}},o.prototype.turnCards=function(t,e,i,n){var o=this;return void 0===n&&(n=!0),new Promise(function(r){return __awaiter(o,void 0,void 0,function(){var o;return __generator(this,function(s){switch(s.label){case 0:return o=t?this["com_pokerlist"+t]:this.com_bankerFrame.getPokerList(),o.visible=!0,o.init(),util.LogUtil.warn(this.topBar.bVal+" => turn seat "+t+" cards "+JSON.stringify(e)),[4,o.showResult(e,n)];case 1:return s.sent(),0===t&&i&&this.pokersShowTimes(),r(),[2]}})})})},o.prototype.pokersShowTimes=function(){var t=this;[1,2,3,4].forEach(function(e){return t["com_pokerlist"+e].showTimes()})},o.prototype.onRemove=function(){this.db_girl.stop(!0),this.com_countDown.clearTimer(),this.initUI(),util.SoundUtil.destroy(this.com_pokerlist1.getResultSoundList())},o.prototype.updatelimit=function(t){var e=this;this.limit.min=t.min,this.limit.max=t.max;var i=Math.min.apply(Math,Object.keys(this.limit.min).map(function(t){return e.limit.min[t]})),n=Math.max.apply(Math,Object.keys(this.limit.max).map(function(t){return e.limit.max[t]}));this.topBar.aVal=util.NumberUtil.formatUnit(i)+"-"+util.NumberUtil.formatUnit(n)},o}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.horoscope.RoomUI")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomIds=["LI1","LI2"],e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),i.prototype.playAni=function(t){t?[{db:this.db_LF1,name:"lieng_room1"},{db:this.db_LF2,name:"lieng_room2"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())}):[this.db_LF1,this.db_LF2].forEach(function(t){return t.stop()})},i.prototype.updataNumber=function(){if(this.room1Number){var t=Data.getTopic(Const.Topic.ONLINE).snapshot;this.room1Number.text=(t.base_room_count.LI1||0)+(t.room_count.LI1||0),this.room2Number.text=(t.base_room_count.LI2||0)+(t.room_count.LI2||0)}},i.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),[this.LI1_Group,this.LI2_Group].forEach(function(t){return t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.selected=t.name,i.updataRooms(),e.dialog.EnterRoomDialog.instance.show(),e.dialog.EnterRoomDialog.instance.roomName=t.name},i)}),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return i.playAni(!1)},this)},i.prototype.init=function(){this.playAni(!0),this.updateHallData(this.roomsData),this.updataNumber()},i.prototype.updataRooms=function(){if(this.selected){var t=util.NumberUtil.formatNumber(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance).split(","),i="";t.forEach(function(t){i+=t});var n=100*Number(i),o=this.dealData(n/7),r=[];o.forEach(function(t,e){var i={ante:util.NumberUtil.formatUnit(t,1,1e3,["","K","M"]),admittance:util.NumberUtil.formatUnit(7*t,1,1e3,["","K","M"]),disabled:7*t>n,selected:0===e,bet_limit:t};r.push(i)}),e.dialog.EnterRoomDialog.instance.setData(r)}},i.prototype.dealData=function(t){var e=this.dataDeal[this.selected].bet_limit.chips,i=[];e.forEach(function(t){i.push(Number(t))});for(var n=0,o=i.length;o>n&&!(i[n]>t);n++);for(var r=[],s=n-1;s>=0&&r.length<6;s--)r.push(i[s]);if(r=r.reverse(),r.length<6)for(var s=n;r.length<6;s++)r.push(i[s]);return r},i.prototype.updateHallDatas=function(t){this.roomsData=t,this.LI1_Group&&this.updateHallData(t)},i.prototype.updateHallData=function(t){var e=this;[this.LI1_Group,this.LI2_Group].forEach(function(t){t.visible=!1,t.includeInLayout=!1}),this.dataDeal={},t.forEach(function(t){e.dataDeal[t.room_id]=t,e[t.room_id+"_Group"].name=t.room_id,e[t.room_id+"_Group"].visible=!0,e[t.room_id+"_Group"].includeInLayout=!0}),this.updataRooms()},i}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.lieng.Hall");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.invalidateState()},e.prototype.getCurrentState=function(){var t="normal";return this.data&&(this.data.disabled?t="disabled":this.data.selected&&(t="selected")),t},e}(eui.ItemRenderer);e.RateListItem=n,__reflect(n.prototype,"ui.lieng.RateListItem")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){}return t}();__reflect(i.prototype,"PlayerFrame");var n=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.length=6,e._type="six",e.sendDeal=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FIGHT)},e.getNetPosition=function(t){return(t+e.my_position-1)%e.size||e.size},e.getLocalPosition=function(t){return(t-e.my_position+e.size+1)%e.size||e.size},e.getDeskData=function(){var t="/lieng_desk/"+e.desk_id;return util.LogUtil.debug("lieng roomUI [getDeskData] topic => "+t),Data.getTopic(t)},e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e.hideUI=function(t){return e.main.contains(t)&&e.main.removeChild(t)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e.showUI=function(t){return e.main.addChild(t)},e.hideUIS=function(t){return t.forEach(function(t){return e.main.contains(t)&&e.main.removeChild(t)})},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),i.prototype.getCurrentState=function(){return t.prototype.getCurrentState.call(this)+"_"+this.type},i.prototype.childrenCreated=function(){var e=this;this.initView(),t.prototype.childrenCreated.call(this),Const.Config.DESK_LOGO&&(this.img_logo.source=Const.Config.DESK_LOGO),this.proMatch(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.btnMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH),e.hideUI(e.btnMatch)
},this)},i.prototype.initView=function(){this.pokerAni=new e.PokerAni(this.pokerAniGroup),this.players=[];for(var t=1;7>t;t++)this.players.push({player:this["player"+t],pokerList:this["poker"+t],winLoseInfo:this["result"+t],betInfo:this["raise"+t]});this.chips=new e.Chips(this.chipsGroup,this.glodNum)},i.prototype.initUI=function(){this.type=6===this.length?"six":"four",this.pokerAni&&this.proMatch(),this.initMyinfo(),this.autoMatch.setselected(!0),this.winAni.addEventListener(egret.Event.COMPLETE,this.WinAniCall,this)},i.prototype.WinAniCall=function(){this.hideUI(this.winAni)},i.prototype.removeFromStage=function(){this.winAni.removeEventListener(egret.Event.COMPLETE,this.WinAniCall,this)},i.prototype.playWinAni=function(){this.showUI(this.winAni),this.winAni.play("baicai_win",null,0,1)},i.prototype.proMatch=function(){var t=this;this.pokerAni.init(),this.hideUI(this.btnMatch),this.players.forEach(function(e,i){i<t.length&&(0!==i&&(e.player.visible=!1),e.player.init(),e.pokerList.init(),e.betInfo.visible=!1,egret.Tween.removeTweens(e.winLoseInfo),e.winLoseInfo.text="")}),this.pokerAniGroup.visible=!1,this.operatBtns.init(),this.operatBtns.visible=!1,this.hideUI(this.autoMatch),this.my_position=0,this.betData={1:{raise:0,op:"none"},2:{raise:0,op:"none"},3:{raise:0,op:"none"},4:{raise:0,op:"none"},5:{raise:0,op:"none"},6:{raise:0,op:"none"}},this.chips.init(),this.glodGroup.visible=!1,this.hideUI(this.winAni),this.isbegin=!0,this.timeOutId&&util.TimeUtil.clearTimeout(this.timeOutId),this.timeOutId=void 0},i.prototype.initData=function(){util.LogUtil.debug("[lieng] [initData]");var t=this.getDeskData();Data.validate(topic.liengSchema,t);var e=t.snapshot;if(this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatNumber(this.ante||e.bet_limit.ante),this.chips.setAnte(this.ante||e.bet_limit.ante),this.topBar.bVal=this.desk_id,e&&e.stage&&"none"!==e.stage.toLowerCase()){this.length="LI1"===e.room_setting.room_id?6:4,this.type=6===this.length?"six":"four",LiengController.instance.enter_room_args={ante:e.bet_limit.ante},this.glodGroup.visible=!0,this.updatePlayerInfo(),util.LogUtil.info("[lieng] [initData] reconnect successfully!"),util.LogUtil.info("[lieng] [initData] my_position => "+this.my_position),util.LogUtil.info("[lieng] [initData] snapshot => "+JSON.stringify(e));for(var i=0;i<this.size;i++)this.players[i].pokerList.showAllPokers(0===i?e.fight[this.my_position].cards:[void 0,void 0,void 0]);this.setChipsNum(e),this.updateBet(!1),"deal"!==e.stage.toLowerCase()&&this.playerturn(Number(e.stage))}},i.prototype.initMyinfo=function(){var t={avatar:Const.UserInfo.AVATAR,username:Const.UserInfo.NICK,balance:Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance};this.player1.userInfo=t},i.prototype.playerturn=function(t,e){void 0===e&&(e=!1);var i=this.getDeskData().snapshot,n=this.getLocalPosition(t)-1;util.LogUtil.info("[lieng] [playerturn] It's "+i.user_info[t].username+" 's turn. pos=>"+n);for(var o=0;o<this.size;o++)this.players[o].player.stopCountDown();this.players[n].player.countDown(i.stage_timestamp,i.stage_timestamp+i.room_setting.time.op),this.operatBtns.visible=!this.poker1.isOver,this.operatBtns.trunChange(this.my_position===t),this.players[n].betInfo.visible=!1,this.my_position===t&&(this.operatBtns.setDate(i.raise_rate_options),this.operatBtns.setMaxBet(i.max_bet)),this.betData[t].raise=0},i.prototype.sendPoker=function(){return __awaiter(this,void 0,void 0,function(){var t,t,e,t,i,n;return __generator(this,function(o){switch(o.label){case 0:for(util.LogUtil.info("[lieng] [sendPoker]"),this.pokerAniGroup.visible=!0,this.glodGroup.visible=!0,t=0;t<this.size;t++)this.jump(this.players[t].player);for(t=0;t<this.size;t++)this.chips.flyChipsToDesk(this.players[t].player.getHeadGlobalPosition(),this.ante);return util.SoundUtil.play("fp_mp3"),this.pokerAni.shuffle(),[4,this.sleep(800)];case 1:o.sent(),e=Math.floor(Math.random()*this.size),t=0,o.label=2;case 2:return t<3*this.size?(i=(t+e)%this.size,[4,this.sendAPoker(this.players[i].pokerList,i)]):[3,5];case 3:o.sent(),o.label=4;case 4:return t++,[3,2];case 5:for(this.pokerAniGroup.visible=!1,util.SoundUtil.play("fanpai_mp3"),n=0;n<this.size;n++)this.players[n].pokerList.tweenMove();return[2]}})})},i.prototype.sendAPoker=function(t,e){var i=this;return new Promise(function(e){var n=t.getGlobalPostion();util.SoundUtil.play("bet1_mp3"),i.pokerAni.flyCard(n,function(){t.sendSuccess()}),util.TimeUtil.setTimeout(e,10)})},i.prototype.setChipsNum=function(t){var e=this,i=t.total_bet;Object.keys(t.op_info).forEach(function(n){e.getLocalPosition(Number(n));"bet"!==t.op_info[n].op&&"none"!==t.op_info[n].op&&(i-=t.op_info[n].raise)}),this.chips.setNow(i)},i.prototype.registerEvent=function(){},i.prototype.onRemoveStage=function(){this.main.removeEventListener(egret.Event.RESIZE,this.resize,this)},i.prototype.resize=function(){Main.instance.orientation===egret.OrientationMode.PORTRAIT},i.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_USER_INFO:break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_CANCEL_MATCH:this.autoMatch.setAutoMatch(!1),this.showUI(this.autoMatch);break;case Const.UICommand.CMD_CONTINUE_MATCH:this.proMatch();break;case Const.UICommand.CMD_UPDATE_BET:this.updateBet();break;case Const.UICommand.CMD_UPDATE_SETTLE:this.updateSettle();break;case Const.UICommand.CMD_LEAVE_DESK:this.autoMatch.clearInterval()}},i.prototype.updateBet=function(t){var e=this;void 0===t&&(t=!0);var i=this.getDeskData().snapshot;Object.keys(i.op_info).forEach(function(n){var o=e.getLocalPosition(Number(n)),r=i.op_info[n],s=e.players[o-1],a=e.betData[n];if((r.raise!==a.raise||r.op!==a.op)&&(a.raise=r.raise,a.op=r.op,!s.pokerList.isOver)){if("none"===r.op)return;switch(util.LogUtil.info("[lieng] [updateBet] pos=>"+o+" "+i.user_info[n].username+"'s op_info=> "+JSON.stringify(r)),e.chips.flyChipsToDesk(s.player.getHeadGlobalPosition(),r.raise),s.player.tweenBalance(i.user_info[n].balance),r.op){case"raise":case"call":e.jump(s.player),t&&util.SoundUtil.play("Chips_mp3"),s.betInfo.visible=!0,s.betInfo.bet(r.raise);break;case"all_in":e.jump(s.player),t&&util.SoundUtil.play("Chips_mp3"),s.betInfo.visible=!0,s.betInfo.bet();break;case"quit":s.pokerList.giveUp(),s.betInfo.visible=!1,1===o&&(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),e.showUI(e.btnMatch))}}})},i.prototype.jump=function(t){egret.Tween.removeTweens(t),t.y=0,egret.Tween.get(t).to({verticalCenter:-15},80,egret.Ease.quadOut).to({verticalCenter:0},80,egret.Ease.quadIn)},i.prototype.updatePlayerInfo=function(){var t=this,e=this.getDeskData().snapshot;if(e){var i=e.user_info;this.size=Object.keys(i).length,0===this.my_position&&Object.keys(i).forEach(function(e){var n=i[e];n.user_id===""+Const.UserInfo.USER_ID&&(t.my_position=Number(e))}),Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e)),r=t.players[o-1].player;r.visible=!0,Number(e)===t.my_position&&(n.username=r.userInfo.username),r.userInfo=n})}},i.prototype.updateStage=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n=this;return __generator(this,function(o){switch(o.label){case 0:switch(t=this.getDeskData().snapshot,e=t.stage.toString().toLowerCase()){case"deal":return[3,1];case"1":return[3,2];case"2":return[3,2];case"3":return[3,2];case"4":return[3,2];case"5":return[3,2];case"6":return[3,2];case"settle":return[3,3]}return[3,5];case 1:return this.updatePlayerInfo(),this.poker1.cards=t.fight[this.my_position].cards,this.sendPoker(),util.LogUtil.info("[lieng] [updateStage] myCards => "+t.fight[this.my_position].cards),[3,5];case 2:return this.playerturn(Number(t.stage)),[3,5];case 3:for(this.operatBtns.visible=!1,i=0;i<this.size;i++)this.players[i].player.stopCountDown();return[4,this.surplus()];case 4:return o.sent(),this.timeOutId=util.TimeUtil.setTimeout(function(){n.hideUI(n.btnMatch),n.autoMatch.parent||(n.showUI(n.autoMatch),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM)),n.timeOutId=void 0},6e3),[3,5];case 5:return[2]}})})},i.prototype.updateSettle=function(){var t=this,e=this.getDeskData().snapshot,i=[];Object.keys(e.settle).forEach(function(n){var o=t.getLocalPosition(Number(n)),r=t.players[o-1],s=e.settle[n].surplus;r.player.tweenBalance(e.user_info[n].balance),s>0?(r.player.shakeAvatar(),1===o&&(util.SoundUtil.play("win_mp3"),t.playWinAni()),r.pokerList.playwinAni(),i.push(r.player.getHeadGlobalPosition()),r.winLoseInfo.scoreAni(2e3,s)):(r.winLoseInfo.setScore(s),1===o&&0>s&&util.SoundUtil.play("dissapoint_mp3"))}),this.chips.getReward(i)},i.prototype.surplus=function(){var t=this,e=this.getDeskData().snapshot;util.LogUtil.info("[lieng] [surplus] my_position => "+this.my_position),util.LogUtil.warn("[lieng] [surplus] surplus => "+JSON.stringify(e.fight)),Object.keys(e.fight).forEach(function(i){var n=t.getLocalPosition(Number(i)),o=t.players[n-1],r=e.fight;1!==n&&r&&r[i].cards&&o.pokerList.showResult(r[i].cards)})},i}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.lieng.RoomUI")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ROOM_ID_MAP={PG1:"xinshoufang",PG2:"chujifang",PG3:"zhongjifang",PG4:"gaojifang",PG5:"zhizunfang",PG6:"wangzhefang"},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.playAni=function(t){t?(this.db_girl.play("pg_girl"),[{db:this.btn_xinshoufang.getChildAt(0).getChildAt(1),name:"pg_room1"},{db:this.btn_chujifang.getChildAt(0).getChildAt(1),name:"pg_room2"},{db:this.btn_zhongjifang.getChildAt(0).getChildAt(1),name:"pg_room3"},{db:this.btn_gaojifang.getChildAt(0).getChildAt(1),name:"pg_room4"},{db:this.btn_zhizunfang.getChildAt(0).getChildAt(1),name:"pg_room5"},{db:this.btn_wangzhefang.getChildAt(0).getChildAt(1),name:"pg_room6"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())})):(this.db_girl.stop(),[this.btn_xinshoufang.getChildAt(0).getChildAt(1),this.btn_chujifang.getChildAt(0).getChildAt(1),this.btn_zhongjifang.getChildAt(0).getChildAt(1),this.btn_gaojifang.getChildAt(0).getChildAt(1),this.btn_zhizunfang.getChildAt(0).getChildAt(1),this.btn_wangzhefang.getChildAt(0).getChildAt(1)].forEach(function(t){return t.stop()}))},e.prototype.registerEvent=function(){var t=this;[this.gp_xinshoufang,this.gp_chujifang,this.gp_zhongjifang,this.gp_gaojifang,this.gp_zhizunfang,this.gp_wangzhefang].forEach(function(e){return e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.name)},t)}),this.addEventListener(eui.UIEvent.ADDED,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(eui.UIEvent.ADDED_TO_STAGE,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.playAni(!1)},this)},e.prototype.updateHallDatas=function(t){this.rooms=t,this.gp_xinshoufang&&this.updateData(t)},e.prototype.updateData=function(t){var e=this;Object.keys(this.ROOM_ID_MAP).forEach(function(t){e["gp_"+e.ROOM_ID_MAP[t]].visible=!1,e["gp_"+e.ROOM_ID_MAP[t]].includeInLayout=!1}),t.forEach(function(t){var i=t.room_id;e["gp_"+e.ROOM_ID_MAP[i]].visible=!0,e["gp_"+e.ROOM_ID_MAP[i]].includeInLayout=!0,e["gp_"+e.ROOM_ID_MAP[i]].name=i,e["btn_"+e.ROOM_ID_MAP[i]].getChildAt(0).getChildAt(4).text=util.NumberUtil.formatUnit(t.bet_limit.ante),e["btn_"+e.ROOM_ID_MAP[i]].getChildAt(0).getChildAt(6).text=util.NumberUtil.formatUnit(t.bet_limit.admittance)})},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.paigow.Hall")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){}return t}();e.SummaryData=i,__reflect(i.prototype,"ui.paigow.SummaryData");var n=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.com_pokers=[],e.com_frames=[],e.new_uis=[],e.doBankerAni=!1,e.timeout=[],e.canSendMatchNotify=!0,e.updateBalance=!0,e.showUI=function(t){return e.main.addChild(t)},e.hideUIS=function(t){return t.forEach(function(t){return e.main.contains(t)&&e.main.removeChild(t)})},e.changeCurOrientationMode=function(t){e.new_uis.forEach(function(e){return e.resetMode(t.data)})},e.getNetPosition=function(t){return(t+e.my_position-1)%4||4},e.getLocalPosition=function(t){return(t+4-e.my_position+1)%4||4},e.getDeskData=function(){return Data.getTopic("/pg_desk/"+e.desk_id)},e._sendDispute=function(t){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DISPUTE,{my_position:e.my_position,rate:t.data}),e.player_frame1.setBet(t.data)},e._sendRaise=function(t){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,{my_position:e.my_position,rate:t.data}),e.player_frame1.setRaise(t.data)},e.count_down=function(t,i){e.showUI(e.countdown),e.countdown.show(t,i)},e.flaychip=function(t,i,n){return e.chips.flyChip(t,i,25)},e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e}return __extends(n,t),Object.defineProperty(n,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"desk_id",{get:function(){return this._desk_id},set:function(t){this._desk_id=t},enumerable:!0,configurable:!0}),n.prototype.initUI=function(){this.init(),this.initOwnUserInfo(),this.registUIEventListener(),this.changeCurOrientationMode({data:Main.instance.orientation})},n.prototype.initOwnUserInfo=function(){this.player_frame1.visible=!0,this.player_frame1.setName(Const.UserInfo.NICK),this.player_frame1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance),this.player_frame1.setHead(Const.UserInfo.AVATAR)},n.prototype.init=function(){var t=this;this.is_init||(this.is_init=!0,[1,2,3,4].forEach(function(e){t.com_pokers.push(t["com_pokerlist"+e]),t.com_frames.push(t["player_frame"+e])}),this.player_frame2.visible=!1,this.player_frame3.visible=!1,this.player_frame4.visible=!1,this.beginAni=new e.BeginAni,this.robAni=new e.RobAni,this.diceAni=new e.DiceAni,this.chips=new e.Chips(this.main),this.settleDialog=new e.dialog.SettleDialog,this.new_uis=[this.beginAni,this.hog_btns,this.mult_btns,this.countdown,this.robAni,this.matchBtn],this.hideUIS(this.new_uis),this.timeout.forEach(function(t){return util.TimeUtil.clearTimeout(t)}),this.timeout.splice(0))},n.prototype.initData=function(){this.gp_wait_raise.visible=!1,this.seecard.recoverMask(),this.my_position=0,this.matchBtn.visible=!1,this.next_time.visible=!1,this.is_banker=!1,this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this._desk_id,this.updateBalance=!0,this.updateUserInfo();var t=this.getDeskData();Data.validate(topic.paigowSchema,t);var i=t.snapshot;switch(this.deskinfo.setRound(i.desk_info.round),this.seeCardDataRecoverd(i),i&&i.desk_info.stage&&"init"!==i.desk_info.stage.toLowerCase()&&"none"!==i.desk_info.stage.toLowerCase()&&(util.LogUtil.info("[paigow] [initData] reconnect successfully!"),util.LogUtil.info("[paigow] [initData] my_position => "+this.my_position),util.LogUtil.info("[paigow] [initData] snapshot => "+JSON.stringify(i))),i.desk_info.stage.toLowerCase()){case"dispute":var n=i.dispute.desk[this.my_position];this.next_time.visible=!1,this.doBankerAni=!1,this.is_banker=!1,this.count_down(i.dispute.stage_timestamp,Number(i.room_setting.time.dispute)),n.is_done||(this.showUI(this.hog_btns),this.main.addChildAt(this.seecard,99),this.hog_btns.init(i.dispute.desk[1].rate_options.map(Number)),this.hog_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,this._sendDispute,this),this.hog_btns.once(e.MultButtonsBase.EVT_SEND_MULT,this._sendDispute,this)),this.updateDispute();break;case"raise":var o=this.getLocalPosition(Number(i.desk_info.banker_position)),r=this.com_frames[o-1];if(r.showSnatch(!0),r.showBanker(!0),this.updateRaise(),r.setBet(i.dispute.desk[i.desk_info.banker_position].rate),o!==this.my_position){var s=i.raise.desk[this.my_position];s.is_done||(this.mult_btns.visible=!0,this.showUI(this.mult_btns),this.main.addChildAt(this.seecard,99),this.mult_btns.init(i.raise.desk[this.my_position].rate_options,this.ante,i.dispute.desk[o].rate),this.mult_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,this._sendRaise,this),this.mult_btns.once(e.MultButtonsBase.EVT_SEND_MULT,this._sendRaise,this))}else this.gp_wait_raise.visible=!0;this.count_down(i.raise.stage_timestamp,Number(i.room_setting.time.raise)+1e3);break;case"settle":case"end":var a=this.getLocalPosition(Number(i.desk_info.banker_position)),l=this.com_frames[a-1];l.showSnatch(!0),l.showBanker(!0),l.setBet(i.dispute.desk[i.desk_info.banker_position].rate),this.updateRaise(),this.showAllInfo(i)}},n.prototype.showAllInfo=function(t){var e=this;[1,2,3,4].forEach(function(i){var n=e.getLocalPosition(i),o=t.settle.desk[i],r=e.com_frames[n-1];r.pokerList.setCardType(o.cards_info.cards_type,o.cards_info.cards,o.cards_info.result,!0),r.showSurplus(!0,o.surplus)}),"end"===t.desk_info.stage.toLowerCase()?this.showSettle(t):this.startCountDown()},n.prototype.seeCardDataRecoverd=function(t){var e=this;if(t.summary[1]){var i=t.summary[1],n=[];Object.keys(i).forEach(function(t){i[t].cardInfo&&n.concat.apply(n,i[t].cardInfo.cards)}),n.forEach(function(t){return e.seecard.setMask(t)})}},n.prototype.registerEvent=function(){var t=this;this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.status_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.seecard.visible=!t.seecard.visible},this)},n.prototype.registUIEventListener=function(){this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.changeCurOrientationMode,this)},n.prototype.removeFromStage=function(){this.changeStageHideUIS(),this.stage.removeEventListener(Main.EVT_ORIENTATION_CHANGE,this.changeCurOrientationMode,this)},n.prototype.updateUserInfo=function(){var t=this,e=this.getDeskData().snapshot;e.user_info&&(0===this.my_position&&Object.keys(e.user_info).forEach(function(i){var n=e.user_info[i];n.user_id===""+Const.UserInfo.USER_ID&&(t.my_position=Number(i),util.LogUtil.info("[paigow] [updateUserInfo] my_position => "+t.my_position))}),Object.keys(e.user_info).forEach(function(i){var n=e.user_info[i],o=t.getLocalPosition(Number(i)),r=t["player_frame"+o];t.getDeskData().snapshot.desk_info.stage;n.username?(r.visible=!0,1!==o&&(r.setName(n.username),r.setHead(n.avatar)),t.updateBalance&&r.setBalance(n.balance)):(r.visible=!1,r.initHead())}))},n.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_ROOM_SETTING:this.updateRoomSetting();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_UPDATE_USER_INFO:this.getDeskData().snapshot.desk_info.stage.toLowerCase();this.updateUserInfo();break;case Const.UICommand.CMD_UPDATE_DISPUTE:this.updateDispute();break;case Const.UICommand.CMD_UPDATE_RAISE:this.updateRaise();break;case Const.UICommand.CMD_UPDATE_SETTLE:break;case Const.UICommand.CMD_CONTINUE_MATCH:this.beforeContinueMatch();break;case Const.UICommand.CMD_CANCEL_MATCH:this.showUI(this.matchBtn),this.main.addChildAt(this.seecard,99),this.matchBtn.visible=!0,this.deskinfo.setRound(0),this.initPlayers();break;case Const.UICommand.CMD_LEAVE_DESK:}},n.prototype.beforeContinueMatch=function(){this.initPlayers()},n.prototype.updateRoomSetting=function(){},n.prototype.initPlayers=function(){var t=this;[1,2,3,4].forEach(function(e){var i=(t.com_pokers[e-1],t.com_frames[e-1]);i.visible=1===e,i.pokerList.visible=!1,i.group_bet.visible=!1,i.group_banker.visible=!1,i.initHead(),i.hideBet(),i.hideSurplus(),i.showSurplus(!1),i.showBanker(!1),i.showSnatch(!1)}),this.seecard.visible=!1,this.gp_wait_raise.visible=!1},n.prototype.updateStage=function(){var t=this;this.hideUIS(this.new_uis);var i=this.getDeskData().snapshot;switch(this.deskinfo.setRound(i.desk_info.round),this.updateBalance=!0,i.desk_info.stage.toLowerCase()){case"dispute":util.LogUtil.info("[paigow] [updateStage] dispute"),this.timeout.forEach(function(t){return util.TimeUtil.clearTimeout(t)}),this.timeout.length=0,this.rest(),this.next_time.visible=!1,this.doBankerAni=!1,this.is_banker=!1,this.com_frames.forEach(function(t){t.pokerList.visible=!1,t.group_bet.visible=!1,t.group_banker.visible=!1,t.hideBet(),t.showBanker(!1),t.showSnatch(!1),t.hideSurplus()}),this.showUI(this.beginAni),util.SoundUtil.play("nn_gamestart_mp3"),this.beginAni.once(e.BeginAni.EVT_SHOW_BTN,function(){util.LogUtil.info("[paigow] [beginAni] callback => "+t.getDeskData().snapshot.desk_info.stage),"dispute"===t.getDeskData().snapshot.desk_info.stage&&(t.showUI(t.robAni),util.SoundUtil.play("qzpj_qiangzhuang_mp3"),t.robAni.once(e.RobAni.EVT_SHOW_BTN,function(){util.LogUtil.info("[paigow] [robAni] callback => "+t.getDeskData().snapshot.desk_info.stage),"dispute"===t.getDeskData().snapshot.desk_info.stage&&(t.showUI(t.hog_btns),t.main.addChildAt(t.seecard,99),t.hog_btns.init(i.dispute.desk[1].rate_options.map(Number)),t.hog_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,t._sendDispute,t),t.hog_btns.once(e.MultButtonsBase.EVT_SEND_MULT,t._sendDispute,t),t.count_down(i.dispute.stage_timestamp,Number(i.room_setting.time.dispute)))},t))},this);break;case"raise":util.LogUtil.info("[paigow] [updateStage] raise"),this.rest(),this.updateDeskInfo(),egret.Tween.get(this).wait(1e3).call(function(){1!==t.getLocalPosition(Number(t.getDeskData().snapshot.desk_info.banker_position))?(util.SoundUtil.play("qzpj_begin_bet_mp3"),t.mult_btns.visible=!0,t.showUI(t.mult_btns),t.main.addChildAt(t.seecard,99),t.mult_btns.init(i.raise.desk[1].rate_options.map(Number),t.ante,t.cur_banker_rate),t.mult_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,t._sendRaise,t),t.mult_btns.once(e.MultButtonsBase.EVT_SEND_MULT,t._sendRaise,t)):t.gp_wait_raise.visible=!0,t.count_down(i.raise.stage_timestamp,Number(i.room_setting.time.raise)+1e3)});break;case"settle":case"end":this.updateBalance=!1,util.LogUtil.info("[paigow] [updateStage] settle or end"),this.rest(),this.gp_wait_raise.visible=!1,this.countdown.visible=!1,this.mult_btns.visible=!1,this.showUI(this.diceAni),this.diceAni.setDice(i.desk_info.init_dice),this.diceAni.once(e.DiceAni.EVT_SHOW_BTN,function(){var e=i.desk_info.init_dice;t.sum(e)},this)}},n.prototype.updateDispute=function(){var t=this,e=this.getDeskData().snapshot;Object.keys(e.dispute.desk).forEach(function(i){var n=t.getLocalPosition(Number(i)),o=t["player_frame"+n],r=e.dispute.desk[i].rate;"0"!==r.toString()&&(o.setBet(r),util.LogUtil.info("[paigow] [updateDispute] net_position => "+i+" local_position => "+n+" "+e.user_info[i].username+" bet=>"+r))})},n.prototype.updateDeskInfo=function(){var t=this;this.hog_btns.visible=!1;var e=this.getDeskData().snapshot.desk_info,i=(this.getDeskData().snapshot,0),n=0;if(e.banker_position){var o=e.banker_position;n=o,Object.keys(this.getDeskData().snapshot.dispute.desk).forEach(function(e){var n=t.getLocalPosition(Number(e));t["player_frame"+n],t["player_frame"+o];i=t.getDeskData().snapshot.dispute.desk[o].rate,t.cur_banker_rate=i})}if(i){var r=[];if(Object.keys(this.getDeskData().snapshot.dispute.desk).forEach(function(e){var n=t.getDeskData().snapshot.dispute.desk[e].rate,o=t.getLocalPosition(Number(e));i===n&&r.push(o)}),util.LogUtil.info("[paigow] [updateDeskInfo] candidateList =>"+r+"  banker_pos =>"+n),r.length>1)this.is_banker===!1&&this.playFrameAni(r,n);else{var s=this["player_frame"+n];if(util.SoundUtil.play("nn_banker_mp3"),s.group_banker.visible===!0)return;this.shinyThreeTimes(n)}}},n.prototype.updateRaise=function(){var t=this,e=this.getDeskData().snapshot;Object.keys(e.raise.desk).forEach(function(i){var n=t.getLocalPosition(Number(i)),o=t["player_frame"+n],r=e.raise.desk[i].rate;if("string"==typeof r&&(r=Number(r)),"0"!==r.toString()&&!o.group_bet.visible){if(t.getLocalPosition(Number(t.getDeskData().snapshot.desk_info.banker_position))===n)return;o.setRaise(r),util.LogUtil.info("[paigow] [updateRaise] "+e.user_info[i].username+" raise =>"+r)}})},n.prototype.surplusAni=function(){var t=this,e=this.getDeskData().snapshot.settle;Object.keys(e).forEach(function(i){var n=e[i],o=t.getLocalPosition(Number(i)),r=t["player_frame"+o];1===o&&n.surplus>0&&util.SoundUtil.play("nn_scrollnumber_mp3"),r.showSurplus(!0,n.surplus)})},n.prototype.changeStageHideUIS=function(){this.settleDialog.visible=!1,this.gp_wait_raise.visible&&(this.gp_wait_raise.visible=!1)},n.prototype.playFrameAni=function(t,e){var i=this;this.is_banker=!0,egret.Tween.removeTweens(this.player_frame1);var n=15;n=n-n%t.length+t.indexOf(e)+1;var o=egret.Tween.get(this.player_frame1);Array.apply(void 0,Array(n)).forEach(function(e,n){var r=n*n*n/15;o.call(function(){var e=n%t.length;i["player_frame"+t[0===e?t.length-1:e-1]].showSnatch(!1);var o=i["player_frame"+t[e]];util.SoundUtil.play("nn_bankerrun_mp3"),o.showSnatch(!0)}).wait(r)}),o.call(function(){i.player_frame1.showSnatch(!1),i.player_frame2.showSnatch(!1),i.player_frame3.showSnatch(!1),i.player_frame4.showSnatch(!1),util.SoundUtil.play("nn_banker_mp3"),i.shinyThreeTimes(e)})},n.prototype.shinyThreeTimes=function(t){egret.Tween.removeTweens(this.player_frame1);var e=this.com_frames[t-1],i=egret.Tween.get(this.player_frame1);[1,2,3,4,5,6,7].forEach(function(t,n){var o=50*n;i.call(function(){var t=n%2===0;e.showSnatch(t)}).wait(o)}),i.call(function(){e.showBanker(!0)})},n.prototype.sum=function(t){for(var e=0,i=t.length-1;i>=0;i--)e+=t[i];this.sendPokerAni(e)},n.prototype.sendPokerAni=function(t){var e=this;this.mult_btns.visible=!1;var i=egret.Tween.get(this),n=this.getLocalPosition(Number(this.getDeskData().snapshot.desk_info.banker_position)),o=(t%4+2+n)%4+1;this["player_frame"+o].showArrow();for(var r=1;4>=r;r++)this["player_frame"+r].pokerList.visible=!1,this["player_frame"+r].pokerList.poker_1.img_poker.source="",this["player_frame"+r].pokerList.poker_2.img_poker.source="",this["player_frame"+r].pokerList.card_type.source="",this["player_frame"+r].pokerList.bg1.source="",this["player_frame"+r].pokerList.bg2.source="",this["player_frame"+r].pokerList.bg3.source="";for(var s=function(t){var n=0;n=0>t?t+5:(3+t)%4+1,a["player_frame"+n].pokerList.visible=!0,i.call(function(){e["player_frame"+n].pokerList.poker_1.setCard(0)}).wait(300).call(function(){e["player_frame"+n].pokerList.poker_2.setCard(0)}).wait(300)},a=this,r=o;r>o-5;r--)s(r);this.showPokerListAni(this.getDeskData().snapshot.desk_info.deal_first,i)},n.prototype.showPokerListAni=function(t,e){for(var i=this,n=(this.getDeskData().snapshot.desk_info,function(n){var r=0;r=n+t>4?(n+t)%4:n+t;var s=o.getDeskData().snapshot.settle.desk[o.getNetPosition(r)].cards_info;util.LogUtil.info("[paigow] [showPokerListAni] local_position =>"+r+" cardInfo=>"+JSON.stringify(s)),e.call(function(){i["player_frame"+r].pokerList.poker_1.setCard(s.cards[0]),i.seecard.setMask(s.cards[0])}).wait(300).call(function(){i["player_frame"+r].pokerList.poker_2.setCard(s.cards[1]),i.seecard.setMask(s.cards[1])}).wait(300).call(function(){i["player_frame"+r].pokerList.setCardType(s.cards_type,s.cards,s.result)}).wait(300)}),o=this,r=0;4>r;r++)n(r);e.call(function(){i.updateBalance=!0,i.updateUserInfo(),i.showSurplus(),i.chipAni();var t=i.getDeskData().snapshot.settle.user_status;i.playSettleAni(t)})},n.prototype.showSurplus=function(){for(var t=1;4>=t;t++){var e=this.getDeskData().snapshot.settle.desk[this.getNetPosition(t)].surplus;this["player_frame"+t].showSurplus(!0,e),util.LogUtil.warn("[paigow] [showSurplus] local_position =>"+t+"  surplus=>"+e)}},n.prototype.showSettle=function(t){var e=this.summaryArrdeal(t.summary[1]),i=this.summaryArrdeal(t.summary[2]);util.LogUtil.info("[paigow] [showSettle] end"),util.LogUtil.warn("[paigow] [showSettle] firstArr =>"+JSON.stringify(e)),util.LogUtil.warn("[paigow] [showSettle] secondArr =>"+JSON.stringify(i)),this.settleDialog.show(e.concat(i))},n.prototype.summaryArrdeal=function(t){var e=this,n=[];return[1,2,3,4].forEach(function(o){var r=t[e.getLocalPosition(o)],s=new i;s.name=e.my_position===o?Const.UserInfo.NICK:r.username,s.ante=e.ante,s.start_money=r.initBalance,s.bet_multiple=r.disputeRate,s.rob_multiple=r.raiseRate,s.isBanker=0!==r.disputeRate,s.surplus=r.surPlus,s.card_result=r.cardInfo.result,s.card_type=r.cardInfo.cards_type,n.push(s)}),n},n.prototype.chipAni=function(){var t=this;return new Promise(function(e){var i=t.getDeskData().snapshot.settle.desk,n=t.getDeskData().snapshot.raise.desk,o=0,r=[],s=[];Object.keys(n).forEach(function(e){var a=n[e],l=i[e],u=t.getLocalPosition(Number(e));a.is_banker!==!1&&(o=u),l.surplus>0?s.push(u):l.surplus<0&&r.push(u)});var a=10;r.forEach(function(e){var i=t["player_frame"+o],n=t["player_frame"+e];util.SoundUtil.play("nn_collectgold_mp3"),t.flaychip(n.getChipPosition(),i.getChipPosition(),a)});var l=10;t.winTimeout=util.TimeUtil.setTimeout(function(){s.forEach(function(e){var i=10,n=t["player_frame"+o],r=t["player_frame"+e];util.SoundUtil.play("nn_collectgold_mp3"),t.flaychip(n.getChipPosition(),r.getChipPosition(),i)})},30*a+500),util.TimeUtil.setTimeout(e,30*(a+l)+1e3)})},n.prototype.playSettleAni=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n=this;return __generator(this,function(o){switch(o.label){case 0:switch(this.settle_ani.visible=!0,e=0,i=this.getDeskData().snapshot,t){case"all_kill":this.settle_ani.play("teb_take_all",null,0,1),util.SoundUtil.play("erba_tongchi_mp3"),this.settle_ani.alpha=1;break;case"all_lose":this.settle_ani.play("teb_take_lose",null,0,1),util.SoundUtil.play("erba_tongpei_mp3"),this.settle_ani.alpha=1;break;case"win":this.settle_ani.play("teb_win",null,0,1),util.SoundUtil.play("erba_win_mp3"),this.settle_ani.alpha=1;break;case"lose":e=1;break;default:e=1}return"settle"===i.desk_info.stage&&this.startCountDown(),this.settle_ani.once(egret.Event.COMPLETE,function(){egret.Tween.get(n.settle_ani).to({alpha:0},500,egret.Ease.circOut).call(function(){n.settle_ani.visible=!1})},this),"end"!==i.desk_info.stage?[3,2]:[4,this.sleep(2e3)];case 1:o.sent(),this.showUI(this.matchBtn),this.main.addChildAt(this.seecard,99),this.matchBtn.visible=!0,this.showSettle(i),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),o.label=2;case 2:return[2]}})})},n.prototype.startCountDown=function(){var t=this;util.LogUtil.info("[paigow] [startCountDown] prepare => "+this.getDeskData().snapshot.room_setting.time.prepare+", settle.stage_timestamp => "+this.getDeskData().snapshot.settle.stage_timestamp+", now => "+util.TimeUtil.now),this.next_time.visible=!0,this.lb_countdown.text="";var e=(Number(this.getDeskData().snapshot.room_setting.time.prepare)+this.getDeskData().snapshot.settle.stage_timestamp-util.TimeUtil.now)/1e3<<0,i=function(e){e>0?(t.lb_countdown.text="（"+e+"）",t.lb_countdown.visible=!0):t.stopCountDown()};this.canSendMatchNotify&&(this.tid=util.TimeUtil.setInterval(function(){return i(--e)},1e3),this.canSendMatchNotify=!1)},n.prototype.stopCountDown=function(){this.tid&&util.TimeUtil.clearInterval(this.tid),this.tid=void 0,this.next_time.visible=!1,this.canSendMatchNotify=!0},n.prototype.rest=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.settle_ani),this.hideUIS(this.new_uis),this.main.contains(this.countdown)&&this.main.removeChild(this.countdown),this.timeout.forEach(function(t){return util.TimeUtil.clearTimeout(t)}),this.timeout.splice(0)},n}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.paigow.RoomUI")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.hor_layout=new eui.HorizontalLayout,t.ver_layout=new eui.VerticalLayout,t.horizontalCenter=0,t.hor_layout.gap=10,t.ver_layout.gap=20,t.ver_layout.horizontalAlign=egret.HorizontalAlign.CENTER,t.visible=!1,t
}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.registEvent(),this.gp_btns.layout=430===this.verticalCenter?this.ver_layout:this.hor_layout,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.registEvent,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeEvent,this)},i.prototype.registEvent=function(){this.gp_mult_btns.addEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.removeEvent=function(){this.visible=!1,this.gp_mult_btns.removeEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.sendMult=function(t){t.stopImmediatePropagation(),this.dispatchEventWith(i.EVT_SEND_MULT,!1,t.data),this.parent&&this.parent.removeChild(this)},i.prototype.resetMode=function(t){t===egret.OrientationMode.PORTRAIT?this.gp_btns&&(this.gp_btns.layout=this.ver_layout):this.gp_btns&&(this.gp_btns.layout=this.hor_layout)},i.EVT_SEND_MULT="evt_send_mult",i}(eui.Component);t.MultButtonsBase=e,__reflect(e.prototype,"ui.paigow.MultButtonsBase")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ROOM_ID_MAP={PD1:"xinshoufang",PD2:"chujifang",PD3:"zhongjifang",PD4:"gaojifang",PD5:"zhizunfang",PD6:"wangzhefang"},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.playAni=function(t){t?[{db:this.btn_xinshoufang.getChildAt(0).getChildAt(1),name:"pok_room1"},{db:this.btn_chujifang.getChildAt(0).getChildAt(1),name:"pok_room2"},{db:this.btn_zhongjifang.getChildAt(0).getChildAt(1),name:"pok_room3"},{db:this.btn_gaojifang.getChildAt(0).getChildAt(1),name:"pok_room4"},{db:this.btn_zhizunfang.getChildAt(0).getChildAt(1),name:"pok_room6"},{db:this.btn_wangzhefang.getChildAt(0).getChildAt(1),name:"pok_room5"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())}):[this.btn_xinshoufang.getChildAt(0).getChildAt(1),this.btn_chujifang.getChildAt(0).getChildAt(1),this.btn_zhongjifang.getChildAt(0).getChildAt(1),this.btn_gaojifang.getChildAt(0).getChildAt(1),this.btn_zhizunfang.getChildAt(0).getChildAt(1),this.btn_wangzhefang.getChildAt(0).getChildAt(1)].forEach(function(t){return t.stop()})},e.prototype.registerEvent=function(){var t=this;[this.gp_xinshoufang,this.gp_chujifang,this.gp_zhongjifang,this.gp_gaojifang,this.gp_zhizunfang,this.gp_wangzhefang].forEach(function(e){return e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.name)},t)}),this.addEventListener(eui.UIEvent.ADDED,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(eui.UIEvent.ADDED_TO_STAGE,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.playAni(!1)},this)},e.prototype.updateHallDatas=function(t){this.rooms=t,this.gp_xinshoufang&&this.updateData(t)},e.prototype.updateData=function(t){var e=this;Object.keys(this.ROOM_ID_MAP).forEach(function(t){e["gp_"+e.ROOM_ID_MAP[t]].visible=!1,e["gp_"+e.ROOM_ID_MAP[t]].includeInLayout=!1}),t.forEach(function(t){var i=t.room_id;e["gp_"+e.ROOM_ID_MAP[i]].visible=!0,e["gp_"+e.ROOM_ID_MAP[i]].includeInLayout=!0,e["gp_"+e.ROOM_ID_MAP[i]].name=i,e["btn_"+e.ROOM_ID_MAP[i]].getChildAt(0).getChildAt(3).text=util.LanguageUtil.translate("lbl_game_basebet")+util.NumberUtil.formatNumber(t.bet_limit.ante),e["btn_"+e.ROOM_ID_MAP[i]].getChildAt(0).getChildAt(4).text=util.LanguageUtil.translate("lbl_game_allowbet")+util.NumberUtil.formatNumber(t.bet_limit.admittance)})},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.pokdeng.Hall")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.is_init=!1,e.my_position=0,e.ante=0,e.timeout=[],e.max_player=0,e.isSendRaiseChipDone=[],e.time1=0,e.time2=0,e.getNetPosition=function(t){return 0===t?0:(t+e.my_position-1)%e.max_player||e.max_player},e.getLocalPosition=function(t){return 0===t?0:(t+e.max_player-e.my_position+1)%e.max_player||e.max_player},e.getDeskData=function(){return Data.getTopic("/pokdeng_desk/"+e.desk_id)},e._sendFight=function(t){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DONE,t)},e._sendRaise=function(t){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,t)},e.sleep=function(t){return new Promise(function(i){e.timeout.push(util.TimeUtil.setTimeout(i,t))})},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"desk_id",{get:function(){return this._desk_id},set:function(t){this._desk_id=t},enumerable:!0,configurable:!0}),i.prototype.initUI=function(){this.init(),this.pokerAni=new e.PokerAni(this.gp_pokerAni),this.initOwnUserInfo(),this.registUIEventListener(),this.beginAnotherGameInit(),Const.Config.DESK_LOGO&&(this.img_logo.source=Const.Config.DESK_LOGO),util.LogUtil.info("pokdeng [initUI]")},i.prototype.init=function(){this.is_init||(this.is_init=!0)},i.prototype.initData=function(){this.my_position=0,this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this.desk_id,this.updateUserInfo(!0,!1),this.chipsList.setChips(this.getDeskData().snapshot.raise_rate_options),this.chipsList.updateEnable(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance),this.reconnection(),util.LogUtil.info("pokdeng [initData]")},i.prototype.reconnection=function(){var t=this.getDeskData().snapshot,e=t.stage;switch(e){case"RAISE":this.commonCode(),this.chipsList.visible=!0,this.countDown.visible=!0,this.countDown.show(t.stage_timestamp,t.room_setting.time.raise+1750,t.room_setting.time.raise);break;case"DEAL":case"FIGHT":this.commonCode(),this.chipsList.visible=!1,this.countDown.visible=!1,this.pokerAni.initPoker();for(var i=1;i<=this.max_player;i++){var n=this["player"+i].pokerList;n.visible=!0,this.time2=util.TimeUtil.now,this.gp_pokerAni.visible=!1}this.updateFight(!0);var o=t.fight,r=o[this.my_position];r.cards&&this.player1.pokerList.showResult(200,r.cards,r.odds,!1,r),this.player0.pokerList.visible=!0,this.db_girl.play("pok_girl","pai2"),t.stop_decision_ts&&this.updateDecisionPos(),this.showKeycard()}},i.prototype.commonCode=function(){this.updateUserInfo(!0,!1);for(var t=1;t<=this.max_player;t++){var e=this["player"+t];e.setChip("0"),e.showChipGroup(!0)}this.betAni.show(),this.updateRaise()},i.prototype.showKeycard=function(){var t=this,e=this.getDeskData().snapshot,i=e.fight;Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e)),r=(t["player"+o].pokerList,t["player"+o]);if(n.more_card){if(r.pokerList.poker_3.visible)return;r.pokerList.keycard(),r.pokerList.poker_3.visible=!0,1===o&&n.cards.length>2&&(r.pokerList.poker_3.turnCard(200),r.pokerList.poker_3.num=n.cards[2]),0===o&&t.db_girl.play("pok_girl","pai3")}})},i.prototype.registerEvent=function(){var t=this;this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.player1.pokerList.addEventListener(e.PokerList.EVT_KEYCARD,function(){t._sendFight(!0),t.player1.pokerList.setCheckButtonVisible(!1),t.player1.init()},this),this.player1.pokerList.addEventListener(e.PokerList.EVT_PASS,function(){t._sendFight(!1),t.player1.pokerList.setCheckButtonVisible(!1),t.player1.init()},this),this.chipsList.addEventListener(e.ChipsList.EVT_BET,function(){t._sendRaise(t.chipsList.cur_chosen_item.value)},this)},i.prototype.registUIEventListener=function(){this.playdbAni(!0)},i.prototype.removeFromStage=function(){this.playdbAni(!1)},i.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_UPDATE_USER_INFO:this.updateUserInfo(!1,!1);break;case Const.UICommand.CMD_UPDATE_RAISE:this.updateRaise();break;case Const.UICommand.CMD_UPDATE_DECISION_POSITION:this.updateDecisionPos();break;case Const.UICommand.CMD_UPDATE_FIGHT:this.updateFight(!1);break;case Const.UICommand.CMD_CANCEL_MATCH:this.matchBtn.visible=!0,this.matchBtn.cancel(),this.beginAnotherGameInit();break;case Const.UICommand.CMD_CONTINUE_MATCH:this.beginAnotherGameInit();break;case Const.UICommand.CMD_LEAVE_DESK:this.matchBtn.clearInterval()}},i.prototype.playdbAni=function(t){t?this.db_girl.play("pok_girl","daiji"):this.db_girl.stop()},i.prototype.initOwnUserInfo=function(){this.player1.visible=!0,this.player1.setName(Const.UserInfo.NICK),this.player1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance,!1),this.player1.setHead(Const.UserInfo.AVATAR)},i.prototype.updateUserInfo=function(t,e){var i=this,n=this.getDeskData().snapshot;n.user_info&&(0===this.my_position&&Object.keys(n.user_info).forEach(function(t){var e=n.user_info[t];e.user_id===""+Const.UserInfo.USER_ID&&(i.my_position=Number(t)),i.max_player=Object.keys(n.user_info).length-1}),Object.keys(n.user_info).forEach(function(o){var r=n.user_info[o],s=i.getLocalPosition(Number(o)),a=i["player"+s];r.username?(a.visible=!0,1!==s&&(a.setName(r.username),a.setHead(r.avatar)),t&&a.setBalance(r.balance,e)):(a.visible=!1,a.initHead())}))},i.prototype.updateStage=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o;return __generator(this,function(r){switch(r.label){case 0:switch(t=this.getDeskData().snapshot,e=t.stage){case"RAISE":return[3,1];case"DEAL":return[3,2];case"FIGHT":return[3,3];case"SETTLE":return[3,4]}return[3,7];case 1:for(this.updateUserInfo(!0,!1),i=1;i<=this.max_player;i++)n=this["player"+i],n.setChip("0"),n.showChipGroup(!0);return this.showBetAni("start",t),[3,7];case 2:return this.chipsList.visible=!1,this.countDown.visible=!1,this.showBetAni("stop",t),o=egret.Tween.get(this),this.time1=util.TimeUtil.now,o.wait(750),this.shuffle(o),[3,7];case 3:return[3,7];case 4:return this.updateFight(!0),[4,this.sleep(1e3)];case 5:return r.sent(),[4,this.payoutAni()];case 6:return r.sent(),this.updateUserInfo(!0,!0),this.matchBtn.visible=!0,this.matchBtn.addToStage(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),[3,7];case 7:return[2]}})})},i.prototype.updateRaise=function(){var t=this,e=this.getDeskData().snapshot,i=e.raise;Object.keys(i).forEach(function(e){var n=i[e],o=t.getLocalPosition(Number(e)),r=t["player"+o];n.is_done&&-1===t.isSendRaiseChipDone.indexOf(o)&&(1===o&&(t.chipsList.visible=!1),t.jump(r),t.isSendRaiseChipDone.push(o),t.sendChips(r,n.raise_rate),t.updateUserInfo(!0,!0),r.setChip(util.NumberUtil.formatUnit(n.raise_rate)))})},i.prototype.jump=function(t){egret.Tween.removeTweens(t),t.y=0,egret.Tween.get(t).to({verticalCenter:-15},80,egret.Ease.quadOut).to({verticalCenter:0},80,egret.Ease.quadIn)},i.prototype.showBetAni=function(t,e){var i=this;this.betAni.show(t),egret.Tween.removeTweens(this.betAni),this.betAni.horizontalCenter=-1300,this.betAni.alpha=.8,egret.Tween.get(this.betAni).to({horizontalCenter:0,alpha:1},250,egret.Ease.backOut).to({horizontalCenter:20},300).to({horizontalCenter:600,alpha:0},200,egret.Ease.quadIn).call(function(){i.betAni.show();var n="start"===t;i.chipsList.visible=n,i.countDown.visible=n,n&&i.countDown.show(e.stage_timestamp,e.room_setting.time.raise+1750,e.room_setting.time.raise)})},i.prototype.shuffle=function(t){var e=this;this.gp_pokerAni.visible=!1,t.call(function(){e.gp_pokerAni.visible=!0,e.pokerAni.shuffle()}).wait(825),this.dealCard(t)},i.prototype.dealCard=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,o,r,s,a,l,u=this;return __generator(this,function(h){switch(h.label){case 0:for(e=[],i=1;5>=i;i++)n=this["player"+i].pokerList,n.visible=!1;for(this.player0.pokerList.visible=!1,o=this.getLocalPosition(0),r=[1,2,3,0,4,5],s=r.indexOf(o),a=function(i){t.call(function(){for(var t=0;5>=t;t++){var n=s+t;n>5&&(n=n%5-1);var o=r[n],a=u["player"+o].pokerList;u["player"+o].visible&&e.push(u.pokerAni.flyCard(a.getPokerType(i),a.getCardPos(i),o))}}).wait(200)},l=1;2>=l;l++)a(l);return[4,Promise.all(e)];case 1:return h.sent(),t.wait(100).call(function(){u.pokerAni.initPoker(),util.SoundUtil.play("fanpai_mp3");for(var t=1;t<=u.max_player;t++){var e=u["player"+t].pokerList;e.visible=!0,u.time2=util.TimeUtil.now,u.gp_pokerAni.visible=!1}util.LogUtil.debug("[dealCard] AnimationTime:"+(u.time2-u.time1)+" "),u.updateFight(!0);var i=u.getDeskData().snapshot,n=i.fight,o=n[u.my_position];o.cards&&u.player1.pokerList.showResult(200,o.cards,o.odds,!1,o),u.player0.pokerList.visible=!0,u.db_girl.play("pok_girl","pai2")}),[2]}})})},i.prototype.sendChips=function(t,i){var n=this.gp_chipsArea.getChildByName("landscapeArea"),o=new e.Chip;o.horizontalCenter=t.parent.horizontalCenter,o.verticalCenter=t.parent.verticalCenter,n.addChild(o),egret.Tween.get(o).to({horizontalCenter:600*(Math.random()-.5),verticalCenter:100*(Math.random()-.5),rotation:360*Math.random()},200),util.SoundUtil.play("baicao_Chips_mp3");var r=this.gp_chipsArea.getChildByName("portraitArea");o=new e.Chip,o.chipValue=util.NumberUtil.formatUnit(i);var s=(this.getDeskData().snapshot.raise_rate_options.indexOf(Number(i))+1).toString();util.LogUtil.debug("[sendChips] chipValue:"+o.chipValue+" chipIndex:"+s),"0"===s&&(s="1"),o.type=s,o.horizontalCenter=t.parent.horizontalCenter,o.verticalCenter=t.parent.verticalCenter,r.addChild(o),egret.Tween.get(o).to({horizontalCenter:150*(Math.random()-.5),verticalCenter:350*(Math.random()-.5),rotation:360*Math.random()},200)},i.prototype.beginAnotherGameInit=function(){for(var t=0;5>=t;t++){var e=this["player"+t];e.hideSurplus(),e.pokerList.visible=!1,e.pokerList.setBack(),e.pokerList.mutiple.visible=!1,e.init(),e.pokerList.deleteCard(),e.setChip("0"),e.showChipGroup(!1)}for(var t=2;5>=t;t++)this["player"+t].visible=!1,this["player"+t].initHead();this.gp_pokerAni.visible=!1,this.player1.pokerList.setCheckButtonVisible(!1),this.clearChip(),this.isSendRaiseChipDone=[],this.playdbAni(!0)},i.prototype.clearChip=function(){var t=this.gp_chipsArea.getChildByName("landscapeArea"),e=this.gp_chipsArea.getChildByName("portraitArea");t.removeChildren(),e.removeChildren()},i.prototype.updateFight=function(t){var e=this,i=this.getDeskData().snapshot,n=i.fight;Object.keys(n).forEach(function(o){var r=n[o],s=e.getLocalPosition(Number(o)),a=e["player"+s].pokerList,l=e["player"+s];if(("SETTLE"===i.stage||r.is_sky&&t)&&(r.cards&&a.showResult(200,r.cards,r.odds,"SETTLE"===i.stage,r),"SETTLE"===i.stage&&a.showMutiple(r.odds),1===s&&e.player1.pokerList.setCheckButtonVisible(!1)),r.more_card){if(l.pokerList.poker_3.visible)return;l.pokerList.keycard(),e.gp_pokerAni.visible=!0,e.pokerAni.initPoker();var u=egret.Tween.get(e);e.validateNow(),e.pokerAni.flyCard(a.getPokerType(3),a.getCardPos(3),s),u.wait(150).call(function(){e.gp_pokerAni.visible=!1,l.pokerList.poker_3.visible=!0,1===s&&r.cards.length>2&&(l.pokerList.poker_3.turnCard(200),l.pokerList.poker_3.num=r.cards[2],l.pokerList.showStatus(r.is_sky,r.point)),0===s&&e.db_girl.play("pok_girl","pai3")})}})},i.prototype.updateDecisionPos=function(){var t=this.getDeskData().snapshot,e=t.fight,i=this.getLocalPosition(Number(t.fight_position)),n=(e[t.fight_position],this["player"+i]);util.LogUtil.debug("[updateDecisionPos] localPos:"+i+" netPos:"+t.fight_position+" stop_decision_ts:"+t.stop_decision_ts+" room_setting.time.op:"+t.room_setting.time.op);for(var o=0;5>=o;o++)this["player"+o].init();this.player1.pokerList.setCheckButtonVisible(1===i),n.countDown(t.stop_decision_ts,t.room_setting.time.op)},i.prototype.payoutAni=function(){var t=this;return new Promise(function(e){return __awaiter(t,void 0,void 0,function(){var t,i,n=this;return __generator(this,function(o){switch(o.label){case 0:return t=this.getDeskData().snapshot,i=this.getDeskData().snapshot.settle,this.settleSendchips(),[4,this.sleep(400)];case 1:return o.sent(),Object.keys(i).forEach(function(t){var o=i[t],r=n.getLocalPosition(Number(t)),s=n["player"+r];o.surplus>0?s.scoreAni(1e3,o.surplus):s.showSurplus(o.surplus),1===r&&o.surplus>0&&(util.SoundUtil.play("win_mp3"),n.db_winAni.visible=!0,n.db_winAni.play("thirteen-win",null,0,1),n.db_winAni.alpha=1,n.db_winAni.once(egret.Event.COMPLETE,function(){egret.Tween.get(n.db_winAni).to({alpha:0},500,egret.Ease.circOut).call(function(){n.db_winAni.visible=!1,e()})},n)),1===r&&o.surplus<=0&&(util.SoundUtil.play("dissapoint_mp3"),egret.Tween.get(n).wait(800).call(function(){e()})),0===r&&(s.pokerList.poker_3.visible===!1?o.surplus>0?n.db_girl.play("pok_girl","pai2_win"):n.db_girl.play("pok_girl","pai2_lose"):o.surplus>0?n.db_girl.play("pok_girl","pai3_win"):n.db_girl.play("pok_girl","pai3_lose"))}),[2]}})})})},i.prototype.settleSendchips=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o,r,s,a,l=this;return __generator(this,function(u){switch(u.label){case 0:return t=this.getDeskData().snapshot,e=this.getDeskData().snapshot.settle,i=t.raise,n=t.fight[0].odds,o=[],Object.keys(e).forEach(function(t){var r=e[t],s=l.getLocalPosition(Number(t)),a=l["player"+s];if(r.surplus>=0&&o.push(s),r.surplus<0&&0!==s&&n>=2)for(var u=i[t],h=2;n>=h;h++)l.sendChips(a,u.raise_rate);if(r.surplus<0&&0===s)for(var c=Math.abs(r.surplus),h=2;n>=h;h++)l.sendChips(a,c)}),[4,this.sleep(200)];case 1:return u.sent(),r=this.gp_chipsArea.getChildByName("portraitArea"),s=r.numChildren,a=Math.floor(s/o.length),o.forEach(function(t,e){var i=0>a*e?0:a*e,n=a*(e+1);e===o.length-1&&(n=s);for(var u=i;n>u;u++){var h=r.getChildAt(u);egret.Tween.get(h).to({horizontalCenter:l["player"+t].horizontalCenter,verticalCenter:l["player"+t].verticalCenter,visible:!1},200)}}),[2]}})})},i}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.pokdeng.RoomUI")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pool="",e}return __extends(e,t),e}(topic.RoomItemData);e.RoomItemData=i,__reflect(i.prototype,"ui.sedie.RoomItemData");var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomNameImgs=["ft_font_room1_png","ft_font_room2_png","ft_font_room3_png","ft_font_room4_png"],e.roomIds=["BTN1","BTN2","BTN3","BTN4"],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btns=[this.btn1,this.btn2,this.btn3,this.btn4],this.data&&this.updateRooms()},e.prototype.updateHallDatas=function(t){this.data=t,this.btn1&&this.updateRooms()},e.prototype.updateRooms=function(){var t=this;this.btns.forEach(function(t){t.visible=!1,t.includeInLayout=!1}),this.data.forEach(function(e){var i=t.roomIds.indexOf(e.room_setting.room_id);e.nameImg=t.roomNameImgs[i];var n=t.btns[i];n.visible=!0,n.includeInLayout=!0,n.bindData=e,n.update()})},e.prototype.udpateRoadMap=function(t){if(this.btn1){var e=this.roomIds.indexOf(t.room_setting.room_id),i=this.btns[e];i.update()}},e}(t.HallBase);e.Hall=n,__reflect(n.prototype,"ui.sedie.Hall"),function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lushuList=new eui.ArrayCollection,e.shot=function(){egret.callLater(function(){egret.callLater(function(){var t=new egret.RenderTexture;t.drawToTexture(e.lushu),e.img_shot.source=t},e)},e)},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.bindData.room_setting.room_id)},this),this.addEventListener(egret.Event.RESIZE,this.resize,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return e.resize()},this)},e.prototype.resize=function(){var t=Math.floor((this.width-38)/54);this.root.width=54*t+40;var e=54*t,i=54*this.lushuList.length-2;this.img_ligth.x=i>0?i-54:0,this.scroller.viewport.scrollH=i>e?i-e:0,this.lushuList.length?(this.shot(),this.blink()):this.img_ligth.visible=!1},e.prototype.update=function(){if(this.bindData&&!util.ObjectUtil.isEqual(this.bindData.road_map,this.roadMapoldData)){var t=[],e=util.ObjectUtil.copy(this.bindData.road_map);this.roadMapoldData=util.ObjectUtil.copy(this.bindData.road_map),t=this.bindData.road_map.length>31?e.slice(e.length-31):e,t.length&&this._init&&(t[t.length-1].isNew=!0,t[t.length-1].time=util.TimeUtil.now),this._init=!0,this.lushuList=new eui.ArrayCollection(t),this.resize()}},e.prototype.blink=function(){var t=this;egret.callLater(function(){egret.Tween.get(t.img_ligth).to({visible:!0},200).to({visible:!1},200).to({visible:!0},200).to({visible:!1},200).call(function(){t.img_ligth.visible=!0})},this)},e}(t.control.Button);e.HallItemButton=i,__reflect(i.prototype,"ui.sedie.Hall.HallItemButton")}(n=e.Hall||(e.Hall={}))}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){this.write_4=0,this.red_4=0,this.write_3_red_1=0,this.write_1_red_3=0,this["double"]=0,this.single=0}return t}();e.AreaMark=i,__reflect(i.prototype,"ui.sedie.AreaMark");var n=function(n){function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.girl_scale=1,t.ownBet=new i,t.otherBet=new i,t.robotBet=new i,t.selfBet=new i,t.idle=0,t.ALL_TYPE=["write_4","red_4","write_3_red_1","write_1_red_3","double","single"],t.defaultChips=[500,1e3,2e3,5e3,1e4,2e4],t.limit={min:new i,max:new i},t.AREA_TYPE={1:0,2:1,3:2,4:3,5:4,6:5},t._stoneGroup=[],t._winGroup=[],t._labBetchips=[],t._labBetchipGroup=[],t._whereBet="",t.STAGE={prepare:"lbl_game_prepare2",shuffle:"lbl_game_wait",deal:"lbl_game_wait",bet:"lbl_game_betting",open:"lbl_game_payout_wait",settle:"lbl_game_payout_wait",pool:"lbl_game_payout_wait"},t.girl_standby=function(){t.bowlGroup.visible=!0,t.showGirlAni("2",1),t.db_girl.once(dragonBones.AnimationEvent.COMPLETE,t.girl_standby2,t)},t.girl_standby2=function(){t.bowlGroup.visible=!0,t.showGirlAni("1")},t.getMinLimit=function(){return Math.min.apply(Math,Object.keys(t.limit.min).map(function(e){return t.limit.min[e]}))},t}return __extends(o,n),Object.defineProperty(o,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"cur_stage",{get:function(){return this.STAGE[this.currentStage]},enumerable:!0,configurable:!0}),o.prototype.createChildren=function(){n.prototype.createChildren.call(this),this._stoneGroup=[this.stone0,this.stone1,this.stone2,this.stone3],this._winGroup=[this.win0,this.win1,this.win2,this.win3,this.win4,this.win5],this._labBetchips=[this.lab_fw_own,this.lab_fr_own,this.lab_tw_own,this.lab_tr_own,this.lab_dou_own,this.lab_sin_own],this._labBetchipGroup=[this.lab_fw_group,this.lab_fr_group,this.lab_tw_group,this.lab_tr_group,this.lab_dou_group,this.lab_sin_group],this.allChipAreas=[this.chipArea1,this.chipArea2,this.chipArea3,this.chipArea4,this.chipArea5,this.chipArea6]},o.prototype.childrenCreated=function(){n.prototype.childrenCreated.call(this),this.main.addEventListener(egret.Event.RESIZE,this.resize,this),this.chipArea6.setLeftOrRight("rightArea"),this.chipArea5.setLeftOrRight("leftArea")},o.prototype.initUI=function(){this.initChips(),this.com_countDown.clearTimer(),this.com_betArea.init(),this.clearbetchips()},o.prototype.initData=function(){var t=this,e=this.data.desk,n=this.data.stage;this.initChipstack(),this.showGirlAni("1"),this.idle=0,this.channel_settles=this.desk_settle_data=void 0,this.currentStage=this.data.stage.stage.toLowerCase(),this.com_tip.show(this.cur_stage),this.balance=e.user_info.balance,this.com_bottomPanel.setHead(Const.UserInfo.AVATAR),this.com_bottomPanel.setBalance(this.balance),this.com_bottomPanel.setName(Const.UserInfo.NICK),this.com_bottomPanel.setSurplus(Number(e.user_info.surplus)),this.com_bottomPanel.showWin(e.user_info.surplus>0),this.com_bottomPanel.setChips(n.bet_limit.chips),this.com_bottomPanel.updateEnable(this.balance),this.setDefaultChips(n.bet_limit.chips);var o=e.user_info.bet,r=e.bet,s=new i;switch(Object.keys(r).forEach(function(t){s[t]=Number(r[t]||0)-Number(o[t]||0)}),this.ALL_TYPE.forEach(function(e){t.otherBet[e]=Number(s[e]||0),t.ownBet[e]=Number(o[e]||0)}),this.old_robot_bets=[],this.flyChipAni(this.ownBet,"own",!1),this.flyChipAni(this.otherBet,"other",!1),this.btn_people.label=String(this.data.desk_item&&this.data.desk_item.playernum||0),this.com_betArea.setEnable(!1),this.bowlGroup.visible=!0,this.currentStage){case"deal":this.bowlGroup.visible=!1,this.db_girl.play("sedie_girl","2"),this.db_girl.once(egret.Event.LOOP_COMPLETE,this.girl_standby,this);break;case"bet":this.girl_standby2(),this.com_betArea.setEnable(!0),this.com_countDown.start(Number(n.stage_timestamp)+Number(n.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.handleRobotbet(n.bets,!1),this.updateBet(this.ownBet);break;case"open":this.girl_standby2(),this.showBowlAni(this.data.desk.open,!0),this.handleRobotbet(n.bets,!1);break;case"settle":this.handleRobotbet(n.bets,!1);break;case"after_settle":this.settle(e);break;case"shuffle":this.bowlGroup.visible=!1,this.showGirlAni("3"),this.db_girl.once(egret.Event.LOOP_COMPLETE,this.girl_standby,this)}this.updatelimit(n.bet_limit),this.topBar.bVal=e.round_id,this.roadMap.updateRoadMap(this.data.desk_item)},o.prototype.registerEvent=function(){var t=this;this.com_betArea.addEventListener(e.BetArea.EVT_BET,function(e){t.onBet(e.data)},this),this.com_betArea.addEventListener(e.BetArea.EVT_SHOW_TIP,function(e){"bet"!==t.currentStage&&(t.cur_stage&&t.com_tip.show(t.cur_stage),util.SoundUtil.play("xiazhushibai_mp3"))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},o.prototype.execCommand=function(t,e){var n=this;switch(t){case Const.UICommand.CMD_UPDATE_ROBOT_BET:this.handleRobotbet(e,"bet"===this.currentStage);break;case Const.UICommand.CMD_UPDATE_ALL_BET:var o=e.own,r=e.total,s=new i;this.ALL_TYPE.forEach(function(t,e){var i=(r[t]||0)-(o[t]||0);s[t]=i-n.otherBet[t],n.otherBet[t]=i}),this.flyChipAni(s,"other","bet"===this.currentStage),this.updateShowBet();break;case Const.UICommand.CMD_UPDATE_SETTLE:"settle"===this.currentStage&&(this.desk_settle_data=e,util.LogUtil.warn(this.topBar.bVal+" => SETTLE STAGE"));break;case Const.UICommand.CMD_UPDATE_USER_INFO:!function(){n.balance=e.balance,n.com_bottomPanel.setBalance(n.balance),n.com_bottomPanel.updateEnable(n.balance),n.idle=Number(e.idle)}();break;case Const.UICommand.CMD_UPDATE_BET:!function(){var t=e.own;"bet"===n.currentStage&&n.com_betArea.setEnable(!0);var o=new i;n.ALL_TYPE.forEach(function(e,i){o[e]=(t[e]||0)-n.ownBet[e],n.ownBet[e]=t[e]||0}),n.updateBet(n.ownBet),n.flyChipAni(o,"own","bet"===n.currentStage),n.updateShowBet(!0)}();break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:"shuffle"===this.currentStage&&(this.topBar.bVal=e.round_id,util.LogUtil.warn(this.topBar.bVal+" => SHUFFLE STAGE"),this.desk_settle_data=void 0,this.bowlGroup.visible=!1,util.SoundUtil.play("yaotouzi_mp3"),this.showGirlAni("3"),this.db_girl.once(egret.Event.LOOP_COMPLETE,this.girl_standby,this),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1),this.initChips());break;case Const.UICommand.CMD_UPDATE_STAGE:!function(){var t=e;n.data&&(n.data.stage=t),n.updatelimit(t.bet_limit);var i=t.stage.toLowerCase();n.currentStage!==i&&(n.currentStage=i,n.onStageChange(t))}();break;case Const.UICommand.CMD_UPDATE_CARDS:"open"===this.currentStage&&egret.Tween.get(this.bowlGroup).wait(500).call(function(){egret.Tween.removeTweens(n.bowlGroup),n.showBowlAni(e)});break;case Const.UICommand.CMD_BALANCE_HINT:"bet"===this.currentStage&&this.com_betArea.setEnable(!0),this.com_tip.show(util.LanguageUtil.translate(e));break;case Const.UICommand.CMD_UPDATE_ROAD_MAP:this.roadMap.updateRoadMap(e);break;case Const.UICommand.CMD_INIT_UI:this.onRemove(),this.initUI();break;case Const.UICommand.CMD_UPDATE_PEOPLE:this.btn_people&&(this.btn_people.label=e.toString());break;case Const.UICommand.CMD_UPDATE_ROBOT_SETTEL:this.channel_settles=e}},o.prototype.onStageChange=function(e){var i=this;switch(this.com_betArea.setEnable(!1),"settle"!==this.currentStage&&"after_settle"!==this.currentStage&&this.com_betArea.init(),this.db_girl.removeEventListener(egret.Event.LOOP_COMPLETE,this.girl_standby,this),this.currentStage){case"deal":!function(){util.LogUtil.warn(i.topBar.bVal+" => DEAL STAGE"),i.cleanBowlAni(),i.db_girl.play("sedie_girl","1"),i.db_girl.once(egret.Event.LOOP_COMPLETE,i.girl_standby2,i);var e=i.getMinLimit();i.idle>=5?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_game_nobet2","lbl_game_comfirm")):i.balance&&i.balance.lt(e)?(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL),t.dialog.MessageDialog.instance.showAlert("lbl_balance_error2","lbl_game_comfirm")):3===i.idle&&i.com_tip.show(util.LanguageUtil.translate("lbl_game_nobet"))}();break;case"bet":util.LogUtil.warn(this.topBar.bVal+" => BET STAGE"),this.cleanBowlAni(),this.girl_standby(),this.com_countDown.start(Number(e.stage_timestamp)+Number(e.room_setting.time[this.currentStage]),"bet"===this.currentStage),this.com_betArea.setEnable(!0),util.SoundUtil.play("start_mp3"),this.showBetHintAni("start"),this.initChips();break;case"stop_bet":this.showBetHintAni("stop");break;case"open":util.LogUtil.warn(this.topBar.bVal+" => OPEN STAGE"),this.girl_standby2();break;case"settle":util.LogUtil.warn(this.topBar.bVal+" => SETTLE STAGE"),this.cleanBowlAni();break;case"after_settle":util.LogUtil.warn(this.topBar.bVal+" => SETTLE STAGE"),this.settleHandler();break;case"shuffle":util.LogUtil.warn(this.topBar.bVal+" => SHUFFLE STAGE"),this.cleanBowlAni(),this.initChips()}},o.prototype.setDefaultChips=function(t){var e=this;this.defaultChips=[],t.forEach(function(t){e.defaultChips.push(Number(t))})},o.prototype.payoutAni=function(e,i,n){var o=this,r=600,s=!1;util.LogUtil.warn(this.topBar.bVal+" => total surplus "+JSON.stringify(e)+" own surplus "+JSON.stringify(i)),this.ALL_TYPE.forEach(function(t,e){if("lose"===n[t]){o._labBetchipGroup[e].visible=!1;var i=o.allChipAreas[e];i.initStack("all"),o.ownBet[t]=0,o.otherBet[t]=0,o.robotBet[t]=0}}),s&&util.SoundUtil.play("payout_chips_mp3"),this.payoutAniTimeout1=util.TimeUtil.setTimeout(function(){var n=!1;Object.keys(e).forEach(function(r,s){var a=o.AREA_TYPE[s+1];if(e[r]>0&&void 0!==a){var l=o.allChipAreas[a],u=o.db_girl.localToGlobal(),h=o.group_chipAni.globalToLocal(u.x+50,u.y+50),c=i[r],p=e[r]-i[r];if(c>0){n=!0;var _=l.getAChipStack(!0),d=_.getFlyChipGlobalPos(),g=o.group_chipAni.globalToLocal(d.x,d.y),m=t.component.SChip.getOneChip(c,"1");m.scaleX=m.scaleY=.77,o.group_chipAni.addChild(m),m.name="own",m.x=h.x,m.y=h.y,egret.Tween.get(m).to({x:g.x,y:g.y},400,egret.Ease.quadOut).call(function(){t.component.SChip.returnChip(m),_.addChip(c)})}if(p>0){var f=l.getAChipStack(!1),d=f.getFlyChipGlobalPos();n=!0;var g=o.group_chipAni.globalToLocal(d.x,d.y),b=t.component.SChip.getOneChip(p,"player");b.scaleX=b.scaleY=.77,o.group_chipAni.addChild(b),b.name="other",b.x=h.x,b.y=h.y,egret.Tween.get(b).to({x:g.x,y:g.y},400,egret.Ease.quadOut).call(function(){t.component.SChip.returnChip(b),f.addChip(p)})}}}),n&&util.SoundUtil.play("payout_chips_mp3"),o.updateBet(o.ownBet)},r),this.payoutAniTimeout2=util.TimeUtil.setTimeout(function(){var e=!1;o.ALL_TYPE.forEach(function(i,s){var a=o.allChipAreas[s];if("lose"!==n[s]){o._labBetchipGroup[s].visible=!1;var l=o.getOtherPos(),u=o.com_bottomPanel.getOwnPos();l=o.group_chipAni.globalToLocal(l.x,l.y),u=o.group_chipAni.globalToLocal(u.x,u.y);var h=a.getImages(o.group_chipAni,"other"),c=function(e,n){egret.Tween.get(e).wait(700).to({y:e.y-20},200).wait(200).to({x:n.x,y:n.y},r,egret.Ease.quadOut).call(function(){o.otherBet[i]=0,o.robotBet[i]=0,t.component.ChipStacked.returnImg(e)
})};h.length>0&&(e=!0),h.forEach(function(t){c(t,l)});var p=a.getImages(o.group_chipAni,"own");p.length>0&&(e=!0),p.forEach(function(t){c(t,u)})}a.init()})},2*r)},o.prototype.flyChipAni=function(e,i,n){var o=this;void 0===n&&(n=!0);var r,s,a,l="own"===i;Promise.all(Object.keys(e).map(function(u,h){var c=o.AREA_TYPE[h+1],p=Number(e[u]);if(r=l?o.com_bottomPanel.getOwnPos():o.getOtherPos(),s=o.group_chipAni.globalToLocal(r.x,r.y),p>0){if(!l&&n){var _=-516;o.btn_people.verticalCenter=_,egret.Tween.get(o.btn_people).to({verticalCenter:_-15},80,egret.Ease.quadOut).to({verticalCenter:_},80,egret.Ease.quadIn)}util.LogUtil.warn(o.topBar.bVal+" => "+i+" bet "+p+" on "+u),n&&util.SoundUtil.play("fangchouma_mp3");var d=o.getFlyChipList(p);d.length=Math.min(d.length,l?3:6);var g=o.allChipAreas[c].getRandomChipStack(l);return Promise.all(d.map(function(e,i){return new Promise(function(r){var u=l?g[0]:g[d.length/2>i?0:1],h=u.getFlyChipGlobalPos();a=o.group_chipAni.globalToLocal(h.x,h.y);var c=t.component.SChip.getOneChip(e,l?void 0:"player");c.scaleX=c.scaleY=.77;var p=function(){u.addChip(e,l?c.type:void 0),t.component.SChip.returnChip(c),r({chip:c})};o.group_chipAni.addChild(c),c.name=l?"own":"other",c.x=s.x,c.y=s.y,c.alpha=1,egret.Tween.get(c).to({x:a.x,y:a.y},n?500-200*Math.random():0,egret.Ease.quadOut).call(p)})}))}return[]}))},o.prototype.getChipPos=function(t){var e=t.localToGlobal();return{x:e.x+util.NumberUtil.getRandom(29,t.width-29),y:e.y+util.NumberUtil.getRandom(29,t.height-29)}},o.prototype.getOtherPos=function(){var t=this.btn_people.localToGlobal();return{x:t.x+this.btn_people.width/2,y:t.y+this.btn_people.height/2}},o.prototype.getFlyChipList=function(t){for(var e,i=[],n=this.defaultChips.length-1;n>=0;n--)for(;t>=this.defaultChips[n];)i.push(this.defaultChips[n]),t-=this.defaultChips[n];return e=i.reverse()},o.prototype.showBetHintAni=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,o,r=this;return __generator(this,function(s){switch(s.label){case 0:return[4,this.db_bet_tip.play("horoscope_"+t+"_betting")];case 1:return e=s.sent(),i=e.armature.getSlot("font"),n=RES.getRes("ho_font_"+t+"_betting_png"),o=new egret.Bitmap(n),o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,i.setDisplay(o),i.invalidUpdate(),this.db_bet_tip.visible=!0,this.db_bet_tip.once(egret.Event.LOOP_COMPLETE,function(){r.db_bet_tip.stop(!0),r.db_bet_tip.visible=!1},this),[2]}})})},o.prototype.settleHandler=function(){if(this.desk_settle_data&&this.channel_settles){this.com_bottomPanel.showWin(this.desk_settle_data.surplus>0),this.desk_settle_data.surplus>0&&this.playWinAni(),this.settle(this.desk_settle_data),this.com_bottomPanel.setSurplus(this.desk_settle_data.surplus);for(var t=new i,e=new i,n=[],o=0;5>=o;o++){var r=this.getBetType(o),s=this.channel_settles.robot[r]?this.channel_settles.robot[r].payout:0,a=this.desk_settle_data.desk_settles.guest[r]?this.desk_settle_data.desk_settles.guest[r].payout:0,l=this.desk_settle_data.desk_settles.player[r]?this.desk_settle_data.desk_settles.player[r].payout:0;t[r]=s+a+l;var u=this.desk_settle_data.own_settle[r]?this.desk_settle_data.own_settle[r].payout:0;e[r]=u;var h=this.desk_settle_data.result;n[r]="lose";for(var c=0;c<h.length;c++)if(h[c]===r){n[r]="win";break}}this.payoutAni(t,e,n)}},o.prototype.settle=function(t){for(var e=[],i=(new Decimal(0),t.result),n=0;5>=n;n++){var o=this.getBetType(n);i&&-1!==i.indexOf(o)&&e.push(n)}this.com_betArea.showResult(e),this.playwinAni(e)},o.prototype.getBetType=function(t){var e;switch(t){case 0:e="write_4";break;case 1:e="red_4";break;case 2:e="write_3_red_1";break;case 3:e="write_1_red_3";break;case 4:e="double";break;case 5:e="single"}return e},o.prototype.handleRobotbet=function(t,e){var n=this;if(this.data&&this.data.stage){var o=util.ObjectUtil.minus(this.old_robot_bets||[],t);this.old_robot_bets=util.ObjectUtil.copy(t);var r=new i;o&&o.length&&(o.forEach(function(t){n.ALL_TYPE.forEach(function(e){var i=Number(n.data.stage.bet_limit.max[e])||0,o=Number(n.data.stage.bet_limit.min[e])||0,s=t.bets[""+e]&&t.bets[""+e].p||0,a=t.bets[""+e]&&t.bets[""+e].m||0,l=new Decimal((s*(i-o)+o)*a).divToInt(100).mul(100);if(l.greaterThan(0))for(var u=l.toNumber(),h=n.defaultChips.length-1;h>=0;h--)u%=n.defaultChips[h],0===h&&u>0&&(l=l.minus(u));n.robotBet[e]=l.add(n.robotBet[e]).toNumber(),r[e]+=l.toNumber()})}),this.flyChipAni(r,"other","bet"===this.currentStage),this.updateShowBet(),util.LogUtil.debug("===================================handleRobotbet","increment",r))}},o.prototype.updateShowBet=function(t){void 0===t&&(t=!1)},o.prototype.onBet=function(t){var e=new i;return e[t]=this.com_bottomPanel.getCurChipValue(),this._whereBet=t,this.balance.add(this.ownBet[t]).lt(this.limit.min[t])?(this.com_tip.show(util.LanguageUtil.translate("lbl_balance_error")),void util.SoundUtil.play("xiazhushibai_mp3")):void(this.checkLimit(t)?(this.com_betArea.setEnable(!1),this.com_bottomPanel.betAni(!0),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BET,e)):(this.com_tip.show(util.LanguageUtil.translate("lbl_game_beterror")+"\n"+util.LanguageUtil.translate("lbl_game_beterror_number",util.NumberUtil.formatNumber(this.limit.min[t]),util.NumberUtil.formatNumber(this.limit.max[t]))),util.SoundUtil.play("xiazhushibai_mp3")))},o.prototype.checkLimit=function(t){var e=Number(this.ownBet[t])+Number(this.com_bottomPanel.getCurChipValue());return e<=this.limit.max[t]&&e>=this.limit.min[t]},o.prototype.onRemove=function(){this.db_girl.stop(!0),this.com_countDown.clearTimer(),egret.Tween.removeTweens(this.bowl),egret.Tween.removeTweens(this.bowlGroup),this.bowlGroup.y=0,this.bowlGroup.scaleX=this.bowlGroup.scaleY=.25,this.bowl.rotation=0;for(var t=0;4>t;t++)this._stoneGroup[t].visible=!1;this.initUI()},o.prototype.showGirlAni=function(t,e){void 0===e&&(e=0),this.db_girl.play("sedie_gril",t,0,e)},o.prototype.showBowlAni=function(t,e){var i=this;void 0===e&&(e=!1),this.bowl.rotation=0,util.SoundUtil.play("dakai_mp3");for(var n=0;n<t.length;n++)this._stoneGroup[n].source="red"===t[n]?"sd_pic_road_r2_png":"sd_pic_road_w2_png",this._stoneGroup[n].visible=!0;var o=(this.stoneGroup.width,this.stoneGroup.height,Math.floor(85*Math.random())),r=Math.floor(40*Math.random());this._stoneGroup[0].x=o,this._stoneGroup[0].y=r;var s=Math.floor(86*Math.random()+145),a=Math.floor(40*Math.random());this._stoneGroup[1].x=s,this._stoneGroup[1].y=a;var l=Math.floor(85*Math.random()),u=Math.floor(41*Math.random()+100);this._stoneGroup[2].x=l,this._stoneGroup[2].y=u;var h=Math.floor(86*Math.random()+145),c=Math.floor(41*Math.random()+100);this._stoneGroup[3].x=h,this._stoneGroup[3].y=c,e?(this.bowlGroup.y=196,this.bowlGroup.scaleX=1,this.bowlGroup.scaleY=1,util.SoundUtil.play("se_jieguo_mp3"),egret.Tween.get(this.bowl).set({x:901,y:510,anchorOffsetX:812,anchorOffsetY:558}).to({rotation:80,alpha:.2,scaleX:1.3,scaleY:1.3},0).wait(1500).to({rotation:28,alpha:1,scaleX:1,scaleY:1},400).set({x:530,y:222,anchorOffsetX:440,anchorOffsetY:280}).to({rotation:0},100).call(function(){egret.Tween.removeTweens(i.bowl),egret.Tween.removeTweens(i.bowlGroup),i.reductionBowl()})):egret.Tween.get(this.bowlGroup).to({y:0}).to({y:196,scaleX:1,scaleY:1},200).call(function(){util.SoundUtil.play("se_jieguo_mp3"),egret.Tween.get(i.bowl).set({x:530,y:222,anchorOffsetX:440,anchorOffsetY:270}).to({rotation:16},100).wait(83).set({x:677,y:326,anchorOffsetX:588,anchorOffsetY:374}).to({rotation:17},103).to({rotation:18},103).to({rotation:19},103).to({rotation:20},103).to({rotation:21},103).to({rotation:22},103).to({rotation:23},103).to({rotation:24},103).to({rotation:25},103).to({rotation:26},103).to({rotation:27},103).to({rotation:28},103).set({x:901,y:510,anchorOffsetX:812,anchorOffsetY:558}).to({rotation:80,alpha:.2,scaleX:1.3,scaleY:1.3},500).wait(1500).to({rotation:28,alpha:1,scaleX:1,scaleY:1},400).set({x:530,y:222,anchorOffsetX:440,anchorOffsetY:280}).to({rotation:0},100).call(function(){egret.Tween.removeTweens(i.bowl),egret.Tween.removeTweens(i.bowlGroup),i.reductionBowl()})})},o.prototype.reductionBowl=function(){var t=this;egret.Tween.get(this.bowlGroup).to({y:0,scaleX:.25,scaleY:.25},200).call(function(){egret.Tween.removeTweens(t.bowl),egret.Tween.removeTweens(t.bowlGroup)}),this.bowl.rotation=0;for(var e=0;4>e;e++)this._stoneGroup[e].visible=!1},o.prototype.cleanBowlAni=function(){egret.Tween.removeTweens(this.bowl),egret.Tween.removeTweens(this.bowlGroup),this.bowlGroup.y=0,this.bowlGroup.scaleX=this.bowlGroup.scaleY=.25,this.bowl.rotation=0,this.bowl.x=902,this.bowl.y=510,this.bowl.anchorOffsetX=812,this.bowl.anchorOffsetY=559,this.bowl.alpha=1,this.bowl.scaleX=this.bowl.scaleY=1;for(var t=0;4>t;t++)this._stoneGroup[t].visible=!1},o.prototype.playwinAni=function(t){var e=this;t.forEach(function(t){e._winGroup[t].group="effect_1_bc_win",e._winGroup[t].currentFrame=0,e._winGroup[t].playTimes=1,e._winGroup[t].visible=!0,e._winGroup[t].isPlaying=!0,e._winGroup[t].once(egret.Event.COMPLETE,function(){e.reset(t)},e)})},o.prototype.reset=function(t){this._winGroup[t].isPlaying=!1,this._winGroup[t].visible=!1,this._winGroup[t].group="",this._winGroup[t].source=null},o.prototype.initChips=function(){var t=this;util.TimeUtil.clearTimeout(this.payoutAniTimeout1),util.TimeUtil.clearTimeout(this.payoutAniTimeout2),this.ALL_TYPE.forEach(function(e,i){t.ownBet[e]=0,t.otherBet[e]=0,t.robotBet[e]=0,t.selfBet[e]=0}),this.updateBet(this.ownBet),this.com_bottomPanel.setSurplus(0),this.com_bottomPanel.showWin(!1)},o.prototype.clearbetchips=function(){var t=this;this.ALL_TYPE.forEach(function(e,i){t._labBetchipGroup[Number(i)].visible=!1})},o.prototype.updateBet=function(t){var e=this;this.ALL_TYPE.forEach(function(i,n){void 0===t[i]||t[i]<=0?e._labBetchipGroup[Number(n)].visible=!1:(e._labBetchipGroup[Number(n)].visible=!0,e._labBetchips[Number(n)].text=util.NumberUtil.formatUnit(t[i]),i===e._whereBet&&egret.Tween.get(e._labBetchipGroup[Number(n)]).to({scaleX:1,scaleY:1},200).to({scaleX:.8,scaleY:.8},100).call(function(){egret.Tween.removeTweens(e._labBetchipGroup[Number(n)])}))})},o.prototype.playWinAni=function(){var t=this;this.db_winAni.visible=!0,this.db_winAni.play("baicai_win",null,0,1),this.db_winAni.alpha=1,this.db_winAni.once(egret.Event.COMPLETE,function(){egret.Tween.get(t.db_winAni).to({alpha:0},500,egret.Ease.circOut).call(function(){t.db_winAni.visible=!1})},this)},o.prototype.resize=function(){this.roadMap.resize()},o.prototype.updatelimit=function(t){var e=this;this.limit.min=t.min,this.limit.max=t.max;var i=Math.min.apply(Math,Object.keys(this.limit.min).map(function(t){return e.limit.min[t]})),n=Math.max.apply(Math,Object.keys(this.limit.max).map(function(t){return e.limit.max[t]}));this.topBar.aVal=util.NumberUtil.formatUnit(i)+"-"+util.NumberUtil.formatUnit(n)},o.prototype.initChipstack=function(){this.allChipAreas.forEach(function(t){return t.init()})},o}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.sedie.RoomUI")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.tk1=32,e.tk2=20,e.roomIds=["TK1","TK2"],e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),i.prototype.playAni=function(t){t?[{db:this.db_LF1,name:"th_room1"},{db:this.db_LF2,name:"th_room2"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())}):[this.db_LF1,this.db_LF2].forEach(function(t){return t.stop()})},i.prototype.updataNumber=function(){if(this.room1Number){var t=Data.getTopic(Const.Topic.ONLINE).snapshot;this.room1Number.text=(t.base_room_count.TK1||0)+(t.room_count.TK1||0),this.room2Number.text=(t.base_room_count.TK2||0)+(t.room_count.TK2||0)}},i.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),[this.TK1_Group,this.TK2_Group].forEach(function(t,n){return t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.selected=t.name,i.updataRooms(n),e.dialog.EnterRoomDialog.instance.show(),e.dialog.EnterRoomDialog.instance.roomName=t.name},i)}),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return i.playAni(!1)},this)},i.prototype.init=function(){this.playAni(!0),this.updateHallData(this.roomsData),this.updataNumber()},i.prototype.updataRooms=function(t){if(void 0===t&&(t=0),this.selected){var i=0===t?this.tk1:this.tk2,n=util.NumberUtil.formatNumber(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance).split(","),o="";n.forEach(function(t){o+=t});var r=100*Number(o),s=this.dealData(r/i),a=[];s.forEach(function(t,e){var n={ante:util.NumberUtil.formatUnit(t,1,1e3,["","K","M"]),admittance:util.NumberUtil.formatUnit(t*i,1,1e3,["","K","M"]),disabled:t*i>r,selected:0===e,bet_limit:t};a.push(n)}),e.dialog.EnterRoomDialog.instance.setData(a)}},i.prototype.dealData=function(t){var e=this.dataDela[this.selected].bet_limit.chips,i=[];e.forEach(function(t){i.push(Number(t))});for(var n=0,o=i.length;o>n&&!(i[n]>t);n++);for(var r=[],s=n-1;s>=0&&r.length<6;s--)r.push(i[s]);if(r=r.reverse(),r.length<6)for(var s=n;r.length<6;s++)r.push(i[s]);return r},i.prototype.updateHallDatas=function(t){this.roomsData=t,this.TK1_Group&&this.updateHallData(t)},i.prototype.updateHallData=function(t){var e=this;[this.TK1_Group,this.TK2_Group].forEach(function(t){t.visible=!1,t.includeInLayout=!1}),this.dataDela={},t.forEach(function(t){e.dataDela[t.room_id]=t,e[t.room_id+"_Group"].name=t.room_id,e[t.room_id+"_Group"].visible=!0,e[t.room_id+"_Group"].includeInLayout=!0}),this.updataRooms()},i}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.thirteenkill.Hall");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.invalidateState()},e.prototype.getCurrentState=function(){var t="normal";return this.data&&(this.data.disabled?t="disabled":this.data.selected&&(t="selected")),t},e}(eui.ItemRenderer);e.RateListItem=n,__reflect(n.prototype,"ui.thirteenkill.RateListItem")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){}return t}();__reflect(i.prototype,"PlayFrame");var n=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInit=!1,e.isOver=!1,e.ismust=!1,e.pass=!1,e.isAllPoker=!1,e.sendDeal=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FIGHT)},e.getNetPosition=function(t){return(t+e.my_position-1)%4||4},e.getLocalPosition=function(t){return(t-e.my_position+5)%4||4},e.getDeskData=function(){return Data.getTopic("/tk_desk/"+e.desk_id)},e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e.hideUI=function(t){return t.parent&&t.parent.removeChild(t)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e.showUI=function(t){return e.btnGroup.addChild(t)},e.hideUIS=function(t){return t.forEach(function(t){return t.parent&&t.parent.removeChild(t)})},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),Const.Config.DESK_LOGO&&(this.img_logo.source=Const.Config.DESK_LOGO),this.initView(),this.proMatch(),this.poker1.pokersAddEventListener(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.prototype.initView=function(){var t=this;this.pokerAni=new e.PokerAni(this.pokers),this.pics=[this.pass1,this.pass2,this.pass3,this.pass4,this.win1,this.win2,this.win3,this.win4,this.leftGroup,this.rightGroup,this.topGroup],this.boomAni=new e.BoomAni(this.main),this.tianwangAni=new e.TianWangAni(this.main),this.operatBtns.playBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.poker1.playPoker(),t.operatBtns.removeMyself()},this),this.players=[{player:this.player1,pokerList:this.poker1,winLoseInfo:this.result1,pass:this.pass1,win:this.win1},{player:this.player2,pokerList:this.poker2,winLoseInfo:this.result2,pass:this.pass2,win:this.win2},{player:this.player3,pokerList:this.poker3,winLoseInfo:this.result3,pass:this.pass3,win:this.win3},{player:this.player4,pokerList:this.poker4,winLoseInfo:this.result4,pass:this.pass4,win:this.win4}],this.otherpokergroups=[this.leftGroup,this.topGroup,this.rightGroup]},i.prototype.initUI=function(){this.pics&&this.proMatch(),this.initMyinfo(),this.sortBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sortPoker,this),this.poker1.addEventListener(e.PokerList.SELECT_POKER_CHANGE,this.selectPokerChange,this),this.autoMatch.setselected(!0),this.winAni.addEventListener(egret.Event.COMPLETE,this.WinAniCall,this)},i.prototype.WinAniCall=function(){this.hideUI(this.winAni)},i.prototype.handPokerChange=function(){var t=this.poker1.isTwoLine();Main.instance.orientation===egret.OrientationMode.PORTRAIT&&(this.operatBtns.verticalCenter=t?204:394,this.pass1.verticalCenter=t?237:427)},i.prototype.selectPokerChange=function(t){this.selecePokers=t.data.pokers,this.isAllPoker=t.data.isAllPokers,this.setOperatBtnStatus()},i.prototype.setOperatBtnStatus=function(){if(0===this.selecePokers.length)this.operatBtns.setPlayBtnDisable(!1);else if(this.pass)this.pass&&e.PokerUtil.instance.isFourLianDuiBoom(this.selecePokers)?this.operatBtns.setPlayBtnDisable(!0):this.operatBtns.setPlayBtnDisable(!1);else{var t=e.PokerUtil.instance.sendPoker(this.selecePokers,this.ismust?[]:this.lastPokers,this.poker1.isFirst());this.operatBtns.setPlayBtnDisable(t)}},i.prototype.removeFromStage=function(){this.sortBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sortPoker,this),this.poker1.removeEventListener(e.PokerList.SELECT_POKER_CHANGE,this.selectPokerChange,this),this.winAni.removeEventListener(egret.Event.COMPLETE,this.WinAniCall,this)},i.prototype.proMatch=function(){this.pics.forEach(function(t){t.visible=!1}),this.sortBtn.init(),this.leftRemainNum.text=this.rightRemainNum.text=this.topRemainNum.text="13",this.players.forEach(function(t){t.player.init(),t.pass.visible=!1,t.win.visible=!1,t.winLoseInfo.initview(),t.pokerList.init()}),this.pokerAni.init(),this.hideUIS([this.operatBtns,this.autoMatch,this.sortBtn]),this.player2.visible=!1,this.player3.visible=!1,this.player4.visible=!1,this.handPokerChange(),this.my_position=0,this.deskPokers.clean(),this.lastPokers=[],this.pokers.visible=!1,this.ismust=!1,this.poker1.cleanSelectedPoker(),this.selecePokers=[],this.isAllPoker=!1,this.isInit=!1,this.isOver=!1,this.pass=!1,this.poker1.touchChildren=!0,this.sortBtn.enabled=!0},i.prototype.initData=function(){util.LogUtil.debug("[thirteenkill] [initData]");var t=this.getDeskData();Data.validate(topic.thirteenkillSchema,t);var e=t.snapshot;if(this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatNumber(this.ante||e.ante),this.topBar.bVal=this.desk_id,e&&e.stage&&"none"!==e.stage&&"start"!==e.stage){var i=e.decision_position;if(ThirteenKillController.instance.enter_room_args={ante:e.ante},this.updatePlayerInfo(!0),!i)return void util.LogUtil.info("[thirteenkill] [initData] decision_position => undefined");util.LogUtil.info("[thirteenkill] [initData] reconnect successfully!"),util.LogUtil.info("[thirteenkill] [initData] my_position => "+this.my_position),util.LogUtil.info("[thirteenkill] [initData] snapshot => "+JSON.stringify(e)),this.poker1.visible=!0,this.pokers.visible=!0;e.desk[i],this.getLocalPosition(i)-1;this.deskPokers.showPoker2(e.card),this.deskPokers.showUpGroupPoker(),this.poker1.showPoker(e.desk[this.my_position].cards),this.poker1.sortPoker(!1),this.isInit=!0,this.tianwanglaile(!1),this.onceInit()}},i.prototype.onceInit=function(){var t=this;this.player2.x?(this.showPokerNow(),this.decision()):setTimeout(function(){return t.onceInit()},70)},i.prototype.initMyinfo=function(){var t={avatar:Const.UserInfo.AVATAR,username:Const.UserInfo.NICK,balance:Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance};this.player1.userInfo=t},i.prototype.sendPoker=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o,r,s;return __generator(this,function(a){switch(a.label){case 0:return util.LogUtil.info("[thirteenkill] [sendpoker]"),util.SoundUtil.play("fp_mp3"),this.poker1.visible=!0,this.pokerAni.shuffle(),[4,this.sleep(800)];case 1:if(a.sent(),this.isOver||"deal_card"!==this.getDeskData().snapshot.stage)return[2];t=Math.floor(4*Math.random()),this.poker1.visible=!0,e=[this.player1,this.player2,this.player3,this.player4],i=0,a.label=2;case 2:return 52>i?(n=(i+t)%4,[4,this.sendAPoker(e[n],n)]):[3,5];case 3:a.sent(),a.label=4;case 4:return i++,[3,2];case 5:return this.isOver||"deal_card"!==this.getDeskData().snapshot.stage?[2]:[4,this.sleep(300)];case 6:return a.sent(),this.isOver||"deal_card"!==this.getDeskData().snapshot.stage?[2]:(o=this.getDeskData().snapshot.desk[this.my_position].cards,this.poker1.setHandPokser(o),util.LogUtil.info("[thirteenkill] [sendpoker] my cards is "+o),this.pokerAni.allPlay(),util.SoundUtil.play("fanpai_mp3"),this.poker1.showPokerWhichInBack(),[4,this.sleep(700)]);case 7:return a.sent(),r=this.getDeskData(),this.isOver||"deal_card"!==r.snapshot.stage?[2]:(s=r.snapshot.desk,this.leftGroup.visible=s[this.getNetPosition(2)].all_kill?!1:!0,this.topGroup.visible=s[this.getNetPosition(3)].all_kill?!1:!0,this.rightGroup.visible=s[this.getNetPosition(4)].all_kill?!1:!0,this.showUI(this.sortBtn),[2])}})})},i.prototype.sendAPoker=function(t,e){var i=this;return new Promise(function(n){var o=t.localToGlobal(),r=new egret.Point;r.x=o.x+t.width/2,r.y=2===e?o.y+t.height+120:o.y-120;var s=0!==e?null:function(){i.poker1.addAPoker(void 0)};util.SoundUtil.play("killer_fapai_mp3"),i.pokerAni.flyCard(s,r,e),util.TimeUtil.setTimeout(n,10)})},i.prototype.sortPoker=function(){var t=this.sortBtn.isSort;this.sortBtn.isSort=!t,this.poker1.sortPoker(!t),this.sortBtn.setType(),util.SoundUtil.play("DealCard_1_mp3")},i.prototype.registerEvent=function(){},i.prototype.onRemoveStage=function(){this.main.removeEventListener(egret.Event.RESIZE,this.resize,this)},i.prototype.resize=function(){Main.instance.orientation===egret.OrientationMode.PORTRAIT&&(this.poker1.horizontalCenter="own"===this.poker1.type?140:0)},i.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_USER_INFO:this.updatePlayerInfo();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_CANCEL_MATCH:this.autoMatch.setAutoMatch(!1),this.autoMatch.setVerPosition(this.poker1.isTwoLine(),this.poker1.visible),this.showUI(this.autoMatch);break;case Const.UICommand.CMD_CONTINUE_MATCH:this.proMatch();break;case Const.UICommand.CMD_UPDATE_FIGHT:this.decision();break;case Const.UICommand.CMD_UPDATE_MYPOKER:this.playPokerByMyself(e);break;case Const.UICommand.CMD_UPDATE_SETTLE:this.tianwanglaile();break;case Const.UICommand.CMD_UPDATE_BALANCE:this.award(e);break;case Const.UICommand.CMD_LEAVE_DESK:this.autoMatch.clearInterval()}},i.prototype.award=function(t){var e=this;[1,2,3,4].forEach(function(i){var n=t[i],o=e.getLocalPosition(i),r=e.players[o-1].winLoseInfo;n.award&&(util.LogUtil.warn("[thirteenkill] [award] pos=>"+o+" "+n.username+" 's award is "+n.award),r.setScore(n.award),e.players[o-1].player.tweenBalance(n.balance),util.TimeUtil.setTimeout(function(){var t=e.getDeskData();t&&t.snapshot&&"payout"!==t.snapshot.stage&&(r.text="")},1500))})},i.prototype.tianwanglaile=function(t){var e=this;void 0===t&&(t=!0);var i=this.getDeskData().snapshot;[1,2,3,4].forEach(function(n){var o=e.getLocalPosition(n),r=i.desk[n];if(r.all_kill){var s=e.players[o-1];switch(t&&e.tianwangAni.playAni(),r.card_size&&s.pokerList.showPoker(r.cards),s.pokerList.visible=!0,s.win.visible=!0,e.pokerAni.hidePlayerPoker(o-1),util.LogUtil.info("[thirteenkill] [tianwanglaile] pos=>"+o+" "+r.username+" is all_kill"),o){case 1:e.sortBtn.enabled=!1,e.poker1.cleanSelectedPoker(),e.poker1.touchChildren=!1;break;case 2:e.leftGroup.visible=!1;break;case 3:e.topGroup.visible=!1;break;case 4:e.rightGroup.visible=!1}}})},i.prototype.updatePlayerInfo=function(t){var e=this;void 0===t&&(t=!1);var i=this.getDeskData().snapshot;if(i){var n=i.desk;t&&0===this.my_position&&[1,2,3,4].forEach(function(t){var i=n[t];i.user_id===""+Const.UserInfo.USER_ID&&(e.my_position=Number(t))}),[1,2,3,4].forEach(function(i){var o=n[i],r=e.getLocalPosition(Number(i));if(t){var s=e.players[r-1].player;s.visible=!0,Number(i)===e.my_position&&(o.username=s.userInfo.username),s.userInfo=o}else e.players[r-1].pass.visible=o.pass})}},i.prototype.decideToPlay=function(t,i,n,o,r){t.pass.visible=!1,util.LogUtil.info("[thirteenkill] [decideToPlay] pos=>"+this.getLocalPosition(i)+" "+n.username+" 's turn"),i===this.my_position?(this.ismust=r.must,this.operatBtns.setPassBtnDisable(!this.ismust),this.pass=n.pass,!this.isInit&&n.cards&&13===n.cards.length&&13===n.card_size&&(this.isInit=!0,this.poker1.setHandPokser(n.cards),this.poker1.sortPoker(this.sortBtn.isSort)),this.showUI(this.operatBtns),this.handPokerChange(),(!this.pass||this.pass&&e.PokerUtil.instance.isFourLianDuiBoom(n.next))&&n.next&&0!==n.next.length?(this.ismust&&e.PokerUtil.instance.checkIsBoom(n.next)||(util.LogUtil.info("[thirteenkill] [decideToPlay] next card  =>"+n.next),this.poker1.setSelectPokers(n.next)),util.SoundUtil.play("kliller_MyTurn_mp3"),t.player.countDown(o-r.room_setting.time.op,o)):!this.pass||e.PokerUtil.instance.isFourLianDuiBoom(this.selecePokers)&&e.PokerUtil.istwoOrtwotow(this.lastPokers)?(util.SoundUtil.play("kliller_MyTurn_mp3"),t.player.countDown(o-r.room_setting.time.op,o),this.setOperatBtnStatus()):this.operatBtns.setPlayBtnDisable(!1)):(this.hideUI(this.operatBtns),t.player.countDown(o-r.room_setting.time.op,o))},i.prototype.decision=function(){var t=this,e=this.getDeskData().snapshot,i=e.decision_position,n=e.stop_decision_ts,o=e.desk[i],r=this.getLocalPosition(i)-1,s=this.players[r],a=0;if([1,2,3,4].forEach(function(i){0===e.desk[i].card_size&&a++,t.players[i-1].player.stopCountDown()}),n)this.decideToPlay(s,i,o,n,e);else if(s.pass.visible=o.pass,o.pass)0===r&&this.handPokerChange();else if(!util.ObjectUtil.isEqual(this.lastPokers,e.desk.card)){switch(e.desk.card&&0!==e.desk.card.length&&(this.lastPokers=e.desk.card),this.playPoker(e.desk.card||[],r),util.LogUtil.info("[thirteenkill] [decision] pos=>{pos} "+o.username+" play is "+(e.desk.card||"pass")),e.desk.card_type){case"four":case"quadruple_pair":case"triple_pair":this.boomAni.showAni()}this.playerOver(r,o,a,e)}},i.prototype.playPoker=function(t,e){var i=this;if(void 0===t&&(t=[]),0!==t.length){var n=this.deskPokers.showPoker2(t),o=[];if(n.forEach(function(t){t.scaleX=.5,t.scaleY=.5}),0===e)o=this.poker1.getPokerPostions(t),o.forEach(function(t){t.y-=30,t.scaleX=.7,t.scaleY=.7});else{var r=this.players[e].player,s=r.localToGlobal(),a={x:0,y:0};a.x=s.x+r.width/2,a.y=2===e?s.y+r.height+120:s.y-120,t.forEach(function(t){return o.push({x:a.x,y:a.y,scaleX:.5,scaleY:.5})})}n.forEach(function(t){return i.pokerAni.GlobalToLocal(t)}),o.forEach(function(t){return i.pokerAni.GlobalToLocal(t)}),this.pokerAni.playPokers(t,o,n,function(){return i.deskPokers.showUpGroupPoker()})}},i.prototype.playerOver=function(t,e,i,n){switch(t){case 0:this.isInit=!0,0===e.card_size&&(this.win1.visible=3>i),this.playPokerByMyself({isPass:!1,cards:n.desk.card});break;case 1:0===e.card_size?(this.win2.visible=3>i,this.leftGroup.visible=!1,this.pokerAni.hidePlayerPoker(t)):e.card_size&&(this.leftRemainNum.text=String(e.card_size));break;case 2:0===e.card_size?(this.win3.visible=3>i,this.topGroup.visible=!1,this.pokerAni.hidePlayerPoker(t)):e.card_size&&(this.topRemainNum.text=String(e.card_size));break;case 3:0===e.card_size?(this.win4.visible=3>i,this.rightGroup.visible=!1,this.pokerAni.hidePlayerPoker(t)):e.card_size&&(this.rightRemainNum.text=String(e.card_size))}this.pokerAni.setPokerNumber(t,e.card_size)},i.prototype.playPokerByMyself=function(t){var i=(t.isPass,t.cards);if(util.LogUtil.info("[thirteenkill] [playPokerByMyself] My play is "+(i||"pass")),i){if(i.length>1?util.SoundUtil.play("DealCard_1_mp3"):util.SoundUtil.play("DealCard_0_mp3"),this.isInit=!0,util.ObjectUtil.isEqual(this.lastPokers,i)||((!this.lastPokers||0===this.lastPokers.length)&&(this.lastPokers=i),this.playPoker(i,0)),e.PokerUtil.instance.checkIsBoom(i)&&this.boomAni.showAni(),this.isAllPoker){var n=this.getDeskData().snapshot,o=0;[1,2,3,4].forEach(function(t){0===n.desk[t].card_size&&o++}),this.win1.visible=3>o}this.poker1.playPokerSuccess(i)}else this.handPokerChange(),this.pass1.visible=!0,util.SoundUtil.play("kliller_DealPass_mp3");this.player1.stopCountDown(),this.hideUI(this.operatBtns),this.poker1.cleanSelectedPoker(),this.selecePokers=[]},i.prototype.showPokerNow=function(){var t=this;this.pokerAni.init(!1);var e=this.player2.localToGlobal();this.pokerAni.setPos({x:e.x+this.player2.width/2,y:e.y-120},1);var i=this.player3.localToGlobal();this.pokerAni.setPos({x:i.x+this.player3.width/2,y:i.y+this.player3.height+120},2);var n=this.player4.localToGlobal();this.pokerAni.setPos({x:n.x+this.player4.width/2,y:n.y-120},3),this.pokerAni.setNow();var o=this.getDeskData().snapshot;this.leftGroup.visible=!0,this.topGroup.visible=!0,this.rightGroup.visible=!0,this.showUI(this.sortBtn),0===this.my_position&&[1,2,3,4].forEach(function(e){var i=o.desk[e];i.user_id===""+Const.UserInfo.USER_ID&&(t.my_position=Number(e))}),[1,2,3,4].forEach(function(e){var i=o.desk[e],n=t.getLocalPosition(e)-1;if(i.all_kill){t.pokerAni.hidePlayerPoker(n);var r=t.players[n];switch(r.pokerList.visible=!0,i.card_size&&r.pokerList.showPoker(i.cards),r.win.visible=!0,n){case 1:t.leftGroup.visible=!1;break;case 2:t.topGroup.visible=!1;break;case 3:t.rightGroup.visible=!1}}else if(void 0!==i.card_size)switch(n){case 0:t.poker1.setHandPokser(i.cards),t.poker1.sortPoker(t.sortBtn.isSort);break;case 1:0===i.card_size?(t.leftGroup.visible=!1,t.win2.visible=!0):t.leftRemainNum.text=String(i.card_size);break;case 2:0===i.card_size?(t.topGroup.visible=!1,t.win3.visible=!0):t.topRemainNum.text=String(i.card_size);break;case 3:0===i.card_size?(t.rightGroup.visible=!1,t.win4.visible=!0):t.rightRemainNum.text=String(i.card_size)}t.pokerAni.setPokerNumber(n,i.all_kill?0:i.card_size)})},i.prototype.updateStage=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:switch(t=this.getDeskData().snapshot,e=t.stage){case"start":return[3,1];case"deal_card":return[3,2];case"decision":return[3,3];case"payout":return[3,4]}return[3,6];case 1:return this.updatePlayerInfo(!0),[3,6];case 2:return this.poker1.visible=!0,this.pokers.visible=!0,this.sendPoker(),[3,6];case 3:return this.poker1.visible=!0,this.pokers.visible=!0,this.showPokerNow(),[3,6];case 4:return this.poker1.visible=!0,this.pokerAni.init(!1),this.surplus(),this.sortBtn.enabled=!1,this.poker1.touchChildren=!1,this.poker1.cleanSelectedPoker(),[4,this.sleep(2e3)];case 5:return i.sent(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),this.autoMatch.setVerPosition(this.poker1.isTwoLine(),this.poker1.visible),this.showUI(this.autoMatch),[3,6];case 6:return[2]}})})},i.prototype.surplus=function(){var t=this;this.isOver=!0,this.leftGroup.visible=!1,this.rightGroup.visible=!1,this.topGroup.visible=!1;var e=this.getDeskData().snapshot;this.pokerAni.hidePlayerPoker(1),this.pokerAni.hidePlayerPoker(2),this.pokerAni.hidePlayerPoker(3),util.LogUtil.info("[thirteenkill] [surplus] my_position => "+this.my_position),[1,2,3,4].forEach(function(i){var n=t.getLocalPosition(i),o=e.desk[i],r=t.players[n-1];r.pass.visible=!1;var s=o.surplus;s>0?r.winLoseInfo.scoreAni(2e3,s):r.winLoseInfo.setScore(s),s>0&&r.player.shakeAvatar(),void 0===o.card_size&&(o.card_size=13),o.card_size&&r.pokerList.showPoker(o.cards),r.win.visible=!1,r.player.tweenBalance(o.balance),util.LogUtil.warn("[thirteenkill] [surplus] net_postion =>"+i+"  user_data => "+JSON.stringify(o)),i===t.my_position?s>0?(util.SoundUtil.play("win_mp3"),o.all_kill||(t.showUI(t.winAni),t.winAni.play("thirteen-win",null,0,1))):0>s&&util.SoundUtil.play("dissapoint_mp3"):(o.all_kill&&t.tianwangAni.playAni(),o.card_size&&(r.pokerList.visible=!0))
})},i}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.thirteenkill.RoomUI")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataProvider=new eui.ArrayCollection,e.init=function(){return e.girl.play("tf-girl")},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.girl.stop()},this)},e.prototype.updateHallDatas=function(t){this.dataProvider.replaceAll(t.map(function(t){var e,i;switch(t.room_id){case"SG1":e="tf_font_hall_fresh_room_png",i="room01";break;case"SG2":e="tf_font_hall_beginner_room_png",i="room02";break;case"SG3":e="tf_font_hall_intermediate_room_png",i="room03";break;case"SG4":e="tf_font_hall_advanced_room_png",i="room04";break;case"SG5":e="tf_font_hall_superior_room_png",i="room05";break;case"SG6":e="tf_font_hall_master_room_png",i="room06"}return util.ObjectUtil.merge(t,{title:e,db:i,ante:""+util.LanguageUtil.translate("lbl_game_basebet")+util.NumberUtil.formatUnit(t.bet_limit.ante),admittance:""+util.LanguageUtil.translate("lbl_game_allowbet")+util.NumberUtil.formatUnit(t.bet_limit.admittance)})}))},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.three.Hall"),function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){return e.bindData&&e.db.play(e.bindData.db,null,5*Math.random())},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),eui.Watcher.watch(this,["bindData","db"],this.init,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.db.stop()},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.bindData.room_id)},this)},e}(t.control.Button);e.HallItemButton=i,__reflect(i.prototype,"ui.three.Hall.HallItemButton")}(i=e.Hall||(e.Hall={}))}(e=t.three||(t.three={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeout=[],t._deskStage={},t.init=function(e){void 0===e&&(e=!0),e&&(t.seats.forEach(function(t){return t.init()}),t.busy=t.shined=!1),t.chipAndPoker.$children.forEach(function(t){return egret.Tween.removeTweens(t)}),t.chipAndPoker.removeChildren(),t.dealt=!1,t.timeout.forEach(function(t){return util.TimeUtil.clearTimeout(t)}),t.timeout.splice(0),util.TimeUtil.clearTimeout(t.shineTimeout)},t.getSeat=function(e){var i;return Object.keys(t.data.userInfo).some(function(n){var o=t.data.userInfo[n],r=o.user_id===Const.UserInfo.USER_ID;return r&&(e=(e+5-Number(o.position)+1)%5||5,i=t.seats[e-1]),r}),i},t.updateUserInfo=function(e){return t.getSeat(Number(e.position)).userInfo=e},t.deal=function(e){void 0===e&&(e=300),t.init(!1),t.dealt=!0,t.seats.forEach(function(i,n){e&&n?t.timeout.push(util.TimeUtil.setTimeout(function(){return i.deal(t.pokerPoint,t.chipAndPoker,e)},.5*e*n)):i.deal(t.pokerPoint,t.chipAndPoker,e)})},t.shineDispute=function(e){0===e.length&&(e=t.seats.slice()),e.length>1&&(util.SoundUtil.play("sg_LampRun_mp3"),e.forEach(function(t,e){return t.shine=0===e}),e.push(e.shift()),t.shineTimeout=util.TimeUtil.setTimeout(function(){return t.shineDispute(e)},100))},t.shineBanker=function(e,i){void 0===i&&(i=2),t.shineTimeout=util.TimeUtil.setTimeout(function(){e.shine=!e.shine,e.shine&&i--,i&&t.shineBanker(e,i)},100)},t.setCountdown=function(){var e;!t.shined&&util.TimeUtil.clearTimeout(t.shineTimeout),t.seats.filter(function(t){return t.dispute&&t.dispute.is_done}).length===t.seats.length?(t._deskStage.DISPUTE?t.shineDispute(t.seats.filter(function(t){return 1===t.dispute.dispute_rate})):t.seats.some(function(e){var i=e.dispute.is_banker;return i&&!t.shined&&(t.shined=!0,t.seats.forEach(function(t){return t.shine=t===e}),t.shineBanker(e)),i}),e=!1):e=!0,t.showCountdown=t._deskStage.DISPUTE&&e||t._deskStage.RAISE&&t.seats.some(function(t){return!(t.raise&&t.raise.is_done)})||t._deskStage.FIGHT&&t.seats.some(function(t){return!(t.fight&&t.fight.is_done)})},t.dispute=function(e,i){!i.is_banker&&util.SoundUtil.play("sg_"+(-1===i.dispute_rate?"noB":"b")+"anker_"+(util.NumberUtil.getRandom(0,1)?"boy":"girl")+"_mp3"),t.getSeat(e).dispute=i,t.showDispute=t._deskStage.DISPUTE&&!(t.seat1.dispute&&t.seat1.dispute.is_done),t.setCountdown()},t.updateRaiseRateOptions=function(e){t.raiseBtns.forEach(function(i,n){var o=e[n];i.label=""+o,0!==n&&(new Decimal(t.data.ante).mul(o).gt(t.seat1.userInfo.balance)?(i.enabled=!1,i.filters=[Const.grayFilter]):(i.enabled=!0,i.filters=null))})},t.raise=function(e,i){t.getSeat(e).raise=i,t.showRaise=t._deskStage.RAISE&&!(t.seat1.raise&&t.seat1.raise.is_done)&&!t.seat1.dispute.is_banker,t.setCountdown(),t.showRaiseTip=t.showCountdown&&t._deskStage.RAISE&&(t.seat1.raise&&t.seat1.raise.is_done||t.seat1.dispute.is_banker)},t.open=function(e,i,n){var o=t.getSeat(e).open(i,n);return t.showFight=t._deskStage.FIGHT&&!(t.seat1.fight&&t.seat1.fight.is_done),t.setCountdown(),o},t.showSurplus=function(e){void 0===e&&(e=1e3);var i=t.seats.filter(function(t){return t.dispute.is_banker})[0],n=t.data.settle[t.seat1.userInfo.position].surplus>0,o=t.data.settle[i.userInfo.position].surplus>0,r=Object.keys(t.data.settle).filter(function(e){return t.data.settle[e].surplus>0}).length;return e&&(t.seat1===i?n?t.playDB(1===r?"tf_take_all":"tf_win"):4===r&&t.playDB("tf_take_lose"):n&&t.playDB("tf_win")),Promise.all(t.seats.map(function(n){var s=t.data.settle[n.userInfo.position].surplus;return n.showSurplus(s,e),n!==i&&e?new Promise(function(a){if(s>0)if(o||4!==r){var l=function(){util.SoundUtil.play("sg_send_chip_mp3"),Array.apply(void 0,Array(util.NumberUtil.getRandom(10,12))).forEach(function(o,r,s){var l=function(){return r===s.length-1&&a()};util.TimeUtil.setTimeout(function(){return i.sendChip(n,t.chipAndPoker,e,l)},.1*e*r)})};util.TimeUtil.setTimeout(l,1.7*e)}else util.SoundUtil.play("sg_send_chip_mp3"),Array.apply(void 0,Array(util.NumberUtil.getRandom(10,12))).forEach(function(o,r,s){if(r){var l=function(){return r===s.length-1&&a()};util.TimeUtil.setTimeout(function(){return i.sendChip(n,t.chipAndPoker,e,l)},.1*e*r)}else i.sendChip(n,t.chipAndPoker,e)});else 0>s?(util.SoundUtil.play("sg_send_chip_mp3"),Array.apply(void 0,Array(util.NumberUtil.getRandom(10,12))).forEach(function(o,r,s){if(r){var l=function(){return r===s.length-1&&a()};util.TimeUtil.setTimeout(function(){return n.sendChip(i,t.chipAndPoker,e,l)},.1*e*r)}else n.sendChip(i,t.chipAndPoker,e)})):a()}):null}))},t.initMatch=function(){t.showMatch=!1,t.matchBtn.icon="tf_font_match_png",t.checkBox.visible=t.matchBtn.bindData=!0},t.match=function(){t.matchBtn.bindData=!0,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},t.playDB=function(e){switch(e){case"tf_start_game":util.SoundUtil.play("sg_kaishi_mp3"),util.SoundUtil.play("sg_kaishi_"+(util.NumberUtil.getRandom(0,1)?"boy":"girl")+"_mp3");break;case"tf_win":util.SoundUtil.play("sg_win_mp3");break;case"tf_take_all":util.SoundUtil.play("sg_tongchi_mp3"),util.SoundUtil.play("sg_tongchi_"+(util.NumberUtil.getRandom(0,1)?"boy":"girl")+"_mp3")}egret.Tween.removeTweens(t.db),t.db.alpha=1,t.db.play(e,null,null,1)},t}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"deskStage",{get:function(){return this._deskStage},set:function(t){var e=this;Object.keys(util.ObjectUtil.pure(this._deskStage)).forEach(function(i){return e._deskStage[i]=i===t}),!this._deskStage.hasOwnProperty(t)&&(this._deskStage[t]=!0),this.showDispute=this._deskStage.DISPUTE&&!(this.seat1.dispute&&this.seat1.dispute.is_done),this.showRaise=this._deskStage.RAISE&&!(this.seat1.raise&&this.seat1.raise.is_done)&&!(this.seat1.dispute&&this.seat1.dispute.is_banker),this.showFight=this._deskStage.FIGHT&&!(this.seat1.fight&&this.seat1.fight.is_done),this.setCountdown(),this.showRaiseTip=this.showCountdown&&this._deskStage.RAISE&&(this.seat1.raise&&this.seat1.raise.is_done||this.seat1.dispute&&this.seat1.dispute.is_banker)},enumerable:!0,configurable:!0}),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.seats=[this.seat1,this.seat2,this.seat3,this.seat4,this.seat5],this.raiseBtns=[this.raiseBtn1,this.raiseBtn2,this.raiseBtn3,this.raiseBtn4,this.raiseBtn5]},i.prototype.initUI=function(){this.init(),this.initMatch()},i.prototype.initData=function(){var t=this;this.deskStage=this.data.deskStage,this.topBar.aVal=util.NumberUtil.formatUnit(this.data.ante),this.topBar.bVal=this.data.desk_id,Object.keys(this.data.userInfo).forEach(function(e){var i=t.data.userInfo[e];i.user_id&&t.updateUserInfo(i)}),!this._deskStage.NONE&&this.deal(0),this._deskStage.DISPUTE&&(this.endTime=Number(this.data.stage_timestamp)+Number(this.data.room_setting.time.dispute)),Object.keys(this.data.dispute).forEach(function(e){var i=t.data.dispute[e];i.is_done&&t.dispute(Number(e),i)}),this._deskStage.RAISE&&(this.endTime=Number(this.data.stage_timestamp)+Number(this.data.room_setting.time.raise)),this.data.raise_rate_options&&this.updateRaiseRateOptions(this.data.raise_rate_options),Object.keys(this.data.raise).forEach(function(e){var i=t.data.raise[e];i.is_done&&t.raise(Number(e),i)}),this._deskStage.FIGHT&&(this.endTime=Number(this.data.stage_timestamp)+Number(this.data.room_setting.time.op)),Object.keys(this.data.fight).forEach(function(e){var i=t.data.fight[e];i.is_done&&t.open(Number(e),i,0)}),this._deskStage.SETTLE&&(this.showSurplus(0),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM))},i.prototype.registerEvent=function(){var t=this;this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return util.SoundUtil.destroy(["sg_send_chip_mp3","sg_win_mp3","sg_tongchi_mp3","sg_tongchi_boy_mp3","sg_tongchi_girl_mp3"])},this),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){return t.dealt&&t.deal(0)},this),this.fightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FIGHT,t.seat1.userInfo.position)},this),this.noDisputeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DISPUTE,t.seat1.userInfo.position,-1)},this),this.disputeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DISPUTE,t.seat1.userInfo.position,1)},this),this.raiseBtns.forEach(function(e,i){return e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,t.seat1.userInfo.position,Number(e.label))},t)}),this.matchBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.matchBtn.bindData?t.match():t.initMatch()},this),this.db.addEventListener(egret.Event.COMPLETE,function(){egret.Tween.get(t.db).wait(500).to({alpha:0},300)},this)},i.prototype.execCommand=function(e,i){var n=this;switch(util.LogUtil.debug("three.RoomUI [execCommand] cmd => "+Const.UICommand[e]),e){case Const.UICommand.CMD_UPDATE_STAGE:switch(i){case"DISPUTE":this.deskStage=i,t.three.RoomUI.instance.playDB("tf_start_game"),this.deal(),this.endTime=util.TimeUtil.now+Number(this.data.room_setting.time.dispute);break;case"RAISE":util.TimeUtil.setTimeout(function(){n._deskStage.DISPUTE&&(n.deskStage=i,util.SoundUtil.play("sg_banker_selected_mp3"))},2e3),this.endTime=util.TimeUtil.now+Number(this.data.room_setting.time.raise);break;case"FIGHT":this.deskStage=i,this.deal(0),this.endTime=util.TimeUtil.now+Number(this.data.room_setting.time.op);break;case"SETTLE":this.busy=!0,util.TimeUtil.setTimeout(function(){return __awaiter(n,void 0,void 0,function(){var t,e=this;return __generator(this,function(n){switch(n.label){case 0:return[4,this.showSurplus()];case 1:return n.sent(),this.busy=!1,this.deskStage=i,Object.keys(this.data.userInfo).forEach(function(t){return e.updateUserInfo(e.data.userInfo[t])}),(this.showMatch=this.checkBox.selected)?(t=function(i){var n=e.endTime-i,o=Math.max(Math.ceil(.001*n),0),r="（"+o+"）";return!e.stage||e.matchBtn.bindData?void util.NotifyUtil.removeNotification("util.TimeUtil.now",t):void(e.matchTime!==r&&(e.matchTime=r,0===o&&(e.match(),util.NotifyUtil.removeNotification("util.TimeUtil.now",t))))},this.matchBtn.icon="tf_font_cancel_png",this.checkBox.visible=this.matchBtn.bindData=!1,this.endTime=util.TimeUtil.now+5e3,util.NotifyUtil.addNotification("util.TimeUtil.now",t)):this.initMatch(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),[2]}})})},2500);break;default:this.deskStage=i}break;case Const.UICommand.CMD_UPDATE_USER_INFO:this.data.userInfo[i.position]=i,!this.busy&&this.updateUserInfo(i);break;case Const.UICommand.CMD_UPDATE_DISPUTE:this.dispute(i.position,i.dispute);break;case Const.UICommand.CMD_UPDATE_RAISE_RATE_OPTIONS:this.updateRaiseRateOptions(i);break;case Const.UICommand.CMD_UPDATE_RAISE:this.raise(i.position,i.raise);break;case Const.UICommand.CMD_UPDATE_FIGHT:this.open(i.position,i.fight);break;case Const.UICommand.CMD_UPDATE_SETTLE:this.data.settle=i;break;case Const.UICommand.CMD_CONTINUE_MATCH:this.init();break;case Const.UICommand.CMD_CANCEL_MATCH:this.deskStage="SETTLE",this.initMatch();break;case Const.UICommand.CMD_LEAVE_DESK:this.matchBtn.bindData=!0}},i}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.three.RoomUI")}(e=t.three||(t.three={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomIds=["TGF1","TGF2","TGF3","TGF4","TGF5","TGF6"],e.copyData=[],e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.copy(),this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.girl.stop()},this)},e.prototype.copy=function(){for(var t=0;6>t;t++)this.copyData.push(util.ObjectUtil.copy(this.rooms.dataProvider.getItemAt(t)))},e.prototype.init=function(){this.girl.play("3cgfgirl"),this.updataRooms()},e.prototype.updataRooms=function(){var t=this,e=[];this.roomsData.forEach(function(i,n){var o=t.copyData[t.roomIds.indexOf(i.room_id)];o.ante=util.NumberUtil.formatUnit(i.bet_limit.ante),o.admittance=util.NumberUtil.formatUnit(i.bet_limit.admittance),o.name=i.room_id,e.push(o)}),this.rooms.dataProvider=new eui.ArrayCollection(e)},e.prototype.updateHallDatas=function(t){this.roomsData=t,this.rooms&&this.updataRooms()},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.threeflower.Hall"),function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){if(e.bindData){if(e.bindData.visible===!1)return e.parent.includeInLayout=!1,void(e.visible=!1);e.visible=!0,e.parent.includeInLayout=!0,e.db.play(e.bindData.db)}},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),eui.Watcher.watch(this,["bindData"],this.datachange,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},e.prototype.onAddStage=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.init()},e.prototype.onRemoveStage=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.db.stop()},e.prototype.onClick=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,this.bindData.name)},e.prototype.datachange=function(){this.init()},e}(t.control.Button);e.HallItemButton=i,__reflect(i.prototype,"ui.threeflower.Hall.HallItemButton")}(i=e.Hall||(e.Hall={}))}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function t(){}return t}();e.PlayerUI=i,__reflect(i.prototype,"ui.threeflower.PlayerUI");var n=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.my_position=1,t.uis=[],t.bakerPosition=1,t.sounds={qiangzhuang:["qzwxs_banker_boy_mp3","qzwxs_banker_girl_mp3"],buqiang:["qzwxs_noBanker_boy_mp3","qzwxs_noBanker_girl_mp3"],kaishi:["qzwxs_kaishi_boy_mp3","qzwxs_kaishi_girl_mp3"]},t.count_down=function(e,i){t.showUI(t.countDown),t.countDown.show(e,i)},t.sendDeal=function(){t.hideUIS([t.threePoker,t.watchButtons]),"deal"!==t.getDeskData().snapshot.desk_info.stage||t.isSend||(t.isSend=!0,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FIGHT))},t.getNetPosition=function(e){return(e+t.my_position-1)%5||5},t.getLocalPosition=function(e){return(e-t.my_position+1)%5||5},t.getDeskData=function(){return Data.getTopic("/tgf_desk/"+t.desk_id)},t.flaychip=function(e,i,n){return t.chips.flyChip(e,i,25)},t.showResultDBAni=function(e){return t.result_ani.show(e)},t.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},t.hideUI=function(e){return t.main.contains(e)&&t.main.removeChild(e)},t.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},t.showUI=function(e){return t.main.addChild(e)},t.hideUIS=function(e){return e.forEach(function(e){return t.main.contains(e)&&t.main.removeChild(e)})},t}return __extends(n,i),Object.defineProperty(n,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),n.prototype.childrenCreated=function(){this.initView(),i.prototype.childrenCreated.call(this),this.hideUIS([this.beiginImg,this.beiginLight]),this.poker1.touchEnabled=this.poker1.touchEnabled=!0},n.prototype.initView=function(){this.uis=[this.countDown,this.watchButtons,this.qiangzhuangBtns,this.threePoker,this.autoMatch],this.chips=new t.bull.Chips(this.main),this.pokerAni=new e.PokerAni(this.gp_pokerAni),this.result_ani=new e.ResultMC(this.main),this.playerinfo=[{player:this.player1,poker:this.poker1,state:this.state1,snatch:this.snatch1},{player:this.player2,poker:this.poker2,state:this.state2,snatch:this.snatch2},{player:this.player3,poker:this.poker3,state:this.state3,snatch:this.snatch3},{player:this.player4,poker:this.poker4,state:this.state4,snatch:this.snatch4},{player:this.player5,poker:this.poker5,state:this.state5,snatch:this.snatch5}]},n.prototype.initUI=function(){this.main.addEventListener(egret.Event.RESIZE,this.resize,this),this.proMatch(),this.initMyinfo()},n.prototype.proMatch=function(){this.playerinfo.forEach(function(t,e){t.state.visible=!1,t.snatch.visible=!1,t.player.visible=0===e,t.player.init(),t.poker.init(),0!==e&&t.player.randonHead(),t.poker.visible=!1,t.poker.type=0===e?"own":"other",t.snatch.type="thinking"}),this.threePoker.init(),this.my_position=0,this.isSend=!1,this.hideUIS(this.uis)},n.prototype.initData=function(){var t=this;this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this.desk_id;var e=this.getDeskData();Data.validate(topic.threeflowerSchema,e);var i=e.snapshot;switch(this.updatePlayerInfo(),i&&i.desk_info.stage&&"init"!==i.desk_info.stage&&"none"!==i.desk_info.stage&&(util.LogUtil.info("[threeflower] [initData] reconnect successfully!"),util.LogUtil.info("[threeflower] [initData] my_position => "+this.my_position),util.LogUtil.info("[threeflower] [initData] snapshot => "+JSON.stringify(i))),i.desk_info.stage){case"dispute":this.beiginAniCall();var n=i.dispute.desk;0!==n[this.getNetPosition(this.my_position)].dispute&&(this.hideUI(this.qiangzhuangBtns),this.updateDispute());break;case"deal":var o=this.getLocalPosition(Number(i.desk_info.banker_position)),r=this.playerinfo[o-1].player;r.isBanker=!0,r.setXiaoguo(!0),this.setMyCardInfo(),this.playerinfo.forEach(function(e,i){e.player.visible&&(e.poker.visible=!0,e.poker.setBack(),0===i&&e.poker.setCards(t.myCardInfo.cards_info.cards))}),i.deal.desk[this.getNetPosition(this.my_position)].is_done?this.updateFight():(this.showUI(this.threePoker),this.showUI(this.watchButtons)),this.count_down(i.deal.stage_timestamp,i.room_setting.time.op);break;case"settle":this.updateFight(!0),this.surplus(),this.showUI(this.autoMatch),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM)}},n.prototype.initMyinfo=function(){this.player1.setName(Const.UserInfo.NICK),this.player1.setHead(Const.UserInfo.AVATAR),this.player1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance)},n.prototype.hideSnatch=function(){this.playerinfo.forEach(function(t){t.snatch.visible=!1})},n.prototype.beiginAni=function(t){var e=this;this.showUI(this.beiginImg);var i=(this.main.width+this.beiginImg.width)/2;this.beiginImg.horizontalCenter=-i,util.SoundUtil.play("qzwxs_kaishi_mp3"),util.SoundUtil.play(this.sounds.kaishi[Math.floor(2*Math.random())]),egret.Tween.get(this.beiginImg).to({horizontalCenter:0},.5*Number(i)).call(function(){return"dispute"!==e.getDeskData().snapshot.desk_info.stage?void e.hideUI(e.beiginImg):(e.showUI(e.beiginLight),void egret.Tween.get(e.beiginLight).to({scaleX:.4},240).to({scaleX:1.5},440).to({scaleX:1},200).call(function(){e.hideUIS([e.beiginImg,e.beiginLight]),"dispute"===e.getDeskData().snapshot.desk_info.stage&&e.beiginAniCall()}))})},n.prototype.beiginAniCall=function(){this.showUI(this.qiangzhuangBtns),this.qiangzhuangBtns.removeEventListener(t.bull.MultButtonsBase.EVT_SEND_MULT,this.qiangzhuang,this),this.qiangzhuangBtns.once(t.bull.MultButtonsBase.EVT_SEND_MULT,this.qiangzhuang,this),this.playerinfo.forEach(function(t,e){e&&t.player.visible&&(t.snatch.visible=!0)});var e=this.getDeskData().snapshot;this.count_down(e.dispute.stage_timestamp,e.room_setting.time.dispute)},n.prototype.qiangzhuang=function(t){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DISPUTE,t.data)},n.prototype.sendPoker=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o;return __generator(this,function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return 5>t?(e=(this.bakerPosition+5-t)%5||5,this.playerinfo[e-1].player.visible?(i=void 0,n=this.getNetPosition(Number(e)),e===this.my_position&&(o=this.getDeskData().snapshot,"settle"===o.desk_info.stage?(this.playerinfo[e-1].poker.type="other",i=[void 0,void 0].concat(o.deal.desk[this.my_position].cards_info.best_cards)):i=this.myCardInfo.cards_info.cards,util.LogUtil.info("[threeflower] [sendPoker] myCardInfo => "+i)),this.dealCard(e,i),[4,this.sleep(200)]):[3,3]):[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return"deal"===this.getDeskData().snapshot.desk_info.stage&&(this.showUI(this.threePoker),this.showUI(this.watchButtons)),[2]}})})},n.prototype.dealCard=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(n){switch(n.label){case 0:return i=this.playerinfo[t-1].poker,[4,this.pokerAni.flyCard(t,i.getTopCardPos(),i.getPokerSize())];case 1:return n.sent(),this.pokerAni.hidePoker(t),e&&i.setCards(e),[4,i.dealCardAni()];case 2:return n.sent(),[2]}})})},n.prototype.chipAni=function(){var t=this;return new Promise(function(e){var i=t.getDeskData().snapshot.settle.desk,n=0,o=[],r=[];n=t.bakerPosition,Object.keys(i).forEach(function(e){var s=i[e],a=t.getLocalPosition(Number(e));n!==Number(e)&&(s.surplus>0?r.push(a):s.surplus<0&&o.push(a))});var s=10;o.forEach(function(e){var i=t.playerinfo[n-1].player,o=t.playerinfo[e-1].player;util.SoundUtil.play("qzwxs_send_chip_mp3"),t.flaychip(o.getChipPosition(),i.getChipPosition(),s)}),egret.setTimeout(function(){t.playerinfo[n-1].player.playAnim()},t,100);var a=10;t.winTimeout=util.TimeUtil.setTimeout(function(){r.forEach(function(e){var i=10,o=t.playerinfo[e-1].player,r=t.playerinfo[n-1].player;util.SoundUtil.play("qzwxs_send_chip_mp3"),t.flaychip(r.getChipPosition(),o.getChipPosition(),i)})},30*s+500),util.TimeUtil.setTimeout(function(){r.forEach(function(e){t.playerinfo[e-1].player.playAnim()})},30*(s+a)+600),util.TimeUtil.setTimeout(e,30*(s+a)+1e3)})},n.prototype.checkDBAni=function(){var e=this,i=this.getDeskData().snapshot.settle.desk,n=[0,0];if(this.bakerPosition===this.my_position){if([1,2,3,4,5].forEach(function(t){t!==e.my_position&&e.playerinfo[t-1].player.visible&&(i[t].surplus>0?n[0]++:n[1]++)}),0===n[0])return this.showResultDBAni(t.bull.ResultEnum.take_all);if(0===n[1])return this.showResultDBAni(t.bull.ResultEnum.lose_all)}return i[this.my_position].surplus>0?this.showResultDBAni(t.bull.ResultEnum.win):void 0},n.prototype.playFrameAni=function(t,e){var i=this,n=15;n=n-n%t.length+t.indexOf(e)+1,egret.Tween.removeTweens(this.player1);var o=egret.Tween.get(this.player1);Array.apply(void 0,Array(n)).forEach(function(e,n){var r=n*n*n/15;o.call(function(){var e=n%t.length;i.playerinfo[t[0===e?t.length-1:e-1]-1].player.setXiaoguo(!1),i.playerinfo[t[e]-1].player.setXiaoguo(!0),util.SoundUtil.play("nn_bankerrun_mp3")}).wait(r)}),o.call(function(){util.SoundUtil.play("sg_banker_selected_mp3"),i.shinyThreeTimes(e)})},n.prototype.shinyThreeTimes=function(t){egret.Tween.removeTweens(this.player1);var e=egret.Tween.get(this.player1),i=this.playerinfo[t-1];[1,2,3,4,5,6,7].forEach(function(t,n){var o=50*n;e.call(function(){var t=n%2===0;i.player.setXiaoguo(t)}).wait(o)}),e.call(function(){return i.player.isBanker=!0})},n.prototype.registerEvent=function(){var t=this;this.watchButtons.addEventListener(e.WatchButtons.BTN_TOUCH,this.watchBtnTouch,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.poker1.addEventListener(e.PokerList.EVT_SELECT,function(e){util.LogUtil.debug("[threeflower] [registerEvent] selectedchange  poker=>"+JSON.stringify(e.data)),t.threePoker.dataChange(e)},this)},n.prototype.onRemoveStage=function(){this.main.removeEventListener(egret.Event.RESIZE,this.resize,this)},n.prototype.resize=function(){Main.instance.orientation===egret.OrientationMode.PORTRAIT&&(this.poker1.horizontalCenter="own"===this.poker1.type?140:0)},n.prototype.watchBtnTouch=function(t){t.data>0?(this.threePoker.showBestCards(),this.poker1.showBestCards(),egret.setTimeout(this.sendDeal,this,1e3)):this.threePoker.isRight()&&!this.isSend&&this.sendDeal()},n.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_USER_INFO:this.updatePlayerInfo();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_CANCEL_MATCH:this.autoMatch.setAutoMatch(!1),this.showUI(this.autoMatch);break;case Const.UICommand.CMD_UPDATE_DISPUTE:this.updateDispute();break;case Const.UICommand.CMD_UPDATE_FIGHT:this.updateFight();break;case Const.UICommand.CMD_CONTINUE_MATCH:this.proMatch();break;case Const.UICommand.CMD_LEAVE_DESK:this.autoMatch.clearInterval()}},n.prototype.updateFight=function(t){var e=this;void 0===t&&(t=!1);var i=this.getDeskData().snapshot.deal.desk;t&&util.LogUtil.warn("[threeflower] [updateFight] deal =>"+JSON.stringify(i)),Object.keys(i).forEach(function(n){var o=i[n];if(o.is_done||t){var r=e.getLocalPosition(Number(n)),s=[void 0,void 0].concat(o.cards_info.best_cards);e.playerinfo[r-1].poker.visible=!0,e.playerinfo[r-1].poker.showResult(s,o.cards_info.best_type)}})},n.prototype.updateDispute=function(){var t=this,e=this.getDeskData().snapshot,i=e.dispute.desk;Object.keys(i).forEach(function(n){var o=t.getLocalPosition(Number(n)),r=i[n],s=t.playerinfo[o-1].snatch;if(0!==r.dispute&&("thinking"===s.type||!s.visible)){s.visible=!0,s.type=1===r.dispute?"snatch":"nsnatch",util.LogUtil.info("[threeflower] [updateDispute] "+e.user_info[n].username+" dispute =>"+r.dispute);var a=1===r.dispute?t.sounds.qiangzhuang:t.sounds.buqiang;util.SoundUtil.play(a[Math.floor(2*Math.random())])}})},n.prototype.chooseBanker=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o,r,s,a=this;return __generator(this,function(l){switch(l.label){case 0:if(t=this.getDeskData().snapshot,e=t.dispute.desk,i=[],util.LogUtil.info("[threeflower] [chooseBanker] chooseBanker my_position => "+this.my_position),Object.keys(e).forEach(function(t){var n=a.getLocalPosition(Number(t)),o=e[t];a.playerinfo[n-1].snatch;1===o.dispute&&i.push(n)}),n=this.getLocalPosition(Number(t.desk_info.banker_position)),this.bakerPosition=n,0===i.length&&this.playerinfo.forEach(function(t,e){t.player.visible&&i.push(e+1)}),util.LogUtil.info("[threeflower] [chooseBanker] candidateList => "+i+"  banker_position =>"+t.desk_info.banker_position),!(i.length>1))return[3,2];for(o=i.splice(1),r=o.length-1;r>=0;r--)i.push(o[r]);return this.playFrameAni(i,n),[4,this.sleep(1e3)];case 1:return l.sent(),[3,3];case 2:s=this.playerinfo[n-1].player,util.SoundUtil.play("nn_banker_mp3"),this.shinyThreeTimes(n),l.label=3;case 3:return[2]}})})},n.prototype.updatePlayerInfo=function(t){var e=this;void 0===t&&(t=!1);var i=this.getDeskData().snapshot;if(i){var n=i.user_info;0===this.my_position&&Object.keys(n).forEach(function(t){var i=n[t];i.user_id===""+Const.UserInfo.USER_ID&&(e.my_position=Number(t))}),Object.keys(n).forEach(function(o){var r=n[o],s=e.getLocalPosition(Number(o)),a=e.playerinfo[s-1].player;r?(a.visible=!0,1!==s&&(a.setName(r.username),a.setHead(r.avatar)),(t||"settle"!==i.desk_info.stage)&&a.setBalance(r.balance)):a.visible=!1})}},n.prototype.setMyCardInfo=function(){this.myCardInfo=this.getDeskData().snapshot.deal.desk[this.my_position];var t=this.myCardInfo.cards_info.best_cards;this.threePoker.setCorrectArr(t),this.poker1.setCorrectArr(t),util.LogUtil.info("[threeflower] [setMyCardInfo] best_cards => "+t)},n.prototype.updateStage=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:switch(t=this.getDeskData().snapshot,this.hideUIS(this.uis),e=t.desk_info.stage){case"dispute":return[3,1];case"deal":return[3,2];case"settle":return[3,4]}return[3,7];case 1:return this.beiginAni(),util.LogUtil.info("[threeflower] [updateStage] dispute"),[3,7];case 2:return util.LogUtil.info("[threeflower] [updateStage] deal"),[4,this.chooseBanker()];case 3:return i.sent(),this.setMyCardInfo(),this.hideSnatch(),this.calRemainMill(t.deal.stage_timestamp,t.room_setting.time.op)/1e3>0&&(this.sendPoker(),this.count_down(t.deal.stage_timestamp,t.room_setting.time.op)),[3,7];case 4:return util.LogUtil.info("[threeflower] [updateStage] settle"),[4,this.sleep(800)];case 5:return i.sent(),[4,this.payoutAni()];case 6:return i.sent(),this.showUI(this.autoMatch),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM),[3,7];case 7:return[2]}})})},n.prototype.payoutAni=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.updateFight(!0),this.checkDBAni(),this.chipAni(),this.surplus()])];case 1:return t.sent(),this.updatePlayerInfo(!0),[4,this.sleep(1e3)];case 2:return t.sent(),[2]}})})},n.prototype.surplus=function(){var t=this,e=this.getDeskData().snapshot.settle.desk;util.LogUtil.info("[threeflower] [surplus] my_position => "+this.my_position),Object.keys(e).forEach(function(i){var n=e[i],o=t.getLocalPosition(Number(i)),r=t.playerinfo[o-1].state,s=t.playerinfo[o-1].player;s.visible&&(r.visible=!0,r.setScore(n.surplus),util.LogUtil.warn("[threeflower] [surplus] net_position=>"+i+" surplus=>"+n.surplus))})},n}(t.UIBase);e.RoomUI=n,__reflect(n.prototype,"ui.threeflower.RoomUI")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ROOM_ID_MAP={TE1:"xinshoufang",TE2:"chujifang",TE3:"zhongjifang",TE4:"gaojifang",TE5:"zhizunfang",TE6:"wangzhefang"},e
}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.playAni=function(t){t?(this.db_girl.play("teb_girl"),[{db:this.btn_xinshoufang.getChildAt(0).getChildAt(1),name:"teb_room1"},{db:this.btn_chujifang.getChildAt(0).getChildAt(1),name:"teb_room2"},{db:this.btn_zhongjifang.getChildAt(0).getChildAt(1),name:"teb_room3"},{db:this.btn_gaojifang.getChildAt(0).getChildAt(1),name:"teb_room4"},{db:this.btn_zhizunfang.getChildAt(0).getChildAt(1),name:"teb_room5"},{db:this.btn_wangzhefang.getChildAt(0).getChildAt(1),name:"teb_room6"}].forEach(function(t){return t.db.play(t.name,null,5*Math.random())})):(this.db_girl.stop(),[this.btn_xinshoufang.getChildAt(0).getChildAt(1),this.btn_chujifang.getChildAt(0).getChildAt(1),this.btn_zhongjifang.getChildAt(0).getChildAt(1),this.btn_gaojifang.getChildAt(0).getChildAt(1),this.btn_zhizunfang.getChildAt(0).getChildAt(1),this.btn_wangzhefang.getChildAt(0).getChildAt(1)].forEach(function(t){return t.stop()}))},e.prototype.registerEvent=function(){var t=this;[this.gp_xinshoufang,this.gp_chujifang,this.gp_zhongjifang,this.gp_gaojifang,this.gp_zhizunfang,this.gp_wangzhefang].forEach(function(e){return e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.name)},t)}),this.addEventListener(eui.UIEvent.ADDED,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(eui.UIEvent.ADDED_TO_STAGE,function(e){return e.target===t&&(t.updateData(t.rooms),t.playAni(!0))},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.playAni(!1)},this)},e.prototype.updateHallDatas=function(t){this.rooms=t,this.gp_xinshoufang&&this.updateData(t)},e.prototype.updateData=function(t){var e=this;Object.keys(this.ROOM_ID_MAP).forEach(function(t){e["gp_"+e.ROOM_ID_MAP[t]].visible=!1,e["gp_"+e.ROOM_ID_MAP[t]].includeInLayout=!1}),t.forEach(function(t){var i=t.room_id;e["gp_"+e.ROOM_ID_MAP[i]].visible=!0,e["gp_"+e.ROOM_ID_MAP[i]].includeInLayout=!0,e["gp_"+e.ROOM_ID_MAP[i]].name=i,e["btn_"+e.ROOM_ID_MAP[i]].getChildAt(0).getChildAt(4).text=util.NumberUtil.formatUnit(t.bet_limit.ante),e["btn_"+e.ROOM_ID_MAP[i]].getChildAt(0).getChildAt(6).text=util.NumberUtil.formatUnit(t.bet_limit.admittance)})},e}(t.HallBase);e.Hall=i,__reflect(i.prototype,"ui.twoeight.Hall")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.is_init=!1,e.my_position=0,e.ante=0,e.new_uis=[],e.doBankerAni=!1,e.timeout=[],e.time1=0,e.time2=0,e.hasSetBetArray=[],e.hasSetRaiseArray=[],e.updateBalance=!0,e.showUI=function(t){e.hideUIS(e.new_uis),e.main.addChild(t)},e.showCountDownUi=function(t){e.main.addChild(t)},e.hideUIS=function(t){return t.forEach(function(t){return e.main.contains(t)&&e.main.removeChild(t)})},e.changeCurOrientationMode=function(t){e.new_uis.forEach(function(e){return e.resetMode(t.data)})},e.getNetPosition=function(t){return(t+e.my_position-1)%4||4},e.getLocalPosition=function(t){return(t+4-e.my_position+1)%4||4},e.getDeskData=function(){return Data.getTopic("/te_desk/"+e.desk_id)},e._sendDispute=function(t){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DISPUTE,{my_position:e.my_position,rate:t.data}),e.player1.setBet(t.data),e.max_grab.visible=!1},e._sendRaise=function(t){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,{my_position:e.my_position,rate:t.data})},e.sleep=function(t){return new Promise(function(i){e.timeout.push(util.TimeUtil.setTimeout(i,t))})},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"desk_id",{get:function(){return this._desk_id},set:function(t){this._desk_id=t},enumerable:!0,configurable:!0}),i.prototype.initUI=function(){this.init(),this.initOwnUserInfo(),this.registUIEventListener(),this.changeCurOrientationMode({data:Main.instance.orientation}),this.clearChip(),this.cardsCount=[0,0,0,0,0,0,0,0,0,0],this.beginAnotherGameInit(),util.LogUtil.info("twoeight [initUI]")},i.prototype.init=function(){this.is_init||(this.is_init=!0,this.beginAni=new e.BeginAni,this.beginBetAni=new e.BeginBetAni,this.beginRaiseAni=new e.BeginRaiseAni,this.diceAni=new e.DiceAni,this.mult_btns=new e.MultButtons,this.hog_btns=new e.HogButtons,this.count_down=new e.CountDown,this.matchBtn=new e.MatchButton,this.new_uis=[this.beginAni,this.hog_btns,this.mult_btns,this.count_down,this.beginBetAni,this.beginRaiseAni,this.diceAni,this.matchBtn],this.timeout.forEach(function(t){return util.TimeUtil.clearTimeout(t)}),this.timeout.splice(0))},i.prototype.initData=function(){this.my_position=0,this.cardsCount=[],this.ante=this.data.ante,this.topBar.aVal=util.NumberUtil.formatUnit(this.ante),this.topBar.bVal=this.desk_id,this.updateBalance=!0,this.updateUserInfo(),this.reconnection(),util.LogUtil.info("twoeight [initData]")},i.prototype.reconnection=function(){var t=this,i=this.getDeskData().snapshot;this.deskinfo.setRound(i.desk_info.round),this.deskinfo.setChip(util.NumberUtil.formatUnit(i.desk_info.total_bet)),this.cardsCount=[],i.desk_info.cards_count&&Object.keys(i.desk_info.cards_count).forEach(function(e){t.cardsCount.push(i.desk_info.cards_count[e])}),this.showCardsCount();var n=i.desk_info.stage;this.hideUIS(this.new_uis),"dispute"!==i.desk_info.stage&&(this.max_grab.visible=!1),"raise"!==i.desk_info.stage&&(this.multipe_bets.visible=!1);var o=function(e,i){t.showCountDownUi(t.count_down),t.count_down.show(e,i)};switch(n){case"dispute":this.hasSetBetArray=[],this.max_grab.visible=!0,this.showUI(this.hog_btns),this.hog_btns.init(i.dispute.desk[1].rate_options.map(Number)),this.hog_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,this._sendDispute,this),this.hog_btns.once(e.MultButtonsBase.EVT_SEND_MULT,this._sendDispute,this);for(var r=2;4>=r;r++){var s=this["player"+r];s.group_bankerBet.visible===!1&&s.img_skip.visible===!1&&s.showThinking(!0)}this.updateDispute(),o(i.dispute.stage_timestamp,Number(i.room_setting.time.dispute)+3250),this.count_down.once(e.CountDown.EVT_HIDDEN,function(){t.hideUIS(t.new_uis)},this);break;case"raise":this["player"+this.getLocalPosition(Number(this.getDeskData().snapshot.desk_info.banker_position))].showBanker(!0,!1),this.hasSetRaiseArray=[],1!==this.getLocalPosition(Number(this.getDeskData().snapshot.desk_info.banker_position))&&(this.multipe_bets.visible=!0,this.showUI(this.mult_btns),this.mult_btns.init(i.raise.desk[1].rate_options.map(Number),this.ante,1),this.mult_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,this._sendRaise,this),this.mult_btns.once(e.MultButtonsBase.EVT_SEND_MULT,this._sendRaise,this));for(var r=2;4>=r;r++)if(this.getLocalPosition(Number(this.getDeskData().snapshot.desk_info.banker_position))!==r){var a=this["player"+r];a.group_bet.visible===!1&&a.showThinking(!0)}this.updateRaise(),o(i.raise.stage_timestamp,Number(i.room_setting.time.raise)+5e3),this.count_down.once(e.CountDown.EVT_HIDDEN,function(){t.hideUIS(t.new_uis)},this);break;case"settle":case"end":this["player"+this.getLocalPosition(Number(this.getDeskData().snapshot.desk_info.banker_position))].showBanker(!0,!1);var l=this.getLocalPosition(i.desk_info.deal_first);[0,1,2,3].forEach(function(e){var i=0;i=e+l>4?(e+l)%4:e+l;var n=t.getDeskData().snapshot.settle.desk[t.getNetPosition(i)].cards_info,o=t["player"+i].pokerList;o.poker_1.setCard(n.cards[0]),o.poker_2.setCard(n.cards[1]),o.setCardType(n.cards_type,n.cards),o.visible=!0}),this.showSurplus(),this.updateBalance=!0,this.updateUserInfo(),this.showCardsCount(),"end"===this.getDeskData().snapshot.desk_info.stage&&(this.showUI(this.matchBtn),this.clearChip(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM))}},i.prototype.registerEvent=function(){var t=this;this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.tip_group.visible=!t.tip_group.visible},this)},i.prototype.registUIEventListener=function(){this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.changeCurOrientationMode,this)},i.prototype.removeFromStage=function(){this.hideUIS(this.new_uis),this.stage.removeEventListener(Main.EVT_ORIENTATION_CHANGE,this.changeCurOrientationMode,this)},i.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_UPDATE_USER_INFO:this.updateUserInfo();break;case Const.UICommand.CMD_UPDATE_DESK_INFO:this.updateDeskInfo(!1);break;case Const.UICommand.CMD_UPDATE_DISPUTE:this.updateDispute();break;case Const.UICommand.CMD_UPDATE_RAISE:this.updateRaise();break;case Const.UICommand.CMD_UPDATE_STAGE:this.updateStage();break;case Const.UICommand.CMD_UPDATE_ROUND_INFO:this.updateRound();break;case Const.UICommand.CMD_CANCEL_MATCH:this.showUI(this.matchBtn),this.beginAnotherGameInit();break;case Const.UICommand.CMD_CONTINUE_MATCH:this.beginAnotherGameInit();break;case Const.UICommand.CMD_LEAVE_DESK:}},i.prototype.initOwnUserInfo=function(){this.player1.visible=!0,this.player1.setName(Const.UserInfo.NICK),this.player1.setBalance(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance),this.player1.setHead(Const.UserInfo.AVATAR),util.LogUtil.info("twoeight [initOwnUserInfo]")},i.prototype.updateUserInfo=function(){var t=this,e=this.getDeskData().snapshot;e.user_info&&(0===this.my_position&&Object.keys(e.user_info).forEach(function(i){var n=e.user_info[i];n.user_id===""+Const.UserInfo.USER_ID&&(t.my_position=Number(i))}),Object.keys(e.user_info).forEach(function(i){var n=e.user_info[i],o=t.getLocalPosition(Number(i)),r=t["player"+o];t.getDeskData().snapshot.desk_info.stage;n.username?(r.visible=!0,1!==o&&(r.setName(n.username),r.setHead(n.avatar)),t.updateBalance&&r.setBalance(n.balance)):(r.visible=!1,r.initHead())}))},i.prototype.updateDeskInfo=function(t){var e=this,i=this.getDeskData().snapshot.desk_info;if(this.deskinfo.setRound(i.round),this.deskinfo.setChip(util.NumberUtil.formatUnit(i.total_bet)),this.cardsCount=[],i.cards_count&&Object.keys(i.cards_count).forEach(function(t){e.cardsCount.push(i.cards_count[t])}),i.banker_position&&t){var n=[],o=[];Object.keys(this.getDeskData().snapshot.dispute.desk).forEach(function(t){var i=e.getLocalPosition(Number(t)),r=(e["player"+i],e.getDeskData().snapshot.dispute.desk[t].rate);"string"==typeof r&&(r=Number(r)),r>0?n.push(i):-1===r&&o.push(i)});var r=this.getLocalPosition(Number(i.banker_position));0===n.length&&(n=o),this.doBankerAni||this.bankerAni(n,r)}},i.prototype.showBet=function(){for(var t=1;4>=t;t++)this["player"+t].showBet(!1)},i.prototype.bankerAni=function(t,e){var i=this;this.doBankerAni=!0;var n=egret.Tween.get(this);[0,1,2].forEach(function(e){t.forEach(function(e,o){var r=i["player"+t[o]];n.call(function(){util.SoundUtil.play("erba_sound_suiji_mp3"),r.showSnatch(!0)}).wait(100).call(function(){r.showSnatch(!1),util.SoundUtil.play("erba_sound_suiji_mp3")}).wait(100)})}),this.bankerAni2(e,n)},i.prototype.bankerAni2=function(t,e){var i=this,n=this["player"+t];[0,1,2].forEach(function(t){e.call(function(){n.showSnatch(!0)}).wait(100).call(function(){n.showSnatch(!1)}).wait(100)}),e.call(function(){n.showBanker(!0,!0),i.showBet()})},i.prototype.updateStage=function(t){var i=this;void 0===t&&(t=!1),this.hideUIS(this.new_uis);var n=this.getDeskData().snapshot;"dispute"!==n.desk_info.stage&&(this.max_grab.visible=!1),"raise"!==n.desk_info.stage&&(this.multipe_bets.visible=!1);var o=function(t,e){i.showCountDownUi(i.count_down),i.count_down.show(t,e)};switch(this.updateBalance=!0,n.desk_info.stage){case"dispute":this.timeout.forEach(function(t){return util.TimeUtil.clearTimeout(t)}),this.timeout.splice(0),this.showCardsCount(),this.hasSetBetArray=[],this.rest(),this.showUI(this.beginAni),util.SoundUtil.play("erba_game_start_mp3"),this.timeout.push(util.TimeUtil.setTimeout(function(){i.showUI(i.beginBetAni),util.SoundUtil.play("erba_sound_qz_mp3")},1250)),this.timeout.push(util.TimeUtil.setTimeout(function(){i.max_grab.visible=!0,i.showUI(i.hog_btns),i.hog_btns.init(n.dispute.desk[1].rate_options.map(Number)),i.hog_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,i._sendDispute,i),i.hog_btns.once(e.MultButtonsBase.EVT_SEND_MULT,i._sendDispute,i);for(var t=2;4>=t;t++)i["player"+t].group_bankerBet.visible===!1&&i["player"+t].img_skip.visible===!1&&i["player"+t].showThinking(!0);o(n.dispute.stage_timestamp,Number(n.room_setting.time.dispute)+3250)},2250)),this.count_down.once(e.CountDown.EVT_HIDDEN,function(){i.hideUIS(i.new_uis)},this);break;case"raise":this.rest(),this.hasSetRaiseArray=[],this.updateDeskInfo(!0),this.timeout.push(util.TimeUtil.setTimeout(function(){i.showUI(i.beginRaiseAni),util.SoundUtil.play("erba_sound_betB_mp3")},3e3)),this.timeout.push(util.TimeUtil.setTimeout(function(){1!==i.getLocalPosition(Number(i.getDeskData().snapshot.desk_info.banker_position))&&(i.multipe_bets.visible=!0,i.showUI(i.mult_btns),i.mult_btns.init(n.raise.desk[1].rate_options.map(Number),i.ante,1),i.mult_btns.removeEventListener(e.MultButtonsBase.EVT_SEND_MULT,i._sendRaise,i),i.mult_btns.once(e.MultButtonsBase.EVT_SEND_MULT,i._sendRaise,i));for(var t=2;4>=t;t++)i.getLocalPosition(Number(i.getDeskData().snapshot.desk_info.banker_position))!==t&&i["player"+t].group_bet.visible===!1&&i["player"+t].showThinking(!0);o(n.raise.stage_timestamp,Number(n.room_setting.time.raise)+5e3)},4e3)),this.count_down.once(e.CountDown.EVT_HIDDEN,function(){i.hideUIS(i.new_uis)},this);break;case"settle":case"end":this["player"+this.getLocalPosition(Number(this.getDeskData().snapshot.desk_info.banker_position))].showBanker(!0,!1),this.updateBalance=!1,this.rest(),this.showUI(this.diceAni),this.diceAni.setDice(n.desk_info.init_dice),this.timeout.push(util.TimeUtil.setTimeout(function(){var t=i.getLocalPosition(n.desk_info.deal_first);i["player"+t].showArrow(),i.sendPokerAni(i.getLocalPosition(n.desk_info.deal_first))},3800))}},i.prototype.updateRound=function(){for(var t=1;4>=t;t++){var e=this["player"+t];e.showBanker(!1,!1),e.pokerList.visible=!1,e.hideBet()}this.doBankerAni=!1,this.clearChip()},i.prototype.updateDispute=function(){var t=this,e=this.getDeskData().snapshot;Object.keys(e.dispute.desk).forEach(function(i){var n=t.getLocalPosition(Number(i)),o=t["player"+n],r=e.dispute.desk[i].rate;"string"==typeof r&&(r=Number(r)),0!==r&&-1===t.hasSetBetArray.indexOf(n)&&(t.hasSetBetArray.push(n),o.setBet(r),1===n&&(t.max_grab.visible=!1))})},i.prototype.updateRaise=function(){var t=this,e=this.getDeskData().snapshot;Object.keys(e.raise.desk).forEach(function(i){var n=t.getLocalPosition(Number(i)),o=t["player"+n],r=e.raise.desk[i].rate,s=e.user_info[i].this_round_bet;if("string"==typeof r&&(r=Number(r)),0!==r&&!o.group_bet.visible){if(t.getLocalPosition(Number(t.getDeskData().snapshot.desk_info.banker_position))===n)return;-1===t.hasSetRaiseArray.indexOf(n)&&(t.hasSetRaiseArray.push(n),o.setRaise(r),util.LogUtil.info("twoeight [updateRaise][receive] this_round_bet => "+JSON.stringify(s)),t.sendChips(o,util.NumberUtil.formatUnit(s))),1===n&&(t.hideUIS(t.new_uis),t.multipe_bets.visible=!1)}})},i.prototype.sendChips=function(t,i){var n=this.gp_chipsArea.getChildByName("landscapeArea"),o=new e.Chip;o.chipValue=i,"0"!==o.chipValue&&(util.SoundUtil.play("erba_sound_bet_mp3"),o.horizontalCenter=t.horizontalCenter,o.verticalCenter=t.verticalCenter,n.addChild(o),egret.Tween.get(o).to({horizontalCenter:600*(Math.random()-.5),verticalCenter:Math.abs(100*(Math.random()-.5))+100,rotation:360*Math.random()},200));var r=this.gp_chipsArea.getChildByName("portraitArea");o=new e.Chip,o.chipValue=i,"0"!==o.chipValue&&(util.SoundUtil.play("erba_sound_bet_mp3"),o.horizontalCenter=t.horizontalCenter,o.verticalCenter=t.verticalCenter,r.addChild(o),egret.Tween.get(o).to({horizontalCenter:500*(Math.random()-.5),verticalCenter:100*(Math.random()-.5)-50,rotation:360*Math.random()},200))},i.prototype.playSettleAni=function(t){var e=this;this.settle_ani.visible=!0;var i=0;return util.LogUtil.info("twoeight [playSettleAni][receive] snapshot.settle.user_status => "+JSON.stringify(t)),new Promise(function(n){switch(t){case"all_kill":e.settle_ani.play("teb_take_all",null,0,1),util.SoundUtil.play("erba_tongchi_mp3"),e.settle_ani.alpha=1;break;case"all_lose":e.settle_ani.play("teb_take_lose",null,0,1),util.SoundUtil.play("erba_tongpei_mp3"),e.settle_ani.alpha=1;break;case"win":e.settle_ani.play("teb_win",null,0,1),util.SoundUtil.play("erba_win_mp3"),e.settle_ani.alpha=1;break;case"lose":i=1;break;default:i=1}1===i&&"end"===e.getDeskData().snapshot.desk_info.stage&&(e.showUI(e.matchBtn),e.clearChip(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM)),e.settle_ani.once(egret.Event.COMPLETE,function(){egret.Tween.get(e.settle_ani).to({alpha:0},500,egret.Ease.circOut).call(function(){e.settle_ani.visible=!1,n(),"end"===e.getDeskData().snapshot.desk_info.stage&&(e.showUI(e.matchBtn),e.clearChip(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CAN_LEAVE_ROOM))})},e)})},i.prototype.twAni=function(){var t=this;return this.tianwang_ani.visible=!0,this.tianwang_ani.alpha=1,new Promise(function(e){t.teb_light.currentFrame=0,t.teb_light.playTimes=1,t.teb_light.isPlaying=!0,t.teb_light.once(egret.Event.COMPLETE,function(){egret.Tween.get(t.tianwang_ani).to({alpha:0},500,egret.Ease.circOut).call(function(){t.tianwang_ani.visible=!1,e()})},t)})},i.prototype.sendPokerAni=function(t){for(var e=this,i=egret.Tween.get(this),n=1;4>=n;n++){var o=this["player"+n];o.pokerList.poker_1.img_poker.source="",o.pokerList.poker_2.img_poker.source="",o.pokerList.card_type.source="",o.pokerList.bg1.source="",o.pokerList.bg2.source="",o.pokerList.bg3.source=""}[0,1,2,3].forEach(function(n){var o=0;o=n+t>4?(n+t)%4:n+t;var r=e["player"+o];r.pokerList.visible=!0,0===n&&i.wait(1300),i.call(function(){r.pokerList.poker_1.setCard(10),util.SoundUtil.play("erba_sound_fanpa_mp3")}).wait(300).call(function(){r.pokerList.poker_2.setCard(10),util.SoundUtil.play("erba_sound_fanpa_mp3"),r.hideBet()}).wait(300)}),this.showPokerListAni(t,i)},i.prototype.showPokerListAni=function(t,e){var i=this;[0,1,2,3].forEach(function(n){var o=0;o=n+t>4?(n+t)%4:n+t;var r=i.getDeskData().snapshot.settle.desk[i.getNetPosition(o)].cards_info,s=i["player"+o];e.call(function(){s.pokerList.poker_1.setCard(r.cards[0]),util.SoundUtil.play("erba_sound_fanpa_mp3")}).wait(300).call(function(){s.pokerList.poker_2.setCard(r.cards[1]),util.SoundUtil.play("erba_sound_fanpa_mp3")}).wait(300).call(function(){s.pokerList.setCardType(r.cards_type,r.cards),"sky_king"===r.cards_type&&i.twAni(),util.LogUtil.info("twoeight [showPokerListAni][receive] currentPos => "+o+" cards => "+r.cards+" cards_type => "+r.cards_type)}).wait(300)}),e.call(function(){i.updateBalance=!0,i.updateUserInfo(),i.showSurplus(),i.showCardsCount();var t=i.getDeskData().snapshot.settle.user_status;i.playSettleAni(t)})},i.prototype.showCardsCount=function(){if(10===this.cardsCount.length){this.tip_group.getChildAt(1).text=String(this.cardsCount[9]);for(var t=0;t<this.cardsCount.length-1;t++)this.tip_group.getChildAt(t+2).text=String(this.cardsCount[t])}},i.prototype.showSurplus=function(){for(var t=this.getDeskData().snapshot.desk_info.stage,e=1;4>=e;e++){var i=this.getDeskData().snapshot.settle.desk[this.getNetPosition(e)].surplus;util.LogUtil.info("twoeight [showSurplus][receive] currentPos => "+e+" surplus => "+i),this["player"+e].showSurplus(t,i)}},i.prototype.clearChip=function(){var t=this.gp_chipsArea.getChildByName("landscapeArea"),e=this.gp_chipsArea.getChildByName("portraitArea");t.removeChildren(),e.removeChildren()},i.prototype.beginAnotherGameInit=function(){this.updateRound();for(var t=2;4>=t;t++){var e=this["player"+t];e.visible=!1,e.initHead(),e.hideSurplus()}if(this.player1.hideSurplus(),this.deskinfo.chip.text="注码：---",this.deskinfo.round.text="局数：---",this.cardsCount.length&&10===this.cardsCount.length){this.tip_group.getChildAt(1).text="0";for(var t=0;t<this.cardsCount.length-1;t++)this.tip_group.getChildAt(t+2).text="0"}this.clearChip()},i.prototype.rest=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.settle_ani),egret.Tween.removeTweens(this.tianwang_ani),this.hideUIS(this.new_uis),this.main.contains(this.count_down)&&this.main.removeChild(this.count_down),this.timeout.forEach(function(t){return util.TimeUtil.clearTimeout(t)}),this.timeout.splice(0)},i}(t.UIBase);e.RoomUI=i,__reflect(i.prototype,"ui.twoeight.RoomUI")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.hor_layout=new eui.HorizontalLayout,t.ver_layout=new eui.VerticalLayout,t.horizontalCenter=0,t.hor_layout.gap=13,t.ver_layout.gap=20,t.ver_layout.horizontalAlign=egret.HorizontalAlign.CENTER,t.visible=!1,t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.registEvent(),this.gp_btns.layout=528===this.verticalCenter?this.ver_layout:this.hor_layout,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.registEvent,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeEvent,this)},i.prototype.registEvent=function(){this.gp_mult_btns.addEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.removeEvent=function(){this.visible=!1,this.gp_mult_btns.removeEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.sendMult=function(t){t.stopImmediatePropagation(),this.dispatchEventWith(i.EVT_SEND_MULT,!1,t.data),this.parent&&this.parent.removeChild(this)},i.prototype.resetMode=function(t){t===egret.OrientationMode.PORTRAIT?(this.gp_btns&&(this.gp_btns.layout=this.ver_layout),this.verticalCenter=528):(this.gp_btns&&(this.gp_btns.layout=this.hor_layout),this.verticalCenter=201)},i.EVT_SEND_MULT="evt_send_mult",i}(eui.Component);t.MultButtonsBase=e,__reflect(e.prototype,"ui.twoeight.MultButtonsBase")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var FishController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="fish",e.initDesk=function(t){util.LogUtil.debug("[FISHController] [initDesk]");var i=e.room_setting_map.get(e.room_id),n=Data.getTopic(i.stage_topic);e.room_ui.setInitData({stage:n.snapshot,desk:t.snapshot,desk_item:e.room_bind_data_map.get(e.room_id)}),util.LogUtil.info("[FISHController] [setInitData]"),e.registerDeskData()},e.updateDesk=function(t,i,n){var o=t&&t.snapshot,r=i&&i.snapshot,s=n&&n.snapshot;if(util.LogUtil.debug("[FISHController] [updateDesk] newRaw => "+JSON.stringify(s)),util.LogUtil.warn("[FISHController] [updateDesk] data =>",util.ObjectUtil.copy(o)),util.ObjectUtil.isEqual(o.user_info.bet,r.user_info.bet)||(util.LogUtil.debug("[FISHController] CMD_UPDATE_BET => "+JSON.stringify(o.user_info.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_BET,o)),util.ObjectUtil.isEqual(o.bet,r.bet)||(util.LogUtil.debug("[FISHController] CMD_UPDATE_ALL_BET => "+JSON.stringify(o.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ALL_BET,o)),!util.ObjectUtil.isEqual(o.open,r.open)&&o.open&&(util.LogUtil.debug("[FISHController] CMD_UPDATE_CARDS => "+JSON.stringify(o.open)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_CARDS,o.open)),o.open&&util.ObjectUtil.isEqual(o.user_info.balance,r.user_info.balance)){var a={desk_settles:o.desk_settles,own_settle:o.user_info.settle,own_total_surplus:o.user_info.surplus,result:o.result};e.old_settle_log&&util.ObjectUtil.isEqual(a,e.old_settle_log)||(e.old_settle_log=a,util.LogUtil.debug("[FISHController] CMD_UPDATE_SETTLE => "+JSON.stringify(a))),util.LogUtil.debug("------------settleData------",o),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_SETTLE,{open:o.open,player_total_bet:o.bet,own_bet:o.user_info.bet,desk_settles:o.desk_settles,own_settle:o.user_info.settle,own_total_surplus:o.user_info.surplus,result:o.result})}util.ObjectUtil.isEqual(o.user_info,r.user_info)||(util.LogUtil.debug("[FISHController] CMD_UPDATE_USER_INFO"),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO,o.user_info)),util.ObjectUtil.isEqual(o.round_id,r.round_id)&&util.ObjectUtil.isEqual(o.round_number,r.round_number)||(util.LogUtil.debug("[FISHController] CMD_UPDATE_ROUND_INFO"),e.old_settle_log=void 0,e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO,{round_id:o.round_id,round_number:o.round_number}))},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.updateStageHandler=function(t,e,i,n){var o=e.snapshot,r=e.snapshot.bet_limit,s=0,a=0,l="",u="";Object.keys(r.min).forEach(function(t){var e=Number(r.min[t]);(0===s||s>e)&&(s=e)}),Object.keys(r.max).forEach(function(t){var e=Number(r.max[t]);(0===a||e>a)&&(a=e)}),l=util.NumberUtil.formatUnit(s),u=util.NumberUtil.formatUnit(a),t.simple_limit=l+"-"+u,t.limit=""+util.LanguageUtil.translate("lbl_room_bet_limit2")+t.simple_limit,t.stage_timestamp=o.stage_timestamp,t.stage_room_setting=o.room_setting,o.stage!==t.game_stage&&t.room_id===this.room_id&&this.room_ui.stage&&(t.game_stage=o.stage,"after_settle"===t.game_stage.toLowerCase()&&this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROBOT_SETTEL,e.snapshot.channel_settles[Const.UserInfo.CHANNEL_ID]),this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_STAGE,e.snapshot))},e.prototype.updateRoadMapHandler=function(t,e){util.LogUtil.debug("-------updateRoadMapHandler-------",t,e),t.road_map=util.ObjectUtil.copy(e.snapshot.round_result),ui.fish.Hall.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t),t.room_id===this.room_id&&ui.fish.RoomUI.instance.stage&&ui.fish.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t)},e}(JoinDeskGameController);__reflect(FishController.prototype,"FishController");var FlowerController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="gf",e.initDesk=function(t){e.hideLoading(t),ui.flower.RoomUI.instance.desk_id=e.desk_id,ui.flower.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i,n){var o=util.ObjectUtil.copy(i);if(o.snapshot.version=t.snapshot.version,o.snapshot.timestamp=t.snapshot.timestamp,!util.ObjectUtil.isEqual(t.snapshot,o.snapshot)){Data.validate(topic.FlowerDeskTopic.schema,t);var r=t.snapshot,s=i.snapshot;util.LogUtil.debug("[updateDesk][receive] desk_id => "+JSON.stringify(e.desk_id)+" newRaw => "+JSON.stringify(n)),e.checkNewData(t,i,"desk")&&ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DESK),e.checkNewData(t,i,"room_setting")&&ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROOM_SETTING),r.stage!==s.stage&&(util.LogUtil.info("desk_id => "+JSON.stringify(e.desk_id)+" CMD_UPDATE_STAGE:"+JSON.stringify(r.stage)),ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t)),r.total_bet!==s.total_bet&&ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_BET),r.round!==s.round&&ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO),r.dynamic_min!==s.dynamic_min&&ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DYNAMIC_MIN),r.stop_decision_ts!==s.stop_decision_ts&&ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STOP_DECISION),r.decision_position!==s.decision_position&&ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DECISION_POSITION),r.card_pk!==s.card_pk&&r.card_pk.length>0&&ui.flower.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_CARD_PK)}},e.checkNewData=function(t,e,i){return!e||!util.ObjectUtil.isEqual(t.snapshot[i],e.snapshot[i])},e.sendFold=function(){util.LogUtil.info("[FlowerController][sendFold] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic),service.FlowerService.instance.fold(e.desk_topic+"/"+e.desk_id)},e.sendRasie=function(t){util.LogUtil.info("[FlowerController][sendRasie] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic+" chip => "+t+" "),service.FlowerService.instance.rasie(e.desk_topic+"/"+e.desk_id,t)},e.sendFight=function(t){util.LogUtil.info("[FlowerController] [sendFight] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic+" target_order => "+t),service.FlowerService.instance.fight(e.desk_topic+"/"+e.desk_id,t)},e.sendWatch=function(){util.LogUtil.info("[FlowerController] [sendWatch] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic),service.FlowerService.instance.watch(e.desk_topic+"/"+e.desk_id)},e.sendCancel=function(){util.LogUtil.info("[FlowerController] [sendCancel] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic),service.FlowerService.instance.cancel(e.desk_topic+"/"+e.desk_id)},e.sendToggle=function(t){util.LogUtil.info("[FlowerController] [sendToggle] desk_id => "+e.desk_id+" desk_topic => "+e.desk_topic+" flag => "+t),service.FlowerService.instance.toggle(e.desk_topic+"/"+e.desk_id,t)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_FOLD,this.sendFold),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_FIGHT,this.sendFight),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_WATCH,this.sendWatch),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_CANCEL,this.sendCancel),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_TOGGLE,this.sendToggle)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_FOLD,this.sendFold),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_FIGHT,this.sendFight),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_WATCH,this.sendWatch),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_CANCEL,this.sendCancel),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_TOGGLE,this.sendToggle)},e.prototype.checkReBackRoom=function(t){var e=t&&"payout"!==t.snapshot.stage.toLowerCase();return!e&&util.LogUtil.warn("[checkReBackRoom] desk_topic:"+!!t+" desk_topic.snapshot.stage: "+t.snapshot.stage),e},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&"deal_card"!==t.snapshot.stage&&this.autoHideMatch()},e}(MatchDeskGameController);__reflect(FlowerController.prototype,"FlowerController");var FourBullController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="look4",e.initDesk=function(t){e.hideLoading(t),ui.four.RoomUI.instance.desk_id=e.desk_id,ui.four.RoomUI.instance.setInitData({ante:t.snapshot.bet_limit.ante})},e.updateDesk=function(t,i){Data.validate(topic.fourSchema,t);var n=t.snapshot,o=i.snapshot;util.ObjectUtil.isEqual(n.user_info,o.user_info)||ui.four.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO),util.ObjectUtil.isEqual(n.dispute,o.dispute)||ui.four.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_DISPUTE),util.ObjectUtil.isEqual(n.raise,o.raise)||ui.four.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_RAISE),util.ObjectUtil.isEqual(n.fight,o.fight)||ui.four.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),util.ObjectUtil.isEqual(n.settle,o.settle)||ui.four.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FIGHT),n.stage!==o.stage&&(ui.four.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_STAGE),e.hideLoading(t))},e.sendDispute=function(t){return service.FourBullService.instance.disputeBanker(e.desk_topic+"/"+e.desk_id,""+t.my_position,t.rate)},e.sendRasie=function(t){return service.FourBullService.instance.rasie(e.desk_topic+"/"+e.desk_id,""+t.my_position,t.rate)
},e.sendFightDone=function(t){return service.FourBullService.instance.fight(e.desk_topic+"/"+e.desk_id,""+t,!0)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.registerNotify=function(){t.prototype.registerNotify.call(this),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone)},e.prototype.removeRegisterNotify=function(){t.prototype.removeRegisterNotify.call(this),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DISPUTE,this.sendDispute),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_RAISE,this.sendRasie),util.NotifyUtil.removeNotification(Const.UINotify.NOTIFY_DONE,this.sendFightDone)},e.prototype.hideLoading=function(t){ui.dialog.MatchDialog.instance.stage&&t.snapshot.stage&&"none"!==t.snapshot.stage.toLowerCase()&&this.autoHideMatch()},e.prototype.checkReBackRoom=function(t){return t&&"settle"!==t.snapshot.stage.toLowerCase()},e}(MatchDeskGameController);__reflect(FourBullController.prototype,"FourBullController");var ui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getCurrentState=function(){return this.skin.hasState("square")&&Math.max(window.innerWidth/window.innerHeight,window.innerHeight/window.innerWidth)<=4/3?"square":Main.instance.orientation},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.invalidateState(),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.invalidateState,this),this.skin&&this.stage.addEventListener(egret.Event.RESIZE,function(){return e.getCurrentState()!==e.skin.currentState&&e.invalidateState()},this)},e}(eui.ItemRenderer);t.ItemRenderer=e,__reflect(e.prototype,"ui.ItemRenderer")}(ui||(ui={}));var HiloController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="hilo",e.initDesk=function(t){util.LogUtil.debug("[HiloController] [initDesk]");var i=e.room_setting_map.get(e.room_id),n=Data.getTopic(i.stage_topic);e.room_ui.setInitData({stage:n.snapshot,desk:t.snapshot,desk_item:e.room_bind_data_map.get(e.room_id)}),util.LogUtil.info("[HiloController] [setInitData]"),e.registerDeskData()},e.updateDesk=function(t,i,n){var o=t&&t.snapshot,r=i&&i.snapshot,s=n&&n.snapshot;if(util.LogUtil.debug("[HiloController] [updateDesk] newRaw => "+JSON.stringify(s)),util.ObjectUtil.isEqual(o.user_info.bet,r.user_info.bet)||(util.LogUtil.debug("[HiloController] CMD_UPDATE_BET => "+JSON.stringify(o.user_info.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_BET,o)),util.ObjectUtil.isEqual(o.bet,r.bet)||(util.LogUtil.debug("[HiloController] CMD_UPDATE_ALL_BET => "+JSON.stringify(o.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ALL_BET,o)),!util.ObjectUtil.isEqual(o.open,r.open)&&o.open&&(util.LogUtil.debug("[HiloController] CMD_UPDATE_CARDS => "+JSON.stringify(o.open)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_CARDS,o.open)),o.open&&util.ObjectUtil.isEqual(o.user_info.balance,r.user_info.balance)){var a={desk_settles:o.desk_settles,own_settle:o.user_info.settle,own_total_surplus:o.user_info.surplus,result:o.result};e.old_settle_log&&util.ObjectUtil.isEqual(a,e.old_settle_log)||(e.old_settle_log=a,util.LogUtil.debug("[HiloController] CMD_UPDATE_SETTLE => "+JSON.stringify(a))),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_SETTLE,{open:o.open,player_total_bet:o.bet,own_bet:o.user_info.bet,desk_settles:o.desk_settles,own_settle:o.user_info.settle,own_total_surplus:o.user_info.surplus,result:o.result})}util.ObjectUtil.isEqual(o.user_info,r.user_info)||(util.LogUtil.debug("[HiloController] CMD_UPDATE_USER_INFO"),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO,o.user_info)),util.ObjectUtil.isEqual(o.round_id,r.round_id)&&util.ObjectUtil.isEqual(o.round_number,r.round_number)||(util.LogUtil.debug("[HiloController] CMD_UPDATE_ROUND_INFO"),e.old_settle_log=void 0,e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO,{round_id:o.round_id,round_number:o.round_number}))},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.updateStageHandler=function(t,e,i,n){var o=e.snapshot,r=e.snapshot.bet_limit,s=0,a=0,l="",u="";Object.keys(r.min).forEach(function(t){var e=Number(r.min[t]);(0===s||s>e)&&(s=e)}),Object.keys(r.max).forEach(function(t){var e=Number(r.max[t]);(0===a||e>a)&&(a=e)}),l=util.NumberUtil.formatUnit(s),u=util.NumberUtil.formatUnit(a),t.simple_limit=l+"-"+u,t.limit=""+util.LanguageUtil.translate("lbl_room_bet_limit2")+t.simple_limit,t.stage_timestamp=o.stage_timestamp,t.stage_room_setting=o.room_setting,o.stage!==t.game_stage&&t.room_id===this.room_id&&this.room_ui.stage&&(t.game_stage=o.stage,"after_settle"===t.game_stage.toLowerCase()&&this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROBOT_SETTEL,e.snapshot.channel_settles[Const.UserInfo.CHANNEL_ID]),this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_STAGE,e.snapshot))},e.prototype.updateRoadMapHandler=function(t,e){t.road_map=util.ObjectUtil.copy(e.snapshot.round_result),ui.hilo.Hall.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t),t.room_id===this.room_id&&ui.hilo.RoomUI.instance.stage&&ui.hilo.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t)},e}(JoinDeskGameController);__reflect(HiloController.prototype,"HiloController");var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){return e.isFixed&&e.addEventListener(egret.Event.RENDER,e.render,e)},e.render=function(){var t=1e5===e.maxWidth,i=t?e.width*e.scaleX/e.oldScaleX:e.maxWidth;e.scaleX=(e.textWidth>i?i/e.textWidth:1)*e.oldScaleX,e.width=t&&e.width>e.textWidth?i*e.oldScaleX/e.scaleX:e.textWidth},e}return __extends(e,t),Object.defineProperty(e.prototype,"isFixed",{get:function(){return this._isFixed},set:function(t){this._isFixed=t},enumerable:!0,configurable:!0}),e.prototype.$getTextLines=function(){var e=this;if(isNaN(this.explicitWidth)&&(this.$textFieldWidth=0/0),isNaN(this.explicitHeight)&&(this.$textFieldHeight=0/0),this.isFixed){var i=t.prototype.$getTextLines.call(this),n=0,o=[],r=[],s=void 0,a=void 0;return i.length&&(this.textLines=this.text.split(/\r\n|\r|\n/),this.textLines.forEach(function(t){var s="";i.slice(n).some(function(a,l){return s+=a,s===t?(o.push(e.$textLinesWidth.slice(n,n+l+1).reduce(function(t,n,o){return t+n+(o===i.length-1?0:e.letterSpacing)})),r.push(Math.max.apply(Math,e.$lineHeights.slice(n,n+=l+1))),s="",!0):!1})}),this.$textLinesWidth=o,this.$lineHeights=r,this.$textWidth=s=Math.max.apply(Math,o),this.$textHeight=a=r.reduce(function(t,n,o){return t+n+(o===i.length-1?0:e.lineSpacing)}),this.$textStartY=this.$textStartX=0,this.$textFieldWidth>s&&(this.textAlign===egret.HorizontalAlign.RIGHT?this.$textStartX=this.$textFieldWidth-s:this.textAlign===egret.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor((this.$textFieldWidth-s)/2))),this.$textFieldHeight>a&&(this.verticalAlign===egret.VerticalAlign.BOTTOM?this.$textStartY=this.$textFieldHeight-a:this.verticalAlign===egret.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((this.$textFieldHeight-a)/2)))),this.textLines}return t.prototype.$getTextLines.call(this)},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.oldScaleX=this.scaleX,this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.hasEventListener(egret.Event.RENDER)&&e.removeEventListener(egret.Event.RENDER,e.render,e)},this)},e}(eui.BitmapLabel);t.BitmapLabel=e,__reflect(e.prototype,"ui.control.BitmapLabel")}(e=t.control||(t.control={}))}(ui||(ui={}));var HoroscopeController=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="horoscope",e.room_bind_data_map=new Map,e.initDesk=function(t){Data.validate(topic.horoscope.deskSchema,t),util.LogUtil.debug("[HoroscopeController] [initDesk]");var i=e.room_setting_map.get(e.room_id),n=Data.getTopic(i.stage_topic);Data.validate(topic.horoscope.stageSchema,n),e.room_ui.setInitData({stage:n.snapshot,desk:t.snapshot,desk_item:e.room_bind_data_map.get(e.room_id)}),util.LogUtil.info("[HoroscopeController] [setInitData]"),e.registerDeskData()},e.updateDesk=function(t,i,n){var o=t&&t.snapshot,r=i&&i.snapshot,s=n&&n.snapshot;if(util.LogUtil.debug("[HoroscopeController] [updateDesk] newRaw => "+JSON.stringify(s)),Data.validate(topic.horoscope.deskSnapshotSchema,o),util.ObjectUtil.isEqual(o.user_info.bet,r.user_info.bet)||(util.LogUtil.debug("[HoroscopeController] CMD_UPDATE_BET => "+JSON.stringify(o.user_info.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_BET,{own:o.user_info.bet,total:o.bet})),util.ObjectUtil.isEqual(o.bet,r.bet)||(util.LogUtil.debug("[HoroscopeController] CMD_UPDATE_ALL_BET => "+JSON.stringify(o.bet)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ALL_BET,{own:o.user_info.bet,total:o.bet})),!util.ObjectUtil.isEqual(o.open,r.open)&&o.open&&(util.LogUtil.debug("[HoroscopeController] CMD_UPDATE_CARDS => "+JSON.stringify(o.open)),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_CARDS,o.open)),o.open&&util.ObjectUtil.isEqual(o.user_info.balance,r.user_info.balance)){var a={desk_settles:o.desk_settles,own_settle:o.user_info.settle,surplus:o.user_info.surplus};e.old_settle_log&&util.ObjectUtil.isEqual(a,e.old_settle_log)||(e.old_settle_log=a,util.LogUtil.debug("[HoroscopeController] CMD_UPDATE_SETTLE => "+JSON.stringify(a))),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_SETTLE,{open:o.open,total_bet:o.bet,own_bet:o.user_info.bet,desk_settles:o.desk_settles,own_settle:o.user_info.settle,surplus:o.user_info.surplus})}util.ObjectUtil.isEqual(o.user_info,r.user_info)||(util.LogUtil.debug("[HoroscopeController] CMD_UPDATE_USER_INFO"),e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_USER_INFO,o.user_info)),util.ObjectUtil.isEqual(o.round_id,r.round_id)&&util.ObjectUtil.isEqual(o.round_number,r.round_number)||(util.LogUtil.debug("[HoroscopeController] CMD_UPDATE_ROUND_INFO"),e.old_settle_log=void 0,e.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROUND_INFO,{round_id:o.round_id,round_number:o.round_number}))},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.updateStageHandler=function(t,e,i,n){Data.validate(topic.horoscope.stageSchema,e);var o=e.snapshot,r=e.snapshot.bet_limit,s=0,a=0,l="",u="",h=0;Object.keys(r.min).forEach(function(t){var e=Number(r.min[t]);(0===s||s>e)&&(s=e)}),Object.keys(r.max).forEach(function(t){var e=Number(r.max[t]);(0===a||e>a)&&(a=e)}),l=util.NumberUtil.formatUnit(s),u=util.NumberUtil.formatUnit(a),t.simple_limit=l+"-"+u,t.limit=""+util.LanguageUtil.translate("lbl_room_betlimit")+t.simple_limit,t.stage_timestamp=o.stage_timestamp,t.stage_room_setting=o.room_setting,t.pool=util.NumberUtil.formatUnit(h),o.stage!==t.game_stage&&t.room_id===this.room_id&&this.room_ui.stage&&(t.game_stage=o.stage,"pool"===t.game_stage.toLowerCase()&&this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_ROBOT_SETTEL,e.snapshot.channel_settles[Const.UserInfo.CHANNEL_ID]),this.room_ui.execCommand(Const.UICommand.CMD_UPDATE_STAGE,e.snapshot))},e.prototype.updateRoadMapHandler=function(t,e){Data.validate(topic.horoscope.roadmap_schema,e),t.road_map=util.ObjectUtil.copy(e.snapshot.round_result),t.room_id===this.room_id&&ui.horoscope.RoomUI.instance.stage&&ui.horoscope.RoomUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ROAD_MAP,t)},e}(JoinDeskGameController);__reflect(HoroscopeController.prototype,"HoroscopeController");var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shot=function(){egret.callLater(function(){var t=new egret.RenderTexture;t.drawToTexture(e.content),e.cache.source=t},e)},e}return __extends(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){this._source=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipseWidth",{get:function(){return this._ellipseWidth},set:function(t){this._ellipseWidth=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.skinName='<e:Skin states="normal,center" xmlns:e="http://ns.egret.com/eui">\n                        <e:Group id="content" width="100%" height="100%" alpha="0">\n                            <e:Image id="img" source="{source}" width.normal="100%" height.normal="100%" horizontalCenter="0"\n                                    verticalCenter="0" mask="{rect}" />\n                            <e:Rect id="rect" width="100%" height="100%" ellipseWidth="{ellipseWidth}" />\n                        </e:Group>\n                        <e:Image id="cache" includeInLayout="false" />\n                    </e:Skin>',this.img.addEventListener(egret.Event.COMPLETE,this.shot,this),this.content.addEventListener(egret.Event.RESIZE,this.shot,this)},e}(eui.Component);t.EllipseImage=e,__reflect(e.prototype,"ui.control.EllipseImage")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"bg",{get:function(){return this._bg},set:function(t){this._bg=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elements",{get:function(){return this._elements},set:function(t){this._elements=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this._contentWidth},set:function(t){this._contentWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._contentHeight},set:function(t){this._contentHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,this.initIcon()},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this)},e.prototype.initIcon=function(){this.iconDisplay&&(this.iconDisplay.source=this.icon,this.iconDisplay.includeInLayout=this.iconDisplay.visible=!!this.icon)},e.prototype.init=function(){this.initIcon()},e}(eui.Panel);t.Panel=e,__reflect(e.prototype,"ui.control.Panel")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var n=null!==e&&e.apply(this,arguments)||this;return n.dataProvider=new eui.ArrayCollection,n.update=function(e){e.forEach(function(e){var n=t.component.Avatar.generateAvatar(e.avatar);e.user_id===Const.UserInfo.USER_ID?(e.username=Const.UserInfo.NICK,i.avatarMap.set(e.user_id,Const.UserInfo.AVATAR)):e.avatar!==n&&i.avatarMap.get(e.user_id)||i.avatarMap.set(e.user_id,n)}),n.dataProvider.replaceAll(e.map(function(t,e){return util.ObjectUtil.merge(t,{state:e>1?e>5?"loser":"normal":"rank"+(e+1),rank:e+1,balance:util.NumberUtil.formatNumber(t.balance),avatar:i.avatarMap.get(t.user_id)})}))},n}return __extends(i,e),i.avatarMap=new Map,i}(t.Component);e.PlayerArea=i,__reflect(i.prototype,"ui.dragontiger.PlayerArea")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.update=function(e,i,n,o){return util.LogUtil.info("[BlackjackService] sendData topic=>"+e+" data =>"+JSON.stringify(i)),t.prototype.update.call(this,e,i,n,o)},e.prototype.raise=function(t,e){return this.updateWithCatch(t,{action:"bet",raise:e},null,!0,!1)},e.prototype.split=function(t){return this.updateWithCatch(t,{action:"split"},null,!0,!1)},e.prototype.hit=function(t){return this.update(t,{action:"hit"},null,!0)},e.prototype["double"]=function(t){return this.updateWithCatch(t,{action:"redouble"},null,!0,!1)},e.prototype.stop=function(t){return this.update(t,{action:"stand"},null,!0)},e.prototype.buyProtect=function(t,e){return this.updateWithCatch(t,{action:"insurance",insurance:e},null,!0,!1)},e}(t.ServiceBase);t.BlackjackService=e,__reflect(e.prototype,"service.BlackjackService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setHead=function(t){this.avatar=t},e.prototype.getPokerList=function(){return this.com_pokerlist},e}(t.Component);e.BankerFrame=i,__reflect(i.prototype,"ui.bairen.BankerFrame")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tian=0,e.di=1,e.xuan=2,e.huang=3,e.ALL_TYPE=["tian","di","xuan","huang"],e}return __extends(e,t),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this.btns=[this.btn_tian,this.btn_di,this.btn_xuan,this.btn_huang],this.results=[this.img_tian,this.img_di,this.img_xuan,this.img_huang],this.hovers=[this.img_tianbg,this.img_dibg,this.img_xuanbg,this.img_huangbg],this.owns=[this.lab_tian_own,this.lab_di_own,this.lab_xuan_own,this.lab_huang_own],this.alls=[this.lab_tian_all,this.lab_di_all,this.lab_xuan_all,this.lab_huang_all],this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.btns[0].enabled||i.dispatchEventWith(e.EVT_SHOW_TIP)},this),this.ALL_TYPE.forEach(function(t){var e=i[t];i.btns[e].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.onBet(t)},i),i.btns[e].addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){i.hovers[e].alpha=.4},i),i.btns[e].addEventListener(egret.TouchEvent.TOUCH_END,function(){i.hovers[e].alpha=.2},i),i.btns[e].addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){i.hovers[e].alpha=.2},i),i.btns[e].addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){i.hovers[e].alpha=0},i),mouse.setButtonMode(i.btns[e],!0)}),this.init()},e.prototype.init=function(){var t=this;this.ALL_TYPE.forEach(function(e){var i=t[e];egret.Tween.removeTweens(t.results[i]),t.results[i].alpha=0})},e.prototype.showResult=function(t){var e=this;this.init(),t.forEach(function(t){var i=e[t];e.results[i].alpha=0,egret.Tween.get(e.results[i],{loop:!0}).to({alpha:1},500).to({alpha:0},500)})},e.prototype.onBet=function(t){this.dispatchEventWith(e.EVT_BET,!1,t)},e.prototype.updateBet=function(t,e){var i=this;Object.keys(t).forEach(function(n){var o=i[n];e?i.owns[o].text=util.NumberUtil.formatNumber(t[n]||0):i.alls[o].text=util.NumberUtil.formatNumber(t[n]||0)})},e.prototype.setEnable=function(t){var e=this;this.ALL_TYPE.forEach(function(i){var n=e[i];e.btns[n].enabled=t,e.hovers[n].alpha=0})},e.EVT_BET="evt_bet",e.EVT_SHOW_TIP="evt_show_tip",e}(t.Component);e.BetArea=i,__reflect(i.prototype,"ui.bairen.BetArea")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),egret.Tween.get(this.group_star1,{loop:!0}).to({rotation:360},3e3),egret.Tween.get(this.group_star2,{loop:!0}).to({rotation:360},2e3),egret.Tween.get(this.group_star3,{loop:!0}).to({rotation:360},3e3),egret.Tween.get(this.group_star4,{loop:!0}).to({rotation:360},2e3),egret.Tween.get(this.img_long,{loop:!0}).to({rotation:360},300),egret.Tween.get(this.img_short,{loop:!0}).to({rotation:360},800)},e.prototype.show=function(t){switch(this.visible=!1,this.group_start.visible=!1,this.group_stop.visible=!1,t){case"start":this.visible=!0,this.group_start.visible=!0;break;case"stop":this.visible=!0,this.group_stop.visible=!0}},e}(t.Component);e.BetHint=i,__reflect(i.prototype,"ui.bairen.BetHint")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this.btn_people.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.dispatchEventWith(e.EVT_TOGGLE_PEOPLE)},this),this.initRoadMap()},e.prototype.setRoadMapBlink=function(t){this.com_roadMap.is_blink=t},e.prototype.setChips=function(t){this.com_chipList.setChips(t)},e.prototype.setHead=function(t){this.com_head.setHead(t)},e.prototype.setName=function(t){this.com_head.setName(t)},e.prototype.setBalance=function(t){this.com_head.setBalance(t)},e.prototype.setSurplus=function(t){0===t?this.com_head.showSurplus(!1):this.com_head.showSurplus(!0,t)},e.prototype.updatePeople=function(t){this.btn_people.label=t.toString()},e.prototype.getOwnPos=function(){var t=this.com_head.localToGlobal();return{x:t.x+64,y:t.y+64}},e.prototype.getOtherPos=function(){var t=this.btn_people.localToGlobal();return{x:t.x+this.btn_people.width/2,y:t.y+this.btn_people.height/2}},e.prototype.showSurplus=function(t,e){this.com_head.showSurplus(t,e)},e.prototype.getCurChipValue=function(){return this.com_chipList.cur_chosen_item.value},e.prototype.showWin=function(t){this.com_head.showWin(t)},e.prototype.setRoadMap=function(t){this.road_map=t},e.prototype.updateEnable=function(t){this.com_chipList.updateEnable(t)},e.prototype.betAni=function(t){if(t){var e=this.currentState===egret.OrientationMode.LANDSCAPE?0:-95;this.com_head.verticalCenter=e,egret.Tween.get(this.com_head).to({verticalCenter:e-15},80,egret.Ease.quadOut).to({verticalCenter:e},80,egret.Ease.quadIn)}else{var e=26;this.btn_people.bottom=e,egret.Tween.get(this.btn_people).to({bottom:e+15},80,egret.Ease.quadOut).to({bottom:e},80,egret.Ease.quadIn)}},e.prototype.initRoadMap=function(){var t="zh_cn"===Const.Config.LANGUAGE||"zh_hk"===Const.Config.LANGUAGE;this.road_map_title0="lbl_game_sky",this.road_map_title1="lbl_game_land",this.road_map_title2="lbl_game_mysterious",this.road_map_title3="lbl_game_yellow",this.road_map_title_src0=t?"":"hundreds_tian_png",this.road_map_title_src1=t?"":"hundreds_di_png",this.road_map_title_src2=t?"":"hundreds_xuan_png",this.road_map_title_src3=t?"":"hundreds_huang_png",this.road_map_title_txt_visible=t,this.road_map_title_src_visible=!t},e.EVT_TOGGLE_PEOPLE="evt_open_people",e}(t.Component);e.BottomPanel=i,__reflect(i.prototype,"ui.bairen.BottomPanel")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(t,e){var i=this;void 0===e&&(e=!1),this.clearTimer(),util.SoundUtil.destroy(["brnn_stopbet_mp3"]);var n=t-util.TimeUtil.now;n>0?this.timer=util.TimeUtil.setInterval(function(){var n=t-util.TimeUtil.now;if(n>=0){var o=i.lab_count.text!==Math.round(n/1e3).toString();i.lab_count.text=Math.round(n/1e3).toString(),(3===Math.round(n/1e3)||2===Math.round(n/1e3)||1===Math.round(n/1e3))&&e&&o&&util.SoundUtil.play("brnn_clock_mp3")}else i.lab_count.text="0",i.clearTimer()},100):(this.lab_count.text="0",this.clearTimer())},e.prototype.clearTimer=function(){null!=this.timer&&(util.TimeUtil.clearInterval(this.timer),this.timer=null)},e}(t.Component);e.CountDown=i,__reflect(i.prototype,"ui.bairen.CountDown")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.RARE=0]="RARE",t[t.M_RARE=1]="M_RARE",t[t.MEDIUM=2]="MEDIUM",t[t.WELL_DOWN=3]="WELL_DOWN"}(i=e.RoomType||(e.RoomType={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player_count=0,e}return __extends(e,t),e}(topic.RoomItemData);e.RoomItemData=n,__reflect(n.prototype,"ui.bairen.RoomItemData");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.data.room_id)},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){return e.gp_item.scaleX=e.gp_item.scaleY=.95},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_END,function(){return e.gp_item.scaleX=e.gp_item.scaleY=1},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){return e.gp_item.scaleX=e.gp_item.scaleY=1},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){return e.gp_item.scaleX=e.gp_item.scaleY=1},this)},e}(t.ItemRenderer);e.DeskListItem=o,__reflect(o.prototype,"ui.bairen.DeskListItem")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.disputeBanker=function(t,e,i){return util.LogUtil.warn("[BullService] [disputeBanker] [send] desk_ciphertext => "+t+",position => "+e+",rate => "+i),this.update(t,{action:"dispute",dispute:{user_id:Const.UserInfo.USER_ID,position:e,dispute_rate:i}},null,!0)},e.prototype.rasie=function(t,e,i){return util.LogUtil.warn("[BullService] [rasie] [send] desk_ciphertext => "+t+",position => "+e+",rate => "+i),this.update(t,{action:"raise",raise:{user_id:Const.UserInfo.USER_ID,position:e,raise_rate:i}},null,!0)},e.prototype.fight=function(t,e,i){return util.LogUtil.warn("[BullService] [fight] [send] desk_ciphertext => "+t+",position => "+e),this.update(t,{action:"fight",fight:{user_id:Const.UserInfo.USER_ID,position:e,is_done:i}},null,!0)},e}(t.ServiceBase);t.BullService=e,__reflect(e.prototype,"service.BullService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this.username=t},e.prototype.setBalance=function(t){this.balance=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.avatar=t},e.prototype.showSurplus=function(t,e){this.lab_surplus.text="0",t&&(e>0?(this.lab_surplus.font="public_win_fnt",this.lab_sign.font="public_win_fnt",this.lab_sign.text="+",util.SoundUtil.play("brnn_win_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,e,1e3)):0>e&&(this.lab_surplus.font="public_lose_fnt",this.lab_sign.font="public_lose_fnt",this.lab_sign.text="-",util.SoundUtil.play("brnn_lose_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,Math.abs(e),1e3))),this.lab_sign.visible=t,this.lab_surplus.visible=t},e.prototype.showWin=function(t){this.mc_win.visible=t},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.bairen.PlayerFrame")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var n=null!==e&&e.apply(this,arguments)||this;return n.dataProvider=new eui.ArrayCollection,n.bottomArr=[0,-100],n.update=function(e){e.forEach(function(e){var n=t.component.Avatar.generateAvatar(e.avatar);e.user_id===Const.UserInfo.USER_ID?(e.username=Const.UserInfo.NICK,i.avatarMap.set(e.user_id,Const.UserInfo.AVATAR)):e.avatar!==n&&i.avatarMap.get(e.user_id)||i.avatarMap.set(e.user_id,n)}),n.dataProvider.replaceAll(e.map(function(t,e){return util.ObjectUtil.merge(t,{state:e>1?e>5?"loser":"normal":"rank"+(e+1),rank:e+1,balance:util.NumberUtil.formatNumber(t.balance),avatar:i.avatarMap.get(t.user_id)})}))},n.hide=function(t){return n.bottomArr[0]&&!n.contains(t.target)&&n.toggle()},n.toggle=function(t){void 0===t&&(t=300),egret.Tween.removeTweens(n),n.bottomArr.reverse(),egret.Tween.get(n).set({visible:!0,percentBottom:n.bottomArr[0]}).to({visible:!!n.bottomArr[0],percentBottom:n.bottomArr[1]},t,n.bottomArr[0]?egret.Ease.backOut:egret.Ease.backIn),n.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,n.hide,n),n.bottomArr[0]&&egret.callLater(function(){return n.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,n.hide,n)},n)},n.updateCount=function(t){return n.count=util.LanguageUtil.translate("lbl_game_players",""+t)},n}return __extends(i,e),i.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.percentBottom=-100,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return t.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,t.hide,t)},this)},i.avatarMap=new Map,i}(t.Component);e.PlayerList=i,__reflect(i.prototype,"ui.bairen.PlayerList")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getPokerSize=function(){return{width:this.img_poker.width,height:this.img_poker.height}},e.prototype.getPokerPos=function(){return this.img_poker.localToGlobal()},e.prototype.setCard=function(t){"number"==typeof t?this.img_poker.source=t+"_png":this.img_poker.source="poker_back_png"},e.prototype.getTapArea=function(){return this.rect_poker},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.bairen.Poker")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(i){var n=t.call(this)||this;n.pokers=[],n.parent_container=i;for(var o=35;o>=1;o--){var r=new e.PokerAniUI;r.x=0,r.y=1-o,r.visible=!1,n.parent_container.addChild(r),n.pokers.push(r)}return n.pokers=n.pokers.reverse(),n}return __extends(i,t),i.prototype.init=function(){for(var t=1;35>=t;t++){var e=this.pokers[t-1];egret.Tween.removeTweens(e),e.x=0,e.y=1-t,e.visible=!0}},i.prototype.shuffle=function(){util.SoundUtil.play("brnn_dealing_cards_mp3");for(var t=1;35>=t;t++){var e=this.pokers[t-1];egret.Tween.removeTweens(e),e.x=0,e.y=1-t,e.visible=!0;var i=util.NumberUtil.getRandom(-1,1),n=util.NumberUtil.getRandom(-1,1),o=util.NumberUtil.getRandom(60,80),r=util.NumberUtil.getRandom(60,80),s=e.x,a=e.y;egret.Tween.get(e).to({x:i*o,y:a+5*n},200).to({x:s,y:a},200).to({x:n*o,y:a+5*i},200).to({x:s,y:a},200).to({x:i*r,y:a+5*n},200).to({x:s,y:a},200).to({x:n*o,y:a+5*i},200).to({x:s,y:a},200)}},i.prototype.flyCard=function(t,e){var i=this;return new Promise(function(n){var o=5*t,r=5*(t+1)-1,s=i.parent_container.globalToLocal(e.x,e.y),a=0;util.SoundUtil.play("brnn_fapai_mp3");for(var l=function(t){egret.Tween.get(i.pokers[t]).wait(a).set({x:0,y:1-t}).to({x:s.x,y:s.y},200).call(function(){t===r&&n()}),a+=50},u=o;r>=u;u++)l(u)})},i.prototype.hidePoker=function(t){if(t||0===t)for(var e=5*t,i=5*(t+1)-1,n=e;i>=n;n++)this.pokers[n].visible=!1;else this.pokers.forEach(function(t){t.visible=!1})},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.bairen.PokerAni")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Component);e.PokerAniUI=i,__reflect(i.prototype,"ui.bairen.PokerAniUI")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gap=-48,e.result_sound={wuniu:["brnn_niu0_mp3"],niu1:["brnn_niu1_mp3"],niu2:["brnn_niu2_mp3"],niu3:["brnn_niu3_mp3"],niu4:["brnn_niu4_mp3"],niu5:["brnn_niu5_mp3"],niu6:["brnn_niu6_mp3"],niu7:["brnn_niu7_mp3"],niu8:["brnn_niu8_mp3"],niu9:["brnn_niu9_mp3"],niuniu:["brnn_niu10_mp3"],sihuaniu:["brnn_4niu_mp3"],wuhuaniu:["brnn_5niu_mp3"],bomb:["brnn_bomb_mp3"],wuxiaoniu:["brnn_5sniu_mp3"]},e.result_ani={wuniu:["hundreds_pic_bullbg1_png","hundreds_nobull_png","",-2],niu1:["hundreds_pic_bullbg2_png","hundreds_bullone_png","hundreds_1times_png",4],niu2:["hundreds_pic_bullbg2_png","hundreds_bulltwo_png","hundreds_1times_png",4],niu3:["hundreds_pic_bullbg2_png","hundreds_bullthree_png","hundreds_1times_png",4],niu4:["hundreds_pic_bullbg2_png","hundreds_bullfour_png","hundreds_1times_png",4],niu5:["hundreds_pic_bullbg2_png","hundreds_bullfive_png","hundreds_1times_png",4],niu6:["hundreds_pic_bullbg2_png","hundreds_bullsix_png","hundreds_1times_png",4],niu7:["hundreds_pic_bullbg3_png","hundreds_bullseven_png","hundreds_2times_png",2],niu8:["hundreds_pic_bullbg3_png","hundreds_bulleight_png","hundreds_2times_png",2],niu9:["hundreds_pic_bullbg3_png","hundreds_bullnine_png","hundreds_2times_png",2],niuniu:["hundreds_pic_bullbg4_png","hundreds_bullbull_png","hundreds_3times_png",15],sihuaniu:["hundreds_pic_bullbg5_png","hundreds_fourfacebull_png","hundreds_3times_png",24],wuhuaniu:["hundreds_pic_bullbg5_png","hundreds_fivefacebull_png","hundreds_3times_png",24],bomb:["hundreds_pic_bullbg6_png","hundreds_bomb_png","hundreds_3times_png",20],wuxiaoniu:["hundreds_pic_bullbg5_png","hundreds_fivesmallbull_png","hundreds_3times_png",24]},e
}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.registerEvent=function(){var t=this;this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){t.stopDealAni()},this)},e.prototype.getTopCardPos=function(){return this.poker_1.getPokerPos()},e.prototype.getPokerSize=function(){return this.poker_1.getPokerSize()},e.prototype.showPoker=function(t){var e=this;[2,3,4,5].forEach(function(i){e["poker_"+i].visible=t})},e.prototype.setCards=function(t){for(var e=1;5>=e;e++){var i=this["poker_"+e];i.setCard(t[e-1])}},e.prototype.setBack=function(){for(var t=1;5>=t;t++){var e=this["poker_"+t];e.setCard()}},e.prototype.init=function(){for(var t=1;5>=t;t++){var e=this["poker_"+t];egret.Tween.removeTweens(e.img_poker),e.img_poker.scaleX=1,e.img_poker.scaleY=1}this.setBack(),this.img_bg.visible=!1,this.img_type1.visible=!1,this.img_type2.visible=!1,egret.Tween.removeTweens(this.img_bg),egret.Tween.removeTweens(this.img_type1),egret.Tween.removeTweens(this.img_type2),this.stopDealAni()},e.prototype.dealCardAni=function(t){var e=this;return void 0===t&&(t=!0),new Promise(function(i){t?egret.Tween.get(e.group_poker.layout).set({gap:-e.poker_1.getTapArea().width}).to({gap:e.gap},300).call(i):e.group_poker.layout.gap=e.gap})},e.prototype.stopDealAni=function(){egret.Tween.removeTweens(this.group_poker.layout),this.group_poker.layout.gap=this.gap},e.prototype.getResultSound=function(t){return this.result_sound[""+t][0]},e.prototype.getResultSoundList=function(){var t=this,e=[];return Object.keys(this.result_sound).forEach(function(i){e=e.concat(t.result_sound[i])}),e},e.prototype.showResult=function(t,e,i){var n=this;void 0===i&&(i=!0);var o=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},r=function(){return util.SoundUtil.play(n.getResultSound(e))};return new Promise(function(s){for(var a=function(a){var l=n["poker_"+a];egret.Tween.removeTweens(l.img_poker),i?egret.Tween.get(l.img_poker).wait(50*(a-1)).to({scaleX:0,scaleY:1.1},200).call(function(){l.setCard(t[a-1])}).to({scaleX:1,scaleY:1},200).call(function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return 5!==a?[3,2]:(r(),this.cardTypeAni(e),[4,o(600)]);case 1:t.sent(),s(),t.label=2;case 2:return[2]}})})}):(l.setCard(t[a-1]),n.cardTypeAni(e,!1),s())},l=1;5>=l;l++)a(l)})},e.prototype.cardTypeAni=function(t,e){void 0===e&&(e=!0),egret.Tween.removeTweens(this.img_bg),egret.Tween.removeTweens(this.img_type1),egret.Tween.removeTweens(this.img_type2),this.img_bg.visible=!0,this.img_type1.visible=!0,this.img_type2.visible=!0,this.img_bg.source=this.result_ani[t][0],this.img_type1.source=this.result_ani[t][1],this.img_type2.source=this.result_ani[t][2],this.group_type.verticalCenter=this.result_ani[t][3],e?(this.img_bg.scaleX=0,this.img_type1.scaleX=2,this.img_type1.scaleY=2,this.img_type1.alpha=0,this.img_type2.scaleX=2,this.img_type2.scaleY=2,this.img_type2.alpha=0,egret.Tween.get(this.img_bg).to({scaleX:1},500,egret.Ease.backOut),egret.Tween.get(this.img_type1).wait(500).to({scaleX:1,scaleY:1,alpha:1},300),egret.Tween.get(this.img_type2).wait(500).to({scaleX:1,scaleY:1,alpha:1},300)):(this.img_bg.scaleX=1,this.img_type1.scaleX=1,this.img_type1.scaleY=1,this.img_type1.alpha=1,this.img_type2.scaleX=1,this.img_type2.scaleY=1,this.img_type2.alpha=1)},e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.bairen.PokerList")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.road_data=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"is_blink",{get:function(){return this._is_blink},set:function(t){this._is_blink=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"road_map_data",{get:function(){return this._road_map_data},set:function(t){this._road_map_data=t,this.updateDataGroup(this.road_map_data,this.is_blink)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_height",{get:function(){return this._mark_height},set:function(t){this._mark_height=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_width",{get:function(){return this._mark_width},set:function(t){this._mark_width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t,this.updateDataGroup(this.road_map_data,!1)},enumerable:!0,configurable:!0}),e.prototype.updateDataGroup=function(t,e){if(t&&!util.ObjectUtil.isEmpty(t)){var i=util.ObjectUtil.copy(t).slice(t.length<=this.col?0:t.length-this.col),n=[];i.forEach(function(t){["tian","di","xuan","huang"].forEach(function(e){n.push({result:t.indexOf(e)<0?"lose":"win",alpha:1})})}),this.road_data.replaceAll(n),this.road_data.refresh(),e&&this.blink()}},e.prototype.blink=function(){var t=this,e=200,i=function(t,i){return t.to({alpha:i?1:0},e)};Array.apply(void 0,Array(4)).forEach(function(e,n){var o=t.road_data.getItemAt(t.road_data.length-1-n);egret.Tween.removeTweens(o);var r=egret.Tween.get(o);Array.apply(void 0,Array(3)).forEach(function(){i(r,!1),i(r,!0)})})},e.prototype.stopAni=function(){for(var t=0;t<this.road_data.length;t++){var e=this.road_data.getItemAt(t);egret.Tween.removeTweens(e),e.alpha=1}},e}(eui.Component);t.RoadMap=e,__reflect(e.prototype,"ui.bairen.RoadMap")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.rasie=function(t,e,i){return util.LogUtil.warn("[CasinoService] [rasie] [send] desk_ciphertext => "+t+",position => "+e+",rate => "+i),this.update(t,{action:"raise",raise:{user_id:Const.UserInfo.USER_ID,position:e,raise_rate:i}},null,!0)},e.prototype.fight=function(t,e,i){return util.LogUtil.warn("[CasinoService] [fight] [send] desk_ciphertext => "+t+",position => "+e),this.update(t,{action:"fight",fight:{user_id:Const.UserInfo.USER_ID,position:e,is_done:i}},null,!0)},e}(t.ServiceBase);t.CasinoService=e,__reflect(e.prototype,"service.CasinoService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.show=function(t){egret.Tween.removeTweens(this),this.alpha=0,this.lab_tip.text=t,egret.Tween.get(this).to({alpha:1},500).wait(1e3).to({alpha:0},500)},e}(t.Component);e.Tip=i,__reflect(i.prototype,"ui.bairen.Tip")}(e=t.bairen||(t.bairen={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.Match=0]="Match",t[t.Canle=1]="Canle"}(i=e.MatchEnum||(e.MatchEnum={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.btn_auto_match.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.isSelected=e.btn_auto_match.selected},this),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){e.invalidateState(),e.fixPosition()},this)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.setselected=function(t){this.isSelected=t,this.btn_auto_match.selected=t},e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.addToStage=function(){this.btnMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.btn_auto_match.selected?this.autoMatch():(this.btn_auto_match.selected=this.isSelected,this.changeState(i.Match)),this.fixPosition()},e.prototype.removeFromStage=function(){this.btnMatch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.clearInterval()},e.prototype.match=function(){this.sendMatchNotify(),this.removeMyself()},e.prototype.cancleMatch=function(){this.clearInterval(),this.btn_auto_match.selected=this.isSelected,this.changeState(i.Match)},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e.prototype.autoMatch=function(){var t=this,e=5,n=function(e){e>0?t.lbCount.text=util.LanguageUtil.translate("lbl_game_willmatch",e):(t.clearInterval(),t.parent&&t.parent.removeChild(t),t.match())};this.changeState(i.Canle),n(e--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(e--)},1e3)},e.prototype.changeState=function(t){this.type=t===i.Match?"match":"cancel",!this.visible&&(this.visible=!0)},e.prototype.fixPosition=function(){switch(this.currentState){case"landscape_match":case"landscape_cancel":break;case"portrait_match":case"portrait_cancel":}},e}(t.Component);e.AutoMatch=n,__reflect(n.prototype,"ui.blackjack.AutoMatch")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.start=0]="start",t[t.stop=1]="stop"}(i=e.BetAniType||(e.BetAniType={}));var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.show=function(t){switch(this.visible=!1,this.group_start.visible=!1,this.group_stop.visible=!1,t){case i.start:this.visible=!0,this.group_start.visible=!0;break;case i.stop:this.visible=!0,this.group_stop.visible=!0}},e}(t.Component);e.BetAni=n,__reflect(n.prototype,"ui.blackjack.BetAni")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(e,i,n){void 0===e&&(e="big"),void 0===i&&(i=500),void 0===n&&(n=!0);var o=t.call(this)||this,r=Const.Config.CHIP_VALUES.indexOf(i)+1;return o._type=e,0===r?(util.LogUtil.info("筹码数据不正确"),o):(o.bg=r.toString(),o.value=i,o._bgFollowValue=n,o)}return __extends(e,t),Object.defineProperty(e.prototype,"is_disabled",{get:function(){return this._is_disabled},set:function(t){this._is_disabled=t,this.filters=this.is_disabled?[Const.maskFilter]:void 0,this.enabled=!this.is_disabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgFollowValue",{get:function(){return this._bgFollowValue},set:function(t){this._bgFollowValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this._bgType&&(this.bgsource=("big"===this._type?"b":"s")+("_chip_"+this._bgType+"_png")),this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){if(this._value=t,this.displayValue=util.NumberUtil.formatUnit(t),this._bgFollowValue){var e=Const.Config.CHIP_VALUES.indexOf(t)+1;if(0===e)return void util.LogUtil.info("筹码数据没找到",t);this.bg=e.toString()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bg",{set:function(t){this._bgType=t,this.bgsource=("big"===this._type?"b":"s")+("_chip_"+t+"_png")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isChosen",{get:function(){return this._isChosen},set:function(t){this._isChosen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=t},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return"portrait_"+this._type},e}(t.Component);e.Chip=i,__reflect(i.prototype,"ui.blackjack.Chip")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.half_width=356,i.diff_angle=Math.PI/4.5,i.left_limit_angle=-Math.PI/2+i.diff_angle,i.right_limit_angle=Math.PI/2-i.diff_angle,i.move_angle=Math.PI/710,i.r=258,i.chip_list=[],i.offset_point=0,i.can_move_to_right=!1,i.can_move_to_left=!1,i.touchBegin=function(t){i.touchEnd(),i.checkScroll(),i.offset_point=t.$stageX,i.gp_chips.addEventListener(egret.TouchEvent.TOUCH_MOVE,i.touchMove,i),i.gp_chips.addEventListener(egret.TouchEvent.TOUCH_END,i.touchEnd,i),i.gp_chips.addEventListener(egret.TouchEvent.TOUCH_CANCEL,i.touchEnd,i)},i.touchMove=function(t){var e=t.$stageX,n=e-i.offset_point;(n>0&&i.can_move_to_right===!0||0>n&&i.can_move_to_left===!0)&&Math.abs(n)>=4&&(i.offset_point=e,i.chipsRoll((n>0?1:-1)*Math.abs(n)*i.move_angle))},i.touchEnd=function(){i.gp_chips.hasEventListener(egret.TouchEvent.TOUCH_MOVE)&&i.gp_chips.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i.touchMove,i),i.gp_chips.hasEventListener(egret.TouchEvent.TOUCH_END)&&i.gp_chips.removeEventListener(egret.TouchEvent.TOUCH_END,i.touchEnd,i),i.gp_chips.hasEventListener(egret.TouchEvent.TOUCH_CANCEL)&&i.gp_chips.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,i.touchEnd,i)},i.chooseChip=function(e){var n=e.currentTarget;n instanceof t.blackjack.Chip&&(i.cur_chip=n)},i}return __extends(i,e),Object.defineProperty(i.prototype,"cur_chip",{get:function(){return this._cur_chip},set:function(t){t&&(this.cur_chip&&(this.cur_chip.isChosen=!1),this._cur_chip=t,t.isChosen=!0)},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.visible=!1,this.alpha=.5,this.gp_chips.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this)},i.prototype.setChips=function(e){var i=this;this.chip_list.forEach(function(t){return t.is_disabled=t.visible=!1}),e.length&&(e.forEach(function(e,n){if(n<i.chip_list.length){var o=i.chip_list[n];o.value=e,o.visible=!0}else{var o=new t.blackjack.Chip("big",e);o.anchorOffsetX=o.anchorOffsetY=78,i.gp_chips.addChild(o),i.chip_list.push(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,i.chooseChip,i)}}),this.last_chip=this.chip_list[e.length-1],this.initChips())},i.prototype.show=function(t){void 0===t&&(t=!0),egret.Tween.removeTweens(this),egret.Tween.get(this).set({scaleX:.2,scaleY:.2,alpha:.5}).to({scaleX:1,scaleY:1,alpha:1},t?300:0,egret.Ease.backOut),this.visible=!0},i.prototype.hide=function(t){var e=this;void 0===t&&(t=!0),egret.Tween.removeTweens(this),egret.Tween.get(this).set({scaleX:1,scaleY:1,alpha:1}).to({scaleX:.2,scaleY:.2,alpha:.5},t?250:0,egret.Ease.backIn).call(function(){return e.visible=!1})},i.prototype.updateEnable=function(t){if(this.chip_list.length)for(var e=0,i=this.chip_list.indexOf(this.last_chip);i>=e;e++){var n=this.chip_list[e];n.is_disabled=t.lt(new Decimal(n.value))}},i.prototype.chipsRoll=function(t){var e=this;this.last_chip.y<800&&0>t&&Number(this.last_chip.name)+t<this.right_limit_angle?t=this.right_limit_angle-Number(this.last_chip.name):this.chip_list[0].y<800&&t>0&&Number(this.chip_list[0].name)+t>this.left_limit_angle&&(t=this.left_limit_angle-Number(this.chip_list[0].name)),this.chip_list.forEach(function(i){var n=Number(i.name)+t,o=e.calXY(n);i.x=o.x,i.y=o.y,i.name=""+n,egret.Point.release(o)}),this.checkScroll()},i.prototype.checkScroll=function(){this.can_move_to_right=Number(this.chip_list[0].name)<this.left_limit_angle,this.can_move_to_left=Number(this.last_chip.name)>this.right_limit_angle},i.prototype.initChips=function(){var t=this;this.chip_list.length&&this.chip_list.forEach(function(e,i){var n=t.left_limit_angle+i*t.diff_angle,o=t.calXY(n);e.x=o.x,e.y=o.y,e.name=""+n,egret.Point.release(o),0===i&&(t.cur_chip=e)})},i.prototype.calXY=function(t){var e=egret.Point.create(0,0);return t<=Math.PI/2&&t>=-Math.PI/2?(e.x=this.half_width+Math.sin(t)*this.r,e.y=this.half_width-Math.cos(t)*this.r):(e.x=t>Math.PI/2?600:100,e.y=800),e},i}(eui.Component);e.ChipList=i,__reflect(i.prototype,"ui.blackjack.ChipList")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(t,e){var i=this;void 0===e&&(e=!1),this.clearTimer(),util.SoundUtil.destroy(["brnn_stopbet_mp3"]);var n=t-util.TimeUtil.now;n>0?this.timer=util.TimeUtil.setInterval(function(){var n=t-util.TimeUtil.now;if(n>=0){i.visible=!0;var o=i.lab_count.text!==Math.round(n/1e3).toString();if(i.lab_count.text=Math.round(n/1e3).toString(),o&&util.SoundUtil.play("time_mp3"),(3===Math.round(n/1e3)||2===Math.round(n/1e3)||1===Math.round(n/1e3))&&e&&o){util.SoundUtil.play("WarningtimeOver_mp3")}}else egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,i.visible=!1,i.lab_count.text="0",i.clearTimer()},200):(egret.Tween.removeTweens(this.img_bg),this.img_bg.rotation=0,this.visible=!1,this.lab_count.text="0",this.clearTimer())},e.prototype.clearTimer=function(){null!=this.timer&&(util.TimeUtil.clearInterval(this.timer),this.timer=null,this.visible=!1,egret.Tween.removeTweens(this.img_bg),this.img_bg.rotation=0)},e}(t.Component);e.CountDown=i,__reflect(i.prototype,"ui.blackjack.CountDown")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.childrenCreated=function(){var i=this;e.prototype.childrenCreated.call(this),this.doubleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Number(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance.toString())<i.raise?t.dialog.MessageDialog.instance.showAlert("lbl_balance_error","lbl_game_comfirm"):util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BJ_DOUBLE)},this),this.stopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BJ_STOP)},this),this.bidBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BJ_HIT)},this),this.splitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Number(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance.toString())<i.raise?t.dialog.MessageDialog.instance.showAlert("lbl_balance_error","lbl_game_comfirm"):(util.SoundUtil.play("fenpai_mp3"),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BJ_SPLIT))},this)},i.prototype.init=function(){},i.prototype.isHavesplit=function(t){void 0===t&&(t=!1),this.splitBtn.visible=t},i.prototype.splited=function(){this.splitBtn.visible=!1},i.prototype.setRaise=function(t){this.raise=t},i.prototype.setDoubleBtnStatus=function(t){this.doubleBtn.enabled=t,this.doubleBtn.filters=t?null:[Const.grayFilter]},i}(t.Component);e.FuncBtns=i,__reflect(i.prototype,"ui.blackjack.FuncBtns")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.fold=function(t){return this.update(t,{action:"surrender"},null,!0)},e.prototype.rasie=function(t,e){return this.update(t,{action:"bet",bet:e},null,!0)},e.prototype.toggle=function(t,e){return this.update(t,{action:"prevent_timeout",prevent_timeout:e},null,!0)},e.prototype.fight=function(t,e){return this.update(t,{action:"card_pk",card_pk:e},null,!0)},e.prototype.watch=function(t){return this.update(t,{action:"watch_card"},null,!0)},e.prototype.cancel=function(t){return this.update(t,{action:"cancel"},null,!0)},e}(t.ServiceBase);t.FlowerService=e,__reflect(e.prototype,"service.FlowerService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.time_out_id=void 0,t.time_out_id2=void 0,t.time_out_id3=void 0,t.changeGraphics=function(e){t.shape.graphics.beginFill(65535,1),t.shape.graphics.moveTo(0,0),t.shape.graphics.lineTo(0,0),t.shape.graphics.drawArc(0,0,t.radio,e,-Math.PI/2,!1),t.shape.graphics.lineTo(0,0),t.shape.graphics.endFill()},t}return __extends(i,e),Object.defineProperty(i.prototype,"isown",{set:function(t){this.textColor=this.textColor=t?16770435:12632256,this._isown=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"userInfo",{get:function(){return this._userInfo},set:function(e){if(e){var n=t.component.Avatar.generateAvatar(e.avatar);e.user_id===Const.UserInfo.USER_ID?(e.username=Const.UserInfo.NICK,i.avatarMap.set(e.user_id,Const.UserInfo.AVATAR)):e.avatar!==n&&i.avatarMap.get(e.user_id)||i.avatarMap.set(e.user_id,n),e.avatar=i.avatarMap.get(e.user_id)}this._userInfo=e,this.lb_balance.text=e&&util.NumberUtil.formatNumber(e.balance)},enumerable:!0,configurable:!0}),i.prototype.tweenBalance=function(t){util.NumberUtil.tweenNumber(this.lb_balance,t,1500)},i.prototype.getCurrentState=function(){return""+e.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.setPosition=function(t){this.position=t,this.group_pos.visible=!0},i.prototype.initCountDown=function(){this.shape||(this.shape=new egret.Shape,this.shape.x=this.timeLine.width/2,this.shape.y=this.timeLine.height/2,this.timeGroup.addChild(this.shape),this.timeLine.mask=this.shape,this.radio=this.timeLine.width>this.timeLine.height?this.timeLine.width:this.timeLine.height,this.radio*=1.5,this.dix=this.width/2)},i.prototype.init=function(){this.stopCountDown(),this.reset(),this.timeGroup.visible=!1,this.group_pos.visible=!1,this.winLoseInfo.initView()},i.prototype.countDown=function(t,e){var i=this;this.initCountDown(),this.totalTime=e-t,this.time_out_id&&this.stopCountDown(),this.timeGroup.visible=!0;var n=util.TimeUtil.now;this.time_out_id2=util.TimeUtil.setInterval(function(){util.TimeUtil.now<e&&util.SoundUtil.play("time_mp3")},1e3),this.time_out_id3=util.TimeUtil.setInterval(function(){e-util.TimeUtil.now>=900&&(util.SoundUtil.play("WarningtimeOver_mp3"),i.time_out_id3&&util.TimeUtil.clearInterval(i.time_out_id3),i.time_out_id3=void 0)},e-n-1e3),this.time_out_id=util.TimeUtil.setInterval(function(){var n=util.TimeUtil.now-t,o=i.lightMove(n),r=o.x,s=o.y;if(e-t>n){i.shape.graphics.clear();var a=s-i.shape.y,l=r-i.shape.x,u=Math.asin(a/Math.sqrt(a*a+l*l));r<i.shape.x&&(u=Math.PI-u),i.changeGraphics(u)}else i.stopCountDown()},50,this)},i.prototype.stopCountDown=function(){this.time_out_id&&util.TimeUtil.clearInterval(this.time_out_id),this.time_out_id=void 0,this.time_out_id2&&util.TimeUtil.clearInterval(this.time_out_id2),this.time_out_id2=void 0,this.time_out_id3&&util.TimeUtil.clearInterval(this.time_out_id3),this.time_out_id3=void 0,this.timeGroup.visible=!1},i.prototype.lightMove=function(t){var e=this.timeGroup.width,i=this.timeGroup.height,n=15*Math.PI;this.diy=-2.5;var o=(n+2*this.timeGroup.width-10+2*this.timeGroup.height-10)/this.totalTime;this.dix=this.timeGroup.width/2;var r,s,a=t*o,l=e/2-5,u=l+n/4,h=u+i-10,c=h+n/4,p=c+e-10,_=p+n/4,d=_+i-10,g=d+n/4,m=g+e/2-5;if(l>a)r=t*o+this.dix,s=this.diy;else if(u>a){var f=(a-l)/(n/4)*(Math.PI/2);r=l+this.dix+7.5*Math.sin(f),s=7.5*(1-Math.cos(f))+this.diy}else if(h>a)r=l+7.5+this.dix,s=7.5+a-u+this.diy;else if(c>a){var f=(a-h)/(n/4)*(Math.PI/2);r=l+7.5*Math.cos(f)+this.dix,s=i-2.5+7.5*Math.sin(f)+this.diy}else if(p>a)r=l-(a-c)+this.dix,s=i+5+this.diy;else if(_>a){var f=(a-p)/(n/4)*(Math.PI/2);r=-l-7.5*Math.sin(f)+this.dix,s=i+Math.cos(f)-2.5+this.diy}else if(d>a)r=-l-7.5+this.dix,s=i-2.5-(a-_)+this.diy;else if(g>a){var f=(a-d)/(n/4)*(Math.PI/2);r=-l+this.dix-7.5*Math.cos(f),s=7.5-7.5*Math.sin(f)+this.diy}else m>a?(r=a-g-l+this.dix,s=this.diy):(r=this.dix,s=this.diy);return{x:r,y:s}},i.prototype.setHead=function(t){},i.prototype.shakeAvatar=function(){var t=0;this.root.y=t,egret.Tween.removeTweens(this.root),egret.Tween.get(this.root).to({y:t-15},80,egret.Ease.quadOut).to({y:t},80,egret.Ease.quadIn)},i.prototype.winAni=function(){this.win.group="effect_blackjack_win_player",this.win.currentFrame=0,this.win.playTimes=-1,this.win.visible=!0,this.win.isPlaying=!0},i.prototype.reset=function(){this.win.isPlaying=!1,this.win.visible=!1,this.win.group="",this.win.source=null},i.prototype.setScore=function(t){this.winLoseInfo.setScore(t),t>0&&this.winAni()},i.prototype.addScore=function(t){this.winLoseInfo.addScore(t)},i.avatarMap=new Map,i}(t.Component);e.Player=i,__reflect(i.prototype,"ui.blackjack.Player")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.First=0]="First",t[t.Secend=1]="Secend",t[t.Safe=2]="Safe"}(i=e.SetGroupEnum||(e.SetGroupEnum={}));var n=function(t){function n(e){void 0===e&&(e=!1);var i=t.call(this)||this;return i.chipsArr=[],i.addMoveChips=[],i.shot=function(){var t=i.betGroup,e=i.group0_Img;egret.callLater(function(){var i=new egret.RenderTexture;i.drawToTexture(t),e.source=i},i)},i.isOwn=e,i}return __extends(n,t),Object.defineProperty(n.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.pokerFrame1&&(this.pokerFrame1.type=t,this.pokerFrame2.type=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isTop",{get:function(){return this._isTop},set:function(t){this._isTop=Boolean(t)},enumerable:!0,configurable:!0}),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.pokerFrame1.type=this._type,this.pokerFrame2.type=this._type,this.raiseBg.source=this._isOwn?"bj_pic_bet_oneself_png":"bj_pic_bet_player_png",this.lbraise.textColor=this._isOwn?16435513:16777215,this._isTop&&(this.pokerFrame1.bottom+=50,this.pokerFrame2.bottom+=50,this.blacjAni.y=-70,this.blacjImg.y=-110,this.raiseGoup.verticalCenter-=50)},n.prototype.isself=function(){this.ownGroup.visible=this._isOwn,this.otherGroup.visible=!this._isOwn},n.prototype.playAni=function(){this.ownbetAni.visible=this._isOwn,egret.Tween.get(this.ownbetAni,{loop:!0}).to({scaleX:1.5,scaleY:1.5,alpha:.2},1e3)},n.prototype.clearAni=function(){this.ownbetAni.scaleX=1,this.ownbetAni.scaleY=1,this.ownbetAni.alpha=1,this.ownbetAni.visible=!1,egret.Tween.removeTweens(this.ownbetAni)},Object.defineProperty(n.prototype,"isOwn",{get:function(){return this._isOwn},set:function(t){this._isOwn=t},enumerable:!0,configurable:!0}),n.prototype.init=function(){this.isself(),this.player.visible=this._isOwn,this.seatImg.visible=!this._isOwn,this.player.init(),this.pokerFrame1.init(),this.pokerFrame2.init(),this.clearOtherBalckjAni(),this.raiseGoup.visible=!1,this.lbraise.text="0",this.bet1=0,this.bet2=0,this.chipsArr.forEach(function(t){t.parent&&t.parent.removeChild(t),t.alpha=1}),this.shot(),this.addMoveChips=[]},n.prototype.getPlayer=function(){return this.player},n.prototype.isSat=function(t){this.seatImg.visible=!t},n.prototype.flyAddChips=function(t,e){if(!(5>t)){if(e!==i.Safe)switch(e){case i.First:this.bet1+=t;break;case i.Secend:this.bet2+=t}for(var n=Const.Config.CHIP_VALUES.length;n>=0&&t>0;n--)for(;Const.Config.CHIP_VALUES[n]<=t;)t-=Const.Config.CHIP_VALUES[n],this.flyChipsAni(Const.Config.CHIP_VALUES[n],e);util.SoundUtil.play("fangchouma_mp3"),this.raiseGoup.visible=!0,this.lbraise.text=util.NumberUtil.formatUnit(this.bet1+this.bet2),this.player.shakeAvatar()}},n.prototype.flyAllChips=function(t,e){var i=t-this.bet1;if(!(5>i)){this.bet1=t;for(var n=Const.Config.CHIP_VALUES.length;n>=0&&i>0;n--)for(;Const.Config.CHIP_VALUES[n]<=i;)i-=Const.Config.CHIP_VALUES[n],this.flyChipsAni(Const.Config.CHIP_VALUES[n],e);util.SoundUtil.play("fangchouma_mp3"),this.raiseGoup.visible=!0,this.lbraise.text=util.NumberUtil.formatUnit(this.bet1),this.player.shakeAvatar()}},n.prototype.flyChipsAni=function(t,e){var n=this,o=null,r=this.firstChipsGroup;switch(e){case i.First:r=this.firstChipsGroup;break;case i.Secend:r=this.secendChipsGroup;break;case i.Safe:r=this.safeChipsGroup}o=this.createAChip(),o.value=t;var s=this.getChipPos(r),a=this.group_chipAni.globalToLocal(s.x,s.y),l=r.globalToLocal(s.x,s.y),u=this.localToGlobal(97,220),h=this.group_chipAni.globalToLocal(u.x,u.y);this.group_chipAni.addChild(o),o.x=h.x,o.y=h.y;var c={time:util.TimeUtil.now+500,chip:o,area:r,end:l};this.validateNow(),this.addMoveChips.push(c),egret.Tween.get(o).to({x:a.x,y:a.y,rotation:180*Math.random()},500,egret.Ease.quadOut).call(function(){egret.Tween.removeTweens(o),o.x=l.x,o.y=l.y,r.addChild(o),n.shot();var t=n.addMoveChips.indexOf(c);-1!==t&&n.addMoveChips.splice(t,1)})},n.prototype.getChipPos=function(t){void 0===t&&(t=this.firstChipsGroup);var e=t.localToGlobal();return{x:e.x+util.NumberUtil.getRandom(18.75,t.width-18.75),y:e.y+util.NumberUtil.getRandom(19,t.height-19)}},n.prototype.getPokerFrame=function(t){return t?this.pokerFrame1:this.pokerFrame2},n.prototype.recycleAllChips=function(){var t=this.recycleChips(i.First),e=this.recycleChips(i.Secend),n=this.recycleChips(i.Safe);return this.raiseGoup.visible=!1,t||e||n},n.prototype.recycleChips=function(t){var e;switch(t){case i.First:e=this.firstChipsGroup;break;case i.Secend:e=this.secendChipsGroup;break;case i.Safe:e=this.safeChipsGroup}for(var n=e.numChildren>0,o=e.numChildren-1;o>=0;o--){var r=e.getChildAt(o),s=e.localToGlobal(r.x,r.y),a=this.group_chipAni.globalToLocal(s.x,s.y);r.x=a.x,r.y=a.y,this.group_chipAni.addChild(r)}this.shot();for(var l=function(t){var e=u.group_chipAni.getChildAt(t),i=u.group_chipAni.localToGlobal(e.x,e.y),n=u.globalToLocal(i.x,i.y);u.addChild(e),e.x=n.x,e.y=n.y,egret.Tween.removeTweens(e),egret.Tween.get(e).to({x:97,y:220,alpha:.3},500,egret.Ease.quadOut).call(function(){e.alpha=1,e.parent&&e.parent.removeChild(e)})},u=this,o=this.group_chipAni.numChildren-1;o>=0;o--)l(o);return n},n.prototype.createAChip=function(){for(var t,i=0,n=this.chipsArr.length;n>i;i++)if(!this.chipsArr[i].stage){t=this.chipsArr[i];break}return t||(t=new e.Chip,this.chipsArr.push(t),t.scaleX=t.scaleY=.8,t.anchorOffsetX=37.5,t.anchorOffsetY=38,t.type="small"),t},n.prototype.settleFlyChip=function(t,e,n){void 0===n&&(n=600);var o;switch(t){case i.First:o=this.firstChipsGroup;break;case i.Secend:o=this.secendChipsGroup;break;case i.Safe:o=this.safeChipsGroup}for(var r=o.numChildren-1;r>=0;r--){var s=o.getChildAt(r),a=o.localToGlobal(s.x,s.y),l=this.group_chipAni.globalToLocal(a.x,a.y);s.x=l.x,s.y=l.y,this.group_chipAni.addChild(s)}this.shot();for(var u=this.group_chipAni.globalToLocal(e.x,e.y),h=function(t){var e=c.group_chipAni.getChildAt(t);egret.Tween.removeTweens(e),egret.Tween.get(e).to({x:u.x,y:u.y,alpha:0},n,egret.Ease.quadOut).call(function(){e.parent&&e.parent.removeChild(e)})},c=this,r=this.group_chipAni.numChildren-1;r>=0;r--)h(r);util.SoundUtil.play("payout_chips_mp3")},n.prototype.refreshBet=function(){this.lbraise.text=util.NumberUtil.formatUnit(this.bet1+this.bet2)},n.prototype.otherBlackjAni=function(){this.blacjGroup.visible=!0,this.blacjAni.group="effect_blackjack_blackjack2",this.blacjAni.currentFrame=0,this.blacjAni.playTimes=-1,this.blacjAni.visible=!0,this.blacjAni.isPlaying=!0,this.blacjAni.scaleX=1.74,this.blacjAni.scaleY=1.6,this.blacjAni.y=-20,this.blacjImg.source="bj_pic_points3_png",this.blacjImg.scaleX=.24,this.blacjImg.scaleY=.24,this.blacjImg.y=-60,this._isTop&&(this.blacjAni.y-=50,this.blacjImg.y-=50)},n.prototype.clearOtherBalckjAni=function(){this.blacjGroup.visible=!1,this.blacjImg.source="",this.blacjAni.group=""
},n.prototype.reShot=function(){for(var t=this,e=!1,i=this.addMoveChips.length-1;i>=0;i--){var n=this.addMoveChips[i];util.TimeUtil.now>=n.time&&(n.area.addChild(n.chip),egret.Tween.removeTweens(n.chip),n.chip.x=n.end.x,n.chip.y=n.end.y,this.addMoveChips.splice(i,1),e=!0)}e&&setTimeout(function(){return t.shot()},60)},n}(t.Component);e.playerSeat=n,__reflect(n.prototype,"ui.blackjack.playerSeat")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function e(t){var e=this;this.pokers=[],this.backpoker=[],this.usePoker=0,this.aniNum=0,this.lastPokers=[],this.sendCard=function(t,i,n){void 0===i&&(i=null),void 0===n&&(n=100),util.SoundUtil.play("BlackJack_fapai_mp3");var o=t.dealCard(i,n);if(n&&o.point){var r=e.parent_container.globalToLocal(o.point.x,o.point.y),s=e.pokers[e.usePoker];return e.usePoker++,egret.Tween.get(s).to({x:r.x-.5*(Math.max(o.width,t.parent.width)-t.parent.width),y:r.y,size:o.size},n),new Promise(function(t){o.tweenPromise.then(function(){s.visible=!1,t()})})}return new Promise(function(t){t()})},this.split=function(t,i,n){void 0===n&&(n=100),util.SoundUtil.play("BlackJack_fenpai_mp3");var o=t.splitCard(n),r=i.dealCard(o.num,n,!0);if(n){var s=e.parent_container.globalToLocal(o.point.x,o.point.y),a=e.parent_container.globalToLocal(r.point.x,r.point.y),l=e.backpoker[e.aniNum];return e.aniNum++,l.x=s.x,l.y=s.y,l.num=o.num,l.size=o.size,null!==o.num&&l.turnCard(0),egret.Tween.get(l).to({x:a.x-.5*(Math.max(r.width,o.width)-i.parent.width),y:a.y,size:r.size},n),new Promise(function(t){r.tweenPromise.then(function(){l.visible=!1,t()})})}return new Promise(function(t){t()})},this.parent_container=t;for(var i=0;52>i;i++){var n=this.createPoker();n.x=0,n.y=i,this.parent_container.addChild(n),this.pokers.push(n)}for(var o=0;20>o;o++){var n=this.createPoker();this.parent_container.addChild(n),n.visible=!1,this.backpoker.push(n)}this.pokers=this.pokers.reverse()}return e.prototype.createPoker=function(){var e=new t.component.Poker;return e.size=.5,e.once(eui.UIEvent.CREATION_COMPLETE,function(){e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2},this),e},e.prototype.init=function(t){void 0===t&&(t=!0);for(var e=0;52>e;e++){var i=this.pokers[e];i.currentState="back",egret.Tween.removeTweens(i),i.x=0,i.y=e,i.scaleX=i.scaleY=1,i.size=.5,i.rotation=0,i.visible=t}this.backpoker.forEach(function(t){egret.Tween.removeTweens(t),t.rotation=0,t.visible=!1,t.scaleX=t.scaleY=1,t.size=.5}),this.aniNum=0,this.lastPokers.length=0,this.usePoker=0},e.prototype.shuffle=function(){for(var t=0;52>t;t++){var e=this.pokers[t];egret.Tween.removeTweens(e),e.x=0,e.y=t,e.visible=!0;var i=util.NumberUtil.getRandom(-1,1),n=util.NumberUtil.getRandom(-1,1),o=util.NumberUtil.getRandom(60,80),r=util.NumberUtil.getRandom(60,80),s=e.x,a=e.y,l=100;egret.Tween.get(e).to({x:i*o,y:a+5*n},l).to({x:s,y:a},l).to({x:n*o,y:a+5*i},l).to({x:s,y:a},l).to({x:i*r,y:a+5*n},l).to({x:s,y:a},l).to({x:n*o,y:a+5*i},l).to({x:s,y:a},l)}},e.prototype.cardsMove=function(t){var e=t[2],i=e.x,n=e.y,o=500;egret.Tween.get(t[5]).to({x:i-47,y:n-1,rotation:-12},o),egret.Tween.get(t[4]).to({x:i-32,y:n-2,rotation:-8},o),egret.Tween.get(t[3]).to({x:i-15,y:n,rotation:-4},o),egret.Tween.get(t[1]).to({x:i+18,y:n+3,rotation:4},o),egret.Tween.get(t[0]).to({x:i+33,y:n+8,rotation:8},o)},e.prototype.GlobalToLocal=function(t){var e=this.parent_container.globalToLocal(t.x,t.y);t.x=e.x,t.y=e.y},e.prototype.flyCard=function(t,e){var i=this.parent_container.globalToLocal(t.x,t.y),n=this.pokers[this.usePoker],o=100;egret.Tween.get(n).set({x:0,y:this.usePoker}).to({x:i.x/2,y:i.y/2,rotation:180},o/2).to({x:i.x,y:i.y,rotation:360},o/2).call(function(){e&&e(),n.visible=!1}),this.usePoker++},e.prototype.pokerMove=function(t,e,i,n){var o=this,r=this.backpoker[this.aniNum],s=this.parent_container.globalToLocal(e.x,e.y);this.parent_container.globalToLocal(i.x,i.y);r.num=t,r.currentState="normal",egret.Tween.get(r).set({x:s.x,y:s.y}).to({x:i.x,y:i.y},300).call(function(){n&&n(),r.parent&&r.parent.removeChild(r),o.aniNum--}),this.aniNum++,this.parent_container.addChild(r)},e.prototype.setNow=function(){var t=this;this.pokers.forEach(function(e,i){egret.Tween.removeTweens(e),e.visible=i>=t.usePoker})},e}();e.PokerAni=i,__reflect(i.prototype,"ui.blackjack.PokerAni")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e;!function(t){t[t.straight=0]="straight",t[t.three7=1]="three7"}(e=t.pokertype||(t.pokertype={}));var i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.poker&&this.invalidateState()},enumerable:!0,configurable:!0}),i.prototype.getCurrentState=function(){return this._type},i.prototype.setSelecte=function(t){this.poker.selected=t},i.prototype.init=function(){this.groupBJ.visible=!1,this.groupNum.visible=!1,this["double"].visible=!1,this.poker.cleanCard(0),this.poker.selected=!1,this.poker.masked=!1},i.prototype.setPokerNum=function(t){this.num.text=""+t,this.numBg.source=t>21?"bj_pic_points2_png":"bj_pic_points1_png",this.groupNum.visible=!0,this.groupBJ.visible=!1},i.prototype.setPokerType=function(t){switch(this.groupNum.visible=!1,this.groupBJ.visible=!0,t){case e.straight:this.pokertype.text=util.LanguageUtil.translate("ng_straight");break;case e.three7:this.pokertype.text=util.LanguageUtil.translate("ng_21_three7")}this.setDoublePosition()},i.prototype.showDouble=function(t){this["double"].visible=t,t&&this.setDoublePosition()},i.prototype.setDoublePosition=function(){this["double"].visible&&("left"===this._type&&(this["double"].right=this.groupNum.visible&&this.groupBJ.visible?-20:this.groupNum.visible?-110:-220),"right"===this._type&&(this["double"].left=this.groupNum.visible&&this.groupBJ.visible?-20:this.groupNum.visible?-110:-220),this.topRight&&(this["double"].right=-98))},i.prototype.getGroup=function(){return this.poker},i.prototype.blastAni=function(){var t=this;this.blast.group="effect_blackjack_blast",this.blast.currentFrame=0,this.blast.playTimes=1,this.blast.scaleX=1.2,this.blast.scaleY=1.2,this.blast.visible=!0,this.blast.isPlaying=!0,this.blast.once(egret.Event.COMPLETE,function(){t.reset()},this)},i.prototype.reset=function(){this.blast.isPlaying=!1,this.blast.visible=!1,this.blast.group="",this.blast.source=null},i.prototype.setPokerNow=function(t){var e=this;this.poker.cleanTween(),this.poker.cleanCard(0),t.forEach(function(t){return e.poker.dealCard(t,0)})},i.prototype.setTopRight=function(){this.topRight=!0},i}(eui.Component);t.PokerFrame=i,__reflect(i.prototype,"ui.blackjack.PokerFrame")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.dealCard=function(e,n,o){var r,s;return t.group.numChildren&&t.group.$children.some(function(t){var e=null===t.num;return e&&(r=t),e}),r?(r.num=e,{tweenPromise:null,turnPromise:r.turnCard(n),width:null,point:null,size:null}):(r=t.group.addChild(i.poker),r.includeInLayout=r.visible=!1,r.num=e,r.size=.4,{tweenPromise:(s=t.tweenWidth(n)).promise.then(function(){return r.includeInLayout=r.visible=!0}),turnPromise:s.promise.then(function(){return null!==e&&r.turnCard(o?0:n)}),width:s.width,point:t.localToGlobal(s.width-t.layout.columnWidth),size:r.size})},t.splitCard=function(e,i,n){var o,r,s;return void 0===i?(o=t.localToGlobal(t.calcWidth(t.group.numChildren,t.gap)-t.layout.columnWidth),r=t.group.removeChildAt(t.group.numChildren-1)):(o=t.localToGlobal(i*(t.layout.columnWidth+t.gap)-.5*(t.calcWidth(n,t.gap)-t.width)),r=t.group.removeChildAt(0)),{promise:(s=t.tweenWidth(e)).promise,width:s.width,point:o,num:r.num,size:r.size}},t.seeCard=function(){util.SoundUtil.play("BlackJack_anpai_mp3");var e;if(t.group.numChildren&&t.group.$children.some(function(t){var i=null===t.num;return i&&(e=t),i}),e){var i=e.size;e.size=.46,egret.Tween.get(e).wait(200).call(function(){return e.seeing=!0}).wait(1500).call(function(){return e.seeing=!1}).wait(200).call(function(){return e.size=i})}},t.cleanCard=function(e){return Array.apply(void 0,Array(t.group.numChildren)).map(function(i,n,o){return t.splitCard(e,n,o.length)})},t.calcWidth=function(e,i){return t.layout.columnWidth*e+i*(e-1)},t.tweenWidth=function(e){var i,n=t.group.numChildren,o=t.layout.horizontalGap;return n?(t.gap=Math.min(t.oGap,o+(t.group.maxWidth-t.calcWidth(n,o))/(n-1)),i=t.calcWidth(n,t.gap),t.gap!==o&&(e?egret.Tween.get(t.layout).to({horizontalGap:t.gap},e):t.layout.horizontalGap=t.gap)):i=0,{promise:new Promise(function(n){e?egret.Tween.get(t).to({width:i},e).call(n):(t.width=i,n())}),width:i}},t}return __extends(i,e),Object.defineProperty(i,"poker",{get:function(){var e;return this.pokerPool.some(function(t){var i=!t.stage;return i&&(e=t),i})||(e=new t.component.Poker,this.pokerPool.push(e)),e.currentState="back",e.num=null,e.size=1,e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"masked",{set:function(t){this.filters=t?[Const.maskFilter]:null},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.layout=this.group.layout,this.oGap=this.layout.horizontalGap},i.prototype.cleanTween=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.layout),this.group.$children.forEach(function(t){return egret.Tween.removeTweens(t)})},i.pokerPool=[],i}(eui.Component);e.PokerGroup=i,__reflect(i.prototype,"ui.blackjack.PokerGroup")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.update=function(e,i,n,o){return util.LogUtil.info("[FourBullService] sendData topic=>"+e+" data =>"+JSON.stringify(i)),t.prototype.update.call(this,e,i,n,o)},e.prototype.disputeBanker=function(t,e,i){return this.update(t,{action:"dispute",dispute:{user_id:Const.UserInfo.USER_ID,position:e,dispute_rate:i}},null,!0)},e.prototype.rasie=function(t,e,i){return this.update(t,{action:"raise",raise:{user_id:Const.UserInfo.USER_ID,position:e,raise_rate:i}},null,!0)},e.prototype.fight=function(t,e,i){return this.update(t,{action:"fight",fight:{user_id:Const.UserInfo.USER_ID,position:e,is_done:i}},null,!0)},e}(t.ServiceBase);t.FourBullService=e,__reflect(e.prototype,"service.FourBullService")}(service||(service={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return this._type},e.prototype.setmoney=function(t){this.money=util.NumberUtil.formatUnit(t)},e}(eui.Component);t.SafeMoney=e,__reflect(e.prototype,"ui.blackjack.SafeMoney")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.notblackjack=0]="notblackjack",t[t.isblackjack=1]="isblackjack"}(i=e.txtType||(e.txtType={}));var n=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.time_out_id2=null,t._textHeight=35,t.changeGraphics=function(e){t.shape.graphics.beginFill(65535,1),t.shape.graphics.moveTo(0,0),t.shape.graphics.lineTo(0,0),t.shape.graphics.drawArc(0,0,t.radio,e,3*Math.PI/2,!1),t.shape.graphics.lineTo(0,0),t.shape.graphics.endFill()},t}return __extends(n,e),n.prototype.childrenCreated=function(){var i=this;e.prototype.childrenCreated.call(this),this.sure.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Number(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance.toString())<i.raise/2?t.dialog.MessageDialog.instance.showAlert("lbl_balance_error","lbl_game_comfirm"):(i.group_tips.visible=!1,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BJ_BUYPROTECT,!0))},this),this.cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.group_tips.visible=!1},this)},n.prototype.setRaise=function(t){this.raise=t},n.prototype.changeTextContent=function(t,e){this.visible=!0,this.group_tips.visible=!0,t===i.isblackjack?(this.timeGroup.visible=this.textContent.visible=this.group_btns.visible=!0,this.no_bj.visible=!1,this.countDown(e)):(this.timeGroup.visible=this.textContent.visible=this.group_btns.visible=!1,this.no_bj.visible=!0,this.countDown(util.TimeUtil.now+2e3)),this.heightChange(t)},n.prototype.heightChange=function(t){t===i.isblackjack?this.bgImg.height=295+this.textContent.textHeight:this.bgImg.height=295+this.no_bj.textHeight},n.prototype.countDown=function(t){if(this.totalTime=t-util.TimeUtil.now,this.stopCountDown(),!(this.totalTime<=0)){this.visible=this.timeGroup.visible=!0;util.TimeUtil.now,util.TimeUtil.now+t;this.lastTime=this.totalTime,this.lab_count.text=""+Math.floor(this.lastTime/1e3),this.time_out_id2=new egret.Timer(250,Math.ceil(t/250)),this.time_out_id2.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.time_out_id2.start()}},n.prototype.timerFunc=function(){this.lastTime-=250,this.lastTime>0?(this.lab_count.text!==""+Math.floor(this.lastTime/1e3)&&util.SoundUtil.play("time_mp3"),this.lab_count.text=""+Math.floor(this.lastTime/1e3)):null!=this.time_out_id2&&(this.time_out_id2.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.time_out_id2.stop(),this.time_out_id2=null,this.stopCountDown())},n.prototype.stopCountDown=function(){null!=this.time_out_id2&&(this.time_out_id2.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.time_out_id2.stop(),this.time_out_id2=null),this.timeGroup.visible=!1,this.visible=!1},n.prototype.initCountDown=function(){this.shape},n}(t.Component);e.WarnBox=n,__reflect(n.prototype,"ui.blackjack.WarnBox")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setScore=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!0),t>=0?(this.text="0",this.font="bc_font_win_money_fnt",!i&&(this.text="+"+util.NumberUtil.formatNumber(t))):(this.font="bc_font_lose_money_fnt",!i&&(this.text=util.NumberUtil.formatNumber(t))),util.NumberUtil.tweenNumber(this,t,1500,!0).then(function(){return e&&e()})},e.prototype.addScore=function(t){this.score=this.score||0,this.score+=t,this.score>=0?this.font="bc_font_win_money_fnt":this.font="bc_font_lose_money_fnt",this.text=util.NumberUtil.formatNumber(this.score)},e.prototype.initView=function(){egret.Tween.removeTweens(this),this.text="",this.score=0},e}(t.control.BitmapLabel);e.WinLoseInfo=i,__reflect(i.prototype,"ui.blackjack.WinLoseInfo")}(e=t.blackjack||(t.blackjack={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.horizontalCenter=0,e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.init,this)},e.prototype.added=function(){var t=this;this.visible=!0,util.SoundUtil.play("nn_gamestart_mp3"),egret.Tween.get(this.img_left_bull).to({x:0},300),egret.Tween.get(this.img_right_bull).to({x:353},300).call(function(){t.mc_flash.visible=!0,t.mc_flash.isPlaying=!0,t.img_fire.visible=!0,egret.Tween.get(t.img_label).to({scaleX:1,scaleY:1},200,egret.Ease.quintIn).call(function(){egret.Tween.get(t.img_light).to({alpha:1},100).wait(300).call(function(){t.parent&&t.parent.removeChild(t),t.dispatchEventWith(e.EVT_SHOW_BTN)})}),t.img_label.visible=!0})},e.prototype.init=function(){this.visible=!1,util.SoundUtil.destroy(["nn_gamestart_mp3"]),egret.Tween.removeTweens(this.img_left_bull),egret.Tween.removeTweens(this.img_right_bull),egret.Tween.removeTweens(this.img_label),this.img_left_bull.x=-2e3,this.img_right_bull.x=2353,this.img_fire.visible=!1,this.mc_flash.visible=!1,this.mc_flash.currentFrame=0,this.mc_flash.isPlaying=!1,this.img_label.visible=!1,this.img_label.scaleX=this.img_label.scaleY=3,this.img_light.alpha=0},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?0:-100},e.EVT_SHOW_BTN="evt_show_btn",e}(eui.Component);t.BeginAni=e,__reflect(e.prototype,"ui.bull.BeginAni")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.chip_pool=[],i.parent_container=new eui.Group,i.parent_container.percentWidth=i.parent_container.percentHeight=100,i.parent_container.touchEnabled=i.parent_container.touchChildren=!1,e.addChild(i.parent_container),i}return __extends(e,t),e.prototype.getOneChip=function(){var t=this.chip_pool.shift();return t||(t=new eui.Image("bull_pic_chips_png"),t.anchorOffsetX=this.width/2<<0,t.anchorOffsetY=this.height/2<<0),t},e.prototype.returnChip=function(t){this.chip_pool.push(t),t.parent&&t.parent.removeChild(t)},e.prototype.flyChip=function(t,e,i){var n=this,o=this.parent_container.globalToLocal(t.x-37,t.y-37),r=this.parent_container.globalToLocal(e.x-37,e.y-37);this.parent_container.visible=!0;for(var s=function(t){var e=a.getOneChip();e.visible=!1,a.parent_container.addChild(e),util.TimeUtil.setTimeout(function(){return n.flyAni(e,o,r,300)},util.NumberUtil.getRandom(10,30)*t)},a=this,l=0;i>l;l++)s(l)},e.prototype.hideChip=function(){this.parent_container.visible=!1},e.prototype.flyAni=function(t,e,i,n){var o=this;egret.Tween.removeTweens(t),t.x=e.x,t.y=e.y,egret.Tween.get(t).to({x:i.x,y:i.y},n).call(function(){o.returnChip(t)}),t.visible=!0},e.prototype.resetMode=function(t){},e}(eui.Component);t.Chips=e,__reflect(e.prototype,"ui.bull.Chips")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.clearTimeOut=function(){return util.TimeUtil.clearInterval(e.setIntervalID)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e.visible=!1,e.horizontalCenter=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=this.touchChildren=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clearTimeOut,this)},e.prototype.show=function(t,e){var i=this;this.clearTimeOut();var n=function(){var n=i.calRemainMill(t,e)/1e3<<0;n>0?i.lb_cd.text=""+n:(i.parent&&i.parent.removeChild(i),i.visible=!1)};n(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return n()},250)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?-150:-70},e}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ui.bull.CountDown")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.update=function(e,i,n,o){return util.LogUtil.info("[LiengService] sendData topic=>"+e+" data =>"+JSON.stringify(i)),t.prototype.update.call(this,e,i,n,o)},e.prototype.raise=function(t,e){return this.updateWithCatch(t,{action:"raise",raise:e},null,!1,!1)},e.prototype.call=function(t){return this.updateWithCatch(t,{action:"call"},null,!1,!1)},e.prototype.quit=function(t){return this.updateWithCatch(t,{action:"quit"})},e.prototype.all_in=function(t){return this.updateWithCatch(t,{action:"all_in"},null,!1,!1)},e}(t.ServiceBase);t.LiengService=e,__reflect(e.prototype,"service.LiengService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.has_head=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setBet=function(t){this.hideBet(),-1===t?this.img_skip.visible=!0:(this.group_bankerBet.visible=!0,this.lab_bankerBet.text=String(t))},e.prototype.setRaise=function(t){this.hideBet(),t&&(this.group_bet.visible=!0,this.lab_bet.text=String(t))},e.prototype.hideBet=function(){this.img_skip.visible=!1,this.group_bankerBet.visible=!1,this.group_bet.visible=!1},e.prototype.showBanker=function(t){this.group_banker.visible=t},e.prototype.setName=function(t){this.lab_name.text=t},e.prototype.setBalance=function(t){this.lab_balance.text=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.has_head||(this.has_head=!0,this.img_head.source=t)},e.prototype.initHead=function(){this.has_head=!1},e.prototype.showSurplus=function(t,e){t&&(e>0?(this.lab_surplus.font="public_win_fnt",this.lab_sign.font="public_win_fnt",this.lab_sign.text="+",util.NumberUtil.tweenNumber(this.lab_surplus,e,1e3)):(this.lab_surplus.font="public_lose_fnt",this.lab_sign.font="public_lose_fnt",this.lab_sign.text="-",util.NumberUtil.tweenNumber(this.lab_surplus,Math.abs(e),1e3))),this.lab_sign.visible=t,this.lab_surplus.visible=t},e.prototype.showSnatch=function(t){this.img_snatch.visible=t},e.prototype.getChipPosition=function(){return this.group_chip.localToGlobal()},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.bull.PlayerFrame")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e._selected=!1,e._enabled=!0,e.poker_values=[2,3,4,5,6,7,8,9,10,10,10,10,1],e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setSelect=function(t){this._selected=t,t?(this.img_poker.verticalCenter=-20,this.img_select.verticalCenter=-20,this.rect_poker.verticalCenter=-20):(this.img_poker.verticalCenter=0,this.img_select.verticalCenter=0,this.rect_poker.verticalCenter=0,this.setColor())},e.prototype.isSelected=function(){return this._selected},e.prototype.setColor=function(t){switch(t){case"yellow":this.img_select.source="bull_poker_click_png";break;case"red":this.img_select.source="bull_poker_failure_png";break;case"green":this.img_select.source="bull_poker_success_png";break;default:this.img_select.source=""}},e.prototype.enableTap=function(t){this._enabled=t},e.prototype.setCard=function(t){"number"==typeof t?(this.img_poker.source=t+"_png",this.value=this.poker_values[t%13]):(this.img_poker.source="poker_back_png",this.value=0)},e.prototype.getPokerSize=function(){return{width:this.img_poker.width,height:this.img_poker.height}},e.prototype.getPokerPos=function(){return this.img_poker.localToGlobal()},e.prototype.getValue=function(){return this.value},e.prototype.getTapArea=function(){return this.rect_poker},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.bull.Poker")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(i){var n=t.call(this)||this;n.pokers=[],n.parent_container=i;for(var o=1;20>=o;o++){var r=new e.PokerAniUI;r.visible=!1,n.parent_container.addChild(r),n.pokers.push(r)}return n}return __extends(i,t),i.prototype.flyCard=function(t,e,i){var n=this;return new Promise(function(o){for(var r=5*(t-1),s=5*t-1,a=n.parent_container.globalToLocal(e.x,e.y),l=0,u=function(){return util.SoundUtil.play("nn_sendcard_mp3")},h=function(t){egret.Tween.get(n.pokers[t]).wait(l).set({x:0,y:0,scaleX:1,scaleY:1,visible:!0}).call(u).to({x:a.x,y:a.y,scaleX:i.width/n.pokers[t].width,scaleY:i.height/n.pokers[t].height},200).call(function(){t===s&&o()}),l+=50},c=r;s>=c;c++)h(c)})},i.prototype.hidePoker=function(t){if(t)for(var e=5*(t-1),i=5*t-1,n=e;i>=n;n++)this.pokers[n].visible=!1;else this.pokers.forEach(function(t){t.visible=!1})},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.bull.PokerAni")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Component);e.PokerAniUI=i,__reflect(i.prototype,"ui.bull.PokerAniUI")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectList=[],e.landscape_other_gap=-66.5,e.landscape_own_gap=17,e.portrait_own_gap=-60,e.portrait_other_gap=-81.5,e.result_sound={wuniu:["femalecow_0_mp3","malecow_0_mp3"],niu1:["femalecow_1_mp3","malecow_1_mp3"],niu2:["femalecow_2_mp3","malecow_2_mp3"],niu3:["femalecow_3_mp3","malecow_3_mp3"],niu4:["femalecow_4_mp3","malecow_4_mp3"],niu5:["femalecow_5_mp3","malecow_5_mp3"],niu6:["femalecow_6_mp3","malecow_6_mp3"],niu7:["femalecow_7_mp3","malecow_7_mp3"],niu8:["femalecow_8_mp3","malecow_8_mp3"],niu9:["femalecow_9_mp3","malecow_9_mp3"],niuniu:["femalecow_10_mp3","malecow_10_mp3"],sihuaniu:["female4cow_mp3","male4cow_mp3"],wuhuaniu:["female5cow_mp3","male5cow_mp3"],bomb:["femalebomb_mp3","malebomb_mp3"],wuxiaoniu:["female5scow_mp3","male5scow_mp3"]},e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.enabled=!1,this.registerEvent()},e.prototype.registerEvent=function(){var t=this;if("own"===this.type)for(var i=function(i){var o=n["poker_"+i];o.getTapArea().addEventListener(egret.TouchEvent.TOUCH_TAP,function(){!o.isSelected()&&t.getCurrentSelect()<3?(o.setSelect(!0),t.selectList.push(o.getValue()),t.dispatchEventWith(e.EVT_SELECT,!0,t.selectList),t.changePokerColor()):o.isSelected()&&(o.setSelect(!1),t.selectList.splice(t.selectList.indexOf(o.getValue()),1),t.dispatchEventWith(e.EVT_SELECT,!0,t.selectList),t.changePokerColor())},n),mouse.setButtonMode(o.getTapArea(),!0)},n=this,o=1;5>=o;o++)i(o);this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){t.stopDealAni()},this)},e.prototype.changePokerColor=function(){for(var t=function(t){var i=e["poker_"+t];if(i.isSelected())if(3===e.selectList.length){var n=0;e.selectList.forEach(function(t){n+=t}),n%10===0?i.setColor("green"):i.setColor("red")}else i.setColor("yellow")},e=this,i=1;5>=i;i++)t(i)},e.prototype.getCurrentSelect=function(){for(var t=0,e=1;5>=e;e++){var i=this["poker_"+e];i.isSelected()&&t++}return t},e.prototype.getTopCardPos=function(){return this.poker_1.getPokerPos()},e.prototype.getPokerSize=function(){return this.poker_1.getPokerSize()},e.prototype.showPoker=function(t){var e=this;[2,3,4,5].forEach(function(i){e["poker_"+i].visible=t})},e.prototype.setCards=function(t){this.group_finish.visible=!1;for(var e=1;5>=e;e++){var i=this["poker_"+e];i.setCard(t[e-1])}},e.prototype.setColor=function(t){for(var e=1;5>=e;e++){var i=this["poker_"+e];i.isSelected()&&i.setColor(t)}},e.prototype.setBack=function(){for(var t=1;5>=t;t++){var e=this["poker_"+t];e.setCard()}},e.prototype.init=function(){for(var t=1;5>=t;t++){var e=this["poker_"+t];e.setSelect(!1)}this.selectList=[],this.setBack(),this.group_finish.visible=!1,this.mc_result.visible=!1,this.group_poker.layout.gap=this[this.currentState+"_gap"]},e.prototype.dealCardAni=function(t){var e=this;return void 0===t&&(t=!0),new Promise(function(i){t?egret.Tween.get(e.group_poker.layout).set({gap:-e.poker_1.getTapArea().width}).to({gap:e[e.currentState+"_gap"]},300).call(i):(e.group_poker.layout.gap=e[e.currentState+"_gap"],i())})},e.prototype.stopDealAni=function(){egret.Tween.removeTweens(this.group_poker.layout),this.group_poker.layout.gap=this[this.currentState+"_gap"]},e.prototype.finish=function(t){t&&!this.group_finish.visible&&util.SoundUtil.play("qznn_carddone_mp3"),this.init(),this.enabled=!1,this.type="other",this.group_finish.visible=!0},e.prototype.getResultSound=function(t){return this.result_sound[""+t][""+util.NumberUtil.getRandom(0,1)]},e.prototype.showResult=function(t,e){var i=this,n=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},o=function(){return util.SoundUtil.play(i.getResultSound(e))};return new Promise(function(r){i.group_finish.visible=!1,i.mc_result.visible=!1,i.type="other";for(var s=function(s){var a=i["poker_"+s];egret.Tween.get(a.img_poker).wait(50*(s-1)).to({scaleX:0,scaleY:1.1},200).call(function(){a.setCard(t[s-1])}).to({scaleX:1,scaleY:1},200).call(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return 5!==s?[3,2]:(o(),this.mc_result.currentFrame=0,this.mc_result.group="effect_bull_"+e,this.mc_result.playTimes=1,this.mc_result.isPlaying=!0,this.mc_result.visible=!0,[4,n(600)]);case 1:t.sent(),r(),t.label=2;case 2:return[2]}})})})},a=1;5>=a;a++)s(a)})},e.EVT_SELECT="evt_select",e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.bull.PokerList")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.take_all=0]="take_all",t[t.lose_all=1]="lose_all",t[t.win=2]="win"}(i=e.ResultEnum||(e.ResultEnum={}));var n=function(e){function n(i){var n=e.call(this)||this;return n.parent_container=i,n.touchEnabled=!1,n.touchChildren=!1,n.mc=new t.control.MovieClip("",12,1,0,!1),n.mc.scaleX=n.mc.scaleY=1.6,n.mc.visible=!1,n.mc.horizontalCenter=0,n.mc.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.reset,n),n}return __extends(n,e),n.prototype.show=function(t){var e=this;return new Promise(function(n){switch(e.mc.currentFrame=0,t){case i.take_all:e.mc.group="effect_bull_eatall",util.SoundUtil.play("qznn_tongchi_mp3");break;case i.lose_all:e.mc.group="effect_bull_compensation";break;case i.win:e.mc.group="effect_0_win",util.SoundUtil.play("nn_win_mp3")}e.mc.playTimes=1,e.mc.once(egret.Event.COMPLETE,function(){n(),e.reset()},e),e.parent_container.addChild(e.mc),e.mc.isPlaying=!0,e.mc.visible=!0})},n.prototype.reset=function(){this.mc.parent&&(this.mc.parent.removeChild(this.mc),this.mc.isPlaying=!1,this.mc.visible=!1,this.mc.group="",this.mc.source=null)},n.prototype.resetMode=function(t){this.mc.verticalCenter=t===egret.OrientationMode.PORTRAIT?-450:-300},n}(eui.Component);e.ResultMC=n,__reflect(n.prototype,"ui.bull.ResultMC")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ControllerUtil;!function(t){t.registerMap=new Map,t.registerData=function(e,i){e.forEach(function(t){return util.NotifyUtil.addNotification(t.type,t.fuc.bind(t.fuc_obj))});var n=t.registerMap.get(i);n?n.push.apply(n,e):t.registerMap.set(i,e)},t.clearRegister=function(e){var i=t.registerMap.get(e);i&&(i.forEach(function(t){return util.NotifyUtil.removeNotification(t.type,t.fuc.bind(t.fuc_obj))}),t.registerMap["delete"](e))},t.checkRoomsLastOp=function(t,e){!util.ObjectUtil.isEqual(e.snapshot.last_op_room,t.snapshot.last_op_room)&&t.snapshot.last_op_room&&t.snapshot.last_op_room.channel_id===Const.UserInfo.CHANNEL_ID&&(util.LogUtil.warn("[GameController] [checkRoomsLastOp] showhideroom room_id => "+t.snapshot.last_op_room.room_id+" visible => "+t.snapshot.last_op_room.visible),t.snapshot.rooms[t.snapshot.last_op_room.room_id].visible=t.snapshot.last_op_room.visible)
},t.checkOnlineData=function(t){util.LogUtil.debug("[CFacotry] [updateOnlinPlayers] [receive] data => "+JSON.stringify(t)),Data.validate(topic.OnlineTopic.snp_schema,t)},t.uniteDeskTopic=function(t,e){return"/"+t+"_desk/"+e},t.deskTopicListen=function(t,e){return"topic."+t+"_desk/"+e},t.deskHandlerHelper=function(t,e,i,n){t.snapshot.message&&"error_quit"===t.snapshot.message?(util.LogUtil.warn("desk receive msg error_quit"),!ui.MainUI.instance.stage&&util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL,!0),ui.dialog.MessageDialog.instance.showAlert("lbl_balance_error2","lbl_game_comfirm")):n(t,e,i)},t.unsubRooms=function(t){return service.MainService.instance.unsubsRooms(GameConst.valid_game_data_map.get(t).topic.type_topic)},t.roomUI=function(t){return GameConst.valid_game_data_map.get(t).cmpt.room_ui},t.typeTopic=function(t){return GameConst.valid_game_data_map.get(t).topic.type_topic},t.deskTopic=function(t){return GameConst.valid_game_data_map.get(t).topic.desk_topic}}(ControllerUtil||(ControllerUtil={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.init=function(t){this.gp_mult_btns.$children.forEach(function(e,i){return e.updateMult(t[i+1])}),this.visible=!0},i.prototype.registEvent=function(){e.prototype.registEvent.call(this),this.btn_give_up.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.btn_give_up.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this)},i.prototype.sendMult=function(e){e.stopImmediatePropagation();var i=e.target===this.btn_give_up?-1:e.data;this.dispatchEventWith(t.MultButtonsBase.EVT_SEND_MULT,!1,i),this.parent&&this.parent.removeChild(this)},i}(t.MultButtonsBase);t.HogButtons=e,__reflect(e.prototype,"ui.bull.HogButtons")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e;!function(t){t[t.Match=0]="Match",t[t.Canle=1]="Canle"}(e=t.MatchEnum||(t.MatchEnum={}));var i=function(t){function i(){var e=t.call(this)||this;return e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e.visible=!1,e.horizontalCenter=0,e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.prototype.addToStage=function(){this.btn_match_canle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this),this.btn_auto_match.selected?this.autoMatch():this.changeState(e.Match)},i.prototype.removeFromStage=function(){this.clearInterval(),this.btn_match_canle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this)},i.prototype.matchCanleClick=function(){"match"===this.currentState?(this.sendMatchNotify(),this.parent&&this.parent.removeChild(this)):(this.clearInterval(),this.btn_auto_match.selected=!1,this.changeState(e.Match))},i.prototype.autoMatch=function(){var t=this,i=5,n=function(e){e>0?t.lb_countdown.text=util.LanguageUtil.translate("lbl_game_willmatch",e):(t.clearInterval(),t.parent&&t.parent.removeChild(t),t.sendMatchNotify())};this.changeState(e.Canle),n(i--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(i--)},1e3)},i.prototype.changeState=function(t){this.currentState=t===e.Match?"match":"canle",!this.visible&&(this.visible=!0)},i.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?430:130},i}(eui.Component);t.MatchButton=i,__reflect(i.prototype,"ui.bull.MatchButton")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this)},e.prototype.updateMult=function(t){this.mult=t,this.btn.labelDisplay.text=""+t},e.prototype.sendMult=function(){this.dispatchEventWith(e.EVT_SEND_MULT,!0,this.mult)},e.EVT_SEND_MULT="evt_send_mult",e}(eui.Component);t.MultButton=e,__reflect(e.prototype,"ui.bull.MultButton")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.init=function(t,e,i){void 0===t&&(t=[1,4,8,11,15]);var n=Math.min.apply(Math,t);this.gp_mult_btns1.$children.concat(this.gp_mult_btns.$children).forEach(function(o,r){var s=t[r];o.updateMult(s),new Decimal(e).mul(s).mul(i).gte(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance)&&s!==n?(o.enabled=!1,o.filters=[Const.grayFilter]):(o.enabled=!0,o.filters=null)}),this.visible=!0},i.prototype.registEvent=function(){e.prototype.registEvent.call(this),this.gp_mult_btns1.addEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.gp_mult_btns1.removeEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i}(t.MultButtonsBase);t.MultButtons=e,__reflect(e.prototype,"ui.bull.MultButtons")}(e=t.bull||(t.bull={}))}(ui||(ui={}));var GameCoreController=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cur_game",{get:function(){return this._cur_game},enumerable:!0,configurable:!0}),t.prototype.getHallRegistersByGame=function(t){var e=[];if(t){var i=t.cmpt.controller;e=[{type:"topic."+Const.Topic.ROOMS.substring(1)+t.topic.type_topic,fuc:i.updateRoom,fuc_obj:i},{type:"topic.online_players.snapshot",fuc:i.updateOnlinePlayers,fuc_obj:i}]}return e},t.prototype.enterHall=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(o){switch(o.label){case 0:return ui.dialog.MiniLoadingDialog.instance.show(),e=this.cur_game,e?[4,this.leaveHall(!1)]:[3,2];case 1:e=o.sent(),o.label=2;case 2:return this._cur_game=t,util.LogUtil.info("[GameCoreController] ENTER_SEC_HALL name => "+t),i=GameConst.valid_game_data_map.get(t),n=this.getHallRegistersByGame(i),ControllerUtil.registerData(n,"secHall"),i.cmpt.controller.init(),util.LogUtil.info("[GameCoreController] ENTER_SEC_HALL name => "+t+" 2"),[4,Promise.all([ui.MainUI.instance.execCommand(Const.UICommand.CMD_ENTER_SEC_HALL,t),service.MainService.instance.subsRooms(i.topic.type_topic)])];case 3:return o.sent(),util.LogUtil.info("[GameCoreController] updating online players"),service.MainService.instance.updateOnlinePlayers(!0,t),ui.dialog.MiniLoadingDialog.instance.close(),[2]}})})},t.prototype.leaveHall=function(t){return void 0===t&&(t=!0),__awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return e=this.cur_game,this._cur_game=void 0,util.LogUtil.info("[GameCoreController] LEAVE_SEC_HALL name => "+e),t&&ui.dialog.MiniLoadingDialog.instance.show(),ControllerUtil.clearRegister("secHall"),service.MainService.instance.updateOnlinePlayers(!1,e),[4,GameConst.valid_game_data_map.get(e).cmpt.controller.clearHall()];case 1:return i.sent(),ui.MainUI.instance.execCommand(Const.UICommand.CMD_BACK_PRI_HALL,e),t&&ui.dialog.MiniLoadingDialog.instance.close(),[2]}})})},t.prototype.enterGame=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(n){switch(n.label){case 0:return util.LogUtil.info("[GameCoreController] [enterDesk] room_id => "+t+" desk_id => "+e),ui.dialog.MiniLoadingDialog.instance.show(),i=GameConst.valid_game_data_map.get(this.cur_game),[4,i.cmpt.controller.enterGame(t,e)];case 1:return n.sent(),Controller.instance.playBGM(i.room_bgm||i.bgm),ui.dialog.MiniLoadingDialog.instance.close(),[2]}})})},t.prototype.leaveGame=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return util.LogUtil.info("[Controller] BACK_SEC_HAL is_kick => "+t),e=GameConst.valid_game_data_map.get(this.cur_game).cmpt.controller,e.checkLeaveGame()||t?(ui.dialog.MiniLoadingDialog.instance.show(),Controller.instance.toggleUI(ui.MainUI.instance,!0,!1),[4,e.leaveGame()]):[3,2];case 1:return i.sent(),Controller.instance.playBGM(),ui.dialog.MiniLoadingDialog.instance.close(),[3,3];case 2:ui.dialog.MessageDialog.instance.showHint("lbl_game_cannot_return"),i.label=3;case 3:return[2]}})})},t}();__reflect(GameCoreController.prototype,"GameCoreController");var ui;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.chip_pool=[],i.parent_container=new eui.Group,i.parent_container.percentWidth=i.parent_container.percentHeight=100,i.parent_container.touchEnabled=i.parent_container.touchChildren=!1,e.addChild(i.parent_container),i}return __extends(e,t),e.prototype.getOneChip=function(){var t=this.chip_pool.shift();return t||(t=new eui.Image("bull_pic_chips_png"),t.anchorOffsetX=this.width/2<<0,t.anchorOffsetY=this.height/2<<0),t},e.prototype.returnChip=function(t){this.chip_pool.push(t),t.parent&&t.parent.removeChild(t)},e.prototype.flyChip=function(t,e,i){var n=this,o=this.parent_container.globalToLocal(t.x-37,t.y-37),r=this.parent_container.globalToLocal(e.x-37,e.y-37);this.parent_container.visible=!0;for(var s=function(t){var e=a.getOneChip();e.visible=!1,a.parent_container.addChild(e),util.TimeUtil.setTimeout(function(){return n.flyAni(e,o,r,300)},util.NumberUtil.getRandom(10,30)*t)},a=this,l=0;i>l;l++)s(l)},e.prototype.hideChip=function(){this.parent_container.visible=!1},e.prototype.flyAni=function(t,e,i,n){var o=this;egret.Tween.removeTweens(t),t.x=e.x,t.y=e.y,egret.Tween.get(t).to({x:i.x,y:i.y},n).call(function(){o.returnChip(t)}),t.visible=!0},e.prototype.resetMode=function(t){},e}(eui.Component);t.Chips=e,__reflect(e.prototype,"ui.casino.Chips")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clearTimeOut=function(){return util.TimeUtil.clearInterval(e.setIntervalID)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.visible=!1,this.touchEnabled=this.touchChildren=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clearTimeOut,this)},e.prototype.show=function(t,e){var i=this;this.clearTimeOut();var n=function(){var n=i.calRemainMill(t,e)/1e3<<0;n>0?i.lb_cd.text=""+n:(i.parent&&i.parent.removeChild(i),i.visible=!1)};n(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return n()},250)},e}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ui.casino.CountDown")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.update=function(e,i,n,o){return util.LogUtil.info("[PaigowService] sendData topic=>"+e+" data =>"+JSON.stringify(i)),t.prototype.update.call(this,e,i,n,o)},e.prototype.disputeBanker=function(t,e){return this.update(t,{action:"dispute",dispute:{rate:e}},null,!0)},e.prototype.rasie=function(t,e){return this.update(t,{action:"raise",raise:{rate:e}},null,!0)},e}(t.ServiceBase);t.PaigowService=e,__reflect(e.prototype,"service.PaigowService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Component);e.HostingButton=i,__reflect(i.prototype,"ui.casino.HostingButton")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setRaiseMult=function(t){this.lbl_mul.text=String(t)},e}(t.Component);e.MultInfo=i,__reflect(i.prototype,"ui.casino.MultInfo")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.has_head=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setName=function(t){this.lab_name.text=t},e.prototype.setBalance=function(t){this.lab_balance.text=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.has_head||(this.has_head=!0,this.img_head.source=t)},e.prototype.initHead=function(){this.has_head=!1},e.prototype.getChipPosition=function(){return this.group_chip.localToGlobal()},e}(t.Component);e.PlayerInfo=i,__reflect(i.prototype,"ui.casino.PlayerInfo")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e.poker_values=[2,3,4,5,6,7,8,9,10,10,10,10,1],e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setCard=function(t){"number"==typeof t?(this.img_poker.source=t+"_png",this.value=this.poker_values[t%13]):(this.img_poker.source="poker_back_png",this.value=0)},e.prototype.getPokerSize=function(){return{width:this.img_poker.width,height:this.img_poker.height}},e.prototype.getPokerPos=function(){return this.img_poker.localToGlobal()},e.prototype.getValue=function(){return this.value},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.casino.Poker")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(i){var n=t.call(this)||this;n.pokers=[],n.parent_container=i;for(var o=1;42>=o;o++){var r=new e.PokerAniUI;r.visible=!1,n.parent_container.addChild(r),n.pokers.push(r)}return n}return __extends(i,t),i.prototype.flyCard=function(t,e,i){var n=this;return new Promise(function(o){for(var r=7*(t-1),s=7*t-1,a=n.parent_container.globalToLocal(e.x,e.y),l=0,u=function(){return util.SoundUtil.play("nn_sendcard_mp3")},h=function(t){egret.Tween.get(n.pokers[t]).wait(l).set({x:0,y:0,scaleX:1,scaleY:1,visible:!0}).call(u).to({x:a.x,y:a.y,scaleX:i.width/n.pokers[t].width,scaleY:i.height/n.pokers[t].height},200).call(function(){t===s&&o()}),l+=50},c=r;s>=c;c++)h(c)})},i.prototype.hidePoker=function(t){if(t)for(var e=7*(t-1),i=7*t-1,n=e;i>=n;n++)this.pokers[n].visible=!1;else this.pokers.forEach(function(t){t.visible=!1})},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.casino.PokerAni")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Component);e.PokerAniUI=i,__reflect(i.prototype,"ui.casino.PokerAniUI")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.landscape_other_gap=-66.5,e.landscape_own_gap=20,e.portrait_own_gap=-90,e.portrait_other_gap=-81.5,e.result_sound={wuniu:["femalecow_0_mp3","malecow_0_mp3"],niu1:["femalecow_1_mp3","malecow_1_mp3"],niu2:["femalecow_2_mp3","malecow_2_mp3"],niu3:["femalecow_3_mp3","malecow_3_mp3"],niu4:["femalecow_4_mp3","malecow_4_mp3"],niu5:["femalecow_5_mp3","malecow_5_mp3"],niu6:["femalecow_6_mp3","malecow_6_mp3"],niu7:["femalecow_7_mp3","malecow_7_mp3"],niu8:["femalecow_8_mp3","malecow_8_mp3"],niu9:["femalecow_9_mp3","malecow_9_mp3"],niuniu:["femalecow_10_mp3","malecow_10_mp3"],sihuaniu:["female4cow_mp3","male4cow_mp3"],wuhuaniu:["female5cow_mp3","male5cow_mp3"],bomb:["femalebomb_mp3","malebomb_mp3"],wuxiaoniu:["female5scow_mp3","male5scow_mp3"]},e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.registerEvent=function(){var t=this;this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){t.stopDealAni()},this)},e.prototype.getTopCardPos=function(){return this.poker_1.getPokerPos()},e.prototype.getPokerSize=function(){return this.poker_1.getPokerSize()},e.prototype.showPoker=function(t){var e=this;[2,3,4,5].forEach(function(i){e["poker_"+i].visible=t})},e.prototype.setCards=function(t){for(var e=1;5>=e;e++){var i=this["poker_"+e];i.setCard(t[e-1])}},e.prototype.setBack=function(){for(var t=1;5>=t;t++){var e=this["poker_"+t];e.setCard()}},e.prototype.init=function(){this.setBack(),this.mc_result.visible=!1,this.group_poker.layout.gap=this[this.currentState+"_gap"]},e.prototype.dealCardAni=function(t){var e=this;return void 0===t&&(t=!0),new Promise(function(i){t?egret.Tween.get(e.group_poker.layout).to({gap:e[e.currentState+"_gap"]},300).call(i):(e.group_poker.layout.gap=e[e.currentState+"_gap"],i())})},e.prototype.stopDealAni=function(){egret.Tween.removeTweens(this.group_poker.layout),this.group_poker.layout.gap=this[this.currentState+"_gap"]},e.prototype.getResultSound=function(t){return this.result_sound[""+t][""+util.NumberUtil.getRandom(0,1)]},e.prototype.showResult=function(t,e){var i=this,n=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},o=function(){return util.SoundUtil.play(i.getResultSound(e))};return new Promise(function(r){i.mc_result.visible=!1,i.type="other";for(var s=function(s){var a=i["poker_"+s];egret.Tween.get(a.img_poker).wait(50*(s-1)).to({scaleX:0,scaleY:1.1},200).call(function(){a.setCard(t[s-1])}).to({scaleX:1,scaleY:1},200).call(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return 5!==s?[3,2]:(o(),this.mc_result.currentFrame=0,this.mc_result.group="effect_bull_"+e,this.mc_result.playTimes=1,this.mc_result.isPlaying=!0,this.mc_result.visible=!0,[4,n(600)]);case 1:t.sent(),r(),t.label=2;case 2:return[2]}})})})},a=1;5>=a;a++)s(a)})},e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.casino.PokerList")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.win=0]="win"}(i=e.ResultEnum||(e.ResultEnum={}));var n=function(e){function n(i){var n=e.call(this)||this;return n.parent_container=i,n.touchEnabled=!1,n.touchChildren=!1,n.mc=new t.control.MovieClip("",12,1,0,!1),n.mc.scaleX=n.mc.scaleY=1.6,n.mc.visible=!1,n.mc.horizontalCenter=0,n.mc.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.reset,n),n}return __extends(n,e),n.prototype.show=function(t){var e=this;return new Promise(function(n){switch(e.mc.currentFrame=0,t){case i.win:e.mc.group="effect_0_win",util.SoundUtil.play("nn_win_mp3")}e.mc.playTimes=1,e.mc.once(egret.Event.COMPLETE,function(){n(),e.reset()},e),e.parent_container.addChild(e.mc),e.mc.isPlaying=!0,e.mc.visible=!0})},n.prototype.reset=function(){this.mc.parent&&(this.mc.parent.removeChild(this.mc),this.mc.isPlaying=!1,this.mc.visible=!1,this.mc.group="",this.mc.source=null)},n.prototype.resetMode=function(t){this.mc.verticalCenter=t===egret.OrientationMode.PORTRAIT?-450:-300},n}(eui.Component);e.ResultMC=n,__reflect(n.prototype,"ui.casino.ResultMC")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.raise=function(t,e){return this.update(t,{action:"raise",raise:{raise_rate:e}},null,!0)},e.prototype.fight=function(t,e){return this.update(t,{action:"fight",fight:{more_card:e}},null,!0)},e}(t.ServiceBase);t.PokdengService=e,__reflect(e.prototype,"service.PokdengService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setScore=function(t,e){void 0===e&&(e=void 0),void 0===e?this.lb_score.text=util.NumberUtil.formatNumber(t):this.lb_score.text="+"+util.NumberUtil.formatNumber(t)},e}(t.Component);e.WinLoseInfo=i,__reflect(i.prototype,"ui.casino.WinLoseInfo")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e;!function(t){t[t.Match=0]="Match",t[t.Canle=1]="Canle"}(e=t.MatchEnum||(t.MatchEnum={}));var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.visible=!1,this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.prototype.addToStage=function(){this.btn_match_canle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this),this.btn_auto_match.selected?this.autoMatch():this.changeState(e.Match)},i.prototype.removeFromStage=function(){this.clearInterval(),this.btn_match_canle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this)},i.prototype.matchCanleClick=function(){"match"===this.currentState?(this.sendMatchNotify(),this.parent&&this.parent.removeChild(this)):(this.clearInterval(),this.btn_auto_match.selected=!1,this.changeState(e.Match))},i.prototype.autoMatch=function(){var t=this,i=5,n=function(e){e>0?t.lb_countdown.text=util.LanguageUtil.translate("lbl_game_willmatch",e):(t.clearInterval(),t.parent&&t.parent.removeChild(t),t.sendMatchNotify())};this.changeState(e.Canle),n(i--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(i--)},1e3)},i.prototype.changeState=function(t){this.currentState=t===e.Match?"match":"canle",!this.visible&&(this.visible=!0)},i.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?430:130},i}(eui.Component);t.MatchButton=i,__reflect(i.prototype,"ui.casino.MatchButton")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this)},e.prototype.updateMult=function(t){this.mult=t,this.btn.labelDisplay.text=""+t},e.prototype.sendMult=function(){this.dispatchEventWith(e.EVT_SEND_MULT,!0,this.mult)},e.EVT_SEND_MULT="evt_send_mult",e}(eui.Component);t.MultButton=e,__reflect(e.prototype,"ui.casino.MultButton")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.init=function(t,e){void 0===t&&(t=[1,2,3,4,5]);var i=Math.min.apply(Math,t);this.gp_mult_btns1.$children.concat(this.gp_mult_btns.$children).forEach(function(n,o){var r=t[o];n.updateMult(r),new Decimal(e).mul(r).gte(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance)&&r!==i?(n.enabled=!1,n.filters=[Const.grayFilter]):(n.enabled=!0,n.filters=null)}),this.visible=!0},i.prototype.registEvent=function(){e.prototype.registEvent.call(this),this.gp_mult_btns1.addEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.gp_mult_btns1.removeEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i}(t.MultButtonsBase);t.MultButtons=e,__reflect(e.prototype,"ui.casino.MultButtons")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.update=function(e,i,n,o){return util.LogUtil.info("[ThirteenKillService] sendData topic=>"+e+" data =>"+JSON.stringify(i)),t.prototype.update.call(this,e,i,n,o)},e.prototype.play=function(t,e){return this.update(t,{action:"play",cards:e})},e.prototype.pass=function(t){return this.update(t,{action:"pass"})},e}(t.ServiceBase);t.ThirteenKillService=e,__reflect(e.prototype,"service.ThirteenKillService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(t.Component);e.ShowDown=i,__reflect(i.prototype,"ui.casino.ShowDown")}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.show=function(){return Main.instance.addChild(t,!0)},t.close=function(){return t.stage&&t.dialog&&t.dialog.forceClose()},t}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init(),this.registerEvent()},i.prototype.registerEvent=function(){this.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this),this.btn_confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectFinish,this)},i.prototype.init=function(){this.percentHeight=this.percentWidth=100,this.rad_select1.selected=!0,this.raiseData=void 0},i.prototype.setRaise=function(t){this.raiseData=t;for(var e=0;5>e;e++)this["lb_raiseTimes"+(e+1)].text=util.LanguageUtil.translate("lbl_game_times",String(t[e]))},i.prototype.selectFinish=function(){for(var e=0;5>e;e++)if(this["rad_select"+(e+1)].selected){t.casino.RoomUI.instance.execCommand(Const.UICommand.CMD_COMFIRM_HOSTING,this.raiseData[e]);break}this.close()},i.prototype.initSelect=function(){this.rad_select1.selected=!0},i}(t.DialogBase);e.HostingDialog=i,__reflect(i.prototype,"ui.casino.dialog.HostingDialog")}(i=e.dialog||(e.dialog={}))}(e=t.casino||(t.casino={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){this._source=e.generateAvatar(t)},enumerable:!0,configurable:!0}),e.generateAvatar=function(t){return!e.avatarArr&&(e.avatarArr=RES.getGroupByName("public").filter(function(t){return/^head_/.test(t.name)}).map(function(t){return t.name})),t&&RES.hasRes(t)?t:e.avatarArr[util.NumberUtil.getRandom(0,e.avatarArr.length-1)]},e}(t.control.EllipseImage);e.Avatar=i,__reflect(i.prototype,"ui.component.Avatar")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"cancelDisplay",{get:function(){return this._cancelDisplay},set:function(t){this._cancelDisplay=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.removed(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removed,this)},e.prototype.added=function(){var t=this;this.visible=!0,this.db_three.play("start"),egret.Tween.get(this.startGame).set({horizontalCenter:-550}).to({horizontalCenter:0},300).call(function(){return t.cancelDisplay.visible=!0})},e.prototype.removed=function(){this.visible=!1,egret.Tween.removeTweens(this.startGame),this.cancelDisplay.visible=!1},e}(eui.Component);t.BeginAni=e,__reflect(e.prototype,"ui.component.BeginAni")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.chips=new eui.ArrayCollection,e}return __extends(i,t),Object.defineProperty(i.prototype,"cur_chosen_item",{get:function(){return this._cur_chosen_item},set:function(t){this._cur_chosen_item=t},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},i.prototype.init=function(){this.registerEvent(),this.scr_chips.horizontalScrollBar.autoVisibility=!1,this.scr_chips.horizontalScrollBar.visible=!1},i.prototype.registerEvent=function(){var t=this;this.list_chips.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){e.item.disabled||(t.updateCurChip(!1),t.setCurChip(e.item))},this)},i.prototype.setChips=function(t){this.chips.removeAll();for(var i=0;i<t.length;i++){var n=Number(t[i]),o=new e.ChipListItem;o.type=(Const.Config.CHIP_VALUES.indexOf(Number(n))+1).toString(),o.value=n,this.chips.addItemAt(o,i)}this.setCurChip(this.chips.getItemAt(0)),this.chips.refresh()},i.prototype.setCurChip=function(t){this.cur_chosen_item=t,this.updateCurChip(!0)},i.prototype.updateCurChip=function(t){this.cur_chosen_item.isChosen=t,this.chips.itemUpdated(this.cur_chosen_item)},i.prototype.updateEnable=function(t){for(var e=!1,i=!1,n=this.chips.length-1;n>=0;n--){var o=this.chips.getItemAt(n);if(t.lt(o.value)){if(o.disabled=!0,o.isChosen&&(this.updateCurChip(!1),n>0)){var r=this.chips.getItemAt(n-1);this.setCurChip(r)}}else o.disabled=!1;e=e||o.isChosen,i=i||!o.disabled}!e&&i&&this.setCurChip(this.chips.getItemAt(0))},i}(t.Component);e.ChipList=i,__reflect(i.prototype,"ui.component.ChipList")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t,this.displayValue=util.NumberUtil.formatUnit(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type="b_chip_"+t+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isChosen",{get:function(){return this._isChosen},set:function(t){this._isChosen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=t},enumerable:!0,configurable:!0}),e}(t.ItemRenderer);e.ChipListItem=i,__reflect(i.prototype,"ui.component.ChipListItem")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(e){void 0===e&&(e=1);
var i=t.call(this)||this;return i.order=0,i.chips=[],i._max_num=4,i._gap=4,i._cur_show_num=0,i.scaleX=i.scaleY=e,i}return __extends(e,t),Object.defineProperty(e.prototype,"cur_show_num",{get:function(){return this._cur_show_num},set:function(t){this._cur_show_num=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gap",{get:function(){return this._gap},set:function(t){this._gap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max_num",{get:function(){return this._max_num},set:function(t){this._max_num=t},enumerable:!0,configurable:!0}),e.returnImg=function(t){t&&(e.IMGS_POOL.push(t),t.parent&&t.parent.contains(t)&&t.parent.removeChild(t),t.scaleX=t.scaleY=1)},e.prototype.getCopyImg=function(t){var i;i=e.IMGS_POOL.length?e.IMGS_POOL.shift():new eui.Image;var n=new egret.RenderTexture;if(n.drawToTexture(this.gp_cp),i.source=n,i.scaleX=i.scaleY=1,this.parent&&t){var o=this.localToGlobal(),r=t.globalToLocal(o.x,o.y);i.x=r.x,i.y=r.y,t.addChild(i)}return i},e.prototype.initChips=function(){var t=this;this.chips.forEach(function(e){return t.gp_chips.contains(e)&&t.gp_chips.removeChild(e)}),this.lb_value.visible=!1,this.gp_cp.height=this.gp_chips.height,this.order=this.cur_show_num=0},e.prototype.getFlyChipGlobalPos=function(){var t=this.localToGlobal(38,38-Math.min(this.order,this.max_num-1)*this.gap);return this.order+=1,t},e.prototype.addChip=function(t,e){void 0===e&&(e="s_chip_player_png"),[this.gp_cp].concat(this.chips).forEach(function(t){return egret.Tween.removeTweens(t)}),this.lb_value.text=util.NumberUtil.formatUnit(t||0),1===++this.cur_show_num&&(this.lb_value.visible=!0);var i=this.cur_show_num>this.max_num+1,n=i?this.max_num:this.cur_show_num-1,o=this.chips[n];o?(i&&(o.alpha=1),o.source=e):(o=new eui.Image(e),o.horizontalCenter=0,this.chips.push(o)),o.y=-n*this.gap,this.gp_chips.addChild(o),this.gp_cp.height=this.gp_chips.height+n*this.gap,this.cur_show_num>this.max_num&&this.beyon()},e.prototype.beyon=function(){var t=this,e=150;egret.Tween.get(this.gp_cp).set({height:this.gp_chips.height+this.max_num*this.gap}).to({height:this.gp_chips.height+(this.max_num-1)*this.gap},e),this.chips.forEach(function(i,n){return egret.Tween.get(i).set({y:-n*t.gap}).to({y:-(n-1)*t.gap},e)});var i=this.chips.shift();this.chips.push(i),egret.Tween.get(i).to({alpha:0},e).call(function(){return t.gp_chips.contains(i)&&t.gp_chips.removeChild(i)})},e.IMGS_POOL=[],e}(t.Component);e.ChipStacked=i,__reflect(i.prototype,"ui.component.ChipStacked")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),mouse.setButtonMode(this,!0),eui.Watcher.watch(this,["data","is_db_playing"],function(){return e._dragonBones&&(e.data.is_db_playing?e._dragonBones.play(e.data.db_armature):e._dragonBones.stop(!0))},this)},e}(t.ItemRenderer);e.GameItemRenderer=i,__reflect(i.prototype,"ui.component.GameItemRenderer")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hot_list=[],e.dp_hot_games=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),"zh"===Const.Config.LANGUAGE.split("_")[0]?this.btn_toggle.bindData={width:this.btn_toggle.width,rotation:0,isFixed:!1}:this.btn_toggle.bindData={width:this.btn_toggle.height,rotation:90.01,isFixed:!0},this.toggleAni(0),this.registerEvent()},e.prototype.registerEvent=function(){var t=this;this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){return t.btn_toggle.selected=!1},this),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){return t.btn_toggle.selected&&!t.contains(e.target)&&(t.btn_toggle.selected=!1)},this),this.list_games.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_SEC_HALL,{type:t.hot_list[e.itemIndex],is_send_by_hot:!0}),t.btn_toggle.selected=!1},this),this.btn_toggle.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE,function(e){return"selected"===e.property&&t.toggleAni()},this)},e.prototype.toggleAni=function(t){var e=this;void 0===t&&(t=300),egret.Tween.get(this.panel,{onChange:function(){var t=e.panel._tweenLeft;e.panel.left=t+"%",e.listGroup.visible=-100!==t}}).to({_tweenLeft:this.btn_toggle.selected?0:-100},t,egret.Ease.sineOut)},e.prototype.updateHotGames=function(t,e){var i=this,n=[];this.hot_list=[],util.LogUtil.info("[HotSortMenu] list foreach: "+t+"  cur_game_type:"+e),t.forEach(function(t){t!==e&&(i.hot_list.push(t),n.push(GameConst.valid_game_data_map.get(t).dg_item_data))}),util.LogUtil.info("[HotSortMenu] hot_games: "+n+" "),this.dp_hot_games.replaceAll(n),this.dp_hot_games.refresh()},e}(t.Component);e.HotSortMenu=i,__reflect(i.prototype,"ui.component.HotSortMenu")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){[this.image1,this.image2,this.image3,this.image4,this.image5,this.image6,this.image7,this.image8].forEach(function(t){var e=util.NumberUtil.getRandom(1e3,1500);egret.Tween.get(t,{loop:!0}).set({y:0}).wait(util.NumberUtil.getRandom(0,200)).to({y:util.NumberUtil.getRandom(-30,30)},e).to({y:0},e)}),this.dragonBones.play("god")},e.prototype.registerEvent=function(){var t=this;this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){[t.image1,t.image2,t.image3,t.image4,t.image5,t.image6,t.image7,t.image8].forEach(function(t){return egret.Tween.removeTweens(t)}),t.dragonBones.stop(!0)},this)},e}(t.Component);e.LoadingUIAni0=i,__reflect(i.prototype,"ui.component.LoadingUIAni0",["ui.component.LoadingUIAni"])}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ferryShakeAni=function(){egret.Tween.get(this.img_ferry,{loop:!0}).to({rotation:-5},1500).to({rotation:5},3e3).to({rotation:0},1500)},e.prototype.ferryMoveAni=function(){egret.Tween.get(this.img_ferry,{loop:!0}).set({factor:0}).to({factor:1},3e4)},e.prototype.balloonAni=function(t){switch(t){case this.img_balloon1:egret.Tween.get(t,{loop:!0}).to({y:t.y-75},5e3).to({y:t.y+75},1e4).to({y:t.y},5e3);break;case this.img_balloon2:egret.Tween.get(t,{loop:!0}).to({y:t.y+50},4e3).to({y:t.y-50},8e3).to({y:t.y},4e3);break;case this.img_balloon3:egret.Tween.get(t,{loop:!0}).to({y:t.y-100},6e3).to({y:t.y+100},12e3).to({y:t.y},6e3)}},e.prototype.cloudAni=function(t,e){var i;switch(t){case this.img_cloud1:i=-1660;break;case this.img_cloud2:i=-380;break;case this.img_cloud3:i=680;break;case this.img_cloud4:i=2e3}egret.Tween.get(t,{loop:!0}).set({scaleX:.3*t.scaleX,scaleY:.3*t.scaleY,alpha:.1}).wait(15e3*e).to({x:i,y:-1200,scaleX:1.2*t.scaleX,scaleY:1.2*t.scaleY,alpha:1},9e4*e)},e.prototype.seagullAni=function(t,e){switch(t){case this.db_haiou1:egret.Tween.get(t).to({horizontalCenter:-1400,verticalCenter:-500*e},5e3).call(function(){return t.visible=!1});break;case this.db_haiou2:egret.Tween.get(t).to({horizontalCenter:1400,verticalCenter:-500*e},5e3).call(function(){return t.visible=!1})}},e.prototype.startAni=function(){this.ferryShakeAni(),this.ferryMoveAni();for(var t=1;4>t;t++)this.balloonAni(this["img_balloon"+t]);for(var t=1;5>t;t++){for(var e=0;.5>e;)e=Math.random();this.cloudAni(this["img_cloud"+t],e)}for(var t=1;3>t;t++){for(var e=0;.4>e;)e=Math.random();this.seagullAni(this["db_haiou"+t],e)}[this.db_haiou1,this.db_haiou2].forEach(function(t){return t.play("haiou")})},e.prototype.stopAni=function(){egret.Tween.removeTweens(this.img_ferry);for(var t=1;5>t;t++)egret.Tween.removeTweens(this["img_cloud"+t]),4>t&&(egret.Tween.removeTweens(this["img_balloon"+t]),3>t&&egret.Tween.removeTweens(this["db_haiou"+t]));util.LogUtil.info("[MainUIAni] foreach stop ..."),util.LogUtil.info("[MainUIAni] db_haiou1:["+this.db_haiou1+"] & db_haiou2:["+this.db_haiou2+"] ..."),[this.db_haiou1,this.db_haiou2].forEach(function(t){return t.stop(!0)})},e}(t.Component);e.MainUIAni0=i,__reflect(i.prototype,"ui.component.MainUIAni0",["ui.component.MainUIAni"]);var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"factor",{set:function(t){this._imgState===egret.OrientationMode.LANDSCAPE?(this.x=(1-t)*(1-t)*1250+2*t*(1-t)*0+t*t*-1170,this.y=(1-t)*(1-t)*650+2*t*(1-t)*100+t*t*700):(this.x=(1-t)*(1-t)*950+2*t*(1-t)*0+t*t*-740,this.y=(1-t)*(1-t)*900+2*t*(1-t)*400+t*t*900)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageState",{get:function(){return this._imgState},set:function(t){this._imgState=t},enumerable:!0,configurable:!0}),e}(eui.Image);e.Ferry=n,__reflect(n.prototype,"ui.component.Ferry")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),Object.defineProperty(i.prototype,"aKey",{get:function(){return this._aKey},set:function(t){this._aKey=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"aVal",{get:function(){return this._aVal||" "},set:function(t){this._aVal=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bKey",{get:function(){return this._bKey},set:function(t){this._bKey=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bVal",{get:function(){return this._bVal||" "},set:function(t){this._bVal=t},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){var i=this;e.prototype.childrenCreated.call(this),this.menu.addEventListener(t.control.SelectList.EVT_INDEX_CHANGE,function(){if(i.menu.selectedItem)switch(i.menu.selectedItem.value){case"quit":util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL);break;case"setting":i.tapSetting();break;case"feedback":i.tapFeedback()}egret.callLater(function(){return i.menu.reset()},i)},this)},i}(e.TopBar);e.MiniTopBar=i,__reflect(i.prototype,"ui.component.MiniTopBar")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=t.call(this)||this;return e.turnCard=function(t){return __awaiter(e,void 0,void 0,function(){var e,i=this;return __generator(this,function(n){switch(n.label){case 0:return e={scaleX:this.size,scaleY:this.size},this.currentState="back",egret.Tween.removeTweens(this.pic),t?[4,new Promise(function(n){egret.Tween.get(i.pic).set(e).to({scaleX:0,scaleY:1.1*i.size},t).call(function(){return i.currentState="normal"}).to(e,t).call(n)})]:[3,2];case 1:return n.sent(),[3,3];case 2:this.currentState="normal",this.pic.scaleX=e.scaleX,this.pic.scaleY=e.scaleY,n.label=3;case 3:return this.dispatchEventWith(egret.Event.COMPLETE),[2]}})})},e.size=1,e.seeing=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"num",{get:function(){return this._num},set:function(t){this._num=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t,this.pic&&(this.width=this.pic.width*t,this.height=this.pic.height*t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"back",{get:function(){return this._back||Const.Config.CARD_BACK||"poker_back_blank_png"},set:function(t){this._back=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seeing",{get:function(){return this._seeing},set:function(t){this._seeing=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.width=this.pic.width*this.size,this.height=this.pic.height*this.size},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.component.Poker")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var i=t.call(this)||this;return i.tween=function(t,e){return util.NumberUtil.tweenNumber(i.label,t,e)},i.includeInLayout=i.visible=e.visible,e.poolPool.push(i),i}return __extends(e,t),Object.defineProperty(e,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,e.poolPool.forEach(function(e){return e.includeInLayout=e.visible=t})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"game",{get:function(){return this._game},set:function(t){this._game!==t&&(this._game=t,this.stage&&util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_POOL,t,this))},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.game&&util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_POOL,this.game,this)},e.poolPool=[],e.tween=function(t,i,n){return e.poolPool.forEach(function(e){return e.game===t&&e.tween(i,n)})},e}(t.Component);e.Pool=i,__reflect(i.prototype,"ui.component.Pool")}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.thisY=0,t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.poolstage=new eui.Image("bj_prize_win1_png"),this.poolstage.horizontalCenter=0,this.poolfireworks=new t.control.MovieClip("effect_public_fireworks",12),this.poolfireworks.horizontalCenter=0,this.poolfireworks.verticalCenter=-370,this.poolfireworks.scaleY=this.poolfireworks.scaleX=1.4,this.poolpig=new eui.Image("bj_prize_win2_png"),this.poolpig.horizontalCenter=0,this.poolpig2=new eui.Image("bj_prize_win2_png"),this.poolpig2.horizontalCenter=0,this.poolpig2.verticalCenter=-50,this.lab_shuoming=new t.control.Label,this.lab_shuoming.size=48,this.lab_shuoming.textColor=16768333,this.lab_shuoming.horizontalCenter=0,this.lab_shuoming.width=900,this.lab_shuoming.isFixed=!0,this.lab_shuoming.textAlign="center",this.lab_shuoming.visible=!1,this.lab_count=new t.control.BitmapLabel,this.lab_count.font="prize_win_fnt",this.lab_count.horizontalCenter=0,this.lab_count.visible=!1,this.thisY=this.y},i.prototype.play=function(t,e){this.lab_shuoming.text=t,this.prizePoolAni(e),this.y=this.thisY},i.prototype.prizePoolAni=function(t){var e=this;this.poolstage.verticalCenter=-740,this.addChild(this.poolstage),egret.Tween.get(this.poolstage).to({verticalCenter:0},150,egret.Ease.quadOut).call(function(){return e.pigAni(t)})},i.prototype.pigAni=function(t){var e=this;this.poolpig2.visible=!1,this.addChild(this.poolpig2),this.poolpig.verticalCenter=-740,this.addChild(this.poolpig),egret.Tween.get(this.poolpig).to({verticalCenter:-50},150,egret.Ease.quadOut).call(function(){egret.Tween.get(e).to({y:e.y+100},50).to({y:e.y-100},50).call(function(){e.poolfireworks.currentFrame=0,e.poolfireworks.group=e.poolfireworks.group,e.poolpig2.visible=!0,egret.Tween.get(e.poolpig2).to({scaleX:2.4,scaleY:2.4,alpha:0},400).call(function(){e.poolpig2.scaleX=1,e.poolpig2.scaleY=1,e.poolpig2.alpha=1}),e.addChildAt(e.poolfireworks,1),e.playEffect(t)})})},i.prototype.playEffect=function(t){this.lab_shuoming.verticalCenter=150,this.lab_shuoming.visible=!0,this.lab_count.verticalCenter=230,this.lab_count.text="0",this.lab_count.visible=!0,this.addChild(this.lab_shuoming),this.addChild(this.lab_count),util.NumberUtil.tweenNumber(this.lab_count,t,1500)},i.prototype.clean=function(){this.poolstage.parent&&(egret.Tween.removeTweens(this.poolstage),this.poolstage.parent.removeChild(this.poolstage)),this.poolfireworks.parent&&this.poolfireworks.parent.removeChild(this.poolfireworks),this.poolpig.parent&&(egret.Tween.removeTweens(this.poolpig),this.poolpig.parent.removeChild(this.poolpig)),this.lab_shuoming.parent&&this.lab_shuoming.parent.removeChild(this.lab_shuoming),this.lab_count.parent&&(egret.Tween.removeTweens(this.lab_count),this.lab_count.parent.removeChild(this.lab_count)),egret.Tween.removeTweens(this),this.poolpig2.parent&&(egret.Tween.removeTweens(this.poolpig2),this.poolpig2.parent.removeChild(this.poolpig2)),this.y=this.thisY},i}(t.Component);e.PoolDialogAni0=i,__reflect(i.prototype,"ui.component.PoolDialogAni0",["ui.component.PoolDialogAni"])}(e=t.component||(t.component={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.thisY=0,t}return __extends(i,e),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.poolstage=new eui.Image("bj_prize_win1_png"),this.poolstage.horizontalCenter=0,this.poolfireworks=new t.control.MovieClip("effect_public_fireworks",12),this.poolfireworks.horizontalCenter=0,this.poolfireworks.verticalCenter=-370,this.poolfireworks.scaleY=this.poolfireworks.scaleX=1.4,this.poolpig=new eui.Image("bj_prize_win2_png"),this.poolpig.horizontalCenter=0,this.poolpig2=new eui.Image("bj_prize_win2_png"),this.poolpig2.horizontalCenter=0,this.poolpig2.verticalCenter=-50,this.lab_shuoming=new t.control.Label,this.lab_shuoming.size=48,this.lab_shuoming.textColor=16768333,this.lab_shuoming.horizontalCenter=0,this.lab_shuoming.width=900,this.lab_shuoming.isFixed=!0,this.lab_shuoming.textAlign="center",this.lab_shuoming.visible=!1,this.lab_count=new t.control.BitmapLabel,this.lab_count.font="prize_win_fnt",this.lab_count.horizontalCenter=0,this.lab_count.visible=!1,this.thisY=this.y},i.prototype.play=function(t,e){this.lab_shuoming.text=t,this.prizePoolAni(e),this.y=this.thisY},i.prototype.prizePoolAni=function(t){var e=this;this.poolstage.verticalCenter=-740,this.addChild(this.poolstage),egret.Tween.get(this.poolstage).to({verticalCenter:0},150,egret.Ease.quadOut).call(function(){return e.pigAni(t)})},i.prototype.pigAni=function(t){var e=this;this.poolpig2.visible=!1,this.addChild(this.poolpig2),this.poolpig.verticalCenter=-740,this.addChild(this.poolpig),egret.Tween.get(this.poolpig).to({verticalCenter:-50},150,egret.Ease.quadOut).call(function(){egret.Tween.get(e).to({y:e.y+100},50).to({y:e.y-100},50).call(function(){e.poolfireworks.currentFrame=0,e.poolfireworks.group=e.poolfireworks.group,e.poolpig2.visible=!0,egret.Tween.get(e.poolpig2).to({scaleX:2.4,scaleY:2.4,alpha:0},400).call(function(){e.poolpig2.scaleX=1,e.poolpig2.scaleY=1,e.poolpig2.alpha=1}),e.addChildAt(e.poolfireworks,1),e.playEffect(t)})})},i.prototype.playEffect=function(t){this.lab_shuoming.verticalCenter=150,this.lab_shuoming.visible=!0,this.lab_count.verticalCenter=230,this.lab_count.text="0",this.lab_count.visible=!0,this.addChild(this.lab_shuoming),this.addChild(this.lab_count),util.NumberUtil.tweenNumber(this.lab_count,t,1500)},i.prototype.clean=function(){this.poolstage.parent&&(egret.Tween.removeTweens(this.poolstage),this.poolstage.parent.removeChild(this.poolstage)),this.poolfireworks.parent&&this.poolfireworks.parent.removeChild(this.poolfireworks),this.poolpig.parent&&(egret.Tween.removeTweens(this.poolpig),this.poolpig.parent.removeChild(this.poolpig)),this.lab_shuoming.parent&&this.lab_shuoming.parent.removeChild(this.lab_shuoming),this.lab_count.parent&&(egret.Tween.removeTweens(this.lab_count),this.lab_count.parent.removeChild(this.lab_count)),egret.Tween.removeTweens(this),this.poolpig2.parent&&(egret.Tween.removeTweens(this.poolpig2),this.poolpig2.parent.removeChild(this.poolpig2)),this.y=this.thisY},i}(t.Component);e.PoolDialogAni1=i,__reflect(i.prototype,"ui.component.PoolDialogAni1",["ui.component.PoolDialogAni"])}(e=t.component||(t.component={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.update=function(e,i,n,o){return util.LogUtil.info("[ThreeFlowerService] sendData topic=>"+e+" data =>"+JSON.stringify(i)),t.prototype.update.call(this,e,i,n,o)},e.prototype.dispute=function(t,e){return this.update(t,{action:"dispute",dispute:{dispute:e}},null,!0)},e.prototype.fight=function(t){return this.update(t,{action:"deal",deal:{deal:"1"}},null,!0)},e}(t.ServiceBase);t.ThreeFlowerService=e,__reflect(e.prototype,"service.ThreeFlowerService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){var t=util.NumberUtil.getRandom(500,800),i={alpha:.25,scaleX:.25,scaleY:.25};egret.Tween.get(e.img,{loop:!0}).set(i).wait(util.NumberUtil.getRandom(0,200)).to({alpha:1,scaleX:1,scaleY:1},t).to(i,t)},e}return __extends(e,t),Object.defineProperty(e.prototype,"free",{get:function(){return this._free},set:function(t){this._free=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rangeX",{get:function(){return this._rangeX},set:function(t){this._rangeX=t,this.x=util.NumberUtil.getRandom(0,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rangeY",{get:function(){return this._rangeY},set:function(t){this._rangeY=t,this.y=util.NumberUtil.getRandom(0,t)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.height=this.width=0,this.img=new eui.Image("hall_pic_gametextstar_png"),this.img.addEventListener(egret.Event.COMPLETE,function(){e.img.anchorOffsetX=.5*e.img.texture.textureWidth,e.img.anchorOffsetY=.5*e.img.texture.textureHeight},this),this.addChild(this.img),this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return egret.Tween.removeTweens(e.img)},this)},e}(t.Component);__reflect(i.prototype,"Star");var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stars=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"star",{get:function(){var t;return this.stars.some(function(e){return e.free&&(t=e),e.free})||(t=new i,this.stars.push(t)),t.free=!1,t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.img&&this.img.addEventListener(egret.Event.COMPLETE,function(){e.stars.forEach(function(t){t.free=!0,e.contains(t)&&e.removeChild(t)}),Array.apply(void 0,Array(util.NumberUtil.getRandom(8,16))).forEach(function(){var t=e.star;t.rangeX=e.width,t.rangeY=e.height,t.scaleY=t.scaleX=.01*util.NumberUtil.getRandom(50,150),e.addChild(t)})},this)},e}(t.Component);e.Title=n,__reflect(n.prototype,"ui.component.Title")}(e=t.component||(t.component={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.dispute=function(t,e,i){return this.update(t,{action:"dispute",dispute:{user_id:Const.UserInfo.USER_ID,position:e,dispute_rate:i}})},e.prototype.rasie=function(t,e,i){return this.update(t,{action:"raise",raise:{user_id:Const.UserInfo.USER_ID,position:e,raise_rate:i}})},e.prototype.fight=function(t,e){return this.update(t,{action:"fight",fight:{user_id:Const.UserInfo.USER_ID,position:e,is_done:!0}})},e}(t.ServiceBase);t.ThreeService=e,__reflect(e.prototype,"service.ThreeService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){return e.content.text=""},e.show=function(){return Main.instance.addChild(e,!0)},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.submit.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FEEDBACK,e.content.text)},this)},e}(t.DialogBase);e.FeedbackDialog=i,__reflect(i.prototype,"ui.dialog.FeedbackDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.init=function(){i.resize(),i.iframeArea.addEventListener(egret.Event.RENDER,i.render,i)},i.resize=function(){if(Main.instance.orientation===egret.OrientationMode.PORTRAIT){var e=t.UIBase.getMainSize(),n=i.dialog.attr;i.contentWidth=e.width-Math.abs(n.left)-Math.abs(n.right),i.contentHeight=e.height-n.titleHeight-n.titleGap-Math.abs(n.top)-Math.abs(n.bottom)}},i.render=function(){var t=i.iframeArea.localToGlobal(),e={x:t.x,y:t.y,width:i.iframeArea.width,height:i.iframeArea.height};util.ObjectUtil.isEqual(i.iframeOption,e)||setIframe(i.iframeOption=e,Math.min(window.innerWidth/Main.instance.stage.stageWidth,window.innerHeight/Main.instance.stage.stageHeight))},i.show=function(t){t.canClose=void 0===t.canClose?!0:t.canClose,t.showClose=void 0===t.showClose?!0:t.showClose,i.option=t,Main.instance.addChild(i,!0)},i.close=function(){return i.stage&&i.dialog&&i.dialog.forceClose()},i}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"option",{get:function(){return this._option},set:function(t){this._option=t},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.init(),this.dialog.onInit=function(){egretPlayer.style.pointerEvents="none",t.iframeArea.visible=!0,setIframe({src:t.option.url,display:"block"})},this.dialog.beforeClose=function(){setIframe({src:"resource/blank.html",display:"none"}),t.iframeArea.visible=!1,egretPlayer.style.pointerEvents="auto"},this.stage.addEventListener(egret.Event.RESIZE,this.resize,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){t.dialog.beforeClose(),t.iframeArea.removeEventListener(egret.Event.RENDER,t.render,t)},this)},i}(t.DialogBase);e.IframeDialog=i,__reflect(i.prototype,"ui.dialog.IframeDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.show=function(t){e.dialog&&e.dialog.init(),e.option=t,Main.instance.addChild(e,!0)},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"option",{get:function(){return this._option},set:function(t){this._option=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100},e}(t.DialogBase);e.MatchDialog=i,__reflect(i.prototype,"ui.dialog.MatchDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.show=function(t){util.TimeUtil.clearTimeout(e.timeout),e.dialog&&e.dialog.init(),t.state=void 0===t.state?"normal":t.state,t.canClose=void 0===t.canClose?!0:t.canClose,t.showClose=void 0===t.showClose?!0:t.showClose,t.autoHide>0&&(e.timeout=util.TimeUtil.setTimeout(function(){return e.close()},t.autoHide)),e.option=t,Main.instance.addChild(e,!0)},e.showHint=function(t,i){e.show({title:"lbl_game_tip",text:t,autoHide:void 0===i?3e3:i})},e.showAlert=function(t,i,n,o){o&&e.stage&&e.option.onClose===n||e.show({title:"lbl_game_tip",text:t,okText:i,state:"alert",canClose:!1,showClose:!1,onClose:n})},e.showException=function(t,i,n,o,r,s){s&&e.stage&&e.option.onClose===r||(e.status&&(e.status.selected=!0),e.show({title:"lbl_game_tip",text:t,okText:i,state:"exception_on",canClose:!1,showClose:!1,onClose:r,status:n,exception:o}))},e.showConfirm=function(t,i,n,o,r){e.show({title:"lbl_game_tip",text:t,okText:i,cancelText:n,state:"confirm",canClose:!1,onOK:o,onClose:r})},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"option",{get:function(){return this._option},set:function(t){this._option=t},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){var t=this.option.state;return this.skin.hasState(t)?t:/^exception_/.test(t)?"alert":"normal"},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.ok.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.option.onOK&&e.option.onOK(),e.close()},this),this.cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this),this.status&&this.status.addEventListener(egret.Event.CHANGE,function(){e.status.selected?e.option.state="exception_on":e.option.state="exception_off"},this)},e}(t.DialogBase);e.MessageDialog=i,__reflect(i.prototype,"ui.dialog.MessageDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.count=0,e.init=function(){e.circle&&egret.Tween.get(e.circle,{loop:!0}).to({rotation:360},1250)},e.show=function(){e.count++,1===e.count&&(e.dialog&&e.dialog.init(),Main.instance.addChild(e,!0))},e.close=function(){return e.count&&!--e.count&&e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.init()},e}(t.DialogBase);e.MiniLoadingDialog=i,__reflect(i.prototype,"ui.dialog.MiniLoadingDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e}(t.PoolDialog);t.MiniPoolDialog=e,__reflect(e.prototype,"ui.dialog.MiniPoolDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.disputeBanker=function(t,e){return this.update(t,{action:"dispute",dispute:{rate:e}},null,!0)},e.prototype.rasie=function(t,e){return this.update(t,{action:"raise",raise:{rate:e}},null,!0)},e}(t.ServiceBase);t.TwoEightService=e,__reflect(e.prototype,"service.TwoEightService")}(service||(service={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.BOY=0]="BOY",t[t.GIRL=1]="GIRL"}(i||(i={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listItemsGlowOff=function(){e.list_boys.dataProvider.source.forEach(function(t){return t.glow=!1}),e.list_girls.dataProvider.source.forEach(function(t){return t.glow=!1})},e.show=function(t){Main.instance.addChild(e,!0),t&&e.setAvatarInList(e.avatar.source=t)},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()
},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){var t=this;this.percentHeight=this.percentWidth=100,this.tab_boys.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.changeAvatarTab(i.BOY)},this),this.tab_girls.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.changeAvatarTab(i.GIRL)},this),this.changeAvatarTab(i.BOY),this.listItemsGlowOff(),this.list_boys.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){t.listItemsGlowOff();var i=t.list_boys.dataProvider.getItemAt(e.itemIndex);i.glow=!0,t.avatar.source=i.source},this),this.list_girls.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){t.listItemsGlowOff();var i=t.list_girls.dataProvider.getItemAt(e.itemIndex);i.glow=!0,t.avatar.source=i.source},this),this.save_avatar.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CHANGE_AVATAR,t.avatar.source)},this)},e.prototype.changeAvatarTab=function(t){this.tab_boys.currentState=t===i.BOY?"down":null,this.tab_girls.currentState=t===i.GIRL?"down":null,this.avatar_select.selectedIndex=t},e.prototype.setAvatarInList=function(t){-1!==t.indexOf("m")?(this.changeAvatarTab(i.BOY),this.listItemsGlowOff(),this.list_boys.dataProvider.source.forEach(function(e){return e.source===t?(e.glow=!0,!1):void 0})):(this.changeAvatarTab(i.GIRL),this.listItemsGlowOff(),this.list_girls.dataProvider.source.forEach(function(e){return e.source===t?(e.glow=!0,!1):void 0}))},e.prototype.getCurrentState=function(){var e=t.prototype.getCurrentState.call(this);return e===egret.OrientationMode.LANDSCAPE?(this.content_area.setChildIndex(this.save_area,1),this.content_area.layout=new eui.HorizontalLayout):(this.content_area.setChildIndex(this.save_area,0),this.content_area.layout=new eui.VerticalLayout),e},e}(t.DialogBase);e.ProfileDialog=n,__reflect(n.prototype,"ui.dialog.ProfileDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.dataProvider=new eui.ArrayCollection,i.colors="zh_cn"===Const.Config.LANGUAGE?["red","green"]:["green","red"],i.resize=function(){if(Main.instance.orientation===egret.OrientationMode.PORTRAIT){var e=t.UIBase.getMainSize(),n=i.dialog.attr;i.contentWidth=e.width-Math.abs(n.left)-Math.abs(n.right),i.contentHeight=e.height-n.titleHeight-n.titleGap-Math.abs(n.top)-Math.abs(n.bottom)}},i.show=function(t){t.forEach(function(t,e){var n=t.surplus||t.jackpot_out;i.dataProvider.addItem(util.ObjectUtil.merge(t,{color:""+i.colors[n>0?0:1],no:e+1,room_name:t.room_name||"-",date:util.TimeUtil.format(t.payout_time,"yyyy-MM-dd"),time:util.TimeUtil.format(t.payout_time,"hh:mm:ss"),valid_bet:util.NumberUtil.formatNumber(t.valid_bet),surplus:t.repeal_time?"ng_cancel":""+(n>0?"+":"")+util.NumberUtil.formatNumber(n),payout_time:util.TimeUtil.format(t.payout_time,"yyyy-MM-dd hh:mm:ss")}))}),Main.instance.addChild(i,!0)},i.close=function(){return i.stage&&i.dialog&&i.dialog.forceClose()},i}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.resize(),this.dialog.onClose=function(){t.dataProvider.removeAll(),t.scroller.stopAnimation(),egret.callLater(function(){return t.list.scrollV=0},t)},this.stage.addEventListener(egret.Event.RESIZE,this.resize,this),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){t.scroller.stopAnimation(),egret.callLater(function(){return t.list.invalidateDisplayList()},t)},this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){return e.itemRenderer.selected&&(t.list.selectedIndex=-1)},this),this.list.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE,function(e){return"selectedIndex"===e.property&&-1===t.list.selectedIndex&&egret.callLater(function(){return t.list.invalidateDisplayList()},t)},this)},i}(t.DialogBase);e.RecordDialog=i,__reflect(i.prototype,"ui.dialog.RecordDialog"),function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getCurrentState=function(){return(this.itemIndex%2?"d":"s")+"_"+(this.selected?"selected":this.data.color)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.invalidateState()},e}(t.ItemRenderer);e.RecordItem=i,__reflect(i.prototype,"ui.dialog.RecordDialog.RecordItem")}(i=e.RecordDialog||(e.RecordDialog={}))}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.init=function(){t.music.value=util.SoundUtil.music,t.effect.value=util.SoundUtil.effect,t.select&&(t.select.selectedIndex=function(){var e;return t.select.dataProvider.source.some(function(t,i){return e=i,t.value===Const.Config.LANGUAGE})?e:-1}()),t.active.selected=util.SoundUtil.active},t.show=function(){return Main.instance.addChild(t,!0)},t.close=function(){return t.stage&&t.dialog&&t.dialog.forceClose()},t}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){var i=this;e.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.music.addEventListener(egret.Event.CHANGE,function(){return util.SoundUtil.toggle(i.music.value,egret.Sound.MUSIC)},this),this.effect.addEventListener(egret.Event.CHANGE,function(){return util.SoundUtil.toggle(i.effect.value)},this),this.select&&this.select.addEventListener(t.control.SelectList.EVT_INDEX_CHANGE,function(){Const.Config.LANGUAGE!==i.select.selectedItem.value&&refresh(""+location.origin+location.pathname+location.search.replace(/(([?|&]lang=)[^&]*)?$/,function(t,e,n){return""+(n||(location.search?"&":"?")+"lang=")+i.select.selectedItem.value}))},this),this.active.addEventListener(egret.Event.CHANGE,function(){return util.SoundUtil.toggle(i.active.selected)},this)},i}(t.DialogBase);e.SettingDialog=i,__reflect(i.prototype,"ui.dialog.SettingDialog")}(e=t.dialog||(t.dialog={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragon=0,e.tie=1,e.tiger=2,e}return __extends(e,t),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this.btns=[this.btn_dragon,this.btn_tie,this.btn_tiger],this.results=[this.img_dragon,this.img_tie,this.img_tiger],this.hovers=[this.img_dragonbg,this.img_tiebg,this.img_tigerbg],this.owns=[this.lab_dragon_own,this.lab_tie_own,this.lab_tiger_own],this.alls=[this.lab_dragon_all,this.lab_tie_all,this.lab_tiger_all],this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.btns[0].enabled||i.dispatchEventWith(e.EVT_SHOW_TIP)},this),["dragon","tie","tiger"].forEach(function(t){var e=i[t];i.btns[e].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.onBet(t)},i),i.btns[e].addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){i.hovers[e].alpha=.4},i),i.btns[e].addEventListener(egret.TouchEvent.TOUCH_END,function(){i.hovers[e].alpha=.2},i),i.btns[e].addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){i.hovers[e].alpha=.2},i),i.btns[e].addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){i.hovers[e].alpha=0},i),mouse.setButtonMode(i.btns[e],!0)}),this.init()},e.prototype.init=function(){var t=this;["dragon","tie","tiger"].forEach(function(e){var i=t[e];egret.Tween.removeTweens(t.results[i]),t.results[i].alpha=0})},e.prototype.showResult=function(t){this.init();var e=this[t];this.results[e].alpha=0,egret.Tween.get(this.results[e],{loop:!0}).to({alpha:1},500).to({alpha:0},500)},e.prototype.onBet=function(t){this.dispatchEventWith(e.EVT_BET,!1,t)},e.prototype.updateBet=function(t,e){var i=this;Object.keys(t).forEach(function(n){var o=i[n];e?i.owns[o].text=util.NumberUtil.formatNumber(t[n]||0):i.alls[o].text=util.NumberUtil.formatNumber(t[n]||0)})},e.prototype.setEnable=function(t){var e=this;["dragon","tie","tiger"].forEach(function(i){var n=e[i];e.btns[n].enabled=t,e.hovers[n].alpha=0})},e.EVT_BET="evt_bet",e.EVT_SHOW_TIP="evt_show_tip",e}(t.Component);e.BetArea=i,__reflect(i.prototype,"ui.dragontiger.BetArea")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),egret.Tween.get(this.group_star1,{loop:!0}).to({rotation:360},3e3),egret.Tween.get(this.group_star2,{loop:!0}).to({rotation:360},2e3),egret.Tween.get(this.group_star3,{loop:!0}).to({rotation:360},3e3),egret.Tween.get(this.group_star4,{loop:!0}).to({rotation:360},2e3),egret.Tween.get(this.img_long,{loop:!0}).to({rotation:360},300),egret.Tween.get(this.img_short,{loop:!0}).to({rotation:360},800)},e.prototype.show=function(t){switch(this.visible=!1,this.group_start.visible=!1,this.group_stop.visible=!1,t){case"start":this.visible=!0,this.group_start.visible=!0;break;case"stop":this.visible=!0,this.group_stop.visible=!0}},e}(t.Component);e.BetHint=i,__reflect(i.prototype,"ui.dragontiger.BetHint")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onChange=function(t){e.road_big.visible=!e.btn_all.selected,e.road_all.visible=e.btn_all.selected},e}return __extends(e,t),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this.btn_people.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.dispatchEventWith(e.EVT_TOGGLE_PEOPLE)},this),this.btn_desk.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return i.dispatchEventWith(e.EVT_OPEN_DESK)},this),this.btn_all.group.addEventListener(egret.Event.CHANGE,this.onChange,this),this.btn_dragonPeek.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){for(var t=0;5>t;t++){var e=i.road_all.getChildAt(t);e.peekRoad("banker")}i.road_big.peekRoad("banker")},this),this.btn_tigerPeek.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){for(var t=0;5>t;t++){var e=i.road_all.getChildAt(t);e.peekRoad("tiger")}i.road_big.peekRoad("tiger")},this)},e.prototype.initRoad=function(){this.btn_all.selected=!0,this.btn_big.selected=!1,this.road_all.visible=!0,this.road_big.visible=!1},e.prototype.setChips=function(t){this.com_chipList.setChips(t)},e.prototype.setHead=function(t){this.com_head.setHead(t)},e.prototype.setName=function(t){this.com_head.setName(t)},e.prototype.setBalance=function(t){this.com_head.setBalance(t)},e.prototype.setSurplus=function(t){t>0?this.com_head.showSurplus(!0,t):this.com_head.showSurplus(!1)},e.prototype.updatePeople=function(t){this.btn_people.label=t.toString()},e.prototype.getOwnPos=function(){var t=this.com_head.localToGlobal();return{x:t.x+64,y:t.y+64}},e.prototype.getOtherPos=function(){var t=this.btn_people.localToGlobal();return{x:t.x+this.btn_people.width/2,y:t.y+this.btn_people.height/2}},e.prototype.showSurplus=function(t,e){this.com_head.showSurplus(t,e)},e.prototype.getCurChipValue=function(){return this.com_chipList.cur_chosen_item.value},e.prototype.showWin=function(t){this.com_head.showWin(t)},e.prototype.setRoadMap=function(t){this.road_map=t},e.prototype.updateEnable=function(t){this.com_chipList.updateEnable(t)},e.prototype.betAni=function(t){if(t){var e=this.currentState===egret.OrientationMode.LANDSCAPE?0:-95;this.com_head.verticalCenter=e,egret.Tween.get(this.com_head).to({verticalCenter:e-15},80,egret.Ease.quadOut).to({verticalCenter:e},80,egret.Ease.quadIn)}else{var e=26;this.btn_people.bottom=e,egret.Tween.get(this.btn_people).to({bottom:e+15},80,egret.Ease.quadOut).to({bottom:e},80,egret.Ease.quadIn)}},e.EVT_TOGGLE_PEOPLE="evt_open_people",e.EVT_OPEN_DESK="evt_open_desk",e}(t.Component);e.BottomPanel=i,__reflect(i.prototype,"ui.dragontiger.BottomPanel")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(t,e){var i=this;void 0===e&&(e=!1),this.clearTimer(),util.SoundUtil.destroy(["end_bet_mp3"]);var n=t-util.TimeUtil.now;n>0?this.timer=util.TimeUtil.setInterval(function(){var n=t-util.TimeUtil.now;if(n>=0){var o=i.lab_count.text!==Math.round(n/1e3).toString();i.lab_count.text=Math.round(n/1e3).toString(),(3===Math.round(n/1e3)||2===Math.round(n/1e3)||1===Math.round(n/1e3))&&e&&o&&util.SoundUtil.play("longhu_end_bet_mp3")}else i.lab_count.text="0",i.clearTimer()},100):(this.lab_count.text="0",this.clearTimer())},e.prototype.clearTimer=function(){null!=this.timer&&(util.TimeUtil.clearInterval(this.timer),this.timer=null)},e}(t.Component);e.CountDown=i,__reflect(i.prototype,"ui.dragontiger.CountDown")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._line_px=1,e.peekRoad=function(t){return e.roadMap.showPeekResult(t)},e}return __extends(e,t),Object.defineProperty(e.prototype,"road_datas",{get:function(){return this._road_datas},set:function(t){this._road_datas=t,t&&this.check()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon_size",{get:function(){return this._icon_size},set:function(t){this._icon_size=Number(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"total_rows",{get:function(){return this._total_rows},set:function(t){this._total_rows=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size=Number(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"line_color",{get:function(){return this._line_color},set:function(t){this._line_color=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"line_px",{get:function(){return this._line_px},set:function(t){this._line_px=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_hide_bg",{get:function(){return this._is_hide_bg},set:function(t){this._is_hide_bg=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_need_space",{get:function(){return this._is_need_space},set:function(t){this._is_need_space=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max_column",{get:function(){return this._max_column},set:function(t){this._max_column=Number(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min_column",{get:function(){return this._min_column},set:function(t){this._min_column=t},enumerable:!0,configurable:!0}),e.prototype.check=function(){var t=0;this.road_datas.forEach(function(e){return t<e.col&&(t=e.col)}),t>=this.min_column?(this.roadMap.left=0/0,this.roadMap.right=0):(this.roadMap.right=0/0,this.roadMap.left=0)},e}(eui.Component);t.DTRoadMap=e,__reflect(e.prototype,"ui.dragontiger.DTRoadMap")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player_count=0,e.lunghu_player_count="",e}return __extends(e,t),e}(topic.RoomItemData);e.DeskItemData=i,__reflect(i.prototype,"ui.dragontiger.DeskItemData");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.data.room_id)},this)},e}(t.ItemRenderer);e.DeskListItem=n,__reflect(n.prototype,"ui.dragontiger.DeskListItem")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.AccountTopic=e,__reflect(e.prototype,"topic.AccountTopic"),function(t){t.schema={type:"object",properties:{snapshot:{type:"object",properties:{balance:{decimal:!0},lock:{type:"object",properties:{room_type:{type:"string"},room_id:{type:"string"},lock_by:{type:"string"}},required:["room_type","room_id","lock_by"]}},required:["balance"]}},required:["snapshot"]}}(e=t.AccountTopic||(t.AccountTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play=function(t){var e=this;this.visible=!0;var i=this.rect_blueStartPos.horizontalCenter/6,n=this.rect_tigerStartPos.horizontalCenter/6;this.lab_round.text=t.toString(),this.img_red.horizontalCenter=this.rect_redStartPos.horizontalCenter,this.img_blue.horizontalCenter=this.rect_blueStartPos.horizontalCenter,this.img_dragon.horizontalCenter=this.rect_dragonStartPos.horizontalCenter,this.img_tiger.horizontalCenter=this.rect_tigerStartPos.horizontalCenter,egret.Tween.get(this.img_red).to({horizontalCenter:this.rect_redPos.horizontalCenter},i),egret.Tween.get(this.img_blue).to({horizontalCenter:this.rect_bluePos.horizontalCenter},i),egret.Tween.get(this.img_dragon).wait(i/2).to({horizontalCenter:this.rect_dragonPos.horizontalCenter},n),egret.Tween.get(this.img_tiger).wait(i/2).to({horizontalCenter:this.rect_tigerPos.horizontalCenter},n).wait(800).call(function(){e.stop()})},e.prototype.stop=function(){this.visible=!1,egret.Tween.removeTweens(this.img_red),egret.Tween.removeTweens(this.img_blue),egret.Tween.removeTweens(this.img_dragon),egret.Tween.removeTweens(this.img_tiger)},e}(t.Component);e.OpenRound=i,__reflect(i.prototype,"ui.dragontiger.OpenRound")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this.username=t},e.prototype.setBalance=function(t){this.balance=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.avatar=t},e.prototype.showSurplus=function(t,e){this.lab_surplus.text="0",t&&(e>0?(this.lab_surplus.font="public_win_fnt",this.lab_sign.font="public_win_fnt",this.lab_sign.text="+",util.NumberUtil.tweenNumber(this.lab_surplus,e,1e3)):(this.lab_surplus.font="public_lose_fnt",this.lab_sign.font="public_lose_fnt",this.lab_sign.text="-",util.NumberUtil.tweenNumber(this.lab_surplus,Math.abs(e),1e3))),this.lab_sign.visible=t,this.lab_surplus.visible=t},e.prototype.showWin=function(t){this.mc_win.visible=t},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.dragontiger.PlayerFrame")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bottomArr=[0,-100],e.hide=function(t){return e.bottomArr[0]&&!e.contains(t.target)&&e.toggle()},e.toggle=function(t){void 0===t&&(t=300),egret.Tween.removeTweens(e),e.bottomArr.reverse(),egret.Tween.get(e).set({visible:!0,percentBottom:e.bottomArr[0]}).to({visible:!!e.bottomArr[0],percentBottom:e.bottomArr[1]},t,e.bottomArr[0]?egret.Ease.backOut:egret.Ease.backIn),e.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.hide,e),e.bottomArr[0]&&egret.callLater(function(){return e.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,e.hide,e)},e)},e.updateCount=function(t){return e.count=util.LanguageUtil.translate("lbl_game_players",""+t)},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.percentBottom=-100,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.hide,e)},this)},e}(t.PlayerArea);t.PlayerList=e,__reflect(e.prototype,"ui.dragontiger.PlayerList")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(t,i){util.LogUtil.warn("[init] count:"+t+", opened:"+i),null==i&&e.immed(),e.tiger.visible=e.discard.visible=e.dragon.visible=!1,e.tiger.currentState=e.dragon.currentState="back",null!=t&&(e.count=t),e.dealt=0,e.opened=!!i,util.TimeUtil.clearTimeout(e.timeout)},e._deal=function(t,i,n,o){var r=i.localToGlobal(),s=e.globalToLocal(r.x,r.y),a=n.localToGlobal(),l=e.globalToLocal(a.x,a.y);return egret.Tween.removeTweens(t),o?(util.SoundUtil.play("longhu_cards_dealing_mp3"),egret.Tween.get(t).set({visible:!0,alpha:i.alpha,x:s.x,y:s.y,size:i.size,scaleX:i.scaleX,rotation:i.rotation}).to({alpha:n.alpha,x:l.x,y:l.y,size:n.size,scaleX:n.scaleX,rotation:n.rotation},o)):(t.visible=!0,t.alpha=n.alpha,t.x=l.x,t.y=l.y,t.size=n.size,t.scaleX=n.scaleX,t.rotation=n.rotation,void 0)},e.deal=function(t,i){return void 0===i&&(i=300),!e.dealt&&util.LogUtil.warn("[deal] count:"+t+", duration:"+i),e.init(t,e.opened),i?new Promise(function(t){e.count--,e.dealt++,e._deal(e.discard,e.start,e.discardMidway,i).wait(i).call(function(){e._deal(e.discard,e.discardMidway,e.discardEnd,i).call(function(){e.count--,e.dealt++,e._deal(e.dragon,e.start,e.dragonEnd,i),e.timeout=util.TimeUtil.setTimeout(function(){e.count--,e.dealt++,e._deal(e.tiger,e.start,e.tigerEnd,i).call(t)},.5*i)})})}):(e.count-=3,e.dealt+=3,e._deal(e.discard,e.start,e.discardEnd,i),e._deal(e.dragon,e.start,e.dragonEnd,i),e._deal(e.tiger,e.start,e.tigerEnd,i),void 0)},e.open=function(t,i){return void 0===i&&(i=300),__awaiter(e,void 0,void 0,function(){var e=this;return __generator(this,function(n){switch(n.label){case 0:return t&&util.LogUtil.warn("[open] dragon_index:"+t.dragon_index+", tiger_index:"+t.tiger_index+", duration:"+i),this.opened=!0,t&&(this.dragon.num=t.dragon_index,this.tiger.num=t.tiger_index),i?(util.SoundUtil.play("longhu_cards_dealing_mp3"),[4,this.dragon.turnCard(i)]):[3,4];case 1:return n.sent(),util.SoundUtil.play("longhu_n0"+t.dragon_card_number+"_mp3"),util.SoundUtil.play("longhu_cards_dealing_mp3"),[4,this.tiger.turnCard(i)];case 2:return n.sent(),[4,new Promise(function(i){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,util.SoundUtil.play("longhu_n0"+t.tiger_card_number+"_mp3")];case 1:return[2,e.sent().once(egret.Event.SOUND_COMPLETE,i)]}})})})];case 3:return n.sent(),[3,5];case 4:this.dragon.turnCard(i),this.tiger.turnCard(i),n.label=5;case 5:return[2]}})})},e.immed=function(){e.dealt&&(e.deal(e.count+e.dealt,0),e.opened&&e.open(null,0))},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.RESIZE,function(){return egret.callLater(e.immed,e)},this)},e}(t.Component);e.PokerArea=i,__reflect(i.prototype,"ui.dragontiger.PokerArea")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img_dragonVP=-91.5,e.img_dragonVL=0,e.img_tigerVP=-94.5,e.img_tigerVL=0,e.img_dragonLabVP=101.5,e.img_dragonLabVL=197,e.img_tigerLabVP=97.5,e.img_tigerLabVL=197,e}return __extends(e,t),e.prototype.show=function(t){var e=this;egret.Tween.removeTweens(this.img_dragon),egret.Tween.removeTweens(this.img_dragonLab),egret.Tween.removeTweens(this.img_tieLab),egret.Tween.removeTweens(this.img_tiger),egret.Tween.removeTweens(this.img_tigerLab),this.group_dragon.visible=!1,this.group_tiger.visible=!1,this.group_tie.visible=!1;var i=300;switch(t){case"dragon":this.group_dragon.visible=!0,i=300;var n=this.currentState===egret.OrientationMode.LANDSCAPE?this.img_dragonVL:this.img_dragonVL,o=this.currentState===egret.OrientationMode.LANDSCAPE?this.img_dragonLabVL:this.img_dragonLabVP;this.img_dragon.verticalCenter=n-1e3,this.img_dragonLab.verticalCenter=o-1e3,this.mc_dragon.currentFrame=0,this.mc_dragon.playTimes=1,this.mc_dragon.isPlaying=!0,egret.Tween.get(this.img_dragon).wait(300).to({verticalCenter:n},i,egret.Ease.quadIn),egret.Tween.get(this.img_dragonLab).wait(i/2+500).to({verticalCenter:o},i,egret.Ease.quadIn).wait(2e3).call(function(){e.group_dragon.visible=!1});break;case"tie":i=300,this.group_tie.visible=!0,this.mc_tie.currentFrame=0,this.mc_tie.playTimes=1,this.mc_tie.isPlaying=!0,this.img_tieLab.scaleX=0,this.img_tieLab.scaleY=0,egret.Tween.get(this.img_tieLab).wait(300).to({scaleX:1,scaleY:1},i,egret.Ease.backOut).wait(500).call(function(){e.group_tie.visible=!1});break;case"tiger":this.group_tiger.visible=!0,i=300;var r=this.currentState===egret.OrientationMode.LANDSCAPE?this.img_tigerVL:this.img_tigerVP,s=this.currentState===egret.OrientationMode.LANDSCAPE?this.img_tigerLabVL:this.img_tigerLabVP;this.img_tiger.verticalCenter=r-1500,this.img_tigerLab.verticalCenter=s-1500,this.mc_tiger.currentFrame=0,this.mc_tiger.playTimes=1,this.mc_tiger.isPlaying=!0,egret.Tween.get(this.img_tiger).wait(300).to({verticalCenter:r},i,egret.Ease.quadIn),egret.Tween.get(this.img_tigerLab).wait(i/2+500).to({verticalCenter:s},i,egret.Ease.quadIn).wait(2e3).call(function(){e.group_tiger.visible=!1})}},e}(t.Component);e.Result=i,__reflect(i.prototype,"ui.dragontiger.Result")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.OnlineTopic=e,__reflect(e.prototype,"topic.OnlineTopic"),function(t){t.schema={type:"object",properties:{snapshot:{type:"object",properties:{base_count:{type:"object",additionalProperties:{type:"number"}},base_room_count:{type:"object",additionalProperties:{type:"number"}},game_count:{type:"object",additionalProperties:{type:"number"}},room_count:{type:"object",additionalProperties:{type:"number"}}},required:["base_count","base_room_count","game_count","room_count"]}},required:["snapshot"]},t.snp_schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{base_count:{additionalProperties:{type:"number"},type:"object"},base_room_count:{additionalProperties:{type:"number"},type:"object"},game_count:{additionalProperties:{type:"number"},type:"object"},room_count:{additionalProperties:{type:"number"},type:"object"}},required:["base_count","base_room_count","game_count","room_count"],type:"object"}}(e=t.OnlineTopic||(t.OnlineTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.show=function(t){egret.Tween.removeTweens(this),this.alpha=0,this.lab_tip.text=t,egret.Tween.get(this).to({alpha:1},500).wait(1e3).to({alpha:0},500)},e}(t.Component);e.Tip=i,__reflect(i.prototype,"ui.dragontiger.Tip")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataProvider=new eui.ArrayCollection,e.show=function(){Main.instance.addChild(e,!0),e.dataProvider.refresh(),util.TimeUtil.setTimeout(function(){return e.stage.dispatchEventWith(Main.EVT_RE_SHOT)},300)},e.update=function(t){return e.dataProvider.replaceAll(t)},e.itemUpdated=function(t){return e.dataProvider.itemUpdated(t)},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100},e}(t.DialogBase);e.ChangeDeskDialog=i,__reflect(i.prototype,"ui.dragontiger.dialog.ChangeDeskDialog"),function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.enter.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CHANGE_DESK,e.data.room_id)},this)},e}(t.ItemRenderer);e.ChangeDeskItem=i,__reflect(i.prototype,"ui.dragontiger.dialog.ChangeDeskDialog.ChangeDeskItem")}(i=e.ChangeDeskDialog||(e.ChangeDeskDialog={}))}(i=e.dialog||(e.dialog={}))}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.PoolTopic=e,__reflect(e.prototype,"topic.PoolTopic"),function(t){t.schema={type:"object",properties:{snapshot:{type:"object",properties:{money:{type:"number"},last_winner:{type:"object",properties:{user_id:{type:"string"},username:{type:"string"},payout:{type:"number"}},required:["user_id","username","payout"]}},required:["money"]}},required:["snapshot"]}}(e=t.PoolTopic||(t.PoolTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.lb_ctx=new t.control.Label,i._point=-1,i.is_show_point=!1,i}return __extends(i,e),Object.defineProperty(i.prototype,"point",{get:function(){return this._point},set:function(t){this._point=t,this.updateLb()},enumerable:!0,configurable:!0}),i.prototype.bindParseMap=function(){this.parse_data_map=i.PARSE_BEAD_ICON_MAP},i.prototype.updateSize=function(t){e.prototype.updateSize.call(this,t),this.lb_ctx.size=.6*t},i.prototype.reSetSize=function(t){e.prototype.reSetSize.call(this,t),this.lb_ctx.size=.6*t},i.prototype.createLb=function(){this.lb_ctx.size=15,this.lb_ctx.textColor=16777215,this.lb_ctx.verticalCenter=0,this.lb_ctx.horizontalCenter=0,this.addChild(this.lb_ctx)},i.prototype.hide=function(){e.prototype.hide.call(this),this.lb_ctx.visible&&(this.lb_ctx.visible=!1)},i.prototype.setLbText=function(t){this.text_letter=t,this.updateLb()},i.prototype.updateLb=function(){this.lb_ctx&&(this.lb_ctx.text=this.is_show_point&&this.point>=0?""+this.point:this.text_letter,!this.lb_ctx.visible&&(this.lb_ctx.visible=!0))},i.prototype.createBg=function(){e.prototype.createBg.call(this),this.createLb(),this.img_bg_red.source="roadmap_dragon_png",this.img_bg_blue.source="roadmap_tiger_png",this.img_bg_green.source="roadmap_tie_png"},i}(e.BBResultMarkBase);e.BeadResultMark=i,__reflect(i.prototype,"ui.dragontiger.BeadResultMark")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.bindParseMap=function(){this.parse_data_map=e.PARSE_BIG_ICON_MAP},e.prototype.createBg=function(){t.prototype.createBg.call(this),this.img_bg_red.source="big_dragon_png",this.img_bg_blue.source="big_tiger_png",this.img_bg_green.source="big_tie_png"},e}(t.BBResultMarkBase);t.BigResultMark=e,__reflect(e.prototype,"ui.dragontiger.BigResultMark")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createBg=function(){t.prototype.createBg.call(this),this.img_bg_red.source="small_dragon2_png",this.img_bg_blue.source="small_tiger2_png"},e}(t.ResultMarkBase);t.CockroachResultMark=e,__reflect(e.prototype,"ui.dragontiger.CockroachResultMark")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;
!function(t){var e=function(){function t(t,e){this.line=new egret.Shape,this.line_width=e?e:1,this.line.graphics.lineStyle(this.line_width,t?t:7631988)}return Object.defineProperty(t.prototype,"line_width",{get:function(){return this._line_width},set:function(t){this._line_width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gap_of_line",{get:function(){return this._gap_of_line},set:function(t){this._gap_of_line=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},set:function(t){this._rows=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cols",{get:function(){return this._cols},set:function(t){this._cols=t},enumerable:!0,configurable:!0}),t.prototype.drawGrids=function(t,e,i,n,o){this.rows=t,this.cols=e,this.gap_of_line=i,this.line.parent&&this.line.parent.removeChild(this.line),void 0===o?n.addChild(this.line):n.addChildAt(this.line,o),this.beginDrawLines()},t.prototype.beginDrawLines=function(){for(var t=this.rows*(this.gap_of_line+this.line_width)+this.line_width,e=this.cols*(this.gap_of_line+this.line_width)+this.line_width,i=0;i<=this.cols;i++){var n=i*(this.gap_of_line+this.line_width)+(i>0?this.line_width:0);this.drawOneLine(new egret.Point(n,0),new egret.Point(n,t))}for(var i=0;i<=this.rows;i++){var o=i*(this.gap_of_line+this.line_width)+(i>0?this.line_width:0);this.drawOneLine(new egret.Point(0,o),new egret.Point(e,o))}},t.prototype.drawOneLine=function(t,e){this.line.graphics.moveTo(t.x,t.y),this.line.graphics.lineTo(e.x,e.y)},t}();t.DrawGridTool=e,__reflect(e.prototype,"ui.dragontiger.DrawGridTool")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createBg=function(){t.prototype.createBg.call(this),this.img_bg_red.source="roadmap_dragon_png",this.img_bg_blue.source="roadmap_tiger_png"},e}(t.ResultMarkBase);t.EyeResultMark=e,__reflect(e.prototype,"ui.dragontiger.EyeResultMark")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(){function e(){this.initParseMap()}return e.prototype.initParseMap=function(){this.initBeadParseMap(),this.initBigParseMap(),this.initThreeParseMap()},e.prototype.initBeadParseMap=function(){t.BeadResultMark.PARSE_BEAD_ICON_MAP=new Map,t.BeadResultMark.PARSE_BEAD_ICON_MAP.set("red",function(t){t.setLbText("lbl_game_dragon"),t.setBg("red")}),t.BeadResultMark.PARSE_BEAD_ICON_MAP.set("blue",function(t){t.setLbText("lbl_game_tiger"),t.setBg("blue")}),t.BeadResultMark.PARSE_BEAD_ICON_MAP.set("green",function(t){t.setLbText("lbl_game_tie"),t.setBg("green")})},e.prototype.initBigParseMap=function(){t.BigResultMark.PARSE_BIG_ICON_MAP=new Map,t.BigResultMark.PARSE_BIG_ICON_MAP.set("red",function(t){return t.setBg("red")}),t.BigResultMark.PARSE_BIG_ICON_MAP.set("blue",function(t){return t.setBg("blue")}),t.BigResultMark.PARSE_BIG_ICON_MAP.set("slash",function(t){return t.setBg("green")})},e.prototype.initThreeParseMap=function(){t.ResultMarkBase.PARSE_THREE_ICON_MAP=new Map,t.ResultMarkBase.PARSE_THREE_ICON_MAP.set("red",function(t){return t.setBg("red")}),t.ResultMarkBase.PARSE_THREE_ICON_MAP.set("blue",function(t){return t.setBg("blue")})},e}();t.ParseRoadMapData=e,__reflect(e.prototype,"ui.dragontiger.ParseRoadMapData")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.RoomsTopic=e,__reflect(e.prototype,"topic.RoomsTopic"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{last_op_room:{properties:{channel_id:{type:"number"},room_id:{type:"string"},visible:{type:"boolean"}},required:["channel_id","room_id","visible"],type:"object"},rooms:{additionalProperties:{properties:{bet_limit:{anyOf:[{properties:{admittance:{type:"number"},ante:{type:"number"}},required:["admittance","ante"],type:"object"},{properties:{chips:{items:{type:"number"},type:"array"},multiples:{type:"number"}},required:["chips"],type:"object"}]},room_id:{type:"string"},visible:{type:"boolean"}},"if":{properties:{visible:{"const":"true"}}},then:{required:["bet_limit","room_id","visible"]},"else":{required:["room_id","visible"]},type:"object"},type:"object"}},required:["rooms"],type:"object"}},required:["snapshot"],type:"object"}}(e=t.RoomsTopic||(t.RoomsTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(t){var e;!function(t){t[t.bead_road=0]="bead_road",t[t.big_road=1]="big_road",t[t.big_eye_road=2]="big_eye_road",t[t.small_road=3]="small_road",t[t.cockroach_road=4]="cockroach_road"}(e=t.roadType||(t.roadType={}));var i=function(i){function n(t,e,n,o,r,s){void 0===s&&(s=!1);var a=i.call(this)||this;return a.old_data={},a.is_init=!1,a._line_px=1,a._is_need_space=!0,a.keys_of_map_marks=[],a._is_good_road=!1,a.can_show_peek=!1,a.can_show_point=!1,a.is_show_point=!1,a.is_need_shot=!0,a.peek_banker_mark={mark:void 0,point:"",icon:[]},a.peek_player_mark={mark:void 0,point:"",icon:[]},a.reShot=function(){a.is_need_shot&&(a.prepareShot(),a.screenShot())},a.prepareShot=function(){a.time_out_id&&clearTimeout(a.time_out_id),a.addChildAt(a.gp_road,a.gp_road_index),a.gp_road.visible=!0,a.img_road.visible=!1},void 0!==t&&(a.type=t),void 0!==e&&(a.size=e),void 0!==n&&(a.icon_size=n),void 0!==o&&(a.total_column=o),void 0!==r&&(a.total_rows=r),void 0!==s&&(a.is_hide_bg=s),a}return __extends(n,i),Object.defineProperty(n.prototype,"is_need_space",{get:function(){return this._is_need_space},set:function(t){this._is_need_space=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"is_good_road",{get:function(){return this._is_good_road},set:function(t){this._is_good_road=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"road_datas",{get:function(){return this._road_datas},set:function(t){t&&(this._road_datas=t,this.createImg(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"is_hide_bg",{get:function(){return this._is_hide_bg},set:function(t){this._is_hide_bg=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"icon_size",{get:function(){return this._icon_size},set:function(t){if(t=Number(t)){var e=this.icon_size;this._icon_size=t,this.checkInit(),this.is_init&&e!==this.icon_size&&this.reSetIconSize()}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"total_rows",{get:function(){return this._total_rows},set:function(t){this._total_rows=t,this.checkInit()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"total_column",{get:function(){return this._total_column},set:function(t){this._total_column=Number(t),this.checkInit()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this._size},set:function(t){if(t=Number(t)){var e=this.size;this._size=t,this.checkInit(),this.is_init&&e!==this.size&&this.reSetBg()}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"line_color",{get:function(){return this._line_color},set:function(t){t&&(this._line_color=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"line_px",{get:function(){return this._line_px},set:function(t){t&&(this._line_px=Number(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this._type},set:function(t){this._type=Number(t),this.mark_cls=this.checkByRoadType(),this.checkInit()},enumerable:!0,configurable:!0}),n.prototype.checkInit=function(){!this.is_init&&this.type>=0&&this.total_column&&this.total_rows&&this.icon_size&&this.size&&this.init()},n.prototype.init=function(){var e=this;this.touchEnabled=!1,this.touchChildren=!1,this.is_init=!0,this.gp_road=new eui.Group,this.gp_road.verticalCenter=this.gp_road.horizontalCenter=0,this.addChild(this.gp_road);var i=new t.DrawGridTool(this.line_color,this.line_px);this.createBg(this.is_hide_bg),i.drawGrids(this.total_rows,this.total_column,this.size,this.gp_road),this.gp_marks=new eui.Group,this.setGroupWH(this.gp_marks),this.gp_road.addChild(this.gp_marks),this.map_marks=new Map,this.img_road=new egret.Bitmap,this.img_road.visible=!1,this.addChild(this.img_road),this.gp_peek=new eui.Group,this.setGroupWH(this.gp_peek),this.addChild(this.gp_peek),this.gp_road_index=this.getChildIndex(this.gp_road),this.stage?this.stage.addEventListener(Main.EVT_RE_SHOT,this.reShot,this):this.once(egret.Event.ADDED_TO_STAGE,function(){return e.stage.addEventListener(Main.EVT_RE_SHOT,e.reShot,e)},this)},n.prototype.createBg=function(t){if(this.width=(this.size+this.line_px)*this.total_column+this.line_px,this.height=(this.size+this.line_px)*this.total_rows+this.line_px,"boolean"==typeof t){if(t)return}else if("true"===t)return;this.bg_rect=new eui.Rect,this.bg_rect.percentWidth=this.bg_rect.percentHeight=100,this.bg_rect.fillColor=16777215,this.gp_road.addChild(this.bg_rect)},n.prototype.setGroupWH=function(t){t.width=this.width,t.height=this.height},n.prototype.setData=function(t){var i=this;this.can_show_peek=!1,[this.peek_player_mark.mark,this.peek_banker_mark.mark].forEach(function(t){return t&&t.hide()}),this.gp_marks.$children.forEach(function(t){t.hide(),!t.visible&&(t.visible=!0)});var n=this.calOffsetCol(t);t.forEach(function(t){var o=t.row,r=t.col-n,s=o+","+r,a=t.round_id,l=i.map_marks.get(s),u=t.icon;if(r>=0)if("banker"===a||"player"===a){i.can_show_peek=!0;var h="banker"===a?i.peek_banker_mark:i.peek_player_mark;h.mark||(h.mark=i.createMark(),i.gp_peek.addChild(h.mark)),h.point=s,h.icon=u,i.setMarkPosition(h.mark,r,o),h.mark.visible=!1,h.mark.setResult(u,i.icon_size,i.type)}else l||(l=i.createMark(),i.setMarkPosition(l,r,o),i.gp_marks.addChild(l),i.map_marks.set(s,l),i.keys_of_map_marks.indexOf(s)<0&&i.keys_of_map_marks.push(s),i.type===e.bead_road&&(l.is_show_point=i.is_show_point)),i.type===e.bead_road&&(l.point=Number(t.number)),l.setResult(u,i.icon_size,i.type)})},n.prototype.showPeekResult=function(t){var e=this;if(this.can_show_peek){var i="banker"===t?this.peek_banker_mark:this.peek_player_mark,n=i.mark;if(this.hidePeekMark(),n){n.alpha=0,egret.Tween.removeTweens(n);var o=egret.Tween.get(n);n.visible=!0,Array.apply(void 0,Array(4)).forEach(function(t,i){return e.alphaAni(o,i)})}}},n.prototype.alphaAni=function(t,i){var o=this;t.to({alpha:1},300).to({alpha:0},300).call(function(){return 3===i&&o.type===e.bead_road&&o.dispatchEventWith(n.EVT_RE_SHOT)})},n.prototype.hidePeekMark=function(){[this.peek_banker_mark,this.peek_player_mark].forEach(function(t){return t.mark&&t.mark.visible&&(t.mark.visible=!1)})},n.prototype.calOffsetCol=function(t){var i,n=this,o=0,r=this.type>e.big_road?2:1,s=(this.is_need_space&&this.type>e.bead_road?1:0)*r,a=this.total_column*r-s;return t.forEach(function(t){(n.type===e.bead_road||"banker"!==t.round_id&&"player"!==t.round_id)&&o<t.col&&(o=t.col)}),i=o+1>a?o-a+1:0},n.prototype.createMark=function(){var t=this.mark_cls,e=new t(this.is_good_road);return e},n.prototype.setMarkPosition=function(t,i,n){var o=this;if(this.type<=e.big_road){var r=this.line_px+((this.size-this.icon_size)/2<<0),s=this.size-this.icon_size+this.line_px;t.x=r+i*(s+this.icon_size),t.y=r+n*(s+this.icon_size),t.x+=0===i?0:1,t.y+=0===n?0:1}else{var r=this.line_px,a=this.size-this.icon_size,l=function(t){return(t/2<<0)*(o.size+o.line_px)};t.x=r+i===0?0:l(i)+(i%2===0?0:a),t.y=r+n===0?0:l(n)+(n%2===0?0:a),t.x+=2*this.line_px,t.y+=this.line_px}},n.prototype.showHidePoint=function(t){return __awaiter(this,void 0,void 0,function(){var i,o=this;return __generator(this,function(r){switch(r.label){case 0:return this.can_show_point&&this.type===e.bead_road?(this.is_show_point=t,i=function(){return o.keys_of_map_marks.forEach(function(e){var i=o.map_marks.get(e);i.is_show_point=t,i.updateLb()})},[4,this.createImg(null,!0,i)]):[3,2];case 1:r.sent(),this.dispatchEventWith(n.EVT_RE_SHOT),r.label=2;case 2:return[2]}})})},n.prototype.setBeadRoadCanShowPoint=function(){this.can_show_point=!0},n.prototype.createImg=function(t,e,i){var o=this;return void 0===e&&(e=!1),void 0===i&&(i=function(t){return o.setData(t)}),__awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:return!e&&util.ObjectUtil.isEqual(this.old_data,t)?(this.dispatchEventWith(n.EVT_SHOW_FINISH),[2]):(this.old_data=t,this.is_need_shot?(this.prepareShot(),i(t),[4,this.screenShot()]):[3,2]);case 1:return o.sent(),[3,3];case 2:this.img_road.visible&&(this.img_road.visible=!1),i(t),this.dispatchEventWith(n.EVT_SHOW_FINISH),o.label=3;case 3:return[2]}})})},n.prototype.screenShot=function(){var t=this;return new Promise(function(e){t.time_out_id=setTimeout(function(){var i=new egret.RenderTexture;i.drawToTexture(t.gp_road),i.getPixels(0,0),t.img_road.texture=i,t.img_road.visible=!0,t.gp_road.visible=!1,t.gp_road.parent&&t.removeChild(t.gp_road),t.dispatchEventWith(n.EVT_SHOW_FINISH),e()},1e3)})},n.prototype.checkByRoadType=function(){switch(this.type){case e.bead_road:return t.BeadResultMark;case e.big_road:return t.BigResultMark;case e.big_eye_road:return t.EyeResultMark;case e.small_road:return t.SmallResultMark;case e.cockroach_road:return t.CockroachResultMark}},n.exchangeRoadTypeFromStr=function(t){switch(t){case"bead_road":return e.bead_road;case"big_road":return e.big_road;case"big_eye_road":return e.big_eye_road;case"small_road":return e.small_road;case"cockroach_road":return e.cockroach_road}},n.prototype.reSetIconSize=function(){var t=this;this.map_marks.forEach(function(e,i){var n=i.split(",");e.reSetSize(t.icon_size),t.setMarkPosition(e,Number(n[1]),Number(n[0]))}),[this.peek_banker_mark,this.peek_player_mark].forEach(function(e){var i=e.point.split(",");e.mark.reSetSize(t.icon_size),t.setMarkPosition(e.mark,Number(i[1]),Number(i[0]))}),this.reShot()},n.prototype.reSetBg=function(){this.createBg(!0),this.setGroupWH(this.gp_marks),this.setGroupWH(this.gp_peek);var e,i=0;if(this.gp_road.$children.forEach(function(t,n){t instanceof egret.Shape&&(e=t,i=n)}),e){this.gp_road.removeChild(e);var n=new t.DrawGridTool(this.line_color,this.line_px);n.drawGrids(this.total_rows,this.total_column,this.size,this.gp_road,i),this.gp_road_index=this.getChildIndex(this.gp_road)}this.reShot()},n.convertData=function(t){var e=util.ObjectUtil.copy(t),i=e.banker_peek,n=e.player_peek;return Object.keys(i).forEach(function(t){i[t].round_id="banker",e[t].push(i[t])}),Object.keys(n).forEach(function(t){n[t].round_id="player",e[t].push(n[t])}),e},n.EVT_SHOW_FINISH="evt_show_finish",n.EVT_RE_SHOT="evt_re_shot",n}(eui.Component);t.RoadMap=i,__reflect(i.prototype,"ui.dragontiger.RoadMap")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createBg=function(){t.prototype.createBg.call(this),this.img_bg_red.source="small_dragon_png",this.img_bg_blue.source="small_tiger_png"},e}(t.ResultMarkBase);t.SmallResultMark=e,__reflect(e.prototype,"ui.dragontiger.SmallResultMark")}(e=t.dragontiger||(t.dragontiger={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._allBtn=[],e.ALL_TYPE=["one_two_four","one_three_four","two_three_four","one_two_three","one_two","two_three","three_four","four_one","one","two","three","four","single","double"],e._clickEffAll=[],e._winEffAll=[],e}return __extends(e,t),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this._allBtn=[this.fantanthree1,this.fantanthree2,this.fantanthree3,this.fantanthree4,this.fantantwo1,this.fantantwo2,this.fantantwo3,this.fantantwo4,this.fantanone1,this.fantanone2,this.fantanone3,this.fantanone4,this.fantanSingle,this.fantanDouble],this._winEffAll=[this.fantanthree1Line,this.fantanthree2Line,this.fantanthree3Line,this.fantanthree4Line,this.fantantwo1Line,this.fantantwo2Line,this.fantantwo3Line,this.fantantwo4Line,this.fantanone1Line,this.fantanone2Line,this.fantanone3Line,this.fantanone4Line,this.fantanSingleLine,this.fantanDoubleLine],this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i._allBtn[0].touchEnabled||i.dispatchEventWith(e.EVT_SHOW_TIP)},this),this.ALL_TYPE.forEach(function(t,e){i._allBtn[e].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.onBet(t)},i),i._allBtn[e].addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){i._winEffAll[e].alpha=.55,i._winEffAll[e].visible=!0},i),i._allBtn[e].addEventListener(egret.TouchEvent.TOUCH_END,function(){i._winEffAll[e].alpha=.55,i._winEffAll[e].visible=!1},i),mouse.setButtonMode(i._allBtn[e],!0)}),this.init()},e.prototype.init=function(){var t=this;this.ALL_TYPE.forEach(function(e,i){egret.Tween.removeTweens(t._winEffAll[i]),t._winEffAll[i].visible=!1})},e.prototype.showResult=function(t){var e=this;this.init(),t.forEach(function(t,i){e._winEffAll[t].alpha=1,egret.Tween.get(e._winEffAll[t],{loop:!0}).set({visible:!0}).wait(400).set({visible:!1}).wait(400)})},e.prototype.onBet=function(t){this.dispatchEventWith(e.EVT_BET,!1,t)},e.prototype.setEnable=function(t){var e=this;this.ALL_TYPE.forEach(function(i,n){e._allBtn[n].touchEnabled=t})},e.prototype.resetInterface=function(){},e.EVT_BET="evt_bet",e.EVT_SHOW_TIP="evt_show_tip",e}(t.Component);e.BetArea=i,__reflect(i.prototype,"ui.fantan.BetArea")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setChips=function(t){this.com_chipList.setChips(t)},e.prototype.setHead=function(t){this.com_head.setHead(t)},e.prototype.setName=function(t){this.com_head.setName(t)},e.prototype.setBalance=function(t){this.com_head.setBalance(t)},e.prototype.setSurplus=function(t){0===t?this.com_head.showSurplus(!1):this.com_head.showSurplus(!0,t)},e.prototype.getOwnPos=function(){var t=this.com_head.localToGlobal();return{x:t.x+64,y:t.y+64}},e.prototype.showSurplus=function(t,e){this.com_head.showSurplus(t,e)},e.prototype.getCurChipValue=function(){return this.com_chipList.cur_chosen_item.value},e.prototype.showWin=function(t){this.com_head.showWin(t)},e.prototype.updateEnable=function(t){this.com_chipList.updateEnable(t)},e.prototype.betAni=function(t){if(t){var e=0;this.com_head.verticalCenter=e,egret.Tween.get(this.com_head).to({verticalCenter:e-15},80,egret.Ease.quadOut).to({verticalCenter:e},80,egret.Ease.quadIn)}},e.EVT_TOGGLE_PEOPLE="evt_open_people",e}(t.Component);e.BottomPanel=i,__reflect(i.prototype,"ui.fantan.BottomPanel")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(t,e){var i=this;void 0===e&&(e=!1),this.clearTimer(),util.SoundUtil.destroy(["brnn_stopbet_mp3"]);var n=t-util.TimeUtil.now;n>0&&(this.timer=util.TimeUtil.setInterval(function(){var n=t-util.TimeUtil.now;if(n>=0){i.visible=!0;var o=i.lab_count.text!==Math.round(n/1e3).toString();if(i.lab_count.text=Math.round(n/1e3).toString(),o&&util.SoundUtil.play("time_mp3"),(3===Math.round(n/1e3)||2===Math.round(n/1e3)||1===Math.round(n/1e3))&&e&&o){var r=20,s=18;util.SoundUtil.play("WarningtimeOver_mp3"),egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,egret.Tween.get(i.img_bg,{loop:!0}).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).wait(60)}}else egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,i.visible=!1,i.lab_count.text="0",i.clearTimer()},100))},e.prototype.clearTimer=function(){null!=this.timer&&(util.TimeUtil.clearInterval(this.timer),this.timer=null,this.visible=!1,egret.Tween.removeTweens(this.img_bg),this.img_bg.rotation=0)},e}(t.Component);e.CountDown=i,__reflect(i.prototype,"ui.fantan.CountDown")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.WorldMessageTopic=e,__reflect(e.prototype,"topic.WorldMessageTopic"),function(t){t.schema={type:"object",properties:{snapshot:{type:"object",properties:{record:{type:"array",items:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},required:["record"]}},required:["snapshot"]}}(e=t.WorldMessageTopic||(t.WorldMessageTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(this.data&&void 0!==this.data.icon&&null!==this.data.icon[0]){var t="";switch(this.data.icon[0]){case"one":t="ft_pic_road1_png";break;case"two":t="ft_pic_road2_png";break;case"three":t="ft_pic_road3_png";break;case"four":t="ft_pic_road4_png"}this.img_1.source=t}},e}(eui.ItemRenderer);t.LushuItem=e,__reflect(e.prototype,"ui.fantan.LushuItem")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this.username=t},e.prototype.setBalance=function(t){util.NumberUtil.tweenNumber(this.lb_balance,t)},e.prototype.setHead=function(t){this.avatar=t},e.prototype.showSurplus=function(t,e){var i=this;if(this.lab_surplus.text="0",t)if(e>0){var n=function(){egret.Tween.removeTweens(i.com_head),i.com_head.verticalCenter=0};this.lab_surplus.font="bc_font_win_money_fnt",this.lab_sign.font="bc_font_win_money_fnt",this.lab_sign.text="+",util.SoundUtil.play("win_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,e,1e3),n(),egret.Tween.get(this.com_head).to({verticalCenter:-30},80,egret.Ease.quadOut).to({verticalCenter:0},80,egret.Ease.quadIn).call(n)}else 0>e&&(this.lab_surplus.font="bc_font_lose_money_fnt",this.lab_sign.font="bc_font_lose_money_fnt",this.lab_sign.text="-",util.SoundUtil.play("dissapoint_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,Math.abs(e),1e3));this.lab_sign.visible=t,this.lab_surplus.visible=t},e.prototype.showWin=function(t){this.mc_win.visible=t},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.fantan.PlayerFrame")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(){function t(t,e){var i=this;this.factor=50,this.glzs=[],this.stones=[],this.runWorld=function(){return!i.display_container.hasEventListener(egret.Event.ENTER_FRAME)&&i.display_container.addEventListener(egret.Event.ENTER_FRAME,i._run,i)},this.stopWorld=function(){return i.display_container.removeEventListener(egret.Event.ENTER_FRAME,i._run,i)},this._run=function(){return i.run()},this.display_container=t;var n=new p2.World({gravity:[0,0]});n.sleepMode=p2.World.BODY_SLEEPING,n.useWorldGravityAsFrictionGravity=!0,this.world=n,this.createGlass(e),n.on("postBroadphase",function(t){for(var e=t.pairs,i=0;i<e.length;i+=2)e.splice(i,2)})}return t.prototype.stonesWakeUp=function(t){this.stones.forEach(function(e){t?e.wakeUp():e.sleep()})},t.prototype.getAllStoneDisplay=function(){return this.stones.map(function(t){return t.displays})},t.prototype.initStones=function(t,e){var i=this;void 0===e&&(e="circle");var n=egret.Point.create(this.base_glass.displays[0].x,this.base_glass.displays[0].y+180);Array.apply(void 0,Array(t)).forEach(function(){var t=i.createStone(egret.Point.create(util.NumberUtil.getRandom(n.x-60,n.x+60),util.NumberUtil.getRandom(n.y-60,n.y+60)),e);i.updateDisplayPosition(t),i.stones.push(t)})},t.prototype.updateGlassPosition=function(t){t.y-=180;for(var e=this.base_glass.position,i=t.x/this.factor-e[0],n=t.y/this.factor-e[1],o=0,r=this.glzs.length;r>o;o++){var s=this.glzs[o],a=s.position;s.position=[a[0]+i,a[1]+n]}egret.Point.release(t)},t.prototype.getStoneDisplay=function(t){var e=new eui.Image("ft_pic_stone_png");return e.x=t.x,e.y=t.y,e.width=e.height=12,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e},t.prototype.createStone=function(t,e){var i=this;void 0===e&&(e="circle");var n=this.factor,o=[this.getStoneDisplay(t)],r=new p2.Body({mass:5,position:[t.x/n,t.y/n],allowSleep:!1});r.damping=.6;var s="circle"===e?new p2.Circle({radius:.1}):new p2.Particle;r.addShape(s),r.displays=o,r.type=p2.Body.DYNAMIC;var a=this.display_container.getChildIndex(this.base_glass.displays[0])||0;return o.forEach(function(t){return i.display_container.addChildAt(t,a)}),this.world.addBody(r),egret.Point.release(t),r},t.prototype.createGlass=function(t){for(var e=Math.PI/2/4,i=2*Math.PI/e,n=0;i>n;n++){var o=this.createBoxes(e,n);0===n&&(this.base_glass=o),this.glzs.push(o)}this.updateGlassPosition(t),this.updateDisplayPosition(this.base_glass)},t.prototype.createBoxes=function(t,e){var i=200/this.factor,n=10*(e+1),o=e*t,r=[180*Math.sin(o)/this.factor,-180*Math.cos(o)/this.factor],s=new p2.Body({mass:0,fixedRotation:!0,position:r,angle:o,id:n});if(s.addShape(new p2.Box({width:i,height:i})),s.type=p2.Body.STATIC,this.world.addBody(s),0===e){var a=new eui.Image("ft_pic_glass_cover_png");a.anchorOffsetX=94,a.anchorOffsetY=-87,s.displays=[a]}return s},t.prototype.updateDisplayPosition=function(t){for(var e=0,i=t.displays.length;i>e;e++){var n=t.displays[e];n.x=t.position[0]*this.factor,n.y=t.position[1]*this.factor}},t.prototype.run=function(){var t=this;this.world.step(1/60,1),this.updateDisplayPosition(this.base_glass);var e=[this.base_glass.position[0]-1.8,this.base_glass.position[0]+1.7],i=[this.base_glass.position[1]+1.85,this.base_glass.position[1]+5.2];this.stones.forEach(function(n){(n.position[0]<e[0]||n.position[0]>e[1]||n.position[1]<i[0]||n.position[1]>i[1])&&(n.position=[t.base_glass.position[0],t.base_glass.position[1]+3.5]),t.updateDisplayPosition(n)})},t}();t.RollingStones=e,__reflect(e.prototype,"ui.fantan.RollingStones")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.objChips=[],e.shot=function(t,i){egret.callLater(function(){egret.callLater(function(){var e=new egret.RenderTexture;e.drawToTexture(t),i.source=e},e)},e)},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.scroller2.addEventListener(egret.Event.RESIZE,this.resize2,this)},e.prototype.updateRoadMap=function(t){if(t&&this.roadMap&&!util.ObjectUtil.isEqual(t.road_map,this.oldRoadMap)){util.LogUtil.debug("[sedie] [RoomRoadMap] [updateRoadMap] write_4=>"+t.result_percent.one+" red_4=>"+t.result_percent.two+" single=>"+t.result_percent.three+" double=>"+t.result_percent.four);for(var e=t.list[0].bead_road.slice(-50),i=0,n=0,o=0,r=0,s=0;s<e.length;s++)switch(e[s].icon[0]){case"one":i++;break;case"two":n++;break;case"three":o++;break;case"four":r++}this.lb_oneNum.text=""+i,this.lb_twoNum.text=""+n,this.lb_threeNum.text=""+o,this.lb_fourNum.text=""+r,this.lb_one.text=Math.floor(100*Number((i/50).toFixed(2)))+"%",this.lb_two.text=Math.floor(100*Number((n/50).toFixed(2)))+"%",this.lb_three.text=Math.floor(100*Number((o/50).toFixed(2)))+"%",this.lb_four.text=Math.floor(100*Number((r/50).toFixed(2)))+"%";var a=util.ObjectUtil.copy(t.list[0].bead_road);this.oldRoadMap=util.ObjectUtil.copy(t.list[0].bead_road),this.roadMap.dataProvider=new eui.ArrayCollection(a),this.resize();var l=util.ObjectUtil.copy(t.list[0].big_road);l.length&&void 0!==this.oldRoadMap2&&(l[l.length-1].isNew=!0,l[l.length-1].time=util.TimeUtil.now),this.oldRoadMap2=util.ObjectUtil.copy(t.list[0].big_road),this.resize2()}},e.prototype.resize=function(){if(this.oldRoadMap){this.validateNow();var t=36.5*Math.floor(this.oldRoadMap.length/6);this.scroller.viewport.scrollH=t>this.scroller.width?t-this.scroller.width+34:0,this.shot(this.scroller,this.img_shot1)}},e.prototype.resize2=function(){if(this.oldRoadMap2){this.roadMap2.removeChildren();var t,e=Math.floor(this.scroller2.width/36.05);if(this.oldRoadMap2[this.oldRoadMap2.length-1].col<=e)t=this.oldRoadMap2;else{for(var i=0,n=this.oldRoadMap2[this.oldRoadMap2.length-1].col-e,o=this.oldRoadMap2.length-1;o>0;o--)if(i=o,this.oldRoadMap2[o].col===n){if(this.oldRoadMap2[o].col!==this.oldRoadMap2[o-1].col){i=o;break}if(this.oldRoadMap2[o].col===this.oldRoadMap2[o-1].col)break}t=this.oldRoadMap2.slice(i+1)}for(var r,s=0;s<t.length;s++){this.objChips[s]?r=this.objChips[s]:(r=new eui.Image,this.objChips.push(r));var a="";switch(t[s].icon[0]){case"one":a="ft_pic_road1_png";break;case"two":a="ft_pic_road2_png";break;case"three":a="ft_pic_road3_png";break;case"four":a="ft_pic_road4_png"}r.source=a,r.scaleX=r.scaleY=.34,r.x=2+36.05*(t[s].col-t[0].col),r.y=36*t[s].row,this.roadMap2.addChild(r)}this.shot(this.roadMap2,this.img_shot2)}},e}(t.Component);e.RoomRoadMap=i,__reflect(i.prototype,"ui.fantan.RoomRoadMap")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.BaicaoDeskTopic=e,__reflect(e.prototype,"topic.BaicaoDeskTopic"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{bet_limit:{properties:{admittance:{type:"number"},ante:{type:"number"}},required:["admittance","ante"],type:"object"},fight:{patternProperties:{"^[1-6]$":{type:"object",properties:{cards:{items:{type:"number",minimum:0,maximum:51},type:"array"},is_done:{type:"boolean"},point:{type:"number"},is_jqk:{type:"boolean"}},required:["is_done","point","is_jqk"]}},additionalProperties:!1,maxProperties:6,minProperties:1},room_setting:{properties:{room_id:{type:"string"},time:{properties:{op:{type:"number"}},required:["op"],type:"object"},type:{type:"string"}},required:["room_id","time","type"],type:"object"},settle:{patternProperties:{"^[1-6]$":{type:"object",properties:{surplus:{type:"number"}},required:["surplus"]}},additionalProperties:!1,maxProperties:6,minProperties:1},stage:{type:"string"},stage_timestamp:{type:"number"},user_info:{patternProperties:{"^[1-6]$":{type:"object",properties:{avatar:{type:"string"},balance:{decimal:!0},position:{type:"string"},user_id:{type:"string"},username:{type:"string"}}}},additionalProperties:!1,maxProperties:6,minProperties:1}},required:["bet_limit","fight","room_setting","settle","stage","stage_timestamp","timestamp","user_info"],type:"object","if":{not:{properties:{stage:{"const":"NONE"}}}},then:{properties:{user_info:{patternProperties:{"^[1-6]$":{required:["balance","position","user_id","username"]}}}}}}},required:["snapshot"],type:"object"}}(e=t.BaicaoDeskTopic||(t.BaicaoDeskTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.gp_tip.contains(this.gl_pool)&&this.gp_tip.removeChild(this.gl_pool)},e.prototype.show=function(t,e){void 0===e&&(e=!1),t&&(e?(this.img_bg.top=-60,this.img_bg.left=this.img_bg.right=-60,this.img_bg.bottom=-100,!this.gp_tip.contains(this.gl_pool)&&this.gp_tip.addChildAt(this.gl_pool,0)):(this.img_bg.top=this.img_bg.bottom=this.img_bg.left=this.img_bg.right=-15,this.gp_tip.contains(this.gl_pool)&&this.gp_tip.removeChild(this.gl_pool)),egret.Tween.removeTweens(this),this.alpha=0,this.lab_tip.text=t,egret.Tween.get(this).to({alpha:1},500).wait(1e3).to({alpha:0},500))},e}(t.Component);e.Tip=i,__reflect(i.prototype,"ui.fantan.Tip")}(e=t.fantan||(t.fantan={}))}(ui||(ui={}));var GameConst;!function(t){t.game_list=[],t.hot_list=[],t.valid_game_data_map=new Map,t.all_game_data_list=[{name:"bull",group:"0",topic:{type_topic:Const.Topic.BULL,desk_topic:Const.Topic.DESK_BULL},cmpt:{hall:ui.bull.Hall.instance,room_ui:ui.bull.RoomUI.instance,controller:BullController.instance},dg_item_data:{bg_source:"home_pic_bullbg_png",hot_bg_source:"hall_pic_bull_png",title_source:"hall_pic_game_bull_png",db_armature:"bull"},bgm:"qznn_room_bg_mp3",room_bgm:"qznn_game_bg_mp3"},{name:"gf",group:"0",topic:{type_topic:Const.Topic.FLOWER,desk_topic:Const.Topic.DESK_FLOWER},cmpt:{hall:ui.flower.Hall.instance,room_ui:ui.flower.RoomUI.instance,controller:FlowerController.instance},dg_item_data:{bg_source:"home_pic_flowerbg_png",hot_bg_source:"hall_pic_flower_png",title_source:"font_hall_top_game_logo_png",db_armature:"flower"},bgm:"zjh_gf_room_bgm_mp3",room_bgm:"zjh_gf_game_bgm_mp3"},{name:"tongbi",group:"0",topic:{type_topic:Const.Topic.CASINO,desk_topic:Const.Topic.DESK_CASINO},cmpt:{hall:ui.casino.Hall.instance,room_ui:ui.casino.RoomUI.instance,controller:CasinoController.instance},dg_item_data:{bg_source:"home_pic_casinobg_png",hot_bg_source:"hall_pic_casino_png",title_source:"hall_pic_game_casino_png",db_armature:"casino-bull"},bgm:"tbnn_room_bg_mp3",room_bgm:"tbnn_game_bg_mp3"},{name:"lunghu",group:"0",topic:{type_topic:Const.Topic.DRAGONTIGER,desk_topic:Const.Topic.DESK_DRAGONTIGER},cmpt:{hall:ui.dragontiger.Hall.instance,room_ui:ui.dragontiger.RoomUI.instance,controller:DragontigerController.instance},dg_item_data:{bg_source:"home_pic_dtbg_png",hot_bg_source:"hall_pic_dragontiger_png",title_source:"hall_pic_game_dt_png",db_armature:"dragontiger"},bgm:"longhu_room_bgm_mp3",room_bgm:"longhu_game_bgm_mp3"},{name:"te",group:"0",topic:{type_topic:Const.Topic.TWOEIGHT_HALL,desk_topic:Const.Topic.DESK_TWOEIGHT},cmpt:{hall:ui.twoeight.Hall.instance,room_ui:ui.twoeight.RoomUI.instance,controller:TwoEightController.instance},dg_item_data:{bg_source:"home_pic_twobg_png",hot_bg_source:"hall_pic_two_png",title_source:"teb_font_hall_top_game_logo_png",db_armature:"two_eight_bar"},bgm:"erba_sound_room_bgm_mp3",room_bgm:"erba_sound_game_bgm_mp3"},{name:"pg",group:"0",topic:{type_topic:Const.Topic.PAIGOW_HALL,desk_topic:Const.Topic.DESK_PAIGOW},cmpt:{hall:ui.paigow.Hall.instance,room_ui:ui.paigow.RoomUI.instance,controller:PaigowController.instance},dg_item_data:{bg_source:"home_pic_paigowbg_png",hot_bg_source:"hall_pic_paigow_png",title_source:"pg_font_top_game_png",db_armature:"paigow"},bgm:"qzpj_game_bg_mp3",room_bgm:"qzpj_room_bg_mp3"},{name:"look4",group:"0",topic:{type_topic:Const.Topic.FOURBULL,desk_topic:Const.Topic.DESK_FOURBULL},cmpt:{hall:ui.four.Hall.instance,room_ui:ui.four.RoomUI.instance,controller:FourBullController.instance},dg_item_data:{bg_source:"home_pic_4cbullbg_png",hot_bg_source:"hall_pic_4cbull_png",title_source:"hall_pic_game_4cb_png",db_armature:"4cbull"},bgm:"ksznn_bg_mp3"},{name:"bairen",group:"0",topic:{type_topic:Const.Topic.BAIREN,desk_topic:Const.Topic.DESK_BAIREN},cmpt:{hall:ui.bairen.Hall.instance,room_ui:ui.bairen.RoomUI.instance,controller:BaiRenController.instance},dg_item_data:{bg_source:"home_pic_hundredsbg_png",hot_bg_source:"hall_pic_hundredsbull_png",title_source:"hall_pic_game_hd_png",db_armature:"hundredsbull"},bgm:"brnn_room_bg_mp3",room_bgm:"brnn_game_bg_mp3"},{name:"sungung",group:"0",topic:{type_topic:Const.Topic.THREE,desk_topic:Const.Topic.DESK_THREE},cmpt:{hall:ui.three.Hall.instance,room_ui:ui.three.RoomUI.instance,controller:ThreeController.instance},dg_item_data:{bg_source:"home_pic_threebg_png",hot_bg_source:"hall_pic_three_facecard_png",title_source:"tf_font_hall_top_game_logo_png",db_armature:"three-facecard"},bgm:"sg_room_bgm_mp3",room_bgm:"sg_game_bgm_mp3"},{name:"tgf",group:"0",topic:{type_topic:Const.Topic.THREEFLOWER,desk_topic:Const.Topic.DESK_THREEFLOWER},cmpt:{hall:ui.threeflower.Hall.instance,room_ui:ui.threeflower.RoomUI.instance,controller:ThreeFlowerController.instance},dg_item_data:{bg_source:"home_pic_3cgfbg_png",hot_bg_source:"hall_pic_3cgf_png",title_source:"hall_pic_game_3cgf_png",db_armature:"3cgf"},bgm:"qzwxs_game_bgm_mp3",room_bgm:"qzwxs_room_bgm_mp3"},{name:"tk",group:"1",topic:{type_topic:Const.Topic.THIRTEENKILL,desk_topic:Const.Topic.DESK_THIRTEENKILL},cmpt:{hall:ui.thirteenkill.Hall.instance,room_ui:ui.thirteenkill.RoomUI.instance,controller:ThirteenKillController.instance},dg_item_data:{bg_source:"home_thirteenbg_png",hot_bg_source:"hall_thirteen_png",title_source:"hall_pic_game_killer_png",db_armature:"home_thirteen"},bgm:"kliller_home_gb_13_mp3"},{name:"baicao",group:"1",topic:{type_topic:Const.Topic.BAICAO_HALL,desk_topic:Const.Topic.DESK_BAICAO},cmpt:{hall:ui.baicao.Hall.instance,room_ui:ui.baicao.RoomUI.instance,controller:BaicaoController.instance},dg_item_data:{bg_source:"home_baicaibg_png",hot_bg_source:"hall_baicai_png",title_source:"hall_pic_game_baicai_png",db_armature:"home_baicai"},bgm:"baicao_home_gb_bc_mp3"},{name:"horoscope",group:"1",topic:{type_topic:Const.Topic.HOROSCOPE,desk_topic:Const.Topic.DESK_HOROSCOPE},cmpt:{hall:ui.horoscope.Hall.instance,room_ui:ui.horoscope.RoomUI.instance,controller:HoroscopeController.instance},dg_item_data:{bg_source:"home_horoscopebg_png",hot_bg_source:"hall_horoscope_png",title_source:"hall_pic_game_horoscope_png",db_armature:"home_horoscope"},bgm:"horoscope_home_bg_hor_mp3"},{name:"lieng",group:"1",topic:{type_topic:Const.Topic.LIENG,desk_topic:Const.Topic.DESK_LIENG},cmpt:{hall:ui.lieng.Hall.instance,room_ui:ui.lieng.RoomUI.instance,controller:LiengController.instance},dg_item_data:{bg_source:"home_liengbg_png",hot_bg_source:"hall_lieng_png",title_source:"hall_pic_game_lieng_png",db_armature:"home_lieng"},bgm:"lieng_home_gb_lieng_mp3"},{name:"pokdeng",group:"1",topic:{type_topic:Const.Topic.POKDENG_HALL,desk_topic:Const.Topic.DESK_POKDENG},cmpt:{hall:ui.pokdeng.Hall.instance,room_ui:ui.pokdeng.RoomUI.instance,controller:PokdengController.instance},dg_item_data:{bg_source:"home_pokdengbg_png",hot_bg_source:"hall_pokdeng_png",title_source:"hall_pic_game_pokdeng_png",db_armature:"home_pokdeng"},bgm:"pokdeng_home_gb_PD_mp3"},{name:"hilo",group:"1",topic:{type_topic:Const.Topic.HILO,desk_topic:Const.Topic.DESK_HILO},cmpt:{hall:ui.hilo.Hall.instance,room_ui:ui.hilo.RoomUI.instance,controller:HiloController.instance},dg_item_data:{bg_source:"home_hilobg_png",hot_bg_source:"hall_hilo_png",title_source:"hall_pic_game_hilo_png",db_armature:"home_hilo"},bgm:"home_bg_hilo_mp3"},{name:"button",group:"1",topic:{type_topic:Const.Topic.SEDIE,desk_topic:Const.Topic.DESK_SEDIE},cmpt:{hall:ui.sedie.Hall.instance,room_ui:ui.sedie.RoomUI.instance,controller:SedieController.instance},dg_item_data:{bg_source:"home_sediebg_png",hot_bg_source:"hall_sedie_png",title_source:"hall_pic_game_xocdie_png",db_armature:"home_sedie"},bgm:"home_bg_sedie_mp3"},{name:"fantan",group:"1",topic:{type_topic:Const.Topic.FANTAN,desk_topic:Const.Topic.DESK_FANTAN},cmpt:{hall:ui.fantan.Hall.instance,room_ui:ui.fantan.RoomUI.instance,controller:FantanController.instance},dg_item_data:{bg_source:"home_fan_tanbg_png",hot_bg_source:"hall_fan_tan_png",title_source:"hall_pic_game_fantan_png",db_armature:"home_fan_tan"},bgm:"home_bg_fantan_mp3"},{name:"fish",group:"1",topic:{type_topic:Const.Topic.FISH,desk_topic:Const.Topic.DESK_FISH},cmpt:{hall:ui.fish.Hall.instance,room_ui:ui.fish.RoomUI.instance,controller:FishController.instance},dg_item_data:{bg_source:"home_fishbg_png",hot_bg_source:"hall_fish_png",title_source:"hall_pic_game_fish_png",db_armature:"home_fish"},bgm:"home_bg_fish_mp3"},{name:"blackjack",group:"1",topic:{type_topic:Const.Topic.BLACKJACK,desk_topic:Const.Topic.DESK_BLACKJACK},cmpt:{hall:ui.blackjack.Hall.instance,room_ui:ui.blackjack.RoomUI.instance,controller:BlackjackController.instance},dg_item_data:{bg_source:"home_black_jackbg_png",hot_bg_source:"hall_black_jack_png",title_source:"hall_pic_game_bj_png",db_armature:"home_black_jack"},bgm:"home_bg_21_mp3"}]
}(GameConst||(GameConst={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return egret.Tween.removeTweens(e.img_light)},this)},e.prototype.showBegin=function(t){this.img_light.visible=!0,this.img_light2.visible=!1,this.showText(t,65280)},e.prototype.showStop=function(t){this.img_light.visible=!1,this.img_light2.visible=!0,this.showText(t,16711680)},e.prototype.showText=function(t,e){this.tipText.textColor=e,this.tipText.text=t},e.prototype.showLight=function(){egret.Tween.removeTweens(this.img_light),this.img_light.scaleX=.3,egret.Tween.get(this.img_light,{loop:!0}).to({scaleX:2},300).to({scaleX:1},150).to({scaleX:.3},100)},e}(t.Component);e.BetHint=i,__reflect(i.prototype,"ui.fish.BetHint")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.initRoadMap(),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return e.resize()},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.roadMapScroller.stopAnimation()},this)},e.prototype.setRoadMapBlink=function(t){this.com_roadMap.is_blink=t},e.prototype.setChips=function(t){this.com_chipList.setChips(t)},e.prototype.setHead=function(t){this.com_head.setHead(t)},e.prototype.setName=function(t){this.com_head.setName(t)},e.prototype.setBalance=function(t){this.com_head.setBalance(t)},e.prototype.setSurplus=function(t){0===t?this.com_head.showSurplus(!1):this.com_head.showSurplus(!0,t)},e.prototype.updatePeople=function(t){this.btn_people.label=t.toString()},e.prototype.getOwnPos=function(){var t=this.com_head.localToGlobal();return{x:t.x+64,y:t.y+64}},e.prototype.getOtherPos=function(){var t=this.btn_people.localToGlobal();return{x:t.x+this.btn_people.width/2,y:t.y+this.btn_people.height/2}},e.prototype.showSurplus=function(t,e){this.com_head.showSurplus(t,e)},e.prototype.getCurChipValue=function(){return this.com_chipList.cur_chosen_item.value},e.prototype.showWin=function(t){this.com_head.showWin(t)},e.prototype.setRoadMap=function(t){this.road_map=t,this.resetScrollerPos()},e.prototype.updateEnable=function(t){this.com_chipList.updateEnable(t)},e.prototype.betAni=function(t){if(t){var e=this.currentState===egret.OrientationMode.LANDSCAPE?0:22.67;this.com_head.verticalCenter=e,egret.Tween.get(this.com_head).to({verticalCenter:e-15},80,egret.Ease.quadOut).to({verticalCenter:e},80,egret.Ease.quadIn)}else{var e=26;this.btn_people.bottom=e,egret.Tween.get(this.btn_people).to({bottom:e+15},80,egret.Ease.quadOut).to({bottom:e},80,egret.Ease.quadIn)}},e.prototype.initRoadMap=function(){util.LogUtil.debug("initRoadMap------------------")},e.prototype.resetScrollerPos=function(){this.validateNow(),this.roadMapScroller.viewport.contentWidth>this.roadMapScroller.viewport.width?this.roadMapScroller.viewport.scrollH=this.roadMapScroller.viewport.contentWidth-this.roadMapScroller.viewport.width:this.roadMapScroller.viewport.scrollH=0,this.com_roadMap.shot()},e.prototype.resize=function(){var t=this;egret.callLater(function(){egret.callLater(function(){t.validateNow(),t.roadMapScroller.viewport.contentWidth>t.roadMapScroller.viewport.width?t.roadMapScroller.viewport.scrollH=t.roadMapScroller.viewport.contentWidth-t.roadMapScroller.viewport.width:t.roadMapScroller.viewport.scrollH=0,t.com_roadMap.shot()},t)},this)},e}(t.Component);e.BottomPanel=i,__reflect(i.prototype,"ui.fish.BottomPanel")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(t,e){var i=this;void 0===e&&(e=!1),this.clearTimer(),util.SoundUtil.destroy(["brnn_stopbet_mp3"]);var n=t-util.TimeUtil.now;n>0&&(this.timer=util.TimeUtil.setInterval(function(){var n=t-util.TimeUtil.now;if(n>=0){i.visible=!0;var o=i.lab_count.text!==Math.round(n/1e3).toString();if(i.lab_count.text=Math.round(n/1e3).toString(),o&&util.SoundUtil.play("time_mp3"),(3===Math.round(n/1e3)||2===Math.round(n/1e3)||1===Math.round(n/1e3))&&e&&o){var r=20,s=18;util.SoundUtil.play("WarningtimeOver_mp3"),egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,egret.Tween.get(i.img_bg,{loop:!0}).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).wait(60)}}else egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,i.visible=!1,i.lab_count.text="0",i.clearTimer()},100))},e.prototype.clearTimer=function(){null!=this.timer&&(util.TimeUtil.clearInterval(this.timer),this.timer=null,egret.Tween.removeTweens(this.img_bg)),this.visible=!1,this.img_bg.rotation=0},e}(t.Component);e.CountDown=i,__reflect(i.prototype,"ui.fish.CountDown")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(topic.RoomItemData);e.RoomItemData=i,__reflect(i.prototype,"ui.fish.RoomItemData");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.data.room_id)},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.bgLight.visible=!0,e.gp_item.scaleX=e.gp_item.scaleY=.95},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.bgLight.visible=!1,e.gp_item.scaleX=e.gp_item.scaleY=1},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){e.bgLight.visible=!1,e.gp_item.scaleX=e.gp_item.scaleY=1},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){e.bgLight.visible=!1,e.gp_item.scaleX=e.gp_item.scaleY=1},this),this.addEventListener(egret.Event.RESIZE,this.resize,this)},e.prototype.resize=function(){this.gp_item.width=74*Math.floor((this.width-40)/74)+40},e}(t.ItemRenderer);e.DeskListItem=n,__reflect(n.prototype,"ui.fish.DeskListItem")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.road_data=new eui.ArrayCollection,e._col=50,e.shot=function(){egret.callLater(function(){egret.callLater(function(){e.gp_shots.$children.forEach(function(t){return t.source=null});for(var t=e.dataArea.height,i=2e3,n=e.dataArea.width/i<<0,o=0;n>o;o++){var r=e.getShotsImg(o),s=new egret.RenderTexture,a=new egret.Rectangle(i*o,0,i*(o+1),t);s.drawToTexture(e.dataArea,a),r.source=s}var l=e.getShotsImg(n),u=new egret.RenderTexture;u.drawToTexture(e.dataArea,new egret.Rectangle(n*i,0,e.dataArea.width,t)),l.source=u},e)},e)},e}return __extends(e,t),Object.defineProperty(e.prototype,"is_blink",{get:function(){return this._is_blink},set:function(t){this._is_blink=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"road_map_data",{get:function(){return this._road_map_data},set:function(t){this._road_map_data=t,this.updateDataGroup(this.road_map_data,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_height",{get:function(){return this._mark_height},set:function(t){this._mark_height=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_width",{get:function(){return this._mark_width},set:function(t){this._mark_width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t,this.updateDataGroup(this.road_map_data,!0)},enumerable:!0,configurable:!0}),e.prototype.updateDataGroup=function(t,e){if(t&&!util.ObjectUtil.isEmpty(t)){var i=util.ObjectUtil.copy(t).slice(t.length<=this.col?0:t.length-this.col),n=[];i.forEach(function(t){"copper"===t[0]&&(t[0]="tiger"),"copper"===t[1]&&(t[1]="tiger"),"copper"===t[2]&&(t[2]="tiger"),n.push({value1:t[0],value2:t[1],value3:t[2]})}),this.road_data.replaceAll(n),this.road_data.refresh(),n.length?(this.shot(),e?this.blink():this.img_ligth.visible=!0):this.img_ligth.visible=!1}},e.prototype.blink=function(){var t=this.img_ligth;egret.Tween.get(t).to({visible:!0},200).to({visible:!1},200).to({visible:!0},200).to({visible:!1},200).call(function(){t.visible=!0})},e.prototype.getShotsImg=function(t){var e;return t>=this.gp_shots.numChildren?(e=new eui.Image,this.gp_shots.addChild(e)):e=this.gp_shots.getChildAt(t),e},e}(eui.Component);t.DeskRoadMap=e,__reflect(e.prototype,"ui.fish.DeskRoadMap")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allStyleList=[],e._pointVal1="cock",e._pointVal2="cock",e._pointVal3="cock",e}return __extends(e,t),Object.defineProperty(e.prototype,"pointVal1",{get:function(){return this._pointVal1},set:function(t){this._pointVal1=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointVal2",{get:function(){return this._pointVal2},set:function(t){this._pointVal2=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointVal3",{get:function(){return this._pointVal3},set:function(t){this._pointVal3=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.style_1.visible=!0,this.currentState="inited",this.o_x=this.cover.x,this.o_y=this.cover.y},e.prototype.init=function(){egret.Tween.removeTweens(this.cover),egret.Tween.removeTweens(this),this.cover.alpha=1,this.cover.rotation=0,this.verticalCenter=-470,this.cover.x=this.o_x,this.cover.y=this.o_y,this.scaleX=.25,this.scaleY=.25},e.prototype.updateDicePoint=function(t){if(t){"copper"===t[0]&&(t[0]="tiger"),"copper"===t[1]&&(t[1]="tiger"),"copper"===t[2]&&(t[2]="tiger"),this.pointVal1=t[0],this.pointVal2=t[1],this.pointVal3=t[2],this.allStyleList=[this.style_1,this.style_2,this.style_3,this.style_4],this.allStyleList.forEach(function(t){t.visible=!1});var e=this.randStyleIndex();this.allStyleList[e].visible=!0}},e.prototype.runOpenAni=function(t,e){void 0===e&&(e=!0),egret.Tween.removeTweens(this.cover),this.cover.rotation=0;var i=this.cover,n=this.o_x+70,o=this.o_y-90;e?egret.Tween.get(i).wait(200).call(function(){util.SoundUtil.play("dakai_mp3")}).to({y:o+65,rotation:12},500).to({y:o,x:n,rotation:30},1300).to({x:this.width+i.width/2,y:0,alpha:0,rotation:45},500).call(function(){util.SoundUtil.play("f_jieguo_mp3"),t&&t()}):(i.x=this.width+i.width/2,i.y=0,i.alpha=0,i.rotation=45,t&&t())},e.prototype.runOpenAni2=function(t){var e=this;egret.Tween.removeTweens(this.cover);var i=this.cover;1===this.scaleX&&(i.x=this.width+i.width/2,i.y=0,i.alpha=0,i.rotation=45),egret.Tween.get(i).wait(500).to({x:this.o_x,y:this.o_y,alpha:1,rotation:0},800).call(function(){egret.Tween.get(e).to({verticalCenter:-470,scaleX:.25,scaleY:.25},500).call(function(){t&&t()})})},e.prototype.centerState=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.cover),this.cover.alpha=0,this.cover.rotation=45,this.verticalCenter=-100,this.cover.x=this.width+this.cover.width/2,this.cover.y=0,this.scaleX=1,this.scaleY=1},e.prototype.resetDiceCup=function(){egret.Tween.get(this.cover).to({x:this.o_x,y:this.o_y,alpha:1,rotation:0}),egret.Tween.get(this).to({verticalCenter:-470,scaleX:.25,scaleY:.25})},e.prototype.randStyleIndex=function(){var t=Math.round(3*Math.random());return t},e}(t.Component);e.DiceCup=i,__reflect(i.prototype,"ui.fish.DiceCup")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.BRDeskTopic=e,__reflect(e.prototype,"topic.BRDeskTopic");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.SnapshotBase);t.BRDeskSnapshot=i,__reflect(i.prototype,"topic.BRDeskSnapshot"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{Open:{properties:{betRate:{type:"number"},cards:{items:{type:"number"},type:"array"},isWin:{type:"boolean"},odds:{type:"number"},type:{type:"string"}},required:["cards","isWin","odds","type"],type:"object"}},properties:{bairen_player_count:{type:"number"},bet:{patternProperties:{"^(tian|di|xuan|huang)$":{type:"number"}},required:[],type:"object"},open:{patternProperties:{"^(tian|di|xuan|huang|banker)$":{$ref:"#/definitions/Open"}},additionalProperties:!1,type:"object"},player_info:{items:{properties:{avatar:{type:"string"},balance:{decimal:!0},bet:{patternProperties:{"^(tian|di|xuan|huang)$":{type:"number"}},required:[],type:"object"},idle:{type:"number"},settle:{patternProperties:{"^(tian|di|xuan|huang)$":{type:"object"}},required:[],type:"object"},surplus:{type:"number"},user_id:{type:"string"},username:{type:"string"}},required:["balance","bet","idle","surplus","user_id","username"],type:"object"},type:"array"},round_id:{type:"string"},round_number:{type:"number"},settle:{patternProperties:{"^(tian|di|xuan|huang)$":{type:"object"}},required:[],type:"object"},shoe_size:{type:"number"},user_info:{properties:{avatar:{type:"string"},balance:{decimal:!0},bet:{patternProperties:{"^(tian|di|xuan|huang)$":{type:"number"}},required:[],type:"object"},idle:{type:"number"},settle:{patternProperties:{"^(tian|di|xuan|huang)$":{type:"object"}},required:[],type:"object"},surplus:{type:"number"},user_id:{type:"string"},username:{type:"string"}},required:["balance","bet","idle","surplus","user_id","username"],type:"object"}},required:["player_info","round_id","user_info"],type:"object"}}(i=t.BRDeskSnapshot||(t.BRDeskSnapshot={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this.username=t},e.prototype.setBalance=function(t){util.NumberUtil.tweenNumber(this.lb_balance,t)},e.prototype.setHead=function(t){this.avatar=t},e.prototype.showSurplus=function(t,e){var i=this;if(this.lab_surplus.text="0",t)if(e>0){var n=function(){egret.Tween.removeTweens(i.com_head),i.com_head.verticalCenter=0};this.lab_surplus.font="thirteen_win_fnt",this.lab_sign.font="thirteen_win_fnt",this.lab_sign.text="+",util.SoundUtil.play("win_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,e,1e3),n(),egret.Tween.get(this.com_head).to({verticalCenter:-30},80,egret.Ease.quadOut).to({verticalCenter:0},80,egret.Ease.quadIn).call(n)}else 0>e&&(this.lab_surplus.font="thirteen_lose_fnt",this.lab_sign.font="thirteen_lose_fnt",this.lab_sign.text="-",util.SoundUtil.play("dissapoint_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,Math.abs(e),1e3));this.lab_sign.visible=t,this.lab_surplus.visible=t},e.prototype.showWin=function(t){this.mc_win.visible=t},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.fish.PlayerFrame")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.road_data=new eui.ArrayCollection,e._col=12,e._road_map_data=[["tiger","tiger","tiger"]],e.inited=!1,e.shot=function(){egret.callLater(function(){egret.callLater(function(){var t=new egret.RenderTexture;t.drawToTexture(e.dataArea),e.img_shot.source=t},e)},e)},e}return __extends(e,t),Object.defineProperty(e.prototype,"is_blink",{get:function(){return this._is_blink},set:function(t){this._is_blink=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"road_map_data",{get:function(){return this._road_map_data},set:function(t){this._road_map_data=t,this.updateDataGroup(this.road_map_data,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_height",{get:function(){return this._mark_height},set:function(t){this._mark_height=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_width",{get:function(){return this._mark_width},set:function(t){this._mark_width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.parent&&this.parent.addEventListener(egret.Event.RESIZE,this.resize,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return e.shot()},this)},e.prototype.updateDataGroup=function(t,e){var i=this.getSize();if(util.LogUtil.debug("------updateGroup=====",t),t&&!util.ObjectUtil.isEmpty(t)){var n=util.ObjectUtil.copy(t).slice(t.length<=i?0:t.length-i),o=[];n.forEach(function(t){"copper"===t[0]&&(t[0]="tiger"),"copper"===t[1]&&(t[1]="tiger"),"copper"===t[2]&&(t[2]="tiger"),o.push({value1:t[0],value2:t[1],value3:t[2],lightV:!1})}),this.road_data.replaceAll(o),this.road_data.refresh(),o.length?(this.shot(),e?this.blink():this.img_ligth.visible=!0):this.img_ligth.visible=!1}},e.prototype.blink=function(){var t=this;egret.callLater(function(){var e=t.getChildAt(0).numChildren;if(0!==e){var i=t.img_ligth;egret.Tween.get(i).to({visible:!0},200).to({visible:!1},200).to({visible:!0},200).to({visible:!1},200).call(function(){i.visible=!0})}},this)},e.prototype.resize=function(){return this.inited?void(this.road_map_data&&this.updateDataGroup(this.road_map_data,!0)):void(this.inited=!0)},e.prototype.getSize=function(){return Math.floor(this.parent.width/74)},e}(eui.Component);t.RoadMap=e,__reflect(e.prototype,"ui.fish.RoadMap")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.BRRoadMapTopic=e,__reflect(e.prototype,"topic.BRRoadMapTopic"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{round_result:{items:{items:{"enum":["di","huang","tian","xuan"],type:"string"},type:"array"},type:"array"}},required:["round_result"],type:"object"}},required:["snapshot"],type:"object"}}(e=t.BRRoadMapTopic||(t.BRRoadMapTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.show=function(t){egret.Tween.removeTweens(this),this.alpha=0,this.lab_tip.text=t,egret.Tween.get(this).to({alpha:1},500).wait(1e3).to({alpha:0},500)},e}(t.Component);e.Tip=i,__reflect(i.prototype,"ui.fish.Tip")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentIndex=0,e}return __extends(e,t),e.prototype.startWinEff=function(){var t=this;this.clearWinEff(),this.visible=!0,this.timer=util.TimeUtil.setInterval(function(){for(var e=t.currentIndex%t.numChildren,i=0;i<t.numChildren;i++)i===e?t.getChildAt(i).visible=!0:t.getChildAt(i).visible=!1;t.currentIndex++},150)},e.prototype.clearWinEff=function(){this.visible=!1,this.currentIndex=0,util.TimeUtil.clearInterval(this.timer)},e}(t.Component);e.WinEff=i,__reflect(i.prototype,"ui.fish.WinEff")}(e=t.fish||(t.fish={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"chipValue",{get:function(){return this._chipValue},set:function(t){this._chipValue=t},enumerable:!0,configurable:!0}),e}(t.Component);e.Chip=i,__reflect(i.prototype,"ui.flower.Chip")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setRound=function(t){this.round.text=util.LanguageUtil.translate("lbl_game_round",t.toString())},e.prototype.setTotalBet=function(t){this.total_bet.text=util.NumberUtil.formatUnit(t.toString())},e}(t.Component);e.DeskInfo=i,__reflect(i.prototype,"ui.flower.DeskInfo")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.showLabel=function(t){var e=this;this.lb_tip.text=t,this.visible=!0,egret.Tween.removeTweens(this.lb_tip),egret.Tween.get(this.lb_tip).set({alpha:0}).to({alpha:1},1e3).wait(1e3).to({alpha:0},1e3).call(function(){e.visible=!1})},e}(t.Component);e.DeskTips=i,__reflect(i.prototype,"ui.flower.DeskTips")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);t.BRDeskSettingData=e,__reflect(e.prototype,"topic.BRDeskSettingData")}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(i=e.Loser||(e.Loser={}));var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.playAni=function(t){var e=this;return this.visible=!0,this.gp_pk_ani.alpha=1,new Promise(function(n){e.db_pk.play("pk",null,0,1),e.burst_left.isPlaying=!1,e.burst_left.currentFrame=0,e.burst_left.visible=!1,e.burst_right.isPlaying=!1,e.burst_right.currentFrame=0,e.burst_right.visible=!1,util.SoundUtil.play("zjh_gf_ZHADAN_mp3"),e.db_pk.once(egret.Event.COMPLETE,function(){switch(t){case i.LEFT:e.burst_left.currentFrame=0,e.burst_left.visible=!0,e.burst_left.playTimes=1,e.burst_left.isPlaying=!0,e.burst_left.once(egret.Event.COMPLETE,o,e);break;case i.RIGHT:e.burst_right.currentFrame=0,e.burst_right.visible=!0,e.burst_right.playTimes=1,e.burst_right.isPlaying=!0,e.burst_right.once(egret.Event.COMPLETE,o,e)}},e);var o=function(){egret.Tween.get(e.gp_pk_ani).to({alpha:0},500,egret.Ease.circOut).call(function(){e.visible=!1,n()})}})},e}(t.Component);e.PKAni=n,__reflect(n.prototype,"ui.flower.PKAni")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.NAP=0]="NAP",t[t.WIN=1]="WIN",t[t.GF=2]="GF",t[t.SF=3]="SF",t[t.LEO=4]="LEO"}(i=e.PayoutAniType||(e.PayoutAniType={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.pokerList.setCheckButtonVisible(!1)},e.prototype.show=function(t,e){switch(this.visible=!0,t){case i.WIN:this.showWin();break;case i.NAP:this.showNap();break;case i.SF:this.showStraightFlush(e);break;case i.GF:this.showGoldenFlower(e);break;case i.LEO:this.showLeopard(e)}},e.prototype.lightAni=function(){var t=this;return new Promise(function(e){egret.Tween.get(t.win_light).set({alpha:0,horizontalCenter:-1e3}).to({alpha:1,horizontalCenter:0},500,egret.Ease.circOut).call(function(){e()})})},e.prototype.coinsAni=function(){var t=this;egret.Tween.get(this.gp_coins).set({alpha:0}).to({alpha:1},300).call(function(){for(var e=0;e<t.gp_coins.numChildren;e++){var i=t.gp_coins.getChildAt(e);egret.Tween.get(i,{loop:!0}).to({verticalCenter:i.verticalCenter+(Math.random()-.5>0?10+10*Math.random():-(10+10*Math.random()))},500).to({verticalCenter:i.verticalCenter},500)}})},e.prototype.pokerAni=function(t){var e=this;return new Promise(function(i){t.visible=!1,e.pokerList.type=t.type,e.pokerList.setCards(t.getCards()),e.pokerList.visible=!0;var n=t.localToGlobal(0,0),o=e.pokerList.localToGlobal(0,0),r=n.x-o.x,s=n.y-o.y;egret.Tween.get(e.pokerList).set({horizontalCenter:e.pokerList.horizontalCenter+r,verticalCenter:e.pokerList.verticalCenter+s,scaleX:"own"===e.pokerList.type?1:0,scaleY:"own"===e.pokerList.type?1:0}).to({horizontalCenter:e.pokerList.horizontalCenter,verticalCenter:e.pokerList.verticalCenter,scaleX:1.2,scaleY:1.2},1e3).wait(2e3).to({horizontalCenter:e.pokerList.horizontalCenter+r,verticalCenter:e.pokerList.verticalCenter+s,scaleX:"own"===e.pokerList.type?1:0,scaleY:"own"===e.pokerList.type?1:0},1e3).call(function(){t.visible=!0,i()})})},e.prototype.reset=function(){egret.Tween.removeTweens(this.win_light),egret.Tween.removeTweens(this.gp_coins),egret.Tween.removeTweens(this.leopard),egret.Tween.removeTweens(this.leopard_font),egret.Tween.removeTweens(this.crown),egret.Tween.removeTweens(this.ear_left),egret.Tween.removeTweens(this.ear_right),egret.Tween.removeTweens(this.straight_flush_font),egret.Tween.removeTweens(this.flower_left),egret.Tween.removeTweens(this.flower_right),egret.Tween.removeTweens(this.flower_font),egret.Tween.removeTweens(this.nap_font),egret.Tween.removeTweens(this.pokerList);for(var t=0;t<this.gp_coins.numChildren;t++){var e=this.gp_coins.getChildAt(t);egret.Tween.removeTweens(e)}this.win_light.visible=!1,this.gp_coins.visible=!1,this.gp_leopard.visible=!1,this.gp_straight_flush.visible=!1,this.gp_flower.visible=!1,this.gp_win.visible=!1,this.gp_nap.visible=!1,this.pokerList.visible=!1,this.visible=!1},e.prototype.showNap=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return this.win_light.alpha=0,this.gp_coins.alpha=0,this.nap_font.alpha=0,this.gp_nap.visible=!0,this.win_light.visible=!0,this.gp_coins.visible=!0,Math.random()<.5?util.SoundUtil.play("zjh_gf_guzhuyizhi_man_mp3"):util.SoundUtil.play("zjh_gf_guzhuyizhi_wom_mp3"),[4,this.lightAni()];case 1:return e.sent(),[4,new Promise(function(e){egret.Tween.get(t.nap_font).set({alpha:0,verticalCenter:-1e3}).to({alpha:1,verticalCenter:0},500,egret.Ease.circOut).call(function(){e()})})];case 2:return e.sent(),this.coinsAni(),[4,this.sleep(1e3)];case 3:return e.sent(),this.reset(),[2]}})})},e.prototype.showWin=function(){var t=this;this.gp_win.visible=!0,this.mc_win.isPlaying=!0,this.mc_win.playTimes=1,this.mc_win.once(egret.Event.COMPLETE,function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.sleep(1e3)];case 1:return t.sent(),this.reset(),[2]}})})},this)},e.prototype.showGoldenFlower=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(i){switch(i.label){case 0:return this.win_light.alpha=0,this.gp_coins.alpha=0,this.flower_left.alpha=0,this.flower_right.alpha=0,this.flower_font.alpha=0,this.gp_flower.visible=!0,this.win_light.visible=!0,this.gp_coins.visible=!0,util.SoundUtil.play("zjh_gf_jinhua_mp3"),[4,this.lightAni()];case 1:return i.sent(),egret.Tween.get(this.flower_left).set({alpha:0}).to({alpha:1},300),[4,new Promise(function(t){egret.Tween.get(e.flower_right).set({alpha:0}).to({alpha:1},300).call(function(){t()})})];case 2:return i.sent(),[4,new Promise(function(t){egret.Tween.get(e.flower_font).set({alpha:0,verticalCenter:-1e3}).to({alpha:1,verticalCenter:0},500,egret.Ease.circOut).call(function(){t()})})];case 3:return i.sent(),this.coinsAni(),[4,this.sleep(1e3)];case 4:return i.sent(),[4,this.pokerAni(t)];case 5:return i.sent(),this.reset(),[2]}})})},e.prototype.showStraightFlush=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(i){switch(i.label){case 0:return this.win_light.alpha=0,this.gp_coins.alpha=0,this.crown.alpha=0,this.ear_left.alpha=0,this.ear_right.alpha=0,this.straight_flush_font.alpha=0,this.gp_straight_flush.visible=!0,this.win_light.visible=!0,this.gp_coins.visible=!0,util.SoundUtil.play("zjh_gf_tonghuashun_mp3"),[4,this.lightAni()];case 1:return i.sent(),egret.Tween.get(this.ear_left).set({alpha:0}).to({alpha:1},300),egret.Tween.get(this.ear_right).set({alpha:0}).to({alpha:1},300),[4,new Promise(function(t){egret.Tween.get(e.crown).set({alpha:0}).to({alpha:1},300).call(function(){t()})})];case 2:return i.sent(),[4,new Promise(function(t){egret.Tween.get(e.straight_flush_font).set({alpha:0,verticalCenter:-1e3}).to({alpha:1,verticalCenter:0},500,egret.Ease.circOut).call(function(){t()})})];case 3:return i.sent(),this.coinsAni(),[4,this.sleep(1e3)];case 4:return i.sent(),[4,this.pokerAni(t)];case 5:return i.sent(),this.reset(),[2]}})})},e.prototype.showLeopard=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(i){switch(i.label){case 0:return this.win_light.alpha=0,this.gp_coins.alpha=0,this.leopard.alpha=0,this.leopard_font.alpha=0,this.gp_leopard.visible=!0,this.win_light.visible=!0,this.gp_coins.visible=!0,util.SoundUtil.play("zjh_gf_baozi_mp3"),[4,this.lightAni()];case 1:return i.sent(),[4,new Promise(function(t){egret.Tween.get(e.leopard).set({alpha:0}).to({alpha:1},300).call(function(){t()})})];case 2:return i.sent(),[4,new Promise(function(t){egret.Tween.get(e.leopard_font).set({alpha:0,verticalCenter:-1e3}).to({alpha:1,verticalCenter:0},500,egret.Ease.circOut).call(function(){t()})})];case 3:return i.sent(),this.coinsAni(),[4,this.sleep(1e3)];case 4:return i.sent(),[4,this.pokerAni(t)];case 5:return i.sent(),this.reset(),[2]}})})},e}(t.Component);e.PayoutAni=n,__reflect(n.prototype,"ui.flower.PayoutAni")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.PLAYER_ID=0]="PLAYER_ID",t[t.CHECKED=1]="CHECKED",t[t.FOLD=2]="FOLD",t[t.LOSE=3]="LOSE"}(i=e.PlayerInfoTopType||(e.PlayerInfoTopType={}));var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+this.type},e.prototype.setName=function(t){this.lb_playerId.text=t},e.prototype.getBalance=function(){return this._balance.toNumber()},e.prototype.setBalance=function(t){this._balance=t,this.lb_playerBalance.text=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.img_head.source=t},e.prototype.showCountDown=function(t){this.countdown.visible=t},e.prototype.removeCountDown=function(){this.countdown.visible=!1},e.prototype.setTop=function(t){switch(this.lb_playerId.visible=!1,this.head_checked.visible=!1,this.head_fold.visible=!1,this.head_lose.visible=!1,this.head_mask.visible=!1,t){case i.PLAYER_ID:this.lb_playerId.visible=!0;break;case i.CHECKED:this.head_checked.visible=!0;break;case i.FOLD:this.head_mask.visible=this.head_fold.visible=!0;break;case i.LOSE:this.head_mask.visible=this.head_lose.visible=!0}},e.prototype.initGraphics=function(){this.shape=new egret.Shape,this.shape.x=this.countdown_bg.width/2,this.shape.y=.8*this.countdown_bg.height,this.addChild(this.shape)},e.prototype.changeGraphics=function(t,e){var i=this,n=this.shape;this.countdown_bg.mask=n,this.countdown_bg.visible=n.visible=!0;var o=function(t){n.graphics.beginFill(65535,1),n.graphics.moveTo(0,0),n.graphics.lineTo(0,0),n.graphics.drawArc(0,0,200,(t-90)*Math.PI/180,-90*Math.PI/180,!1),n.graphics.lineTo(0,0),n.graphics.endFill()};this.stopCountDown(),this.tid=util.TimeUtil.setInterval(function(){var r=t-util.TimeUtil.now,s=(e-r)/e*360;r>0?(n.graphics.clear(),o(s)):(i.stopCountDown(),i.countdown_bg.visible=n.visible=!1,i.countdown_bg.mask=null),i.nowCountDown(s)},50,this)},e.prototype.nowCountDown=function(t){this.nowTime=t},e.prototype.stopCountDown=function(){this.tid&&util.TimeUtil.clearInterval(this.tid),this.tid=void 0},e.prototype.showEnd=function(t,e,i){this.lb_winLoseValue.visible=!0,"lose"===e?(this.lb_winLoseValue.font="public_lose_fnt",this.lb_winLoseValue.text=util.NumberUtil.formatNumber(t)):(this.img_win.visible=!0,this.lb_winLoseValue.font="public_win_fnt",this.lb_winLoseValue.text="+"+util.NumberUtil.formatNumber(t)),i>0&&(this.img_luckyMoney.visible=!0,this.lb_luckyMoney.visible=!0,this.lb_luckyMoney.text="+"+util.NumberUtil.formatNumber(i))
},e.prototype.showReset=function(){this.lb_winLoseValue.visible=!1,this.img_win.visible=!1,this.lb_luckyMoney.visible=!1,this.img_luckyMoney.visible=!1,this.head_mask.visible=!1},e}(t.Component);e.PlayerInfo=n,__reflect(n.prototype,"ui.flower.PlayerInfo")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.setCard=function(t){"number"==typeof t?this.img_poker.source=t+"_png":this.img_poker.source="poker_back_png"},e.prototype.setFailed=function(t,e){this.img_poker.filters=t&&"own"===e?[Const.darkFilter]:[],t&&"other"===e&&(this.img_poker.source="poker_back2_png")},e.prototype.setOtherFailed=function(t){this.img_poker.filters=t?[Const.darkFilter]:[]},e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.getPokerSize=function(){return new egret.Rectangle(0,0,this.img_poker.width,this.img_poker.height)},e.prototype.getPokerPos=function(){return this.poker.localToGlobal()},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.flower.Poker")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(e){var i=t.call(this)||this;return i.pokerIndex=0,i.parent_container=e,i.initPoker(),i}return __extends(i,t),i.prototype.flyCard=function(t,e,i){var n=this;return new Promise(function(i){var o=n.pokers[n.pokerIndex];o.type=t;var r=o.globalToLocal(e.x,e.y),s=function(){return util.SoundUtil.play("nn_sendcard_mp3")};egret.Tween.get(o).set({x:0,y:0,scaleX:.1,scaleY:.1,visible:!0}).call(s).to({x:r.x,y:r.y,scaleX:1,scaleY:1},200).call(i),n.pokerIndex++})},i.prototype.initPoker=function(){this.pokers=[],this.parent_container.removeChildren();for(var t=1;15>=t;t++){var i=new e.Poker;i.visible=!1,this.parent_container.addChild(i),this.pokers.push(i)}this.pokerIndex=0},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.flower.PokerAni")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isWatch=!1,e.isShowResult=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.registerEvent=function(){var t=this;this.btn_check.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dispatchEventWith(e.EVT_CHECK)},this)},e.prototype.setCheckButtonVisible=function(t){this.btn_check.visible=t,t===!0&&(this.isShowResult=!1)},e.prototype.setCards=function(t){t&&(this.cards=t);for(var e=1;3>=e;e++){var i=this["poker_"+e];i.setCard(t?t[e-1]:null)}},e.prototype.getCards=function(){return this.cards},e.prototype.setFailed=function(t){t&&(this.btn_check.visible=!1);for(var e=1;3>=e;e++){var i=this["poker_"+e];i.setFailed(t,this.type)}},e.prototype.setOtherFailed=function(t){for(var e=1;3>=e;e++){var i=this["poker_"+e];i.setOtherFailed(t)}},Object.defineProperty(e.prototype,"isWatch",{get:function(){return this._isWatch},enumerable:!0,configurable:!0}),e.prototype.setWatch=function(t){this._isWatch!==t&&(this._isWatch=t,this.expandCards(t,!1))},e.prototype.showStatus=function(t){util.LogUtil.warn("showStatus type => "+t),this.init(),t&&this[t]?!this[t].visible&&(this[t].visible=!0):this.high_card.visible=!0},e.prototype.init=function(){this.three_of_a_kind.visible=!1,this.straight_flush.visible=!1,this.golden_flower.visible=!1,this.high_card.visible=!1,this.two_pairs.visible=!1,this.straight.visible=!1},e.prototype.showresult=function(t,e){if(e&&(this.cards=e),this.isShowResult!==!0||!t){t&&(this.isShowResult=!0);for(var i=1;3>=i;i++){var n=this["poker_"+i];n.setCard(e[i-1])}}},e.prototype.showResult=function(t,e){var i=this;if(e&&(this.cards=e),this.isShowResult!==!0||!t){t&&(this.isShowResult=!0);var n=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})};return new Promise(function(t){for(var o=function(o){var r=i["poker_"+o];egret.Tween.get(r.img_poker).wait(50*(o-1)).to({scaleX:0,scaleY:1.1},200).call(function(){r.setCard(e[o-1])}).to({scaleX:1,scaleY:1},200).call(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return 3!==o?[3,2]:[4,n(600)];case 1:e.sent(),t(),e.label=2;case 2:return[2]}})})})},r=1;3>=r;r++)o(r)})}},e.prototype.expandCards=function(t,e){var i=this.group_poker.getChildAt(0),n=this.group_poker.getChildAt(2);if(egret.Tween.removeTweens(i),egret.Tween.removeTweens(n),t){if(egret.Tween.get(i).to({rotation:-15},500,egret.Ease.circOut),egret.Tween.get(n).to({rotation:15},500,egret.Ease.circOut),-15===i.rotation||15===n.rotation)return;!e&&util.SoundUtil.play("zjh_"+(Math.random()<.5?"boy":"girl")+"_watch_mp3",1)}else i.rotation=0,n.rotation=0},e.prototype.getPokerType=function(t){return this["poker_"+t].type},e.prototype.getCardPos=function(t){return this["poker_"+t].getPokerPos()},e.prototype.getPokerSize=function(t){return this["poker_"+t].getPokerSize()},e.EVT_CHECK="evt_check",e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.flower.PokerList")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.BRStageTopic=e,__reflect(e.prototype,"topic.BRStageTopic");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);t.BRDeskRoomSettingData=i,__reflect(i.prototype,"topic.BRDeskRoomSettingData");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskStageData);t.BRStageSnapshot=n,__reflect(n.prototype,"topic.BRStageSnapshot"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{BRDeskRoomSettingData:{properties:{time:{properties:{bet:{type:"number"},deal:{type:"number"},open:{type:"number"},settle:{type:"number"},shuffle:{type:"number"}},required:["bet","deal","open","settle","shuffle"],type:"object"}},required:["time"],type:"object"},BRStageSnapshot:{properties:{bet_limit:{properties:{chips:{items:{type:"number"},type:"array"},max:{properties:{di:{type:"number"},huang:{type:"number"},tian:{type:"number"},xuan:{type:"number"}},required:["di","huang","tian","xuan"],type:"object"},min:{properties:{di:{type:"number"},huang:{type:"number"},tian:{type:"number"},xuan:{type:"number"}},required:["di","huang","tian","xuan"],type:"object"}},required:["chips","max","min"],type:"object"},room_setting:{$ref:"#/definitions/BRDeskRoomSettingData"},stage:{type:"string"},stage_timestamp:{type:"number"}},required:["bet_limit","room_setting","stage","stage_timestamp"],type:"object"}},properties:{snapshot:{$ref:"#/definitions/BRStageSnapshot"}},required:["snapshot"],type:"object"}}(e=t.BRStageTopic||(t.BRStageTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.auto_match=!1,e.canSendMatchNotify=!0,e.sendMatchNotify=function(){e.callback&&e.callback(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState(),"cancel"===t&&(this.lb_countdown.text="（5）")},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.isAuto=function(){return this.auto_match},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return util.TimeUtil.clearInterval(e.tid)},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){e.btn_auto_match.selected=!1,e.type="match",e.stopCountDown(),e.auto_match=!1},this),this.startMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMatchNotify,this),this.btn_auto_match.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return e.auto_match=e.btn_auto_match.selected},this),this.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.type="match",e.stopCountDown()},this)},e.prototype.startCountDown=function(){var t=this,e=5,i=function(e){e>0?(t.lb_countdown.text="（"+e+"）",t.lb_countdown.visible=!0):(t.stopCountDown(),t.sendMatchNotify())};this.canSendMatchNotify&&(this.tid=util.TimeUtil.setInterval(function(){return i(--e)},1e3),this.canSendMatchNotify=!1)},e.prototype.stopCountDown=function(){this.tid&&util.TimeUtil.clearInterval(this.tid),this.tid=void 0,this.canSendMatchNotify=!0},e.prototype.setOnMatch=function(t){this.callback=t},e}(t.Component);e.AutoMatch=i,__reflect(i.prototype,"ui.flower.AutoMatch")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chipsListValues=[],e}return __extends(e,t),e.prototype.setChipsValue=function(t){var e=this;[1,2,3,4,5,6].forEach(function(i){e["chip"+i].label=util.NumberUtil.formatUnit(t[i-1].toString()),e.chipsListValues[i]=new Decimal(t[i-1]).div(Const.NUMBER_FACTOR).toNumber()})},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),[1,2,3,4,5,6].forEach(function(t){e["chip"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return e.chipTap(t)},e)})},e.prototype.chipTap=function(t){if(this.dispatchEventWith(e.EVT_SELECT_CHIP,!1,this.chipsListValues[t]),this["chip"+t].enabled)for(var i=1;t>=i;i++)this["chip"+i].enabled=!1,this["chip"+i].filters=[Const.darkFilter]},e.prototype.reset=function(){var t=this;[1,2,3,4,5,6].forEach(function(e){t["chip"+e].enabled=!0,t["chip"+e].filters=[]})},e.prototype.setButtonEnabler=function(t){var e=new Decimal(t).div(Const.NUMBER_FACTOR).toNumber();util.LogUtil.debug("setButtonEnabler ante => "+e+" chipslist =>"+this.chipsListValues);for(var i=1;6>=i;i++)this.chipsListValues[i]<=e&&(this["chip"+i].enabled=!1,this["chip"+i].filters=[Const.darkFilter])},e.prototype.setChipListButtonEnabler=function(t){var e=new Decimal(t).div(Const.NUMBER_FACTOR).toNumber();util.LogUtil.debug("setChipListButtonEnabler player_balance => "+t+" chipslist =>"+this.chipsListValues);for(var i=1;6>=i;i++)e<this.chipsListValues[i]&&(this["chip"+i].enabled=!1,this["chip"+i].filters=[Const.darkFilter])},e.EVT_SELECT_CHIP="evt_select_chip",e}(t.Component);e.ChipsList=i,__reflect(i.prototype,"ui.flower.ChipsList")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.selectValue=0},e.prototype.setValue=function(t){this.selectValue=t},e.prototype.getValue=function(){return this.selectValue},e}(t.Component);e.CompareSelect=i,__reflect(i.prototype,"ui.flower.CompareSelect")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.FOLLOW=0]="FOLLOW",t[t.AUTO_FOLLOW=1]="AUTO_FOLLOW",t[t.CANCEL=2]="CANCEL"}(i=e.CallButtonState||(e.CallButtonState={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.setButtonsEnable=function(t,i,n,o){null!=t&&(e.btn_fold.enabled=t),null!=i&&(e.btn_raise.enabled=i),null!=n&&(e.btn_compare_landscape.enabled=e.btn_compare_portrait.enabled=n),null!=o&&(e.btn_call_landscape.enabled=e.btn_call_portrait.enabled=o)},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.registerEvent=function(){var t=this;this.btn_fold.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dispatchEventWith(e.EVT_FOLD)},this),this.btn_raise.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dispatchEventWith(e.EVT_RAISE)},this),this.btn_compare_landscape.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.compareToggle=!t.compareToggle,t.dispatchEventWith(e.EVT_COMPARE,!1,t.compareToggle)},this),this.btn_compare_portrait.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.compareToggle=!t.compareToggle,t.dispatchEventWith(e.EVT_COMPARE,!1,t.compareToggle)},this),this.btn_call_landscape.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dispatchEventWith(e.EVT_CALL,!1,t.call_btn_state)},this),this.btn_call_portrait.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dispatchEventWith(e.EVT_CALL,!1,t.call_btn_state)},this)},e.prototype.setLabelsNum=function(t){var e=this.btn_call_landscape.labelDisplay,i=this.btn_call_portrait.labelDisplay;e.text=i.text=t,e=this.btn_compare_landscape.labelDisplay,i=this.btn_compare_portrait.labelDisplay,e.text=i.text=t},e.prototype.setCompareLabelsNum=function(t){var e=this.btn_compare_landscape.labelDisplay,i=this.btn_compare_portrait.labelDisplay;e.text=i.text=t},e.prototype.setCallButtonState=function(t){this.call_btn_state=t;var e=this.btn_call_landscape.labelDisplay,n=this.btn_call_landscape.auto,o=this.btn_call_landscape.cancel,r=this.btn_call_portrait.labelDisplay,s=this.btn_call_portrait.auto,a=this.btn_call_portrait.cancel,l=this.btn_call_landscape.mc_landscape,u=this.btn_call_portrait.mc_portrait;switch(t){case i.FOLLOW:e.visible=e.includeInLayout=!0,n.visible=n.includeInLayout=!1,o.visible=o.includeInLayout=!1,r.visible=r.includeInLayout=!0,s.visible=s.includeInLayout=!1,a.visible=a.includeInLayout=!1,l.visible=u.visible=!1;break;case i.AUTO_FOLLOW:e.visible=e.includeInLayout=!1,n.visible=n.includeInLayout=!0,o.visible=o.includeInLayout=!1,r.visible=r.includeInLayout=!1,s.visible=s.includeInLayout=!0,a.visible=a.includeInLayout=!1,l.visible=u.visible=!1;break;case i.CANCEL:e.visible=e.includeInLayout=!1,n.visible=n.includeInLayout=!1,o.visible=o.includeInLayout=!0,r.visible=r.includeInLayout=!1,s.visible=s.includeInLayout=!1,a.visible=a.includeInLayout=!0,l.visible=u.visible=!0}},e.prototype.getButtonState=function(){return this.call_btn_state},e.prototype.resetCompareToggle=function(){this.compareToggle=!1},e.EVT_FOLD="evt_fold",e.EVT_RAISE="evt_raise",e.EVT_COMPARE="evt_compare",e.EVT_CALL="evt_call",e}(t.Component);e.ControlButtons=n,__reflect(n.prototype,"ui.flower.ControlButtons")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.button=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent(),this.toggle.selected=!0},e.prototype.registerEvent=function(){var t=this;this.toggle.addEventListener(eui.UIEvent.CHANGE,function(){return t.dispatchEventWith(e.EVT_TOGGLE_CHANGE,!1,t.toggle.selected)},this)},e.prototype.changeSelected=function(t){this.toggle.selected=t,this.button=this.toggle.selected},e.EVT_TOGGLE_CHANGE="evt_toggle_change",e}(t.Component);e.PreventToggle=i,__reflect(i.prototype,"ui.flower.PreventToggle")}(e=t.flower||(t.flower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clearTimeOut=function(){return util.TimeUtil.clearInterval(e.setIntervalID)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=this.touchChildren=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clearTimeOut,this)},e.prototype.show=function(t,e){var i=this;this.clearTimeOut();var n=function(){var n=i.calRemainMill(t,e)/1e3<<0;n>0?i.lb_cd.text=""+n:(i.parent&&i.parent.removeChild(i),i.visible=!1,util.TimeUtil.clearInterval(i.setIntervalID),i.setIntervalID=void 0)};n(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return n()},250)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?-150:-70},e}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ui.four.CountDown")}(e=t.four||(t.four={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.BlackjackDeskTopic=e,__reflect(e.prototype,"topic.BlackjackDeskTopic");var i;!function(t){var e=function(){function t(){}return t}();t.fight=e,__reflect(e.prototype,"topic.blackjack.fight");var i=function(){function t(){}return t}();t.cardInfo=i,__reflect(i.prototype,"topic.blackjack.cardInfo");var n=function(){function t(){}return t}();t.raise=n,__reflect(n.prototype,"topic.blackjack.raise");var o=function(){function t(){}return t}();t.insurance=o,__reflect(o.prototype,"topic.blackjack.insurance");var r=function(){function t(){}return t}();t.settle=r,__reflect(r.prototype,"topic.blackjack.settle");var s=function(){function t(){}return t}();t.payout=s,__reflect(s.prototype,"topic.blackjack.payout")}(i=t.blackjack||(t.blackjack={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.result={tonghuaniu:{bg:"4cardsbull_pic_bullbg3_png",istonghua:!0,source:"4cardsbull_font_tonghua_png"},shunziniu:{bg:"4cardsbull_pic_bullbg1_png",istonghua:!1,source:"4cardsbull_font_cshunzi_png"},shunjinniu:{bg:"4cardsbull_pic_bullbg1_png",istonghua:!1,source:"4cardsbull_font_cshunjin_png"},huluniu:{bg:"4cardsbull_pic_bullbg2_png",istonghua:!1,source:"4cardsbull_font_hulu_png"}},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.masks=[this.maks1,this.mask2,this.mask3,this.mask4],this.tonghuaImages=[this.tonghua1,this.tonghua2,this.tonghua3,this.tonghua4],this.imags=[this.niuType1,this.niuType2,this.niuType3,this.textTimes]},e.prototype.init=function(t){var e=this,i=this.result[t];this.bg.source=i.bg,this.isToughua=i.istoughua,this.masks.forEach(function(t){t.fillAlpha=0}),i.istonghua?(this.imags.forEach(function(t){t.visible=!1}),this.tonghuaImages.forEach(function(t,i){t.visible=!0,t.mask=e.masks[i]})):(this.imags.forEach(function(t,n){t.visible=!0,t.mask=e.masks[n],3!==n&&(t.source=i.source)}),this.tonghuaImages.forEach(function(t,e){t.visible=!1}))},e.prototype.playAni=function(){this.bg.alpha=0,this.bg.scaleX=0,egret.Tween.get(this.bg).to({scaleX:1,alpha:1},200),this.masks.forEach(function(t,e){egret.Tween.get(t).wait(300+100*e).to({fillAlpha:1})})},e}(t.Component);e.NiuNiuAni=i,__reflect(i.prototype,"ui.four.NiuNiuAni")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.getChipPosition=function(){var t=util.ObjectUtil.copy(this.avatar.localToGlobal());return t.x+=this.avatar.width/2,t.y+=this.avatar.height/2,t},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+this.type},e.prototype.setName=function(t){this.lb_playerId.text=t},e.prototype.setBalance=function(t){this.lb_playerBalance.text=util.NumberUtil.formatNumber(t)},Object.defineProperty(e.prototype,"isBanker",{set:function(t){this.zhuang.visible=t},enumerable:!0,configurable:!0}),e.prototype.getIsBanker=function(){return this.zhuang.visible},e.prototype.setHead=function(t){t&&""!==t&&(this.avatar.source=t)},e.prototype.setXiaoguo=function(t){this.xiaoguo.visible=t},e}(t.Component);e.PlayerInfo=i,__reflect(i.prototype,"ui.four.PlayerInfo")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setCard=function(t){"number"==typeof t?this.img_poker.source="4cb"+t+"_png":this.img_poker.source="poker_back_png"},e.prototype.getPokerSize=function(){return{width:this.img_poker.width,height:this.img_poker.height}},e.prototype.getPokerPos=function(){return this.img_poker.localToGlobal()},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.four.Poker")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.landscape_other_gap=-66.5,e.landscape_own_gap=17,e.portrait_own_gap=-60,e.portrait_other_gap=-81.5,e.result_sound={wuniu:["femalecow_0_mp3","malecow_0_mp3"],niu1:["femalecow_1_mp3","malecow_1_mp3"],niu2:["femalecow_2_mp3","malecow_2_mp3"],niu3:["femalecow_3_mp3","malecow_3_mp3"],niu4:["femalecow_4_mp3","malecow_4_mp3"],niu5:["femalecow_5_mp3","malecow_5_mp3"],niu6:["femalecow_6_mp3","malecow_6_mp3"],niu7:["femalecow_7_mp3","malecow_7_mp3"],niu8:["femalecow_8_mp3","malecow_8_mp3"],niu9:["femalecow_9_mp3","malecow_9_mp3"],niuniu:["femalecow_10_mp3","malecow_10_mp3"],sihuaniu:["female4cow_mp3","male4cow_mp3"],wuhuaniu:["female5cow_mp3","male5cow_mp3"],bomb:["femalebomb_mp3","malebomb_mp3"],wuxiaoniu:["female5scow_mp3","male5scow_mp3"],huluniu:["ksz_femalehulu_mp3","ksz_malehulu_mp3"],tonghuaniu:["ksz_femalesame_mp3","ksz_malesame_mp3"],shunziniu:["ksz_femalestraight_mp3","ksz_malestraight_mp3"],shunjinniu:["ksz_straight_gold_mp3","ksz_straight_gold_mp3"]},e.playsound=function(t){return util.SoundUtil.play(e.getResultSound(t))},e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.initPoker=function(){this.pokers.forEach(function(t){t.setCard()}),this.mc_result.visible=!1,this.otherNiuniu.visible=!1,this.showCardResult=!1},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.pokers=[this.poker1,this.poker2,this.poker3,this.poker4,this.poker5]},e.prototype.setCards=function(t){var e=this;t.forEach(function(t,i){e.pokers[i].setCard(t)}),this.poker5.visible=5===t.length},e.prototype.hidePoker5=function(){this.poker5.visible=!1},e.prototype.pokerEndIsHide=function(){return"poker_back_png"===this.poker5.img_poker.source},e.prototype.showPoker5=function(t){(t||!this.showCardResult)&&(this.poker5.visible=!0,this.poker5.setCard(t))},e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.getTopCardPos=function(){return this.poker1.getPokerPos()},e.prototype.getEndCardPos=function(){return this.poker5.getPokerPos()},e.prototype.getPokerSize=function(){return this.poker1.getPokerSize()},e.prototype.getResultSound=function(t){return this.result_sound[""+t][""+util.NumberUtil.getRandom(0,1)]},e.prototype.isShowCardResult=function(){return this.showCardResult},e.prototype.showMyResult=function(t,e){var i=this;this.showCardResult||(this.showCardResult=!0,!this.poker5.visible&&(this.poker5.visible=!0),egret.Tween.get(this.poker5.img_poker).to({scaleX:0,scaleY:1.1},200).call(function(){i.poker5.setCard(t[4])}).to({scaleX:1,scaleY:1},200).call(function(){i.playsound(e),i.dealAni(e)}))},e.prototype.showResult=function(t,e){var i=this;if(!this.showCardResult)return this.showCardResult=!0,!this.poker5.visible&&(this.poker5.visible=!0),this.mc_result.visible=!1,new Promise(function(n){i.mc_result.visible=!1;for(var o=function(o){var r=i.pokers[o-1];egret.Tween.get(r.img_poker).wait(50*(o-1)).to({scaleX:0,scaleY:1.1},200).call(function(){r.setCard(t[o-1])}).to({scaleX:1,scaleY:1},200).call(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return 5!==o?[3,2]:(this.playsound(e),this.dealAni(e),[4,this.sleep(600)]);case 1:t.sent(),n(),t.label=2;case 2:return[2]}})})})},r=1;5>=r;r++)o(r)})},e.prototype.dealAni=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:switch(e=t){case"tonghuaniu":return[3,1];case"huluniu":return[3,1];case"shunziniu":return[3,1];case"shunjinniu":return[3,1]}return[3,4];case 1:return this.otherNiuniu.visible=!0,[4,this.otherNiuniu.init(t)];case 2:return i.sent(),[4,this.otherNiuniu.playAni()];case 3:return i.sent(),[3,5];case 4:return this.otherNiuniu.visible=!1,this.mc_result.currentFrame=0,this.mc_result.group="effect_bull_"+t,this.mc_result.playTimes=1,this.mc_result.isPlaying=!0,this.mc_result.visible=!0,[3,5];case 5:return[2]}})})},e.prototype.playCardAni=function(t,e){t.visible=!0,egret.Tween.get(e).set({scaleX:0,scaleY:0}).to({scaleX:1,scaleY:1},1e3,egret.Ease.backInOut)},e.prototype.dealCardAni=function(){var t=this;return new Promise(function(e){egret.Tween.get(t.group_poker.layout).set({gap:-t.poker1.width}).to({gap:t[t.currentState+"_gap"]},300).call(e)})},e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.four.PokerList")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){this._source=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cardNumMaskAlpha",{get:function(){return this._alpha},set:function(t){this._alpha=parseFloat(t.toString())},enumerable:!0,configurable:!0}),e.prototype.setCard=function(t){"number"==typeof t?this.source="4cb"+t+"_png":this.source="poker_back_png"},e}(t.Component);e.PokerOg=i,__reflect(i.prototype,"ui.four.PokerOg")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.take_all=0]="take_all",t[t.lose_all=1]="lose_all",t[t.win=2]="win"}(i=e.ResultEnum||(e.ResultEnum={}));var n=function(e){function n(i){var n=e.call(this)||this;return n.parent_container=i,n.touchEnabled=!1,n.touchChildren=!1,n.mc=new t.control.MovieClip("",12,1,0,!1),n.mc.scaleX=n.mc.scaleY=1.6,n.mc.visible=!1,n.mc.horizontalCenter=0,n.mc.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.reset,n),n}return __extends(n,e),n.prototype.show=function(t){var e=this;return new Promise(function(n){switch(e.mc.currentFrame=0,t){case i.take_all:e.mc.group="effect_bull_eatall",e.mc.verticalCenter=Main.instance.orientation===egret.OrientationMode.LANDSCAPE?-290:-200,util.SoundUtil.play("qznn_tongchi_mp3");break;case i.lose_all:e.mc.verticalCenter=Main.instance.orientation===egret.OrientationMode.LANDSCAPE?-220:-240,e.mc.group="effect_bull_compensation";break;case i.win:e.mc.verticalCenter=(Main.instance.orientation===egret.OrientationMode.LANDSCAPE,-190),e.mc.group="effect_0_win",util.SoundUtil.play("nn_win_mp3")}e.mc.playTimes=1,e.mc.once(egret.Event.COMPLETE,function(){n(),e.reset()},e),e.parent_container.addChild(e.mc),e.mc.isPlaying=!0,e.mc.visible=!0})},n.prototype.reset=function(){this.mc.parent&&(this.mc.parent.removeChild(this.mc),this.mc.isPlaying=!1,this.mc.visible=!1,this.mc.group="",this.mc.source=null)},n.prototype.resetMode=function(t){this.mc.verticalCenter=t===egret.OrientationMode.PORTRAIT?-450:-300},n}(eui.Component);e.ResultMC=n,__reflect(n.prototype,"ui.four.ResultMC")}(e=t.four||(t.four={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.BullDeskTopic=e,__reflect(e.prototype,"topic.BullDeskTopic"),function(t){t.fight_schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{stage:{"enum":["DISPUTE","FIGHT","NONE","RAISE","SETTLE"],type:"string"},bet_limit:{properties:{admittance:{type:"number"},ante:{type:"number"}},required:["admittance","ante"],type:"object"},dispute:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{dispute_rate:{type:"number"},is_banker:{type:"boolean"},is_done:{type:"boolean"}},required:["dispute_rate","is_banker","is_done"],type:"object"}},type:"object"},fight:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{cards:{items:{type:"number",maxItems:5,minItems:5},type:"array"},is_done:{type:"boolean"},odds:{type:"number"},type:{type:"string"}},required:["is_done","cards","odds","type"],type:"object"}},type:"object"},raise:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{is_done:{type:"boolean"},raise_rate:{type:"number"}},required:["is_done","raise_rate"],type:"object"}},type:"object"},raise_rate_options:{items:{type:"number"},type:"array"},room_setting:{properties:{dispute_factor:{properties:{1:{type:"number"},2:{type:"number"},3:{type:"number"}},required:["1","2","3"],type:"object"},room_id:{type:"string"},time:{properties:{dispute:{type:"number"},op:{type:"number"},raise:{type:"number"}},required:["dispute","op","raise"],type:"object"}},required:["dispute_factor","room_id","time"],type:"object"},settle:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{surplus:{type:"number"}},required:["surplus"],type:"object"}},type:"object"},stage_timestamp:{type:"number"},user_info:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{avatar:{type:"string"},balance:{decimal:!0},position:{type:"string"},user_id:{type:"string"},username:{type:"string"}},required:[],type:"object"}},type:"object"}},required:["settle","fight","raise","dispute","bet_limit","room_setting","stage","stage_timestamp","user_info"],type:"object"}},required:["snapshot"],type:"object"},t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{stage:{"enum":["DISPUTE","FIGHT","NONE","RAISE","SETTLE"],type:"string"},bet_limit:{properties:{admittance:{type:"number"},ante:{type:"number"}},required:["admittance","ante"],type:"object"},dispute:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{dispute_rate:{type:"number"},is_banker:{type:"boolean"},is_done:{type:"boolean"}},required:["dispute_rate","is_banker","is_done"],type:"object"}},type:"object"},fight:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{cards:{items:{type:"number",maxItems:5,minItems:5},type:"array"},is_done:{type:"boolean"},odds:{type:"number"},type:{type:"string"}},required:["is_done"],type:"object"}},type:"object"},raise:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{is_done:{type:"boolean"},raise_rate:{type:"number"}},required:["is_done","raise_rate"],type:"object"}},type:"object"},raise_rate_options:{items:{type:"number"},type:"array"},room_setting:{properties:{dispute_factor:{properties:{1:{type:"number"},2:{type:"number"},3:{type:"number"}},required:["1","2","3"],type:"object"},room_id:{type:"string"},time:{properties:{dispute:{type:"number"},op:{type:"number"},raise:{type:"number"}},required:["dispute","op","raise"],type:"object"}},required:["dispute_factor","room_id","time"],type:"object"},settle:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{surplus:{type:"number"}},required:["surplus"],type:"object"}},type:"object"},stage_timestamp:{type:"number"},user_info:{additionalProperties:!1,patternProperties:{"^[1-4]+$":{properties:{avatar:{type:"string"},balance:{decimal:!0},position:{type:"string"},user_id:{type:"string"},username:{type:"string"}},required:[],type:"object"}},type:"object"}},required:["settle","fight","raise","dispute","bet_limit","room_setting","stage","stage_timestamp","user_info"],type:"object"}},required:["snapshot"],type:"object"}
}(e=t.BullDeskTopic||(t.BullDeskTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+this.type},e.prototype.setSnatchNumber=function(t){-1===t?this.type="nsnatch":(this.type="snatch",this.snatchNum.text=""+t)},e.prototype.setBetNumber=function(t){this.betNum.text=""+t},e}(t.Component);e.SnatchInfo=i,__reflect(i.prototype,"ui.four.SnatchInfo")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Component);e.TipsInfo=i,__reflect(i.prototype,"ui.four.TipsInfo")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t[t.RIGHT=2]="RIGHT",t[t.LEFT=3]="LEFT"}(i||(i={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startWayGap=10,e.touchMoveStep=0,e.isCardTween=!1,e.lb_str="lbl_game_micard_tip",e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.registerEvent(),this.tx_tishi=new egret.TextField,this.tx_tishi.fontFamily="Microsoft YaHei,PingFang SC,SimHei,SimSun,sans-serif",this.tx_tishi.size=40,this.tx_tishi.textAlign=egret.HorizontalAlign.CENTER,this.tx_tishi.wordWrap=!0,this.tx_tishi.lineSpacing=10,this.tx_tishi.textFlow=[{text:util.LanguageUtil.translate(this.lb_str),style:{textColor:16777215}},{text:"20 s",style:{textColor:16776960}}],this.tishi_width=this.tx_tishi.width},e.prototype.resize=function(){this.tx_tishi.width=Main.instance.orientation===egret.OrientationMode.LANDSCAPE?this.tishi_width:this.tishi_width/2,this.tx_tishi.x=(this.tishiGroup.width-this.tx_tishi.width)/2},e.prototype.init=function(){this.card_left.visible=this.card_right.visible=this.card_top.visible=this.card_bottom.visible=!1,this.isShowPoker=!1,this.Poker.visible=!1},e.prototype.show=function(t,e){var i=this;this.setIntervalID&&util.TimeUtil.clearInterval(this.setIntervalID),this.lb_tips.visible=!0;var n=function(){var n=i.calRemainMill(t,e)/1e3<<0;n>0?i.lb_tips.text=n+" s":(i.lb_tips.visible=!1,i.setIntervalID&&(util.TimeUtil.clearInterval(i.setIntervalID),i.setIntervalID=void 0),i.isShowPoker||(i.touch_area.dispatchEventWith(egret.TouchEvent.TOUCH_END),i.Poker.visible=!0,i.isShowPoker=!0,setTimeout(function(t){return i.sendCloseEvt()},1e3)))};n(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return n()},250)},e.prototype.sendCloseEvt=function(t){this.parent&&this.parent.removeChild(this),t&&-.5>t||util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DONE)},e.prototype.initPoker=function(t){this.init(),t.length<5||(this.poker1.setCard(t[0]),this.poker2.setCard(t[1]),this.poker3.setCard(t[2]),this.poker4.setCard(t[3]),this.card_left.setCard(t[4]),this.card_right.setCard(t[4]),this.card_bottom.setCard(t[4]),this.card_top.setCard(t[4]),this.Poker.setCard(t[4]))},e.prototype.registerEvent=function(){this.touch_area.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandle,this),this.touch_area.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandle,this)},e.prototype.touchHandle=function(t){if(!this.isCardTween)switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:if(0!==this.touchMoveStep||this.isShowPoker)return;this.startTouchX=t.$stageX,this.startTouchY=t.$stageY,this.touchMoveStep=1,this.view_rect.right=this.view_rect.left=this.view_rect.bottom=this.view_rect.top=0/0,this.touch_area.once(egret.TouchEvent.TOUCH_END,this.touchHandle,this);break;case egret.TouchEvent.TOUCH_MOVE:if(this.isShowPoker)return;if(1===this.touchMoveStep){if(t.$stageX-this.startTouchX>this.startWayGap){this.startWay=i.RIGHT,this.touchMoveStep=2,this.view_rect.right=0,this.viewStartW=this.view_rect.width,this.cardStartH=this.card_left.horizontalCenter,this.card_left.visible=!0;break}if(this.startTouchX-t.$stageX>this.startWayGap){this.startWay=i.LEFT,this.touchMoveStep=2,this.view_rect.left=0,this.viewStartW=this.view_rect.width,this.cardStartH=this.card_right.horizontalCenter,this.card_right.visible=!0;break}if(t.$stageY-this.startTouchY>this.startWayGap){this.startWay=i.DOWN,this.touchMoveStep=2,this.view_rect.bottom=0,this.viewStartH=this.view_rect.height,this.cardStartV=this.card_top.verticalCenter,this.card_top.visible=!0;break}if(this.startTouchY-t.$stageY>this.startWayGap){this.startWay=i.UP,this.touchMoveStep=2,this.view_rect.top=0,this.viewStartH=this.view_rect.height,this.cardStartV=this.card_bottom.verticalCenter,this.card_bottom.visible=!0;break}}else 2===this.touchMoveStep&&this.turnOverCheck(t);break;case egret.TouchEvent.TOUCH_END:this.doCardTween(t)}},e.prototype.doCardTween=function(t){var e=this;if(this.isCardTween=!0,3===this.touchMoveStep)switch(this.startWay){case i.RIGHT:egret.Tween.get(this.view_rect).to({width:this.viewStartW},200,egret.Ease.circOut).call(function(){egret.Tween.get(e.card_left).to({cardNumMaskAlpha:0},200,egret.Ease.circOut).wait(1e3).call(function(){e.isCardTween=e.card_left.visible=!1,e.card_left.horizontalCenter=e.cardStartH,e.card_left.cardNumMaskAlpha=1,e.isShowPoker||(e.isShowPoker=!0,e.sendCloseEvt())})});break;case i.LEFT:egret.Tween.get(this.view_rect).to({width:this.viewStartW},200,egret.Ease.circOut).call(function(){egret.Tween.get(e.card_right).to({cardNumMaskAlpha:0},200,egret.Ease.circOut).wait(1e3).call(function(){e.isCardTween=e.card_right.visible=!1,e.card_right.horizontalCenter=e.cardStartH,e.card_right.cardNumMaskAlpha=1,e.isShowPoker||(e.isShowPoker=!0,e.sendCloseEvt())})});break;case i.DOWN:egret.Tween.get(this.view_rect).to({height:this.viewStartH},200,egret.Ease.circOut).call(function(){egret.Tween.get(e.card_top).to({cardNumMaskAlpha:0},200,egret.Ease.circOut).wait(1e3).call(function(){e.isCardTween=e.card_top.visible=!1,e.card_top.verticalCenter=e.cardStartV,e.card_top.cardNumMaskAlpha=1,e.isShowPoker||(e.isShowPoker=!0,e.sendCloseEvt())})});break;case i.UP:egret.Tween.get(this.view_rect).to({height:this.viewStartH},200,egret.Ease.circOut).call(function(){egret.Tween.get(e.card_bottom).to({cardNumMaskAlpha:0},200,egret.Ease.circOut).wait(1e3).call(function(){e.isCardTween=e.card_bottom.visible=!1,e.card_bottom.verticalCenter=e.cardStartV,e.card_bottom.cardNumMaskAlpha=1,e.isShowPoker||(e.isShowPoker=!0,e.sendCloseEvt())})});break;default:this.isCardTween=!1}else switch(this.startWay){case i.RIGHT:Math.abs(this.startTouchX-t.stageX)<2?(this.card_left.horizontalCenter=this.cardStartH,this.view_rect.width=this.viewStartW,this.isCardTween=!1):(egret.Tween.get(this.card_left).to({horizontalCenter:this.cardStartH},200,egret.Ease.circOut).call(function(){return e.isCardTween=e.card_left.visible=!1}),egret.Tween.get(this.view_rect).to({width:this.viewStartW},200,egret.Ease.circOut));break;case i.LEFT:Math.abs(this.startTouchX-t.stageX)<2?(this.card_right.horizontalCenter=this.cardStartH,this.view_rect.width=this.viewStartW,this.isCardTween=!1):(egret.Tween.get(this.card_right).to({horizontalCenter:this.cardStartH},200,egret.Ease.circOut).call(function(){return e.isCardTween=e.card_right.visible=!1}),egret.Tween.get(this.view_rect).to({width:this.viewStartW},200,egret.Ease.circOut));break;case i.DOWN:Math.abs(this.startTouchY-t.stageY)<2?(this.card_top.verticalCenter=this.cardStartV,this.view_rect.height=this.viewStartH,this.isCardTween=!1):(egret.Tween.get(this.card_top).to({verticalCenter:this.cardStartV},200,egret.Ease.circOut).call(function(){return e.isCardTween=e.card_top.visible=!1}),egret.Tween.get(this.view_rect).to({height:this.viewStartH},200,egret.Ease.circOut));break;case i.UP:Math.abs(this.startTouchY-t.stageY)<2?(this.card_bottom.verticalCenter=this.cardStartV,this.view_rect.height=this.viewStartH,this.isCardTween=!1):(egret.Tween.get(this.card_bottom).to({verticalCenter:this.cardStartV},200,egret.Ease.circOut).call(function(){return e.isCardTween=e.card_bottom.visible=!1}),egret.Tween.get(this.view_rect).to({height:this.viewStartH},200,egret.Ease.circOut));break;default:this.isCardTween=!1}this.touchMoveStep=0},e.prototype.turnOverCheck=function(t){var e=t.$stageX-this.startTouchX,n=t.$stageY-this.startTouchY;switch(this.startWay){case i.RIGHT:this.card_left.horizontalCenter=this.cardStartH+e,this.view_rect.width=this.viewStartW-e/2,this.view_rect.width<this.viewStartW/2&&(this.view_rect.width=this.viewStartW/2,this.card_left.horizontalCenter=0,this.touchMoveStep=3,this.touch_area.dispatchEventWith(egret.TouchEvent.TOUCH_END));break;case i.LEFT:this.card_right.horizontalCenter=this.cardStartH+e,this.view_rect.width=this.viewStartW+e/2,this.view_rect.width<this.viewStartW/2&&(this.view_rect.width=this.viewStartW/2,this.card_right.horizontalCenter=0,this.touchMoveStep=3,this.touch_area.dispatchEventWith(egret.TouchEvent.TOUCH_END));break;case i.DOWN:this.card_top.verticalCenter=this.cardStartV+n,this.view_rect.height=this.viewStartH-n/2,this.view_rect.height<this.viewStartH/2&&(this.view_rect.height=this.viewStartH/2,this.card_top.verticalCenter=0,this.touchMoveStep=3,this.touch_area.dispatchEventWith(egret.TouchEvent.TOUCH_END));break;case i.UP:this.card_bottom.verticalCenter=this.cardStartV+n,this.view_rect.height=this.viewStartH+n/2,this.view_rect.height<this.viewStartH/2&&(this.view_rect.height=this.viewStartH/2,this.card_bottom.verticalCenter=0,this.touchMoveStep=3,this.touch_area.dispatchEventWith(egret.TouchEvent.TOUCH_END))}},e}(t.Component);e.Watch=n,__reflect(n.prototype,"ui.four.Watch")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setScore=function(t){t>=0?(this.resultNum.font="public_win_fnt",this.resultNum.text="+"+util.NumberUtil.formatNumber(t)):(this.resultNum.font="public_lose_fnt",this.resultNum.text=util.NumberUtil.formatNumber(t))},e}(t.Component);e.WinLoseInfo=i,__reflect(i.prototype,"ui.four.WinLoseInfo")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.Match=0]="Match",t[t.Canle=1]="Canle"}(i=e.MatchEnum||(e.MatchEnum={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.btn_auto_match.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.isSelected=e.btn_auto_match.selected},this)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.addToStage=function(){this.btnMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.btn_auto_match.selected?this.autoMatch():(this.btn_auto_match.selected=this.isSelected,this.changeState(i.Match))},e.prototype.removeFromStage=function(){this.btnMatch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.clearInterval()},e.prototype.match=function(){this.sendMatchNotify(),this.removeMyself()},e.prototype.cancleMatch=function(){this.clearInterval(),this.btn_auto_match.selected=!1,this.changeState(i.Match)},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e.prototype.autoMatch=function(){var t=this,e=5,n=function(e){e>0?t.lbCount.text=util.LanguageUtil.translate("lbl_game_willmatch",e):(t.clearInterval(),t.parent&&t.parent.removeChild(t),t.match())};this.changeState(i.Canle),n(e--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(e--)},1e3)},e.prototype.changeState=function(t){this.type=t===i.Match?"match":"cancel",!this.visible&&(this.visible=!0)},e}(t.Component);e.AutoMatch=n,__reflect(n.prototype,"ui.four.AutoMatch")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setMultNumber=function(t){this.mult=t,this.btn.labelDisplay.text=""+t},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},e.prototype.onAddStage=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},e.prototype.onRemoveStage=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},e.prototype.onTouch=function(){this.dispatchEventWith(e.EVT_SEND_MULT,!0,this.mult)},e.EVT_SEND_MULT="evt_send_mult",e}(t.Component);e.MultButton=i,__reflect(i.prototype,"ui.four.MultButton")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.btns=[],e._sendRaise=function(t){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_RAISE,{my_position:e.my_position,rate:t.data})},e}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btns=[this.btn1,this.btn2,this.btn3,this.btn4,this.btn5]},i.prototype.onAddStage=function(){this.once(e.MultButton.EVT_SEND_MULT,this.sendRaise,this)},i.prototype.onRemoveStage=function(){this.removeEventListener(e.MultButton.EVT_SEND_MULT,this.sendRaise,this)},i.prototype.init=function(t,e,i,n){void 0===t&&(t=[1,4,8,11,15]);var o=Math.min.apply(Math,t);this.my_position=n,this.btns.forEach(function(n,r){var s=t[r];n.setMultNumber(s),new Decimal(e).mul(s).mul(i).gte(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance)&&s!==o?(n.enabled=!1,n.filters=[Const.grayFilter]):(n.enabled=!0,n.filters=null)}),this.visible=!0},i.prototype.sendRaise=function(t){this.removeMyself(),this._sendRaise(t)},i.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},i}(t.Component);e.MultButtons=i,__reflect(i.prototype,"ui.four.MultButtons")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(i){var n=e.call(this)||this;n.pokers=[],n.parent_container=i;for(var o=1;24>=o;o++){var r=new t.bull.PokerAniUI;r.visible=!1,n.parent_container.addChild(r),n.pokers.push(r)}return n}return __extends(i,e),i.prototype.isSending=function(){return this.pokers[0].visible},i.prototype.flyCard=function(t,e,i,n){var o=this;return new Promise(function(r){for(var s=(t-1)*n,a=t*n-1,l=o.parent_container.globalToLocal(e.x,e.y),u=0,h=1===n?"ksz_fapai_mp3":"nn_sendcard_mp3",c=function(){return util.SoundUtil.play(h)},p=function(t){egret.Tween.get(o.pokers[t]).wait(u).set({x:0,y:0,scaleX:1,scaleY:1,visible:!0}).call(c).to({x:l.x,y:l.y,scaleX:i.width/o.pokers[t].width,scaleY:i.height/o.pokers[t].height},200).call(function(){t===a&&r()}),u+=50},_=s;a>=_;_++)p(_)})},i.prototype.hidePoker=function(t){if(t)for(var e=4*(t-1),i=4*t-1,n=e;i>=n;n++)this.pokers[n].visible=!1;else this.pokers.forEach(function(t){t.visible=!1})},i.prototype.hide2edPoker=function(){for(var t=0;6>t;t++)this.pokers[t].visible=!1},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.four.PokerAni")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._sendDispute=function(e){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DISPUTE,{my_position:t.my_position,rate:e.data}),t.removeMyself()},t}return __extends(i,e),i.prototype.getCurrentState=function(){return Main.instance.orientation},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.invalidateState(),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.invalidateState,this)},i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},i.prototype.onAddStage=function(){this.once(t.MultButton.EVT_SEND_MULT,this._sendDispute,this),this.btnCancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.giveup,this)},i.prototype.onRemoveStage=function(){this.removeEventListener(t.MultButton.EVT_SEND_MULT,this._sendDispute,this),this.btnCancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.giveup,this)},i.prototype.giveup=function(){this._sendDispute({data:-1})},i.prototype.init=function(t,e){this.btn1.setMultNumber(t[1]),this.btn2.setMultNumber(t[2]),this.btn3.setMultNumber(t[3]),this.my_position=e},i.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},i}(eui.Component);t.SnatchMultButtons=e,__reflect(e.prototype,"ui.four.SnatchMultButtons")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},e.prototype.onAddStage=function(){this.btnMi.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendWatchEvt,this),this.btnOpen.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendResult,this)},e.prototype.onRemoveStage=function(){this.btnMi.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendWatchEvt,this),this.btnOpen.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendResult,this)},e.prototype.sendWatchEvt=function(){this.removeMyself(),this.WatchCall&&this.WatchCall()},e.prototype.setCall=function(t){this.WatchCall=t},e.prototype.sendResult=function(){this.removeMyself(),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_DONE)},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e}(t.Component);e.WatchButtons=i,__reflect(i.prototype,"ui.four.WatchButtons")}(e=t.four||(t.four={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.betBtnList=[],t.clickLightList=[],t.winLightList=[],t.winEffList=[],t.betLabelBgList=[],t.betLabelList=[],t.betLbY=[],t.ALL_TYPE=["fixed_123","fixed_456","great","equal","less","1","2","3","4","5","6","combination_1_2","combination_1_3","combination_1_4","combination_1_5","combination_1_6","combination_2_3","combination_2_4","combination_2_5","combination_2_6","combination_3_4","combination_3_5","combination_3_6","combination_4_5","combination_4_6","combination_5_6","less_1","less_2","less_3","less_4","less_5","less_6","great_3","great_4","great_5","great_6"],t.timerArr=[],t.oldBetAreaIndex=-1,t.shot=function(e){egret.callLater(function(){egret.callLater(function(){var i=new egret.RenderTexture;i.drawToTexture(e),t.img_shot.source=i},t)},t)},t}return __extends(i,e),i.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.languageArea.addEventListener(egret.Event.RESIZE,function(){return t.shot(t.languageArea)},this),this.languageArea.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return t.shot(t.languageArea)},this),this.shot(this.languageArea)},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.betBtnArea.$children.forEach(function(e,i){var n=new t.component.ChipStacked(.8),o=new t.component.ChipStacked(.8);n.name="other",o.name="own",n.left=o.right=1;var r=0;r=5>i?-38:11>i?-18:-22,n.verticalCenter=o.verticalCenter=r,e.addChild(n),e.addChild(o)})},i.prototype.init=function(){var t=this.betBtnArea.numChildren;this.betBtnList.length=0;for(var e=0;t>e;e++){var i=this.betBtnArea.getChildAt(e);this.betBtnList.push(i);var n=i.getChildAt(0),o=i.getChildAt(1),r=i.getChildAt(2),s=this.gp_lb.getChildAt(e).getChildByName("img_bet_bg"),a=this.gp_lb.getChildAt(e).getChildByName("lb_bet");this.show(n,!1),this.show(o,!1),r.clearWinEff(),this.show(s,!1),this.show(a,!1),this.clickLightList.push(n),this.winLightList.push(o),this.winEffList.push(r),this.betLabelBgList.push(s),this.betLabelList.push(a),this.betLbY.push(a.y)}this.addEvent()},i.prototype.resetBetAreaUI=function(){var t=this;this.removeTw(),this.initChips(),this.betBtnList.forEach(function(e,i){t.winLightList[i].visible=!1,t.betLabelBgList[i].visible=!1,t.betLabelList[i].visible=!1,t.winEffList[i].clearWinEff()})},i.prototype.initChips=function(){this.betBtnArea.$children.forEach(function(t){["own","other"].forEach(function(e){t.getChildByName(e).initChips()})})},i.prototype.addEvent=function(){var t=this;this.betBtnList.forEach(function(e,i){e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.btnTouchBegin,t),e.removeEventListener(egret.TouchEvent.TOUCH_END,t.btnTouchEnd,t),e.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.btnTouchOutside,t)}),this.betBtnList.forEach(function(e,i){e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.btnTouchBegin,t),e.addEventListener(egret.TouchEvent.TOUCH_END,t.btnTouchEnd,t),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.btnTouchOutside,t)})},i.prototype.btnTouchBegin=function(t){this.betBtnList[0]&&this.betBtnList[0].touchEnabled&&this.showClickLight(t.currentTarget)},i.prototype.btnTouchEnd=function(t){this.btnTouchOutside(t),this.btnTouchTap(t)},i.prototype.btnTouchOutside=function(t){this.showClickLight(t.currentTarget,!1)},i.prototype.btnTouchTap=function(t){if(this.betBtnList[0]&&this.betBtnList[0].touchEnabled){var e=this.betBtnList.indexOf(t.currentTarget),n=this.ALL_TYPE[e];-1!==e&&this.dispatchEventWith(i.EVT_BET,!1,{type:n,index:e})}else this.dispatchEventWith(i.EVT_SHOW_TIP)},i.prototype.showClickLight=function(t,e){void 0===e&&(e=!0);var i=this.betBtnList.indexOf(t);if(-1!==i){var n=this.clickLightList[i];this.show(n,e)}},i.prototype.showWinLight=function(t){var e=this,i=[],n=[];t.forEach(function(t){i.push(e.winLightList[t]),n.push(e.winEffList[t])}),this.timerArr.forEach(function(t){util.TimeUtil.clearTimeout(t)}),i.forEach(function(t){t&&(t.visible=!0)}),n.forEach(function(t){t&&t.startWinEff()})},i.prototype.show=function(t,e){void 0===e&&(e=!0),t.visible=e},i.prototype.setEnable=function(t){this.betBtnList.forEach(function(e){e.touchEnabled=!!t})},i.prototype.updateAreaBetNumber=function(t,e,i){var n=this;void 0===e&&(e=!1),void 0===i&&(i=0),Object.keys(t).forEach(function(o){var r=n.ALL_TYPE.indexOf(o);if(t[o]<=0?(n.betLabelBgList[r].visible=!1,n.betLabelList[r].visible=!1):(n.betLabelBgList[r].visible=!0,n.betLabelList[r].visible=!0),n.betLabelList[r].text=util.NumberUtil.formatNumber(t[o]),e&&-1!==i){var s=n.betLabelList[i],a=n.betLbY[i];s.y=a,egret.Tween.removeTweens(s),egret.Tween.get(s).to({y:a-10},70).to({y:a},50)}})},i.prototype.flyChip=function(e,i,n,o,r,s){var a=this;return void 0===o&&(o=!0),void 0===r&&(r=1),new Promise(function(l){var u=a.betBtnArea.getChildAt(n).getChildByName(1===r||3===r?"own":"other"),h=u.getFlyChipGlobalPos(),c=i.localToGlobal();e.x=c.x,e.y=c.y,e.scaleX=.5,e.scaleY=.5;var p=a.chipArea.globalToLocal(c.x,c.y);e.x=p.x,e.y=p.y,a.chipArea.addChild(e);var _=function(){t.component.SChip.returnChip(e),u.addChip(e.value,e.type),s&&s(),l(void 0)};if(o){var d=a.chipArea.globalToLocal(h.x,h.y);egret.Tween.get(e).to({x:d.x,y:d.y,scaleX:.8,scaleY:.8},4===r?50*util.NumberUtil.getRandom(6,8):50*util.NumberUtil.getRandom(4,10),egret.Ease.sineOut).call(function(){return _()})}else _()})},i.prototype.flyChips=function(e,i,n){var o=this,r=!1;this.betBtnArea.$children.forEach(function(s){var a=s.getChildByName(n);if(a.cur_show_num>0){var l=a.getCopyImg(o.chipArea);a.initChips();var u=void 0;"own"===n?u=e.localToGlobal():(u=i.localToGlobal(),u.x+=i.width/2,u.y+=i.height/2);var h=o.chipArea.globalToLocal(u.x,u.y);r||(r=!0,util.SoundUtil.play("payout_chips_mp3")),egret.Tween.get(l).to({x:h.x,y:h.y,scaleX:.5,scaleY:.5},500,egret.Ease.sineIn).call(function(){return t.component.ChipStacked.returnImg(l)})}})},i.prototype.removeTw=function(){this.chipArea.$children.forEach(function(e){egret.Tween.removeTweens(e),e.scaleX=e.scaleY=1,e instanceof t.component.SChip?t.component.SChip.returnChip(e):e instanceof eui.Image&&t.component.ChipStacked.returnImg(e)})},i.prototype.removeSomeChips=function(t){var e=this;t.forEach(function(t){var i=e.betBtnArea.getChildAt(t);["own","other"].forEach(function(t){i.getChildByName(t).initChips()}),e.betLabelBgList[t].visible=!1,e.betLabelList[t].visible=!1})},i.EVT_BET="evt_bet",i.EVT_SHOW_TIP="evt_show_tip",i}(t.Component);e.BetArea=i,__reflect(i.prototype,"ui.hilo.BetArea")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return egret.Tween.removeTweens(e.img_light)},this)},e.prototype.show=function(t){this.currentState=t,this.showLight()},e.prototype.showLight=function(){egret.Tween.removeTweens(this.img_light),this.img_light.scaleX=.3,egret.Tween.get(this.img_light,{loop:!0}).to({scaleX:2},300).to({scaleX:1},150).to({scaleX:.3},100)},e}(t.Component);e.BetHint=i,__reflect(i.prototype,"ui.hilo.BetHint")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.initRoadMap(),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return e.resize()},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.roadMapScroller.stopAnimation()},this)},e.prototype.setRoadMapBlink=function(t){this.com_roadMap.is_blink=t},e.prototype.setChips=function(t){this.com_chipList.setChips(t)},e.prototype.setHead=function(t){this.com_head.setHead(t)},e.prototype.setName=function(t){this.com_head.setName(t)},e.prototype.setBalance=function(t){this.com_head.setBalance(t)},e.prototype.setSurplus=function(t){0===t?this.com_head.showSurplus(!1):this.com_head.showSurplus(!0,t)},e.prototype.updatePeople=function(t){this.btn_people.label=t.toString()},e.prototype.getOwnPos=function(){var t=this.com_head.localToGlobal();return{x:t.x+64,y:t.y+64}},e.prototype.getOtherPos=function(){var t=this.btn_people.localToGlobal();return{x:t.x+this.btn_people.width/2,y:t.y+this.btn_people.height/2}},e.prototype.showSurplus=function(t,e){this.com_head.showSurplus(t,e)},e.prototype.getCurChipValue=function(){return this.com_chipList.cur_chosen_item.value},e.prototype.showWin=function(t){this.com_head.showWin(t)},e.prototype.setRoadMap=function(t){this.road_map=t,this.resetScrollerPos()},e.prototype.updateEnable=function(t){this.com_chipList.updateEnable(t)},e.prototype.betAni=function(t){if(t){var e=this.currentState===egret.OrientationMode.LANDSCAPE?0:22.67;this.com_head.verticalCenter=e,egret.Tween.get(this.com_head).to({verticalCenter:e-15},80,egret.Ease.quadOut).to({verticalCenter:e},80,egret.Ease.quadIn)}else{var e=26;this.btn_people.bottom=e,egret.Tween.get(this.btn_people).to({bottom:e+15},80,egret.Ease.quadOut).to({bottom:e},80,egret.Ease.quadIn)}},e.prototype.initRoadMap=function(){util.LogUtil.debug("initRoadMap------------------")},e.prototype.resetScrollerPos=function(){this.validateNow(),this.roadMapScroller.viewport.contentWidth>this.roadMapScroller.viewport.width?this.roadMapScroller.viewport.scrollH=this.roadMapScroller.viewport.contentWidth-this.roadMapScroller.viewport.width:this.roadMapScroller.viewport.scrollH=0,this.com_roadMap.shot()},e.prototype.resize=function(){var t=this;egret.callLater(function(){egret.callLater(function(){t.validateNow(),t.roadMapScroller.viewport.contentWidth>t.roadMapScroller.viewport.width?t.roadMapScroller.viewport.scrollH=t.roadMapScroller.viewport.contentWidth-t.roadMapScroller.viewport.width:t.roadMapScroller.viewport.scrollH=0,t.com_roadMap.shot()},t)},this)},e}(t.Component);e.BottomPanel=i,__reflect(i.prototype,"ui.hilo.BottomPanel")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(t,e){var i=this;void 0===e&&(e=!1),this.clearTimer(),util.SoundUtil.destroy(["brnn_stopbet_mp3"]);var n=t-util.TimeUtil.now;n>0&&(this.timer=util.TimeUtil.setInterval(function(){var n=t-util.TimeUtil.now;if(n>=0){i.visible=!0;var o=i.lab_count.text!==Math.round(n/1e3).toString();if(i.lab_count.text=Math.round(n/1e3).toString(),o&&util.SoundUtil.play("time_mp3"),(3===Math.round(n/1e3)||2===Math.round(n/1e3)||1===Math.round(n/1e3))&&e&&o){var r=20,s=18;util.SoundUtil.play("WarningtimeOver_mp3"),egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,egret.Tween.get(i.img_bg,{loop:!0}).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).wait(60)}}else egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,i.visible=!1,i.lab_count.text="0",i.clearTimer()},100))},e.prototype.clearTimer=function(){null!=this.timer&&(util.TimeUtil.clearInterval(this.timer),this.timer=null,egret.Tween.removeTweens(this.img_bg)),this.visible=!1,this.img_bg.rotation=0},e}(t.Component);e.CountDown=i,__reflect(i.prototype,"ui.hilo.CountDown")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(topic.RoomItemData);e.RoomItemData=i,__reflect(i.prototype,"ui.hilo.RoomItemData");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,e.data.room_id)},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.bgLight.visible=!0,e.gp_item.scaleX=e.gp_item.scaleY=.95},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.bgLight.visible=!1,e.gp_item.scaleX=e.gp_item.scaleY=1},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){e.bgLight.visible=!1,e.gp_item.scaleX=e.gp_item.scaleY=1},this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){e.bgLight.visible=!1,e.gp_item.scaleX=e.gp_item.scaleY=1},this),this.addEventListener(egret.Event.RESIZE,this.resize,this)},e.prototype.resize=function(){this.gp_item.width=75*Math.floor((this.width-40)/75)+40
},e}(t.ItemRenderer);e.DeskListItem=n,__reflect(n.prototype,"ui.hilo.DeskListItem")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.road_data=new eui.ArrayCollection,e._col=50,e.shot=function(){egret.callLater(function(){egret.callLater(function(){e.gp_shots.$children.forEach(function(t){return t.source=null});for(var t=e.dataArea.height,i=2e3,n=e.dataArea.width/i<<0,o=0;n>o;o++){var r=e.getShotsImg(o),s=new egret.RenderTexture,a=new egret.Rectangle(i*o,0,i*(o+1),t);s.drawToTexture(e.dataArea,a),r.source=s}var l=e.getShotsImg(n),u=new egret.RenderTexture;u.drawToTexture(e.dataArea,new egret.Rectangle(n*i,0,e.dataArea.width,t)),l.source=u},e)},e)},e}return __extends(e,t),Object.defineProperty(e.prototype,"is_blink",{get:function(){return this._is_blink},set:function(t){this._is_blink=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"road_map_data",{get:function(){return this._road_map_data},set:function(t){this._road_map_data=t,this.updateDataGroup(this.road_map_data,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_height",{get:function(){return this._mark_height},set:function(t){this._mark_height=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_width",{get:function(){return this._mark_width},set:function(t){this._mark_width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t,this.updateDataGroup(this.road_map_data,!1)},enumerable:!0,configurable:!0}),e.prototype.updateDataGroup=function(t,e){if(t&&!util.ObjectUtil.isEmpty(t)){var i,n,o,r=util.ObjectUtil.copy(t).slice(t.length<=this.col?0:t.length-this.col),s=[];r.forEach(function(t){"l"===t[0]?(o=util.LanguageUtil.translate("lbl_game_small2"),i=1592594,n=16734553):"g"===t[0]?(o=util.LanguageUtil.translate("lbl_game_big2"),i=4960155,n=0):(o=util.LanguageUtil.translate("lbl_game_eleven2"),i=1592594,n=16734553);var e=[Number(t[1]),Number(t[2]),Number(t[3])];e.sort(function(t,e){return t-e}),s.push({result:o,value1:String(e[0]),value2:String(e[1]),value3:String(e[2]),alpha:1,strokeColor:i,color:n})}),util.LogUtil.debug("------DeskRoadMap----",s),this.road_data.replaceAll(s),this.road_data.refresh(),s.length?(this.shot(),e?this.blink():this.img_ligth.visible=!0):this.img_ligth.visible=!1}},e.prototype.blink=function(){var t=this.img_ligth;egret.Tween.get(t).to({visible:!0},200).to({visible:!1},200).to({visible:!0},200).to({visible:!1},200).call(function(){t.visible=!0})},e.prototype.getShotsImg=function(t){var e;return t>=this.gp_shots.numChildren?(e=new eui.Image,this.gp_shots.addChild(e)):e=this.gp_shots.getChildAt(t),e},e}(eui.Component);t.DeskRoadMap=e,__reflect(e.prototype,"ui.hilo.DeskRoadMap")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allStyleList=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"pointVal1",{get:function(){return this._pointVal1},set:function(t){this._pointVal1=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointVal2",{get:function(){return this._pointVal2},set:function(t){this._pointVal2=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointVal3",{get:function(){return this._pointVal3},set:function(t){this._pointVal3=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointImageVal",{get:function(){return this._pointImageVal},set:function(t){this._pointImageVal=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.style_1.visible=!0,this.o_x=this.cover.x,this.o_y=this.cover.y},e.prototype.init=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.cover),egret.Tween.removeTweens(this.addResultValueToGroup),this.resultValueGroup.visible=!1,this.resultValueArea.removeChildren(),this.cover.alpha=1,this.cover.rotation=0,this.verticalCenter=-496.5,this.cover.x=this.o_x,this.cover.y=this.o_y,this.scaleX=.28,this.scaleY=.28,this.winLight.visible=!1},e.prototype.updateDicePoint=function(t){if(t){this.resultValueArea.removeChildren(),util.LogUtil.debug("--data---",t),this.pointVal1=t[0],this.pointVal2=t[1],this.pointVal3=t[2],this.allStyleList=[this.style_1,this.style_2,this.style_3,this.style_4,this.style_5],this.allStyleList.forEach(function(t){t.visible=!1});var e=this.randStyleIndex();this.allStyleList[e].visible=!0;var i=Number(t[0])+Number(t[1])+Number(t[2]);this.addResultValueToGroup(i),11===i?this.pointImageVal="11":i>11?this.pointImageVal="big":11>i&&(this.pointImageVal="small")}},e.prototype.runOpenAni=function(t,e){var i=this;void 0===e&&(e=!0),egret.Tween.removeTweens(this.cover),this.cover.rotation=0,this.winLight.visible=!0;var n=this.cover,o=this.o_x+60,r=this.o_y-110;e?egret.Tween.get(n).wait(200).call(function(){util.SoundUtil.play("dakai_mp3")}).to({y:r+62,rotation:12},500).to({y:r,x:o,rotation:25},1300).call(function(){i.actionResult()}).to({x:this.width+n.width/2,y:0,alpha:0,rotation:45},500).call(function(){util.SoundUtil.play("hi_jieguo_mp3"),t&&t()}):(n.x=this.width+n.width/2,n.y=0,n.alpha=0,n.rotation=45,this.scaleX=1,this.scaleY=1,t&&t(),this.resultValueArea.removeChildren())},e.prototype.runOpenAni2=function(t){var e=this;egret.Tween.removeTweens(this.cover),this.resultValueGroup.visible=!1,this.resultValueGroup.verticalCenter=54,this.resultValueArea.removeChildren();var i=this.cover;1===this.scaleX&&(i.x=this.width+i.width/2,i.y=0,i.alpha=0,i.rotation=45),egret.Tween.get(i).to({x:this.o_x,y:this.o_y,alpha:1,rotation:0},1e3).call(function(){e.winLight.visible=!1,egret.Tween.get(e).to({verticalCenter:-496.5,scaleX:.28,scaleY:.28},500).call(function(){t&&t()})})},e.prototype.resetDiceCup=function(){egret.Tween.get(this.cover).to({x:this.o_x,y:this.o_y,alpha:1,rotation:0}),egret.Tween.get(this).to({verticalCenter:-496.5,scaleX:.28,scaleY:.28})},e.prototype.centerState=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.cover),egret.Tween.removeTweens(this.addResultValueToGroup),this.resultValueGroup.visible=!1,this.resultValueArea.removeChildren(),this.cover.alpha=0,this.cover.rotation=45,this.verticalCenter=-100,this.cover.x=this.width+this.cover.width/2,this.cover.y=0,this.scaleX=1,this.scaleY=1,this.winLight.visible=!1},e.prototype.randStyleIndex=function(){var t=Math.round(4*Math.random());return t},e.prototype.addResultValueToGroup=function(t){var e=this,i=String(t),n=i.split("");n.forEach(function(t){var i=new eui.Image("hilo_points_sheet_json#"+t);e.resultValueArea.addChild(i)})},e.prototype.actionResult=function(){var t=this;this.resultValueGroup.visible=!0,egret.Tween.get(this.resultValueGroup).to({verticalCenter:-150},250).wait(1100).call(function(){t.resultValueGroup.visible=!1,t.resultValueGroup.verticalCenter=54,t.resultValueArea.removeChildren()})},e}(t.Component);e.DiceCup=i,__reflect(i.prototype,"ui.hilo.DiceCup")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.CasinoDeskTopic=e,__reflect(e.prototype,"topic.CasinoDeskTopic"),function(t){t.fight_schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{fight:{additionalProperties:!1,patternProperties:{"^[1-6]+$":{properties:{cards:{items:{type:"number"},type:"array"},is_done:{type:"boolean"},odds:{type:"number"},type:{type:"string"}},required:["is_done","cards","odds","type"],type:"object"}},type:"object"},raise:{additionalProperties:!1,patternProperties:{"^[1-6]+$":{properties:{is_done:{type:"boolean"},raise_rate:{type:"number"}},required:["is_done","raise_rate"],type:"object"}},type:"object"},settle:{additionalProperties:!1,patternProperties:{"^[1-6]+$":{properties:{surplus:{type:"number"}},required:["surplus"],type:"object"}},type:"object"},stage:{"enum":["FIGHT","NONE","RAISE","SETTLE"],type:"string"},user_info:{additionalProperties:!1,patternProperties:{"^[1-6]+$":{properties:{avatar:{type:"string"},balance:{decimal:!0},position:{type:"string"},user_id:{type:"string"},username:{type:"string"}},required:[],type:"object"}},type:"object"}},required:["fight","raise","settle","stage","user_info"],type:"object"}},required:["snapshot"],type:"object"},t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{fight:{additionalProperties:!1,patternProperties:{"^[1-6]+$":{properties:{cards:{items:{type:"number"},type:"array"},is_done:{type:"boolean"},odds:{type:"number"},type:{type:"string"}},required:["is_done"],type:"object"}},type:"object"},raise:{additionalProperties:!1,patternProperties:{"^[1-6]+$":{properties:{is_done:{type:"boolean"},raise_rate:{type:"number"}},required:["is_done","raise_rate"],type:"object"}},type:"object"},settle:{additionalProperties:!1,patternProperties:{"^[1-6]+$":{properties:{surplus:{type:"number"}},required:["surplus"],type:"object"}},type:"object"},stage:{"enum":["FIGHT","NONE","RAISE","SETTLE"],type:"string"},user_info:{additionalProperties:!1,patternProperties:{"^[1-6]+$":{properties:{avatar:{type:"string"},balance:{decimal:!0},position:{type:"string"},user_id:{type:"string"},username:{type:"string"}},required:[],type:"object"}},type:"object"}},required:["fight","raise","settle","stage","user_info"],type:"object"}},required:["snapshot"],type:"object"}}(e=t.CasinoDeskTopic||(t.CasinoDeskTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this.username=t},e.prototype.setBalance=function(t){util.NumberUtil.tweenNumber(this.lb_balance,t)},e.prototype.setHead=function(t){this.avatar=t},e.prototype.showSurplus=function(t,e){var i=this;if(this.lab_surplus.text="0",t)if(e>0){var n=function(){egret.Tween.removeTweens(i.com_head),i.com_head.verticalCenter=0};this.lab_surplus.font="thirteen_win_fnt",this.lab_sign.font="thirteen_win_fnt",this.lab_sign.text="+",util.SoundUtil.play("win_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,e,1e3),n(),egret.Tween.get(this.com_head).to({verticalCenter:-30},80,egret.Ease.quadOut).to({verticalCenter:0},80,egret.Ease.quadIn).call(n)}else 0>e&&(this.lab_surplus.font="thirteen_lose_fnt",this.lab_sign.font="thirteen_lose_fnt",this.lab_sign.text="-",util.SoundUtil.play("dissapoint_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,Math.abs(e),1e3));this.lab_sign.visible=t,this.lab_surplus.visible=t},e.prototype.showWin=function(t){this.mc_win.visible=t},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.hilo.PlayerFrame")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.road_data=new eui.ArrayCollection,e._col=12,e.inited=!1,e.shot=function(){egret.callLater(function(){egret.callLater(function(){var t=new egret.RenderTexture;t.drawToTexture(e.dataArea),e.img_shot.source=t},e)},e)},e}return __extends(e,t),Object.defineProperty(e.prototype,"is_blink",{get:function(){return this._is_blink},set:function(t){this._is_blink=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"road_map_data",{get:function(){return this._road_map_data},set:function(t){this._road_map_data=t,this.updateDataGroup(this.road_map_data,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_height",{get:function(){return this._mark_height},set:function(t){this._mark_height=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mark_width",{get:function(){return this._mark_width},set:function(t){this._mark_width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.parent&&this.parent.addEventListener(egret.Event.RESIZE,this.resize,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return e.shot()},this)},e.prototype.updateDataGroup=function(t,e){var i=this.getSize();if(util.LogUtil.debug("------updateGroup=====",t),t&&!util.ObjectUtil.isEmpty(t)){var n,o,r,s=util.ObjectUtil.copy(t).slice(t.length<=i?0:t.length-i),a=[];s.forEach(function(t){"l"===t[0]?(r=util.LanguageUtil.translate("lbl_game_small2"),n=1592594,o=16734553):"g"===t[0]?(r=util.LanguageUtil.translate("lbl_game_big2"),n=4960155,o=0):(r=util.LanguageUtil.translate("lbl_game_eleven2"),n=1592594,o=16734553);var e=[Number(t[1]),Number(t[2]),Number(t[3])];e.sort(function(t,e){return t-e}),a.push({result:r,value1:String(e[0]),value2:String(e[1]),value3:String(e[2]),alpha:1,strokeColor:n,color:o,scale:.9,gap:18,lightV:!1})}),this.road_data.replaceAll(a),this.road_data.refresh(),a.length?(this.shot(),e?this.blink():this.img_ligth.visible=!0):this.img_ligth.visible=!1}},e.prototype.blink=function(){var t=this;egret.callLater(function(){var e=t.getChildAt(0).numChildren;if(0!==e){var i=t.img_ligth;egret.Tween.get(i).to({visible:!0},200).to({visible:!1},200).to({visible:!0},200).to({visible:!1},200).call(function(){i.visible=!0})}},this)},e.prototype.resize=function(){return this.inited?void(this.road_map_data&&this.updateDataGroup(this.road_map_data,!1)):void(this.inited=!0)},e.prototype.getSize=function(){return Math.floor(this.parent.width/75)},e}(eui.Component);t.RoadMap=e,__reflect(e.prototype,"ui.hilo.RoadMap")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.DTDeskTopic=e,__reflect(e.prototype,"topic.DTDeskTopic");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.SnapshotBase);t.DTDeskSnapshot=i,__reflect(i.prototype,"topic.DTDeskSnapshot"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{bet:{properties:{dragon:{type:"number"},tie:{type:"number"},tiger:{type:"number"}},required:[],type:"object"},open:{properties:{dragon_card_number:{type:"number"},dragon_index:{type:"number"},tiger_card_number:{type:"number"},tiger_index:{type:"number"},winner:{type:"string"}},type:"object"},player_info:{items:{properties:{avatar:{type:"string"},balance:{decimal:!0},bet:{properties:{dragon:{type:"number"},tie:{type:"number"},tiger:{type:"number"}},required:[],type:"object"},idle:{type:"number"},settle:{properties:{dragon:{type:"object"},tie:{type:"object"},tiger:{type:"object"}},required:[],type:"object"},surplus:{type:"number"},user_id:{type:"string"},username:{type:"string"}},required:["balance","bet","idle","surplus","user_id","username"],type:"object"},type:"array"},round_id:{type:"string"},round_number:{type:"number"},settle:{properties:{dragon:{type:"object"},tie:{type:"object"},tiger:{type:"object"}},required:[],type:"object"},shoe_size:{type:"number"},user_info:{properties:{avatar:{type:"string"},balance:{decimal:!0},bet:{properties:{dragon:{type:"number"},tie:{type:"number"},tiger:{type:"number"}},required:[],type:"object"},idle:{type:"number"},settle:{properties:{dragon:{type:"object"},tie:{type:"object"},tiger:{type:"object"}},required:[],type:"object"},surplus:{type:"number"},user_id:{type:"string"},username:{type:"string"}},required:["balance","bet","idle","surplus","user_id","username"],type:"object"}},required:["bet","player_info","round_id","shoe_size","user_info"],type:"object"}}(i=t.DTDeskSnapshot||(t.DTDeskSnapshot={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.show=function(t){egret.Tween.removeTweens(this),this.alpha=0,this.lab_tip.text=t,egret.Tween.get(this).to({alpha:1},500).wait(1e3).to({alpha:0},500)},e}(t.Component);e.Tip=i,__reflect(i.prototype,"ui.hilo.Tip")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.DTRoadMapTopic=e,__reflect(e.prototype,"topic.DTRoadMapTopic"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{list:{items:{properties:{banker_peek:{properties:{bead_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},big_eye_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},big_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},cockroach_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},small_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"}},required:["bead_road","big_road"],type:"object"},bead_road:{items:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},round_id:{type:"string"},row:{type:"number"}},required:["col","icon","round_id","row"],type:"object"},type:"array"},big_eye_road:{items:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},type:"array"},big_road:{items:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},type:"array"},cockroach_road:{items:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},type:"array"},player_peek:{properties:{bead_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},big_eye_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},big_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},cockroach_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},small_road:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"}},required:["bead_road","big_road"],type:"object"},small_road:{items:{properties:{col:{type:"number"},icon:{items:{type:"string"},type:"array"},row:{type:"number"}},required:["col","icon","row"],type:"object"},type:"array"}},required:["banker_peek","bead_road","big_eye_road","big_road","cockroach_road","player_peek","small_road"],type:"object"},type:"array"}},required:["list"],type:"object"}},required:["snapshot"],type:"object"},t.three_schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{list:{items:{properties:{round_road:{items:{properties:{gate_info:{properties:{1:{properties:{betOn:{"enum":["1","2","3","4","5","6","7","8"],type:"string"},order:{type:"number"},point:{type:"number"},rank:{type:"number"},type:{"enum":["point","public","supreme"],type:"string"}},required:["betOn","order","point","rank","type"],type:"object"},2:{properties:{betOn:{"enum":["1","2","3","4","5","6","7","8"],type:"string"},order:{type:"number"},point:{type:"number"},rank:{type:"number"},type:{"enum":["point","public","supreme"],type:"string"}},required:["betOn","order","point","rank","type"],type:"object"},3:{properties:{betOn:{"enum":["1","2","3","4","5","6","7","8"],type:"string"},order:{type:"number"},point:{type:"number"},rank:{type:"number"},type:{"enum":["point","public","supreme"],type:"string"}},required:["betOn","order","point","rank","type"],type:"object"},4:{properties:{betOn:{"enum":["1","2","3","4","5","6","7","8"],type:"string"},order:{type:"number"},point:{type:"number"},rank:{type:"number"},type:{"enum":["point","public","supreme"],type:"string"}},required:["betOn","order","point","rank","type"],type:"object"},5:{properties:{betOn:{"enum":["1","2","3","4","5","6","7","8"],type:"string"},order:{type:"number"},point:{type:"number"},rank:{type:"number"},type:{"enum":["point","public","supreme"],type:"string"}},required:["betOn","order","point","rank","type"],type:"object"},6:{properties:{betOn:{"enum":["1","2","3","4","5","6","7","8"],type:"string"},order:{type:"number"},point:{type:"number"},rank:{type:"number"},type:{"enum":["point","public","supreme"],type:"string"}},required:["betOn","order","point","rank","type"],type:"object"},7:{properties:{betOn:{"enum":["1","2","3","4","5","6","7","8"],type:"string"},order:{type:"number"},point:{type:"number"},rank:{type:"number"},type:{"enum":["point","public","supreme"],type:"string"}},required:["betOn","order","point","rank","type"],type:"object"},8:{properties:{betOn:{"enum":["1","2","3","4","5","6","7","8"],type:"string"},order:{type:"number"},point:{type:"number"},rank:{type:"number"},type:{"enum":["point","public","supreme"],type:"string"}},required:["betOn","order","point","rank","type"],type:"object"}},required:["1","2","3","4","5","6","7","8"],type:"object"},round_id:{type:"string"}},required:["gate_info","round_id"],type:"object"},type:"array"}},required:["round_road"],type:"object"},type:"array"}},required:["list"],type:"object"}},required:["snapshot"],type:"object"}}(e=t.DTRoadMapTopic||(t.DTRoadMapTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentIndex=0,e.allImage=[],e}return __extends(e,t),e.prototype.startWinEff=function(){var t=this;this.clearWinEff(),this.visible=!0,this.allImage=[this.eff_1,this.eff_2,this.eff_3,this.eff_4],this.timer=util.TimeUtil.setInterval(function(){for(var e=t.currentIndex%4,i=0;4>i;i++)i===e?t.allImage[i].visible=!0:t.allImage[i].visible=!1;t.currentIndex++},70)},e.prototype.clearWinEff=function(){this.visible=!1,this.currentIndex=0,util.TimeUtil.clearInterval(this.timer)},e}(t.WinEff);t.WinEffTwo=e,__reflect(e.prototype,"ui.hilo.WinEffTwo")}(e=t.hilo||(t.hilo={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.chip_pool=[],t.returnChip=function(e,i){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return i?[4,i(e)]:[3,2];case 1:return t.sent()?[2]:[3,3];case 2:egret.Tween.removeTweens(e),t.label=3;case 3:return e.free=!0,e.parent&&e.parent.removeChild(e),[2]}})})},t.returnAllChips=function(e){return Promise.all(t.chip_pool.map(function(i){return!i.free&&t.returnChip(i,e)}))},t}return __extends(i,e),i.prototype.getOneChip=function(e){var i;return this.chip_pool.some(function(t){return t.free&&(i=t),t.free})||(i=new t.SChip,this.chip_pool.push(i)),i.free=!1,i.value=e,i.type=(Const.Config.CHIP_VALUES.indexOf(Number(e))+1).toString(),i},i}(eui.Component);t.AniChips=e,__reflect(e.prototype,"ui.horoscope.AniChips")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.com_pokerlist.is_banker=!0},e.prototype.getPokerList=function(){return this.com_pokerlist},e}(t.Component);e.BankerFrame=i,__reflect(i.prototype,"ui.horoscope.BankerFrame")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e[1]=0,e[2]=1,e[3]=2,e[4]=3,e.ALL_TYPE=["1","2","3","4"],e.road_tian=new eui.ArrayCollection,e.road_di=new eui.ArrayCollection,e.road_xuan=new eui.ArrayCollection,e.road_huang=new eui.ArrayCollection,e.roads=[],e.road_col=10,e}return __extends(e,t),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this.roads=[this.road_tian,this.road_di,this.road_xuan,this.road_huang],this.btns=[this.btn_tian,this.btn_di,this.btn_xuan,this.btn_huang],this.results=[this.img_tian,this.img_di,this.img_xuan,this.img_huang],this.hovers=[this.img_tianbg,this.img_dibg,this.img_xuanbg,this.img_huangbg],this.owns=[this.lab_tian_own,this.lab_di_own,this.lab_xuan_own,this.lab_huang_own],this.alls=[this.lab_tian_all,this.lab_di_all,this.lab_xuan_all,this.lab_huang_all],this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.btns[0].enabled||i.dispatchEventWith(e.EVT_SHOW_TIP)},this),this.ALL_TYPE.forEach(function(t){var e=i[t];i.btns[e].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.onBet(t)},i),i.btns[e].addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){i.hovers[e].visible=!0},i),i.btns[e].addEventListener(egret.TouchEvent.TOUCH_END,function(){i.hovers[e].visible=!1},i),i.btns[e].addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){i.hovers[e].visible=!1},i),mouse.setButtonMode(i.btns[e],!0)}),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return i.stopBlink()},this),this.init()},e.prototype.init=function(){var t=this;this.ALL_TYPE.forEach(function(e){var i=t[e];egret.Tween.removeTweens(t.results[i]),t.results[i].visible=!1})},e.prototype.showResult=function(t){var e=this;this.init(),t.forEach(function(t){var i=e[t];egret.Tween.get(e.results[i],{loop:!0}).set({visible:!0}).wait(400).set({visible:!1}).wait(400)})},e.prototype.onBet=function(t){this.dispatchEventWith(e.EVT_BET,!1,t)},e.prototype.updateBet=function(t,e){var i=this;Object.keys(t).forEach(function(n){var o=i[n];e?i.owns[o].text=util.NumberUtil.formatUnit(t[n]):i.alls[o].text=util.NumberUtil.formatUnit(t[n])})},e.prototype.updateRoadmap=function(t,e){if(void 0===e&&(e=!1),t){var i=util.ObjectUtil.copy(t).slice(t.length<=this.road_col?0:t.length-this.road_col),n=[],o=[],r=[],s=[],a=[n,o,r,s];i.forEach(function(t){t.forEach(function(t,e){var i=a[e];i.push({suffix:"win"===t?"1":"lose"===t?"2":"3",alpha:1})})}),this.roads.forEach(function(t,e){t.replaceAll(a[e]),t.refresh()}),!e&&this.blink()}},e.prototype.blink=function(){var t=200,e=function(e,i){return e.to({alpha:i?1:0},t)};this.roads.forEach(function(t,i){var n=t.getItemAt(t.length-1);egret.Tween.removeTweens(n);var o=egret.Tween.get(n);Array.apply(void 0,Array(3)).forEach(function(){e(o,!1),e(o,!0)})})},e.prototype.stopBlink=function(){this.roads.forEach(function(t,e){for(var i=0,n=t.length;n>i;i++){var o=t.getItemAt(i);egret.Tween.removeTweens(o),o.alpha=1}})},e.prototype.setEnable=function(t){var e=this;this.ALL_TYPE.forEach(function(i){var n=e[i];e.btns[n].enabled=t,e.hovers[n].visible=!1})},e.EVT_BET="evt_bet",e.EVT_SHOW_TIP="evt_show_tip",e}(t.Component);e.BetArea=i,__reflect(i.prototype,"ui.horoscope.BetArea")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setChips=function(t){this.com_chipList.setChips(t)},e.prototype.setHead=function(t){this.com_head.setHead(t)},e.prototype.setName=function(t){this.com_head.setName(t)},e.prototype.setBalance=function(t){this.com_head.setBalance(t)},e.prototype.setSurplus=function(t){0===t?this.com_head.showSurplus(!1):this.com_head.showSurplus(!0,t)},e.prototype.getOwnPos=function(){var t=this.com_head.localToGlobal();return{x:t.x+64,y:t.y+64}},e.prototype.showSurplus=function(t,e){this.com_head.showSurplus(t,e)},e.prototype.getCurChipValue=function(){return this.com_chipList.cur_chosen_item.value},e.prototype.showWin=function(t){this.com_head.showWin(t)},e.prototype.updateEnable=function(t){this.com_chipList.updateEnable(t)},e.prototype.betAni=function(t){if(t){var e=0;this.com_head.verticalCenter=e,egret.Tween.get(this.com_head).to({verticalCenter:e-15},80,egret.Ease.quadOut).to({verticalCenter:e},80,egret.Ease.quadIn)}},e.EVT_TOGGLE_PEOPLE="evt_open_people",e}(t.Component);e.BottomPanel=i,__reflect(i.prototype,"ui.horoscope.BottomPanel")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"free",{get:function(){return this._free},set:function(t){this._free=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target||this.parent},set:function(t){this._target=t},enumerable:!0,configurable:!0}),e}(t.component.SChip);e.SChip=i,__reflect(i.prototype,"ui.horoscope.SChip")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(t,e){var i=this;void 0===e&&(e=!1),this.clearTimer(),util.SoundUtil.destroy(["brnn_stopbet_mp3"]);var n=t-util.TimeUtil.now;n>0&&(this.timer=util.TimeUtil.setInterval(function(){var n=t-util.TimeUtil.now;if(n>=0){i.visible=!0;var o=i.lab_count.text!==Math.round(n/1e3).toString();if(i.lab_count.text=Math.round(n/1e3).toString(),o&&util.SoundUtil.play("time_mp3"),(3===Math.round(n/1e3)||2===Math.round(n/1e3)||1===Math.round(n/1e3))&&e&&o){var r=20,s=18;util.SoundUtil.play("WarningtimeOver_mp3"),egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,egret.Tween.get(i.img_bg,{loop:!0}).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).wait(60)}}else egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,i.visible=!1,i.lab_count.text="0",i.clearTimer()},100))},e.prototype.clearTimer=function(){null!=this.timer&&(util.TimeUtil.clearInterval(this.timer),this.timer=null,this.visible=!1,egret.Tween.removeTweens(this.img_bg),this.img_bg.rotation=0)},e}(t.Component);e.CountDown=i,__reflect(i.prototype,"ui.horoscope.CountDown")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);t.DTDeskSettingData=e,__reflect(e.prototype,"topic.DTDeskSettingData")}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this.username=t},e.prototype.setBalance=function(t){util.NumberUtil.tweenNumber(this.lb_balance,t)},e.prototype.setHead=function(t){this.avatar=t},e.prototype.showSurplus=function(t,e){var i=this;if(this.lab_surplus.text="0",t)if(e>0){var n=function(){egret.Tween.removeTweens(i.com_head),i.com_head.verticalCenter=0};this.lab_surplus.font="bc_font_win_money_fnt",this.lab_sign.font="bc_font_win_money_fnt",this.lab_sign.text="+",util.SoundUtil.play("win_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,e,1e3),n(),egret.Tween.get(this.com_head).to({verticalCenter:-30},80,egret.Ease.quadOut).to({verticalCenter:0},80,egret.Ease.quadIn).call(n)}else 0>e&&(this.lab_surplus.font="bc_font_lose_money_fnt",this.lab_sign.font="bc_font_lose_money_fnt",this.lab_sign.text="-",util.SoundUtil.play("dissapoint_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,Math.abs(e),1e3));this.lab_sign.visible=t,this.lab_surplus.visible=t},e.prototype.showWin=function(t){this.mc_win.visible=t
},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.horoscope.PlayerFrame")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(i){var n=t.call(this)||this;n.pokers=[],n.parent_container=i;for(var o=35;o>=1;o--){var r=new e.PokerAniUI;r.x=0,r.y=1-o,r.visible=!1,n.parent_container.addChild(r),n.pokers.push(r)}return n.pokers=n.pokers.reverse(),n}return __extends(i,t),i.prototype.init=function(){for(var t=1;35>=t;t++){var e=this.pokers[t-1];egret.Tween.removeTweens(e),e.x=0,e.y=1-t,e.visible=!0}},i.prototype.shuffle=function(){util.SoundUtil.play("fp_mp3");for(var t=1;35>=t;t++){var e=this.pokers[t-1];egret.Tween.removeTweens(e),e.x=0,e.y=1-t,e.visible=!0;var i=util.NumberUtil.getRandom(-1,1),n=util.NumberUtil.getRandom(-1,1),o=util.NumberUtil.getRandom(60,80),r=util.NumberUtil.getRandom(60,80),s=e.x,a=e.y;egret.Tween.get(e).to({x:i*o,y:a+5*n},200).to({x:s,y:a},200).to({x:n*o,y:a+5*i},200).to({x:s,y:a},200).to({x:i*r,y:a+5*n},200).to({x:s,y:a},200).to({x:n*o,y:a+5*i},200).to({x:s,y:a},200)}},i.prototype.flyCard=function(t,e){var i=this;return new Promise(function(n){var o=3*t,r=3*(t+1)-1,s=i.parent_container.globalToLocal(e.x,e.y),a=0;util.SoundUtil.play("bet1_mp3");for(var l=function(t){egret.Tween.get(i.pokers[t]).wait(a).set({x:0,y:1-t}).to({x:s.x,y:s.y},200).call(function(){t===r&&n()}),a+=50},u=o;r>=u;u++)l(u)})},i.prototype.hidePoker=function(t){if(t||0===t)for(var e=3*t,i=3*(t+1)-1,n=e;i>=n;n++)this.pokers[n].visible=!1;else this.pokers.forEach(function(t){t.visible=!1})},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.horoscope.PokerAni")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Component);e.PokerAniUI=i,__reflect(i.prototype,"ui.horoscope.PokerAniUI")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gap=-22,e.result_sound={},e.result_ani={three:["ho_pic_card_type_png","lieng_font_sanjo_png"],straight_flush:["lieng_pic_card_type_bg4_png","ho_font_straightflush_png"],"public":["lieng_pic_card_type_bg3_png","lieng_font_three_facecard_png"],golden_flower:["lieng_pic_card_type_bg2_png","ho_font_flush_png"],straight:["lieng_pic_card_type_bg2_png","lieng_font_straight_png"],point:["lieng_pic_card_type_bg1_png","lieng_font_point_png"]},e._is_banker=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"is_banker",{get:function(){return this._is_banker},set:function(t){this._is_banker=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent()},e.prototype.registerEvent=function(){var t=this;this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){t.stopDealAni()},this)},e.prototype.getTopCardPos=function(){return this.poker_1.localToGlobal()},e.prototype.getPokerSize=function(){return{width:this.poker_1.width,height:this.poker_1.height}},e.prototype.showPoker=function(t){var e=this;[2,3].forEach(function(i){e["poker_"+i].visible=t})},e.prototype.setCards=function(t){for(var e=1;3>=e;e++){var i=this["poker_"+e];i.num=t[e-1],i.turnCard(0)}},e.prototype.setBack=function(){for(var t=1;3>=t;t++){var e=this["poker_"+t];e.currentState="back"}},e.prototype.init=function(){for(var t=1;3>=t;t++){var e=this["poker_"+t];egret.Tween.removeTweens(e),e.scaleX=1,e.scaleY=1}this.setBack(),this.img_bg.visible=!1,this.fnt_point.visible=!1,this.img_type.visible=!1,this.gp_times.visible=!1,egret.Tween.removeTweens(this.img_bg),egret.Tween.removeTweens(this.fnt_point),egret.Tween.removeTweens(this.img_type),this.stopDealAni()},e.prototype.dealCardAni=function(t){var e=this;return void 0===t&&(t=!0),new Promise(function(i){t?egret.Tween.get(e.group_poker.layout).set({gap:-e.poker_1.width}).to({gap:e.gap},200).call(i):e.group_poker.layout.gap=e.gap})},e.prototype.stopDealAni=function(){egret.Tween.removeTweens(this.group_poker.layout),this.group_poker.layout.gap=this.gap},e.prototype.getResultSound=function(t){return this.result_sound[""+t][0]},e.prototype.getResultSoundList=function(){var t=this,e=[];return Object.keys(this.result_sound).forEach(function(i){e=e.concat(t.result_sound[i])}),e},e.prototype.showResult=function(t,e){var i=this;void 0===e&&(e=!0);var n=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},o=t.cards;return this.is_win="win"===t.result,new Promise(function(r){for(var s=function(s){var a=i["poker_"+s];a.num=o[s-1],egret.Tween.removeTweens(a),e?egret.Tween.get(a).wait(50*(s-1)).call(function(){a.turnCard(200).then(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return 3!==s?[3,2]:(this.cardTypeAni(t),[4,n(600)]);case 1:e.sent(),r(),e.label=2;case 2:return[2]}})})})}):(a.turnCard(0),i.cardTypeAni(t,!1),r())},a=1;3>=a;a++)s(a)})},e.prototype.showTimes=function(){!this.is_banker&&this.is_win&&(this.gp_times.visible=!0)},e.prototype.cardTypeAni=function(t,e){void 0===e&&(e=!0);var i=t.type;t.weight;"point"===i?this.group_type.addChildAt(this.fnt_point,0):this.group_type.contains(this.fnt_point)&&this.group_type.removeChild(this.fnt_point),egret.Tween.removeTweens(this.img_bg),egret.Tween.removeTweens(this.fnt_point),egret.Tween.removeTweens(this.img_type),this.img_bg.visible=!0,this.fnt_point.visible=!0,this.img_type.visible=!0,this.img_bg.source=this.result_ani[i][0],this.fnt_point.text=String(t.weight||0),this.img_type.source=this.result_ani[i][1],this.fnt_times.text=String(t.odds||1),e?(this.img_bg.scaleX=0,this.fnt_point.scaleX=2,this.fnt_point.scaleY=2,this.fnt_point.alpha=0,this.img_type.scaleX=2,this.img_type.scaleY=2,this.img_type.alpha=0,egret.Tween.get(this.img_bg).to({scaleX:1},500,egret.Ease.backOut),egret.Tween.get(this.fnt_point).wait(500).to({scaleX:1,scaleY:1,alpha:1},300),egret.Tween.get(this.img_type).wait(500).to({scaleX:1,scaleY:1,alpha:1},300)):(this.img_bg.scaleX=1,this.fnt_point.scaleX=1,this.fnt_point.scaleY=1,this.fnt_point.alpha=1,this.img_type.scaleX=1,this.img_type.scaleY=1,this.img_type.alpha=1)},e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.horoscope.PokerList")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.DTStageTopic=e,__reflect(e.prototype,"topic.DTStageTopic");var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);t.DTDeskRoomSettingData=i,__reflect(i.prototype,"topic.DTDeskRoomSettingData");var n=function(){function t(){}return t}();t.DTStageSnapshot=n,__reflect(n.prototype,"topic.DTStageSnapshot"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{DTDeskRoomSettingData:{properties:{time:{properties:{bet:{type:"number"},deal:{type:"number"},open:{type:"number"},prepare:{type:"number"},settle:{type:"number"}},required:["bet","deal","open","prepare","settle"],type:"object"}},required:["time"],type:"object"},DTStageSnapshot:{properties:{bet_limit:{properties:{chips:{items:{type:"number"},type:"array"},max:{properties:{dragon:{type:"number"},tie:{type:"number"},tiger:{type:"number"}},required:["dragon","tie","tiger"],type:"object"},min:{properties:{dragon:{type:"number"},tie:{type:"number"},tiger:{type:"number"}},required:["dragon","tie","tiger"],type:"object"}},required:["chips","max","min"],type:"object"},room_setting:{$ref:"#/definitions/DTDeskRoomSettingData"},stage:{type:"string"},stage_timestamp:{type:"number"}},required:["bet_limit","room_setting","stage","stage_timestamp"],type:"object"}},properties:{snapshot:{$ref:"#/definitions/DTStageSnapshot"}},required:["snapshot"],type:"object"}}(e=t.DTStageTopic||(t.DTStageTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.gp_tip.contains(this.gl_pool)&&this.gp_tip.removeChild(this.gl_pool)},e.prototype.show=function(t,e){void 0===e&&(e=!1),t&&(e?(this.img_bg.top=-60,this.img_bg.left=this.img_bg.right=-60,this.img_bg.bottom=-100,!this.gp_tip.contains(this.gl_pool)&&this.gp_tip.addChildAt(this.gl_pool,0)):(this.img_bg.top=this.img_bg.bottom=this.img_bg.left=this.img_bg.right=-15,this.gp_tip.contains(this.gl_pool)&&this.gp_tip.removeChild(this.gl_pool)),egret.Tween.removeTweens(this),this.alpha=0,this.lab_tip.text=t,egret.Tween.get(this).to({alpha:1},500).wait(1e3).to({alpha:0},500))},e}(t.Component);e.Tip=i,__reflect(i.prototype,"ui.horoscope.Tip")}(e=t.horoscope||(t.horoscope={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.Match=0]="Match",t[t.Canle=1]="Canle"}(i=e.MatchEnum||(e.MatchEnum={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sendMatchNotify=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.btn_auto_match.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.isSelected=e.btn_auto_match.selected},this)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setselected=function(t){this.isSelected=t,this.btn_auto_match.selected=t},e.prototype.addToStage=function(){this.btnMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.btn_auto_match.selected?this.autoMatch():(this.btn_auto_match.selected=this.isSelected,this.changeState(i.Match))},e.prototype.removeFromStage=function(){this.btnMatch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.clearInterval()},e.prototype.match=function(){this.sendMatchNotify(),this.removeMyself()},e.prototype.cancleMatch=function(){this.clearInterval(),this.btn_auto_match.selected=this.isSelected,this.changeState(i.Match)},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e.prototype.autoMatch=function(){var t=this,e=5,n=function(e){e>0?t.lbCount.text="（"+e+"）":(t.clearInterval(),t.parent&&t.parent.removeChild(t),t.match())};this.changeState(i.Canle),n(e--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(e--)},1e3)},e.prototype.changeState=function(t){this.type=t===i.Match?"match":"cancel",!this.visible&&(this.visible=!0)},e.prototype.fixPosition=function(){switch(this.currentState){case"landscape_match":case"landscape_cancel":break;case"portrait_match":case"portrait_cancel":}},e}(t.Component);e.AutoMatch=n,__reflect(n.prototype,"ui.lieng.AutoMatch")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.call(this)||this;i.group=i.addChild(new eui.Group),i.img_type=i.group.addChild(new eui.Image),i.lbnum=i.group.addChild(new t.control.BitmapLabel);var n=new eui.HorizontalLayout;return n.gap=10,n.verticalAlign="middle",i.group.layout=n,i.lbnum.font="lieng_font_bet_fnt",i.group.right=0,i}return __extends(i,e),Object.defineProperty(i.prototype,"horizontalAlign",{set:function(t){switch(this._horizontalAlign=t,t){case"center":this.group.horizontalCenter=0;break;default:this.group.horizontalCenter=0/0,this.group.right=0}},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.bet=function(t){void 0===t&&(t=-1),0>t?(this.lbnum.text="",this.img_type.source="lieng_font_all_in_png"):(this.lbnum.text=util.NumberUtil.formatNumber(t),this.img_type.source="lieng_font_table_bet_png")},i}(eui.Component);e.BetInfo=i,__reflect(i.prototype,"ui.lieng.BetInfo")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.height=e.width=70,e.bg=new eui.Image,e.bg.percentHeight=e.bg.percentWidth=100,e.bg.verticalCenter=e.bg.horizontalCenter=0,e.addChild(e.bg),e.logo=new eui.Image(Const.Config.CHIP_LOGO||"chip_logo_png"),e.logo.verticalCenter=e.logo.horizontalCenter=0,e.addChild(e.logo),e}return __extends(e,t),e.prototype.randomBG=function(){this.bg.source="b_chip_"+(Math.floor(6*Math.random())+1)+"_png"},e}(eui.Component);t.Chip=e,__reflect(e.prototype,"ui.lieng.Chip")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(t,i){var n=e.call(this)||this;n.maxChips=50,n.chips=[],n.parent_container=t;for(var o=0;200>o;o++)n.chips.push(n.createAChip());return n.glodNum=i,n}return __extends(i,e),i.prototype.setAnte=function(t){this.ante=t},i.prototype.init=function(){this.parent_container.removeChildren(),this.useNum=0,this.chips.forEach(function(t){return egret.Tween.removeTweens(t)}),this.glodNum.text="0",this.glod=0},i.prototype.createAChip=function(){var e=new t.Chip;return e.anchorOffsetX=35,e.anchorOffsetY=35,e},i.prototype.getAchip=function(){var t;return this.useNum<this.chips.length?t=this.chips[this.useNum]:(t=this.createAChip(),this.chips.push(t)),t.randomBG(),this.useNum++,t},i.prototype.randomPosition=function(t){for(var e=[],i=0;t>i;i++)e.push({x:Math.random()*(this.parent_container.width-70)+35,y:Math.random()*(this.parent_container.height-70)+35});return e},i.prototype.flyChipsToDesk=function(t,e){var i=this;if(!(0>=e)&&e){var n=Math.ceil(2*e/this.ante);n=n>this.maxChips?this.maxChips:n;var o=this.parent_container.globalToLocal(t.x,t.y),r=this.randomPosition(n);this.glod+=e;for(var s=function(t){var e=Math.sqrt((o.x-r[t].x)*(o.x-r[t].x)+(o.y-r[t].y)*(o.y-r[t].y)),n=a.getAchip();a.parent_container.addChild(n),egret.Tween.get(n).set({x:o.x,y:o.y}).to(r[t],.3*e+100*Math.random()).call(function(){0===t&&(i.glodNum.text=i.dealNumber(i.glod))})},a=this,l=0;n>l;l++)s(l)}},i.prototype.dealNumber=function(t){return util.NumberUtil.formatNumber(t)},i.prototype.getReward=function(t){var e=this,i=[];t.forEach(function(t){var n=e.parent_container.globalToLocal(t.x,t.y),o=n.x,r=n.y;i.push({x:o,y:r})});for(var n=t.length,o=300,r=this.useNum/n,s=function(t){var e=a.chips[t],n=i[Math.floor(t/r)];egret.Tween.get(e).to(n,o).call(function(){e.parent&&e.parent.removeChild(e)})},a=this,l=0;l<this.useNum;l++)s(l)},i.prototype.setNow=function(t){var e=Math.ceil(2*t/this.ante);this.glod=t,this.glodNum.text=util.NumberUtil.formatNumber(this.glod),e=e>this.maxChips?this.maxChips:e;for(var i=this.randomPosition(e),n=0;e>n;n++){var o=this.getAchip();this.parent_container.addChild(o),o.x=i[n].x,o.y=i[n].y}},i}(eui.Component);t.Chips=e,__reflect(e.prototype,"ui.lieng.Chips")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var topic;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);e.RoomsTopic=i,__reflect(i.prototype,"topic.fantan.RoomsTopic");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.StageTopic=n,__reflect(n.prototype,"topic.fantan.StageTopic");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskStageData);e.StageSnapshot=o,__reflect(o.prototype,"topic.fantan.StageSnapshot");var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.RoadMapTopic=r,__reflect(r.prototype,"topic.fantan.RoadMapTopic");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.DeskTopic=s,__reflect(s.prototype,"topic.fantan.DeskTopic");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.SnapshotBase);e.DeskSnapshot=a,__reflect(a.prototype,"topic.fantan.DeskSnapshot")}(e=t.fantan||(t.fantan={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vertailCenters=[166.5,55.5,-55.5,-166.5],e.heights=[108,222,331,444],e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.lbs=[this.lb1,this.lb2,this.lb3,this.lb4],this.rects=[this.rect1,this.rect2,this.rect3,this.rect4],this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onshow,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onhide,this),this.rects.forEach(function(t,i){return t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.seletIndex=i,e.selecteChange()})}),this.onshow()},e.prototype.onshow=function(){this.cancleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancle,this),this.raiseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.raise,this),this.betBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bet,this),this.tapBar.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.tapBar.addEventListener(egret.TouchEvent.TOUCH_END,this.toucheEnd,this)},e.prototype.onhide=function(){this.cancleBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancle,this),this.raiseBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.raise,this),this.betBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bet,this),this.tapBar.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.tapBar.removeEventListener(egret.TouchEvent.TOUCH_END,this.toucheEnd,this)},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e.prototype.cancle=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FIGHT,{type:"quit"}),this.visible=!1},e.prototype.raise=function(){if(this.raiseGroup.visible){this.raiseGroup.visible=!1;var t=0===this.seletIndex?{type:"all_in"}:{type:"raise",value:this.data[this.seletIndex-1]};util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FIGHT,t)}else this.raiseGroup.visible=!0,this.seletIndex=0,this.selecteChange()},e.prototype.bet=function(){var t=this;this.canBet&&(util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_FIGHT,{type:"call"}),this.canBet=!1,setTimeout(function(){return t.canBet=!0},500))},e.prototype.touchBegin=function(t){this.touchY=t.$stageY,this.backSeletindex=this.seletIndex,this.changeSelected=0,this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},e.prototype.toucheEnd=function(t){this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},e.prototype.touchMove=function(t){var e=this.touchY-t.$stageY,i=Math.floor(e/110)+(e%110>55?1:0);i!==this.changeSelected&&(this.changeSelected=i,this.seletIndex=this.backSeletindex+i,this.seletIndex<0&&(this.seletIndex=0),this.seletIndex>3&&(this.seletIndex=3),this.selecteChange())},e.prototype.selecteChange=function(){this.lb1.textColor=15912263,this.lb2.textColor=15912263,this.lb3.textColor=15912263,this.lb4.textColor=15912263,this.lbs[this.seletIndex].textColor=16777215,this.tapBar.verticalCenter=this.img_selectedBg.verticalCenter=this.vertailCenters[this.seletIndex],this.group_light.height=this.heights[this.seletIndex],this.lbSelect.text=0===this.seletIndex?""+util.NumberUtil.formatNumber(this.max_bet):""+util.NumberUtil.formatNumber(this.data[this.seletIndex-1])},e.prototype.setDate=function(t){this.data=t,this.initData()},e.prototype.setMaxBet=function(t){this.max_bet=t},e.prototype.init=function(){this.raiseGroup.visible=!1,this.canBet=!0},e.prototype.trunChange=function(t){this.raiseGroup.visible=!1,this.raiseBtn.enabled=t,this.betBtn.enabled=t,this.canBet=!0},e.prototype.initData=function(){this.lb2.text="X2",this.lb3.text="X5",this.lb4.text="X10"},e}(t.Component);e.OperatBtns=i,__reflect(i.prototype,"ui.lieng.OperatBtns")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.time_out_id=void 0,t.time_out_id2=void 0,t.time_out_id3=void 0,t.changeGraphics=function(e){t.shape.graphics.beginFill(65535,1),t.shape.graphics.moveTo(0,0),t.shape.graphics.lineTo(0,0),t.shape.graphics.drawArc(0,0,t.radio,e,-Math.PI/2,!1),t.shape.graphics.lineTo(0,0),t.shape.graphics.endFill()},t}return __extends(i,e),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"userInfo",{get:function(){return this._userInfo},set:function(e){if(e){var n=t.component.Avatar.generateAvatar(e.avatar);e.user_id===Const.UserInfo.USER_ID?(e.username=Const.UserInfo.NICK,i.avatarMap.set(e.user_id,Const.UserInfo.AVATAR)):e.avatar!==n&&i.avatarMap.get(e.user_id)||i.avatarMap.set(e.user_id,n),e.avatar=i.avatarMap.get(e.user_id)}this._userInfo=e,this.lb_balance.text=e&&util.NumberUtil.formatNumber(e.balance)},enumerable:!0,configurable:!0}),i.prototype.tweenBalance=function(t){util.NumberUtil.tweenNumber(this.lb_balance,t,500)},i.prototype.getCurrentState=function(){return this._type},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.initCountDown=function(){this.shape||(this.shape=new egret.Shape,this.shape.x=this.timeLine.width/2,this.shape.y=this.timeLine.height/2,this.headGroup.addChild(this.shape),this.timeLine.mask=this.shape,this.radio=this.timeLine.width>this.timeLine.height?this.timeLine.width:this.timeLine.height,this.radio*=1.5,this.dix=this.width/2)},i.prototype.init=function(){this.stopCountDown(),this.light.visible=!1,this.timeLine.visible=!1},i.prototype.countDown=function(t,e){var i=this;this.initCountDown(),this.totalTime=e-t,this.time_out_id&&this.stopCountDown(),this.light.visible=!0,this.timeLine.visible=!0;var n=util.TimeUtil.now;this.time_out_id2=util.TimeUtil.setInterval(function(){util.TimeUtil.now<e&&util.SoundUtil.play("time_mp3")},1e3),this.time_out_id3=util.TimeUtil.setInterval(function(){e-util.TimeUtil.now>=900&&(util.SoundUtil.play("WarningtimeOver_mp3"),i.time_out_id3&&util.TimeUtil.clearInterval(i.time_out_id3),i.time_out_id3=void 0)},e-n-1e3),this.time_out_id=util.TimeUtil.setInterval(function(){var n=util.TimeUtil.now-t,o=i.lightMove(n),r=o.x,s=o.y;if(i.light.x=r,i.light.y=s,e-t>n){i.shape.graphics.clear();var a=s-i.shape.y,l=r-i.shape.x,u=Math.asin(a/Math.sqrt(a*a+l*l));r<i.shape.x&&(u=Math.PI-u),i.changeGraphics(u)}else i.stopCountDown()},50,this)},i.prototype.stopCountDown=function(){this.time_out_id&&util.TimeUtil.clearInterval(this.time_out_id),this.time_out_id=void 0,this.time_out_id2&&util.TimeUtil.clearInterval(this.time_out_id2),this.time_out_id2=void 0,this.time_out_id3&&util.TimeUtil.clearInterval(this.time_out_id3),this.time_out_id3=void 0,this.light.visible=!1,this.timeLine.visible=!1},i.prototype.lightMove=function(t){var e=128,i=128,n=10.5,o=5,r=2*n*Math.PI;this.diy=o/2;var s=(r+2*e+2*i)/this.totalTime;this.dix=e/2+n+o/2;var a,l,u=t*s,h=e/2,c=h+r/4,p=c+i,_=p+r/4,d=_+e,g=d+r/4,m=g+i,f=m+r/4,b=f+e/2;if(h>u)a=t*s+this.dix,l=this.diy;else if(c>u){var y=(u-h)/(r/4)*(Math.PI/2);a=h+this.dix+Math.sin(y)*n,l=n*(1-Math.cos(y))+this.diy}else if(p>u)a=h+n+this.dix,l=n+u-c+this.diy;else if(_>u){var y=(u-p)/(r/4)*(Math.PI/2);a=h+n*Math.cos(y)+this.dix,l=i+n+n*Math.sin(y)+this.diy}else if(d>u)a=h-(u-_)+this.dix,l=i+2*n+this.diy;else if(g>u){var y=(u-d)/(r/4)*(Math.PI/2);a=-h-Math.sin(y)*n+this.dix,l=i+Math.cos(y)*n+this.diy+n}else if(m>u)a=-h-n+this.dix,l=i+n-(u-g)+this.diy;else if(f>u){var y=(u-m)/(r/4)*(Math.PI/2);a=-h+this.dix-7.5*Math.cos(y),l=n-n*Math.sin(y)+this.diy}else b>u?(a=u-f-h+this.dix,l=this.diy):(a=this.dix,l=this.diy);return{x:a,y:l}},i.prototype.setHead=function(t){},i.prototype.getHeadGlobalPosition=function(){var t=this.headGroup.localToGlobal();return{x:t.x+this.headGroup.width/2,y:t.y+this.headGroup.height/2}},i.prototype.shakeAvatar=function(){var t=0;this.avatar.verticalCenter=t,egret.Tween.removeTweens(this.avatar),egret.Tween.get(this.avatar).to({verticalCenter:t-15},80,egret.Ease.quadOut).to({verticalCenter:t},80,egret.Ease.quadIn)},i.avatarMap=new Map,i}(t.Component);e.Player=i,__reflect(i.prototype,"ui.lieng.Player")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(){function e(t){this.pokers=[],this.usePoker=0,this.parent_container=t;for(var e=0;52>e;e++){var i=this.createPoker();i.x=0,i.y=e,this.parent_container.addChild(i),this.pokers.push(i)}this.pokers=this.pokers.reverse()}return e.prototype.createPoker=function(){var e=new t.component.Poker;return e.size=.5,e.once(eui.UIEvent.CREATION_COMPLETE,function(){e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2},this),e},e.prototype.init=function(t){void 0===t&&(t=!0);for(var e=0;52>e;e++){var i=this.pokers[e];egret.Tween.removeTweens(i),i.x=0,i.y=e,i.rotation=0,i.visible=t}this.usePoker=0},e.prototype.shuffle=function(){var t=100;this.usePoker=0;for(var e=0;52>e;e++){var i=this.pokers[e];egret.Tween.removeTweens(i),i.x=0,i.y=e,i.visible=!0;var n=util.NumberUtil.getRandom(-1,1),o=util.NumberUtil.getRandom(-1,1),r=util.NumberUtil.getRandom(60,80),s=util.NumberUtil.getRandom(60,80),a=i.x,l=i.y;egret.Tween.get(i).to({x:n*r,y:l+5*o},t).to({x:a,y:l},t).to({x:o*r,y:l+5*n},t).to({x:a,y:l},t).to({x:n*s,y:l+5*o},t).to({x:a,y:l},t).to({x:o*r,y:l+5*n},t).to({x:a,y:l},t)}},e.prototype.GlobalToLocal=function(t){var e=this.parent_container.globalToLocal(t.x,t.y);t.x=e.x,t.y=e.y},e.prototype.sendAPoker=function(){},e.prototype.flyCard=function(t,e){var i=this.parent_container.globalToLocal(t.x,t.y),n=this.pokers[this.usePoker],o=100;egret.Tween.get(n).set({x:0,y:this.usePoker}).to({x:i.x/2,y:i.y/2,rotation:180},o/2).to({x:i.x,y:i.y,rotation:360},o/2).call(function(){e&&e(),n.visible=!1}),this.usePoker++},e}();e.PokerAni=i,__reflect(i.prototype,"ui.lieng.PokerAni")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.init=function(){this.poker.currentState="back",this.value=0,this.poker_number=-1,this.poker_type=-1,this.sourceNum=-1,this.img_mask.visible=!1,this.angle=0,this.isOver=!0},Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this.img_mask.rotation=t,this.poker.rotation=t,this._angle=t},enumerable:!0,configurable:!0}),e.prototype.showMask=function(){this.img_mask.visible=!0},e.prototype.setCard=function(t){"number"==typeof t?(this.poker.num=t,this.poker.currentState="normal",this.value=t,this.poker_number=t%13,this.poker_type=Math.floor(t/13)):(this.poker.currentState="back",this.value=0,this.poker_number=-1,this.poker_type=-1),this.sourceNum=t},e.prototype.fanmian=function(t,e){var i=this,n=200;this.poker.num=t;this.img_mask.scaleX;this.isOver=!1,this.poker.once(egret.Event.COMPLETE,function(){!i.isOver&&e&&e(),i.isOver&&i.init()},this),this.poker.turnCard(n)},e.prototype.getPokerNumber=function(){return this.poker_number},e.prototype.getPokerType=function(){return this.poker_type},e.prototype.getValue=function(){return this.value},e.prototype.getSourceNum=function(){return this.sourceNum},e}(t.Component);e.PokerGroup=i,__reflect(i.prototype,"ui.lieng.PokerGroup")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.other=88,e.own=192,e.bgs=["lieng_pic_card_type_bg1_png","lieng_pic_card_type_bg2_png","lieng_pic_card_type_bg3_png","lieng_pic_card_type_bg4_png"],e.typeImgs=["lieng_font_point_png","lieng_font_straight_png","lieng_font_sanjo_png","lieng_font_three_facecard_png"],e}return __extends(i,t),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),i.prototype.getCurrentState=function(){return this.type},i.prototype.init=function(){this.poker1.visible=!1,this.poker2.visible=!1,this.poker3.visible=!1,this.poker1.init(),this.poker2.init(),this.poker3.init(),this.poker2.verticalCenter=0,this.img_giveup.visible=!1,this.cardtypegroup.visible=!1,this.cards=void 0,this.isOver=!1,egret.Tween.removeTweens(this.fontGroup),egret.Tween.removeTweens(this.img_type),egret.Tween.removeTweens(this.img_typeBg)},i.prototype.tweenMove=function(){var t=this,e="own"===this.type?this.own:this.other,i=200;egret.Tween.get(this.poker1).set({horizontalCenter:0,visible:!0}).to({horizontalCenter:-1*e},i),egret.Tween.get(this.poker3).set({horizontalCenter:0,visible:!0}).to({horizontalCenter:e},i).call(function(){"own"===t.type&&t.tweenOut(t.cards,function(){t.showType(t.cards,!1)})})},i.prototype.showAllPokers=function(t){void 0===t&&(t=[void 0,void 0,void 0]),this.poker1.setCard(t[0]),this.poker2.setCard(t[1]),this.poker3.setCard(t[2]),this.poker1.visible=!0,this.poker2.visible=!0,this.poker3.visible=!0,void 0!==t[0]&&(this.setNumber(t),this.cards=t)},i.prototype.showPoker2=function(){this.poker2.visible=!0},i.prototype.tweenOut=function(t,e){var i=this;t=t||this.cards,this.poker1.fanmian(t[0],function(){i.poker2.fanmian(t[1],function(){i.poker3.fanmian(t[2],e)})})},i.prototype.giveUp=function(){var t=this;if(this.poker1.showMask(),this.poker2.showMask(),this.poker3.showMask(),this.isOver=!0,"own"!==this.type){var e=200;egret.Tween.get(this.poker1).to({angle:-15},e),egret.Tween.get(this.poker2).to({verticalCenter:-10},e),egret.Tween.get(this.poker3).to({angle:15},e).call(function(){t.img_giveup.visible=!0})}else this.img_giveup.visible=!0},i.prototype.showPokers=function(t){t.length<3||(this.poker1.visible=!0,this.poker2.visible=!0,this.poker3.visible=!0,this.poker1.setCard(t[0]),this.poker2.setCard(t[1]),this.poker3.setCard(t[2]))},i.prototype.getGlobalPostion=function(){var t=this.poker2.localToGlobal();return t.x+=this.poker1.width/2,t.y+=this.poker2.height/2,t},i.prototype.sendSuccess=function(){this.poker2.visible=!0},i.prototype.showResult=function(t,e){var i=this;t=t||this.cards,this.tweenOut(t,function(){i.showType(t,e)})},i.prototype.showType=function(t,e){var i=this,n=200;this.setNumber(t),egret.Tween.get(this.img_typeBg).set({scaleX:0,visible:!0}).to({scaleX:1},n),egret.Tween.get(this.fontGroup).set({scaleX:3,scaleY:3,visible:!0}).to({alpha:1,scaleX:1,scaleY:1},n).call(function(){e&&i.playwinAni()})},i.prototype.setNumber=function(t){this.cardtypegroup.visible=!0;var i=e.PokerUtil.instance.checkType(t);this.img_typeBg.source=this.bgs[i],this.img_type.source=this.typeImgs[i],this.lbnum.text=i===e.cardType.dian?""+this.countNumber(t):""},i.prototype.countNumber=function(t){var e=0;return t.forEach(function(t){var i=(t+2)%13;e+=i>=10?0:i}),e%10},i.prototype.playwinAni=function(){var t=this;this.win.group="effect_1_bc_win",this.win.currentFrame=0,this.win.playTimes=1,this.win.visible=!0,this.win.isPlaying=!0,this.win.once(egret.Event.COMPLETE,function(){t.reset()
},this)},i.prototype.reset=function(){this.win.isPlaying=!1,this.win.visible=!1,this.win.group="",this.win.source=null},i}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.lieng.PokerList")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e;!function(t){t[t.dian=0]="dian",t[t.shunzi=1]="shunzi",t[t.three=2]="three",t[t.sangong=3]="sangong"}(e=t.cardType||(t.cardType={}));var i=function(){function t(){this.pokers=[];for(var t=0;3>t;t++)this.pokers.push(new n)}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.checkType=function(t){var i=this,n=[];return t.forEach(function(t,e){var o=i.pokers[e];o.setValue(t),n.push(o)}),n.sort(function(t,e){return t.getNumber()-e.getNumber()}),11===n[0].getNumber()&&12===n[1].getNumber()&&13===n[2].getNumber()?e.sangong:n[0].getNumber()===n[1].getNumber()&&n[1].getNumber()===n[2].getNumber()?e.three:n[0].getNumber()+1===n[1].getNumber()&&n[1].getNumber()+1===n[2].getNumber()%13||1===n[0].getNumber()&&12===n[1].getNumber()&&13===n[2].getNumber()?e.shunzi:e.dian},t}();t.PokerUtil=i,__reflect(i.prototype,"ui.lieng.PokerUtil");var n=function(){function t(){}return t.prototype.setValue=function(t){this.value=t,this.number=(t+2)%13||13},t.prototype.getNumber=function(){return this.number},t.prototype.getValue=function(){return this.value},t}();__reflect(n.prototype,"Poker")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var topic;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);e.RoomsTopic=i,__reflect(i.prototype,"topic.fish.RoomsTopic");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.StageTopic=n,__reflect(n.prototype,"topic.fish.StageTopic");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskStageData);e.StageSnapshot=o,__reflect(o.prototype,"topic.fish.StageSnapshot");var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.RoadMapTopic=r,__reflect(r.prototype,"topic.fish.RoadMapTopic");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.DeskTopic=s,__reflect(s.prototype,"topic.fish.DeskTopic");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.SnapshotBase);e.DeskSnapshot=a,__reflect(a.prototype,"topic.fish.DeskSnapshot")}(e=t.fish||(t.fish={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setScore=function(t){t>=0?(this.font="bc_font_win_money_fnt",this.text="+"+util.NumberUtil.formatNumber(t)):(this.font="bc_font_lose_money_fnt",this.text=util.NumberUtil.formatNumber(t))},e.prototype.scoreAni=function(t,e){e>=0?this.font="bc_font_win_money_fnt":this.font="bc_font_lose_money_fnt",this.text="",util.NumberUtil.tweenNumber(this,e,t,!0)},e}(t.control.BitmapLabel);e.WinLoseInfo=i,__reflect(i.prototype,"ui.lieng.WinLoseInfo")}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(i){var n=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataProvider=new eui.ArrayCollection,e.show=function(){Main.instance.addChild(e,!0)},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(i,t),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.addToStage(),this.data&&this.startBtnState(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.prototype.setData=function(t){var e=this;this.levelMax=0,this.selected=0,t.forEach(function(t,i){t.disabled||(e.levelMax=i)}),this.data=t,this.dataProvider.replaceAll(t),this.start&&this.startBtnState()},i.prototype.startBtnState=function(){this.data[0].disabled?(this.start.filters=[Const.grayFilter],this.start.enabled=!1):(this.start.filters=null,this.start.enabled=!0)},i.prototype.addToStage=function(){this.level.value=0,this.level.addEventListener(egret.Event.CHANGE,this.levelChange,this),this.start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},i.prototype.removeFromStage=function(){this.level.removeEventListener(egret.Event.CHANGE,this.levelChange,this),this.start.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},i.prototype.levelChange=function(t){this.level.value>this.levelMax&&(this.level.value=this.levelMax),this.selected=this.level.value,this.dealRateState()},i.prototype.startGame=function(){var t=this.data[this.selected].bet_limit;LiengController.instance.enter_room_args={ante:t},e.RoomUI.instance.length="LI1"===this.roomName?6:4,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,this.roomName)},i.prototype.dealRateState=function(){var t=this;this.data.forEach(function(e,i){e.selected=i===t.selected}),this.dataProvider.replaceAll(this.data)},i}(t.DialogBase);i.EnterRoomDialog=n,__reflect(n.prototype,"ui.lieng.dialog.EnterRoomDialog")}(i=e.dialog||(e.dialog={}))}(e=t.lieng||(t.lieng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.init,this)},e.prototype.added=function(){var t=this;this.visible=!0,this.result.scrollEnabled=!0,this.result.percentWidth=0,this.start_game_leaves1.visible=!1,this.start_game_leaves2.visible=!1,this.start_game.visible=!1,this.result.alpha=1;var i=125;egret.Tween.get(this.result).to({scrollEnabled:!1,percentWidth:100},2*i).call(function(){t.start_game_leaves1.visible=!0,t.start_game_leaves2.visible=!0,t.start_game.visible=!0,t.start_game_leaves1.alpha=1,t.start_game_leaves2.alpha=1,t.start_game.scaleX=3,t.start_game.scaleY=3,t.start_game.y=-5e3,egret.Tween.get(t.start_game).to({scaleX:1,scaleY:1,y:93.5},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves1).to({y:200},i).to({y:186},i).to({alpha:.3},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves2).to({y:-14},i).to({y:7},i).to({alpha:.3},i,egret.Ease.circOut).call(function(){egret.Tween.get(t.result).to({alpha:0},3*i,egret.Ease.circOut)})}),util.TimeUtil.setTimeout(function(){t.parent&&t.parent.removeChild(t),t.dispatchEventWith(e.EVT_SHOW_BTN)},8*i)},e.prototype.init=function(){this.visible=!1,egret.Tween.removeTweens(this.result),egret.Tween.removeTweens(this.start_game),egret.Tween.removeTweens(this.start_game_leaves1),egret.Tween.removeTweens(this.start_game_leaves2)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?156.5:51.5,this.horizontalCenter=t===egret.OrientationMode.PORTRAIT?50.5:63.125},e.EVT_SHOW_BTN="evt_show_btn",e}(eui.Component);t.BeginAni=e,__reflect(e.prototype,"ui.paigow.BeginAni")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.chip_pool=[],i.parent_container=new eui.Group,i.parent_container.percentWidth=i.parent_container.percentHeight=100,i.parent_container.touchEnabled=i.parent_container.touchChildren=!1,e.addChild(i.parent_container),i}return __extends(e,t),e.prototype.getOneChip=function(){var t=this.chip_pool.shift();return t||(t=new eui.Image("pg_pic_chip_png"),t.anchorOffsetX=this.width/2<<0,t.anchorOffsetY=this.height/2<<0),t},e.prototype.returnChip=function(t){this.chip_pool.push(t),t.parent&&t.parent.removeChild(t)},e.prototype.flyChip=function(t,e,i){var n=this,o=this.parent_container.globalToLocal(t.x-37,t.y-37),r=this.parent_container.globalToLocal(e.x-37,e.y-37);this.parent_container.visible=!0;for(var s=function(t){var e=a.getOneChip();e.visible=!1,a.parent_container.addChild(e),util.TimeUtil.setTimeout(function(){return n.flyAni(e,o,r,300)},util.NumberUtil.getRandom(10,30)*t)},a=this,l=0;i>l;l++)s(l)},e.prototype.hideChip=function(){this.parent_container.visible=!1},e.prototype.flyAni=function(t,e,i,n){var o=this;egret.Tween.removeTweens(t),t.x=e.x,t.y=e.y,egret.Tween.get(t).to({x:i.x,y:i.y},n).call(function(){o.returnChip(t)}),t.visible=!0},e.prototype.resetMode=function(t){},e}(eui.Component);t.Chips=e,__reflect(e.prototype,"ui.paigow.Chips")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.clearTimeOut=function(){return util.TimeUtil.clearInterval(e.setIntervalID)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e.visible=!1,e.horizontalCenter=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=this.touchChildren=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clearTimeOut,this)},e.prototype.show=function(t,e){var i=this;this.clearTimeOut();var n=function(){var n=i.calRemainMill(t,e)/1e3<<0;n>0?i.lb_cd.text=""+n:(i.parent&&i.parent.removeChild(i),i.visible=!1)};n(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return n()},250)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?-150:-70},e}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ui.paigow.CountDown")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setRound=function(t){this.round.text=util.LanguageUtil.translate("lbl_game_no_round",t.toString())},e}(t.Component);e.DeskInfo=i,__reflect(i.prototype,"ui.paigow.DeskInfo")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=t.call(this)||this;return e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e.horizontalCenter=0,e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.init,this)},e.prototype.added=function(){var t=this;this.verticalCenter=Main.instance.orientation===egret.OrientationMode.PORTRAIT?-11:-71,this.visible=!0,this.teb_pic_dice_cup1.rotation=0,this.teb_pic_dice_cup1.horizontalCenter=0,this.teb_pic_dice_cup1.verticalCenter=0,this.teb_pic_dice_cup1.visible=!0,this.teb_pic_dice_cup2.visible=!0,this.dice1.visible=!1,this.dice2.visible=!1,this.dice_group.alpha=1,util.SoundUtil.play("qzpj_touzi_mp3");var i=50;egret.Tween.get(this.dice_group).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).call(function(){t.teb_pic_dice_cup1.rotation=60,egret.Tween.get(t.teb_pic_dice_cup1).to({horizontalCenter:250,verticalCenter:-250},125).call(function(){egret.Tween.get(t.teb_pic_dice_cup1).to({horizontalCenter:2e3,verticalCenter:-2e3},875,egret.Ease.quintIn),t.dice1.visible=!0,t.dice2.visible=!0,egret.Tween.get(t.dice_group).wait(1500).to({alpha:0},100,egret.Ease.circOut)})}),util.TimeUtil.setTimeout(function(){t.parent&&t.parent.removeChild(t),t.dispatchEventWith(e.EVT_SHOW_BTN)},48*i+2600)},e.prototype.init=function(){this.visible=!1,egret.Tween.removeTweens(this.teb_pic_dice_cup1),egret.Tween.removeTweens(this.dice_group)},e.prototype.setDice=function(t){this.dice1.source="teb_pic_dice"+t[0]+"_png",this.dice2.source="teb_pic_dice"+t[1]+"_png"},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?-11:-71},e.EVT_SHOW_BTN="evt_show_btn",e}(t.Component);e.DiceAni=i,__reflect(i.prototype,"ui.paigow.DiceAni")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.FlowerDeskTopic=e,__reflect(e.prototype,"topic.FlowerDeskTopic"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{bet_limit:{properties:{admittance:{type:"number"},ante:{type:"number"},happy_money:{type:"number"}},required:["admittance","ante","happy_money"],type:"object"},card_pk:{items:{properties:{},type:"object"},type:"array"},decision_position:{type:"number"},desk:{additionalProperties:{properties:{avatar:{type:"string"},balance:{decimal:!0},bet:{items:{type:"number"},type:"array"},cards:{properties:{cards:{items:{type:"number"},type:"array"},type:{type:"string"}},required:["cards","type"],type:"object"},happy_money:{type:"number"},payout:{type:"number"},position:{type:"number"},status:{type:"string"},surplus:{type:"number"},user_id:{type:"string"},username:{type:"string"},watch_card:{type:"boolean"}},type:"object"},maxProperties:6,minProperties:1,type:"object"},dynamic_min:{type:"number"},room_setting:{properties:{room_id:{type:"string"},tax:{type:"number"},time:{properties:{op:{type:"number"}},required:["op"],type:"object"},type:{type:"string"}},required:["room_id","tax","time","type"],type:"object"},round:{type:"number"},stage:{type:"string"},stop_decision_ts:{type:"number"},total_bet:{type:"number"}},required:["bet_limit","card_pk","desk","dynamic_min","room_setting","stage","total_bet"],type:"object","if":{not:{properties:{stage:{"const":"cancel"}}}},then:{properties:{desk:{additionalProperties:{required:["happy_money","payout","position","status","user_id","username","watch_card"]}}}}}},required:["snapshot"],type:"object"}}(e=t.FlowerDeskTopic||(t.FlowerDeskTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.has_head=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setBet=function(t){this.hideBet(),0>=t?this.img_skip.visible=!0:(this.group_bankerBet.visible=!0,this.lab_bankerBet.text=String(t))},e.prototype.setRaise=function(t){this.hideBet(),t&&(this.group_bet.visible=!0,this.lab_bet.text=String(t))},e.prototype.hideBet=function(){this.img_skip.visible=!1,this.group_bankerBet.visible=!1,this.group_bet.visible=!1},e.prototype.showBanker=function(t){this.group_banker.visible=t},e.prototype.setName=function(t){this.lab_name.text=t},e.prototype.setBalance=function(t){this.lab_balance.text=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.has_head||(this.has_head=!0,this.img_head.source=t)},e.prototype.initHead=function(){this.has_head=!1},e.prototype.showSurplus=function(t,e){t&&(e>0?(this.group_lose.visible=!1,this.group_win.visible=!0,this.lab_win.text=util.NumberUtil.formatNumber(e),egret.Tween.removeTweens(this.group_win),egret.Tween.get(this.group_win).to({verticalCenter:-160},1e3)):(this.group_win.visible=!1,this.group_lose.visible=!0,this.lab_lose.text=util.NumberUtil.formatNumber(e),egret.Tween.removeTweens(this.group_lose),egret.Tween.get(this.group_lose).to({verticalCenter:-160},1e3)))},e.prototype.hideSurplus=function(){this.group_win.visible=!1,this.group_lose.visible=!1},e.prototype.showSnatch=function(t){this.img_snatch.visible=t},e.prototype.showBet=function(t){this.group_bankerBet.visible=t,this.img_skip.visible=t},e.prototype.getChipPosition=function(){var t=util.ObjectUtil.copy(this.img_head.localToGlobal());return t.x+=this.img_head.width/2,t.y+=this.img_head.height/2,t},e.prototype.showArrow=function(){var t=this;this.arrow.visible=!0,this.arrow.horizontalCenter="-4",this.arrow.verticalCenter="-180.5",egret.Tween.get(this.arrow).to({verticalCenter:-200},200).to({verticalCenter:-180.5},200).to({verticalCenter:-200},200).to({verticalCenter:-180.5},200).to({verticalCenter:-200},200).to({verticalCenter:-180.5},200).call(function(){t.arrow.visible=!1})},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.paigow.PlayerFrame")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setCard=function(t,e){void 0===t&&(t=0),this.img_poker.source="pg_card_"+(t>10?Math.ceil((t+10)/2):t)+"_png",!e&&util.SoundUtil.play("qzpj_fapai_mp3")},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.paigow.Poker")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardTypeMap=new Map([["superior","pg_card_super_ior_png"],["doublesky","pg_card_double_sky_png"],["doublefloor","pg_card_double_floor_png"],["doubleperson","pg_card_double_person_png"],["doublegoose","pg_card_double_goose_png"],["doubleclub","pg_card_double_club_png"],["doublelongthree","pg_card_double_long_three_png"],["doublestool","pg_card_double_stool_png"],["doubleaxe","pg_card_double_axe_png"],["doubleredten","pg_card_double_red_ten_png"],["doublehighseven","pg_card_double_long_seven_png"],["doublezerosix","pg_card_double_zero_six_png"],["ninemiscellaneous","pg_card_nine_misc_ellaneous_png"],["eightmiscellaneous","pg_card_eight_misc_ellaneous_png"],["sevenmiscellaneous","pg_card_seven_misc_ellaneous_png"],["fivemiscellaneous","pg_card_five_misc_ellaneous_png"],["skyking","pg_card_sky_king_png"],["floorking","pg_card_floor_king_png"],["skybar","pg_card_sky_bar_png"],["floorbar","pg_card_floor_bar_png"],["skyhigh","pg_card_sky_high_png"],["floorhigh","pg_card_floor_high_png"]]),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.enabled=!0},e.prototype.setCardType=function(t,e,i,n){var o=this;if("other"===t)switch(i){case 0:this.card_type.source="teb_pic_card_type_bg1_png",this.bg1.source="pg_number_0_png",this.bg1.horizontalCenter=0,this.bg2.visible=!1,this.bg3.visible=!1;break;case 1:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_1_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case 2:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_2_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case 3:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_3_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case 4:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_4_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case 5:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_5_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case 6:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_6_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case 7:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_7_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case 8:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_8_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case 9:this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_9_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,this.bg3.visible=!1}else this.bg1.source=this.cardTypeMap.get(t),this.bg1.horizontalCenter=0,"superior"===this.cardTypeMap.get(t)&&(this.card_type.source="teb_pic_card_type_bg4_png"),this.card_type.source="teb_pic_card_type_bg3_png",this.bg2.visible=!1,this.bg3.visible=!1;n?(this.poker_1.setCard(e[0],!0),this.poker_2.setCard(e[1],!0)):(this.group_finish.scaleX=0,this.group_finish.scaleY=0,this.fontGroup.alpha=0,this.fontGroup.scaleX=3,this.fontGroup.scaleY=3,egret.Tween.get(this.group_finish).to({scaleX:.7,scaleY:.7},350).call(function(){egret.Tween.get(o.group_finish).to({scaleX:1,scaleY:1},150,egret.Ease.circOut),egret.Tween.get(o.fontGroup).to({scaleX:1,scaleY:1,alpha:1},150)}))},e.EVT_SELECT="evt_select",e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.paigow.PokerList")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.init,this)},e.prototype.added=function(){var t=this;this.visible=!0,this.result.scrollEnabled=!0,this.result.percentWidth=0,this.start_game_leaves1.visible=!1,this.start_game_leaves2.visible=!1,this.start_game.visible=!1,this.result.alpha=1;var i=125;egret.Tween.get(this.result).to({scrollEnabled:!1,percentWidth:100},2*i).call(function(){t.start_game_leaves1.visible=!0,t.start_game_leaves2.visible=!0,t.start_game.visible=!0,t.start_game_leaves1.alpha=1,t.start_game_leaves2.alpha=1,t.start_game.scaleX=3,t.start_game.scaleY=3,t.start_game.y=-5e3,egret.Tween.get(t.start_game).to({scaleX:1,scaleY:1,y:55.5},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves1).to({y:120},i).to({y:109},i).to({alpha:.3},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves2).to({y:0},i).to({y:11},i).to({alpha:.3},i,egret.Ease.circOut).call(function(){egret.Tween.get(t.result).to({alpha:0},3*i,egret.Ease.circOut)})}),util.TimeUtil.setTimeout(function(){t.parent&&t.parent.removeChild(t),t.dispatchEventWith(e.EVT_SHOW_BTN)},8*i)},e.prototype.init=function(){this.visible=!1,egret.Tween.removeTweens(this.result),egret.Tween.removeTweens(this.start_game),egret.Tween.removeTweens(this.start_game_leaves1),egret.Tween.removeTweens(this.start_game_leaves2)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?236.5:-22.5,this.horizontalCenter=t===egret.OrientationMode.PORTRAIT?41.2:51.5},e.EVT_SHOW_BTN="evt_show_btn",e}(eui.Component);t.RobAni=e,__reflect(e.prototype,"ui.paigow.RobAni")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var topic;!function(t){t.fourSchema={$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{snapshot:{type:"object",properties:{bet_limit:{type:"object",properties:{ante:{type:"number"},admittance:{type:"number"}},required:["ante","admittance"]},room_setting:{type:"object",properties:{dispute_factor:{type:"object",patternProperties:{"^[1-3]$":{type:"number"}},additionalProperties:!1},room_id:{type:"string"},tax:{type:"number"},time:{type:"object",properties:{dispute:{type:"number"},raise:{type:"number"},op:{type:"number"}},required:["dispute","raise","op"]},type:{type:"string"}},required:["dispute_factor","room_id","tax","time","type"]},stage:{type:"string"},user_info:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{user_id:{type:"string"},avatar:{type:"string"},username:{type:"string"},balance:{decimal:!0},position:{pattern:"^[1-6]$",type:"string"}}}},additionalProperties:!1},dispute:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{dispute_rate:{type:"number"},is_banker:{type:"boolean"},is_done:{type:"boolean"}}}}},raise:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{raise_rate:{type:"number"},is_done:{type:"boolean"}}}}},fight:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{cards:{items:{type:"integer"}},type:{type:"string"},is_done:{type:"boolean"}}}}},settle:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{surplus:{type:"number"}}}}}}}},required:["snapshot"]};var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.FourDeskTopic=e,__reflect(e.prototype,"topic.FourDeskTopic")}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setMask=function(t){this["mask_"+t].visible=!0},e.prototype.recoverMask=function(){for(var t=1;33>t;t++)this["mask_"+t].visible=!1},e}(t.Component);e.SeeCard=i,__reflect(i.prototype,"ui.paigow.SeeCard")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this)},e.prototype.updateMult=function(t){this.mult=t,this.btn.labelDisplay.text=""+t},e.prototype.sendMult=function(){this.dispatchEventWith(e.EVT_SEND_MULT,!0,this.mult)},e.EVT_SEND_MULT="evt_send_mult",e}(eui.Component);t.BetButton=e,__reflect(e.prototype,"ui.paigow.BetButton")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.init=function(e){var i=this;void 0===e&&(e=[0,1,4,8,11]),this.firstMulBtn.updateMult(e[1]);var n=3-this.gp_mult_btns.numChildren;if(this.canAdd=!0,this.gp_mult_btns.numChildren<3&&this.canAdd){this.canAdd=!1;for(var o=1;n>=o;o++){var r=new t.MultButton;this.gp_mult_btns.addChild(r)}}this.gp_mult_btns.$children.forEach(function(t,n){if(void 0===e[n+1])for(var o=1;o<=5-e.length;o++)i.gp_mult_btns.removeChildAt(i.gp_mult_btns.numChildren-1);else t.updateMult(e[n+2])}),this.visible=!0},i.prototype.registEvent=function(){e.prototype.registEvent.call(this),this.btn_give_up.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this),this.firstMulBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.firstMulBtnHandler,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.btn_give_up.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this),this.firstMulBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.firstMulBtnHandler,this)},i.prototype.sendMult=function(e){e.stopImmediatePropagation();var i=e.target===this.btn_give_up?-1:e.data;this.dispatchEventWith(t.MultButtonsBase.EVT_SEND_MULT,!1,i),this.parent&&this.parent.removeChild(this)},i.prototype.firstMulBtnHandler=function(t){t.stopImmediatePropagation(),this.parent&&this.parent.removeChild(this)},i}(t.MultButtonsBase);t.HogButtons=e,__reflect(e.prototype,"ui.paigow.HogButtons")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.horizontalCenter=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},e.prototype.addToStage=function(){this.btn_match.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btn_matchHandler,this)},e.prototype.removeFromStage=function(){this.btn_match.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btn_matchHandler,this)},e.prototype.btn_matchHandler=function(){this.sendMatchNotify(),this.parent&&this.parent.removeChild(this)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?463:113},e}(eui.Component);t.MatchButton=e,__reflect(e.prototype,"ui.paigow.MatchButton")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this)},e.prototype.updateMult=function(t){this.mult=t,this.btn.labelDisplay.text=""+t},e.prototype.sendMult=function(){this.dispatchEventWith(e.EVT_SEND_MULT,!0,this.mult)},e.EVT_SEND_MULT="evt_send_mult",e}(eui.Component);t.MultButton=e,__reflect(e.prototype,"ui.paigow.MultButton")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.init=function(e,i,n){var o=this;void 0===e&&(e=[1,4,8,11,15]);var r=3-this.gp_mult_btns.numChildren;if(this.canAdd=!0,this.gp_mult_btns.numChildren<3&&this.canAdd){this.canAdd=!1;for(var s=1;r>=s;s++){var a=new t.BetButton;this.gp_mult_btns.addChild(a)}}if(1===this.gp_mult_btns1.numChildren){var a=new t.BetButton;this.gp_mult_btns1.addChild(a)}this.canRemove=!0,this.gp_mult_btns1.$children.concat(this.gp_mult_btns.$children).forEach(function(t,r){if(void 0===e[r]){if(o.canRemove)for(var s=1;s<=5-e.length;s++)o.canRemove=!1,o.gp_mult_btns.numChildren&&o.gp_mult_btns.removeChildAt(o.gp_mult_btns.numChildren-1);1===e.length&&2===o.gp_mult_btns1.numChildren&&o.gp_mult_btns1.removeChildAt(o.gp_mult_btns1.numChildren-1)}else{var a=e[r];t.updateMult(a),0!==r&&new Decimal(i).mul(a).mul(n).greaterThan(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance)?(t.enabled=!1,t.filters=[Const.grayFilter]):(t.enabled=!0,t.filters=null)}}),this.visible=!0},i.prototype.registEvent=function(){e.prototype.registEvent.call(this),this.gp_mult_btns1.addEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.gp_mult_btns1.removeEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i}(t.MultButtonsBase);t.MultButtons=e,__reflect(e.prototype,"ui.paigow.MultButtons")}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var topic;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);e.RoomsTopic=i,__reflect(i.prototype,"topic.hilo.RoomsTopic");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.StageTopic=n,__reflect(n.prototype,"topic.hilo.StageTopic");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskStageData);e.StageSnapshot=o,__reflect(o.prototype,"topic.hilo.StageSnapshot");
var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.RoadMapTopic=r,__reflect(r.prototype,"topic.hilo.RoadMapTopic");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.DeskTopic=s,__reflect(s.prototype,"topic.hilo.DeskTopic");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.SnapshotBase);e.DeskSnapshot=a,__reflect(a.prototype,"topic.hilo.DeskSnapshot")}(e=t.hilo||(t.hilo={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colors="zh_cn"===Const.Config.LANGUAGE?["red","green"]:["green","red"],e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.dealData=function(t,i){return util.ObjectUtil.merge(t,{state:(i%2?"d":"s")+"_"+e.colors[t.surplus>0?0:1],name:t.name,bg:t.isBanker?"pg_icon_banker_bg_png":"pg_icon_player_bg_png",type:t.isBanker?"teb_font_banker_png":"pg_font_player_png",start_money:util.NumberUtil.formatNumber(Number(t.start_money)),card_type:"other"===t.card_type?t.card_result+"点":e.cardTypeMap.get(t.card_type),ante:util.NumberUtil.formatNumber(t.ante),rob_multiple:t.isBanker?"":t.rob_multiple+"倍",bet_multiple:t.isBanker?t.bet_multiple+"倍":"",surplus:""+(t.surplus>0?"+":"")+util.NumberUtil.formatNumber(t.surplus)})},e.cardTypeMap=new Map([["superior","至尊"],["doublesky","双天"],["doublefloor","双地"],["doubleperson","双人"],["doublegoose","双鹅"],["doubleclub","双梅"],["doublelongthree","双长三"],["doublestool","双板凳"],["doubleaxe","双斧头"],["doubleredten","双红头"],["doublehighseven","双高脚"],["doublezerosix","双零霖"],["ninemiscellaneous","杂九"],["eightmiscellaneous","杂八"],["sevenmiscellaneous","杂七"],["fivemiscellaneous","杂五"],["skyking","天王"],["floorking","地王"],["skybar","天杠"],["floorbar","地杠"],["skyhigh","天高九"],["floorhigh","地高九"]]),e.show=function(t){var i=t.splice(4,4);e.visible=!0,e.dataProvider=new eui.ArrayCollection(t.map(e.dealData)),e.dataProvider2=new eui.ArrayCollection(i.map(e.dealData)),Main.instance.addChild(e,!0)},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},e.prototype.addToStage=function(){this.btn_match.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btn_matchHandler,this)},e.prototype.removeFromStage=function(){this.btn_match.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btn_matchHandler,this)},e.prototype.btn_matchHandler=function(){this.sendMatchNotify(),this.parent&&this.parent.removeChild(this)},e}(t.DialogBase);e.SettleDialog=i,__reflect(i.prototype,"ui.paigow.dialog.SettleDialog")}(i=e.dialog||(e.dialog={}))}(e=t.paigow||(t.paigow={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.show=function(t){switch(this.visible=!1,this.group_start.visible=!1,this.group_stop.visible=!1,t){case"start":this.visible=!0,this.group_start.visible=!0;break;case"stop":this.visible=!0,this.group_stop.visible=!0}},e}(t.Component);e.BetAni=i,__reflect(i.prototype,"ui.pokdeng.BetAni")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"chipValue",{get:function(){return this._chipValue},set:function(t){this._chipValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type="b_chip_"+t+"_png"},enumerable:!0,configurable:!0}),e}(t.Component);e.Chip=i,__reflect(i.prototype,"ui.pokdeng.Chip")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t,this.displayValue=util.NumberUtil.formatUnit(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type="b_chip_"+t+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isChosen",{get:function(){return this._isChosen},set:function(t){this._isChosen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=t},enumerable:!0,configurable:!0}),e}(t.ItemRenderer);e.ChipListItem=i,__reflect(i.prototype,"ui.pokdeng.ChipListItem")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.chips=new eui.ArrayCollection,e}return __extends(i,t),Object.defineProperty(i.prototype,"cur_chosen_item",{get:function(){return this._cur_chosen_item},set:function(t){this._cur_chosen_item=t},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},i.prototype.init=function(){this.registerEvent(),this.scr_chips.horizontalScrollBar.autoVisibility=!1,this.scr_chips.horizontalScrollBar.visible=!1},i.prototype.registerEvent=function(){var t=this;this.list_chips.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){e.item.disabled||(t.updateCurChip(!1),t.setCurChip(e.item),t.dispatchEventWith(i.EVT_BET))},this)},i.prototype.setChips=function(t){this.chips.removeAll();for(var i=0;i<t.length;i++){var n=Number(t[i]),o=new e.ChipListItem;o.type=(Const.Config.CHIP_VALUES.indexOf(Number(n))+1).toString(),o.type=(i+1).toString(),o.value=n,this.chips.addItemAt(o,i)}this.setCurChip(this.chips.getItemAt(0)),this.chips.refresh()},i.prototype.setCurChip=function(t){this.cur_chosen_item=t,this.updateCurChip(!0)},i.prototype.updateCurChip=function(t){this.cur_chosen_item.isChosen=t,this.chips.itemUpdated(this.cur_chosen_item)},i.prototype.updateEnable=function(t){for(var e=!1,i=!1,n=this.chips.length-1;n>=0;n--){var o=this.chips.getItemAt(n);if(t.lt(o.value)){if(o.disabled=!0,o.isChosen&&(this.updateCurChip(!1),n>0)){var r=this.chips.getItemAt(n-1);this.setCurChip(r)}}else o.disabled=!1;e=e||o.isChosen,i=i||!o.disabled}!e&&i&&this.setCurChip(this.chips.getItemAt(0))},i.EVT_BET="evt_bet",i}(t.Component);e.ChipsList=i,__reflect(i.prototype,"ui.pokdeng.ChipsList")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.playwarnSound=!1,e.clearTimeOut=function(){return util.TimeUtil.clearInterval(e.setIntervalID)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e.visible=!1,e.horizontalCenter=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=this.touchChildren=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clearTimeOut,this)},e.prototype.show=function(t,i,n){var o=this;this.lastSec=-1,this.clearTimeOut(),this.playwarnSound=!1;var r=function(){var r=o.calRemainMill(t,i)/1e3<<0;o.visible===!1&&(!o.playwarnSound&&1>=r&&util.SoundUtil.play("WarningtimeOver_mp3"),o.playwarnSound=!0,o.clearTimeOut(),util.SoundUtil.destroy(["time_mp3"])),r>0?(o.playwarnSound=!1,r>n/1e3&&(r=n/1e3),o.lb_cd.text=""+r,o.lastSec!==r&&(util.SoundUtil.play("time_mp3"),o.lastSec=r)):(!o.playwarnSound&&util.SoundUtil.play("WarningtimeOver_mp3"),o.playwarnSound=!0,o.visible=!1,o.dispatchEventWith(e.EVT_HIDDEN))};r(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return r()},250)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?226:-23},e.EVT_HIDDEN="evt_hidden",e}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ui.pokdeng.CountDown")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var topic;!function(t){var e;!function(e){e.stageSchema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{StageSnapshot:{properties:{bet_limit:{properties:{chips:{items:{type:"number"},type:"array"},max:{additionalProperties:{type:"number"},type:"object"},min:{additionalProperties:{type:"number"},type:"object"}},required:["chips","max","min"],type:"object"},room_setting:{properties:{room_id:{type:"string"},tax:{type:"number"},time:{properties:{bet:{type:"number"}},required:["bet"],type:"object"},type:{type:"string"}},required:["room_id","time","type"],type:"object"},stage:{type:"string"},stage_timestamp:{type:"number"}},required:["bet_limit","room_setting","stage","stage_timestamp"],type:"object"}},properties:{snapshot:{$ref:"#/definitions/StageSnapshot"}},required:["snapshot"],type:"object"},e.deskSchema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{ResultInfo:{properties:{betRate:{type:"number"},cards:{items:{type:"number"},type:"array"},odds:{type:"number"},result:{"enum":["lose","tie","win"],type:"string"},type:{type:"string"},weight:{type:"number"}},required:["cards","odds","type","weight"],type:"object"},Settle:{patternProperties:{"^[1-4]$|^pool_[1-4]$|^rake_[1-4]$":{type:"number"}},required:["1","2","3","4"],type:"object"}},properties:{snapshot:{properties:{bet:{patternProperties:{"^[1-4]$":{type:"number"}},additionalProperties:!1,minProperties:4,type:"object"},open:{patternProperties:{"^[1-4]$":{allOf:[{$ref:"#/definitions/ResultInfo"},{required:["result"]}]}},properties:{banker:{$ref:"#/definitions/ResultInfo"}},additionalProperties:!1,type:"object"},round_id:{type:"string"},round_number:{type:"number"},settle:{$ref:"#/definitions/Settle"},shoe_size:{type:"number"},user_info:{properties:{avatar:{type:"string"},balance:{decimal:!0},bet:{patternProperties:{"^[1-4]$":{type:"number"}},additionalProperties:!1,minProperties:4,type:"object"},idle:{type:"number"},settle:{$ref:"#/definitions/Settle"},surplus:{type:"number"},user_id:{type:"string"},username:{type:"string"}},required:["balance","bet","idle","surplus","user_id","username"],type:"object"}},required:["round_id","user_info"],type:"object"}},required:["snapshot"],type:"object"},e.deskSnapshotSchema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{ResultInfo:{properties:{betRate:{type:"number"},cards:{items:{type:"number"},type:"array"},odds:{type:"number"},result:{"enum":["lose","tie","win"],type:"string"},type:{type:"string"},weight:{type:"number"}},required:["cards","odds","type","weight"],type:"object"},Settle:{patternProperties:{"^[1-4]$|^pool_[1-4]$|^rake_[1-4]$":{type:"number"}},required:["1","2","3","4"],type:"object"}},properties:{bet:{patternProperties:{"^[1-4]$":{type:"number"}},additionalProperties:!1,minProperties:4,type:"object"},open:{patternProperties:{"^[1-4]$":{allOf:[{$ref:"#/definitions/ResultInfo"},{required:["result"]}]}},properties:{banker:{$ref:"#/definitions/ResultInfo"}},additionalProperties:!1,type:"object"},round_id:{type:"string"},round_number:{type:"number"},settle:{$ref:"#/definitions/Settle"},shoe_size:{type:"number"},user_info:{properties:{avatar:{type:"string"},balance:{decimal:!0},bet:{patternProperties:{"^[1-4]$":{type:"number"}},additionalProperties:!1,minProperties:4,type:"object"},idle:{type:"number"},settle:{$ref:"#/definitions/Settle"},surplus:{type:"number"},user_id:{type:"string"},username:{type:"string"}},required:["balance","bet","idle","surplus","user_id","username"],type:"object"}},required:["round_id","user_info"],type:"object"},e.roadmap_schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{round_result:{items:{items:{type:"string"},type:"array"},type:"array"}},required:["round_result"],type:"object"}},required:["snapshot"],type:"object"};var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);e.RoomsTopic=i,__reflect(i.prototype,"topic.horoscope.RoomsTopic");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.StageTopic=n,__reflect(n.prototype,"topic.horoscope.StageTopic");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskStageData);e.StageSnapshot=o,__reflect(o.prototype,"topic.horoscope.StageSnapshot");var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.RoadMapTopic=r,__reflect(r.prototype,"topic.horoscope.RoadMapTopic");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.DeskTopic=s,__reflect(s.prototype,"topic.horoscope.DeskTopic");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.SnapshotBase);e.DeskSnapshot=a,__reflect(a.prototype,"topic.horoscope.DeskSnapshot")}(e=t.horoscope||(t.horoscope={}))}(topic||(topic={}));var ui;!function(t){var e;!function(t){var e;!function(t){t[t.Match=0]="Match",t[t.Cancel=1]="Cancel"}(e=t.MatchEnum||(t.MatchEnum={}));var i=function(t){function i(){var e=t.call(this)||this;return e.sendMatchNotify=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH),e.dispatchEventWith(i.EVT_SHOW_BTN),e.visible=!1},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e.visible=!1,e.horizontalCenter=0,e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.btn_auto_match.selected=!0},i.prototype.addToStage=function(){this.visible=!0,this.btn_match_canle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this),this.btn_auto_match.selected?this.autoMatch():this.changeState(e.Match)},i.prototype.cancel=function(){this.visible=!0,this.btn_match_canle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this),this.changeState(e.Match)},i.prototype.removeFromStage=function(){this.clearInterval(),this.visible=!1,this.btn_match_canle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this)},i.prototype.matchCanleClick=function(){"match"===this.currentState?this.sendMatchNotify():(this.clearInterval(),this.changeState(e.Match))},i.prototype.autoMatch=function(){var t=this,i=5,n=function(e){e>0?t.lb_countdown.text=util.LanguageUtil.translate("lbl_game_willmatch",e):(t.clearInterval(),t.sendMatchNotify())};this.changeState(e.Cancel),n(i--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(i--)},1e3)},i.prototype.changeState=function(t){this.currentState=t===e.Match?"match":"cancel",!this.visible&&(this.visible=!0)},i.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?430:130},i.EVT_SHOW_BTN="evt_show_btn",i}(eui.Component);t.MatchButton=i,__reflect(i.prototype,"ui.pokdeng.MatchButton")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.has_head=!1,e.time_out_id=void 0,e.time_out_id2=void 0,e.time_out_id3=void 0,e.changeGraphics=function(t){e.shape.graphics.beginFill(65535,1),e.shape.graphics.moveTo(0,0),e.shape.graphics.lineTo(0,0),e.shape.graphics.drawArc(0,0,e.radio,t,-Math.PI/2,!1),e.shape.graphics.lineTo(0,0),e.shape.graphics.endFill()},e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+(this.type?""+this.type:"")},e.prototype.setName=function(t){this.lab_name.text=t},e.prototype.setBalance=function(t,e){e?util.NumberUtil.tweenNumber(this.lab_balance,Math.abs(t.toNumber()),1e3):this.lab_balance.text=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.has_head||(this.has_head=!0,this.img_head.source=t)},e.prototype.initHead=function(){this.has_head=!1},e.prototype.showSurplus=function(t){this.group_surplus.visible=!0,t>=0?(this.lab_surplus.font="pok_win_fnt",this.lab_surplus.text="+"+util.NumberUtil.formatNumber(t)):(this.lab_surplus.font="pok_lose_fnt",this.lab_surplus.text=util.NumberUtil.formatNumber(t))},e.prototype.hideSurplus=function(){this.group_surplus.visible=!1},e.prototype.setChip=function(t){this.bet_num.text=t},e.prototype.showChipGroup=function(t){this.group_bet.visible=t},e.prototype.initCountDown=function(){this.shape||(this.shape=new egret.Shape,this.shape.x=this.timeLine.width/2,this.shape.y=this.timeLine.height/2,this.timeGroup.addChild(this.shape),this.timeLine.mask=this.shape,this.radio=this.timeLine.width>this.timeLine.height?this.timeLine.width:this.timeLine.height,this.radio*=1.5,this.dix=this.width/2)},e.prototype.init=function(){this.stopCountDown(),this.light.visible=!1,this.timeLine.visible=!1},e.prototype.countDown=function(t,e){var i=this;this.initCountDown(),this.totalTime=e;var n=t-e;this.time_out_id&&this.stopCountDown(),this.light.visible=!0,this.timeLine.visible=!0;var o=util.TimeUtil.now;this.time_out_id2=util.TimeUtil.setInterval(function(){util.TimeUtil.now<t&&util.SoundUtil.play("time_mp3")},1e3),this.time_out_id3=util.TimeUtil.setInterval(function(){t-util.TimeUtil.now>=900&&(util.SoundUtil.play("WarningtimeOver_mp3"),i.time_out_id3&&util.TimeUtil.clearInterval(i.time_out_id3),i.time_out_id3=void 0)},t-o-1e3),this.time_out_id=util.TimeUtil.setInterval(function(){var e=util.TimeUtil.now-n,o=i.lightMove(e),r=o.x,s=o.y;if(i.light.x=r,i.light.y=s,t-n>e){i.shape.graphics.clear();var a=s-i.shape.y,l=r-i.shape.x,u=Math.asin(a/Math.sqrt(a*a+l*l));r<i.shape.x&&(u=Math.PI-u),i.changeGraphics(u)}else i.stopCountDown()},50,this)},e.prototype.stopCountDown=function(){this.time_out_id&&util.TimeUtil.clearInterval(this.time_out_id),this.time_out_id=void 0,this.time_out_id2&&util.TimeUtil.clearInterval(this.time_out_id2),this.time_out_id2=void 0,this.time_out_id3&&util.TimeUtil.clearInterval(this.time_out_id3),this.time_out_id3=void 0,this.light.visible=!1,this.timeLine.visible=!1},e.prototype.lightMove=function(t){var e="own"===this.type?118:113,i="own"===this.type?118:113,n=7.5,o=5,r=2*n*Math.PI;this.diy=o/2;var s=(r+2*e+2*i)/this.totalTime;this.dix=e/2+n+o/2;var a,l,u=t*s,h=e/2,c=h+r/4,p=c+i,_=p+r/4,d=_+e,g=d+r/4,m=g+i,f=m+r/4,b=f+e/2;if(h>u)a=t*s+this.dix,l=this.diy;else if(c>u){var y=(u-h)/(r/4)*(Math.PI/2);a=h+this.dix+Math.sin(y)*n,l=n*(1-Math.cos(y))+this.diy}else if(p>u)a=h+n+this.dix,l=n+u-c+this.diy;else if(_>u){var y=(u-p)/(r/4)*(Math.PI/2);a=h+n*Math.cos(y)+this.dix,l=i+n+n*Math.sin(y)+this.diy}else if(d>u)a=h-(u-_)+this.dix,l=i+2*n+this.diy;else if(g>u){var y=(u-d)/(r/4)*(Math.PI/2);a=-h-Math.sin(y)*n+this.dix,l=i+Math.cos(y)*n+this.diy+n}else if(m>u)a=-h-n+this.dix,l=i+n-(u-g)+this.diy;else if(f>u){var y=(u-m)/(r/4)*(Math.PI/2);a=-h+this.dix-7.5*Math.cos(y),l=n-n*Math.sin(y)+this.diy}else b>u?(a=u-f-h+this.dix,l=this.diy):(a=this.dix,l=this.diy);return{x:a,y:l}},e.prototype.scoreAni=function(t,e){this.group_surplus.visible=!0,e>=0?this.lab_surplus.font="pok_win_fnt":this.lab_surplus.font="pok_lose_fnt",this.lab_surplus.text="",util.NumberUtil.tweenNumber(this.lab_surplus,e,t,!0)},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.pokdeng.PlayerFrame")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.pokerIndex=0,i.pokerIndex2=0,i.pokerIndex3=0,i.parent_container=t,i.initPoker(),i}return __extends(i,e),i.prototype.shuffle=function(){var t=this;return util.SoundUtil.play("fp_mp3"),this.initPoker(),new Promise(function(e){for(var i=0;51>i;i++){var n=t.pokers[i];egret.Tween.removeTweens(n),n.visible=!0;var o=util.NumberUtil.getRandom(-1,1),r=util.NumberUtil.getRandom(-1,1),s=util.NumberUtil.getRandom(60,80),a=util.NumberUtil.getRandom(60,80),l=n.x,u=n.y,h=100;egret.Tween.get(n).to({x:o*s,y:u+5*r},h).to({x:l,y:u},h).to({x:r*s,y:u+5*o},h).to({x:l,y:u},h).to({x:o*a,y:u+5*r},h).to({x:l,y:u},h).to({x:r*s,y:u+5*o},h).to({x:l,y:u},h).call(e)}})},i.prototype.flyCard=function(t,e,i){var n=this;return new Promise(function(o){util.SoundUtil.play("baicao_bet1_mp3");var r=n.pokers[n.pokerIndex],s=[1,4,5],a=s.indexOf(i)>-1?360:-360;r.size=t,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,n.parent_container.setChildIndex(r,n.parent_container.numChildren);var l=r.globalToLocal(e.x,e.y);egret.Tween.removeTweens(r),egret.Tween.get(r).set({x:0,y:1-n.pokerIndex,visible:!0,rotation:0,size:.7}).to({x:l.x,y:l.y+1-n.pokerIndex,rotation:a,size:t},150).call(o),n.pokerIndex--})},i.prototype.initPoker=function(){this.pokers=[],this.parent_container.removeChildren();for(var e=1;52>=e;e++){var i=new t.component.Poker;i.x=0,i.y=1-e,i.size=.5,i.visible=!0,this.parent_container.addChild(i),this.pokers.push(i)}this.pokerIndex=51,this.pokerIndex2=51,this.pokerIndex3=51},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.pokdeng.PokerAni")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isWatch=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+(this.type?""+this.type:"")},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent(),this.deleteCard()},e.prototype.registerEvent=function(){var t=this;this.btn_keycard.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dispatchEventWith(e.EVT_KEYCARD)},this),this.btn_pass.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dispatchEventWith(e.EVT_PASS)},this)},e.prototype.setCheckButtonVisible=function(t){this.btn_keycard.visible=t,this.btn_pass.visible=t},e.prototype.deleteCard=function(){this.poker_3.includeInLayout=this.poker_3.visible=!1},e.prototype.keycard=function(){this.poker_3.includeInLayout=this.poker_3.visible=!0},e.prototype.setBack=function(){for(var t=1;3>=t;t++){var e=this["poker_"+t];e.currentState="back"}this.statusBg.visible=!1,this.statusText.visible=!1},Object.defineProperty(e.prototype,"isWatch",{get:function(){return this._isWatch},enumerable:!0,configurable:!0}),e.prototype.setWatch=function(t){this._isWatch!==t&&(this._isWatch=t)},e.prototype.showStatus=function(t,e){t?(this.statusBg.source="pok_pic_pointsbg2_png",this.cardType1=util.LanguageUtil.translate("ng_pokdeng_king")+String(e)):(this.statusBg.source="pok_pic_pointsbg1_png",this.cardType1=String(e)+util.LanguageUtil.translate("ng_point")),this.statusBg.source=t?"pok_pic_pointsbg2_png":"pok_pic_pointsbg1_png"},e.prototype.showStatusText=function(t){var e=[9,10,11,22,23,24,35,36,37,48,49,50],i=[8,9],n=e.indexOf(t[0])>-1?10:t[0]%13===12?1:t[0]%13+2,o=e.indexOf(t[1])>-1?10:t[1]%13===12?1:t[1]%13+2,r=0,s=0;t.length>2?(r=e.indexOf(t[2])>-1?10:t[2]%13===12?1:t[2]%13+2,s=(n+o+r)%10,this.showStatus(!1,s)):(s=(n+o)%10,this.showStatus(i.indexOf(s)>-1,s))},e.prototype.showResult=function(t,e,i,n,o){return __awaiter(this,void 0,void 0,function(){var r,s=this;return __generator(this,function(a){switch(a.label){case 0:return"normal"===this.poker_1.currentState?[2]:(this.poker_1.num=e[0],this.poker_2.num=e[1],this.poker_3.visible&&(this.poker_3.num=e[2]),[4,this.poker_1.turnCard(t)]);case 1:return a.sent(),[4,this.poker_2.turnCard(t)];case 2:return a.sent(),r=this.poker_3.visible,r?[4,this.poker_3.turnCard(t)]:[3,4];case 3:r=a.sent(),a.label=4;case 4:return this.showStatus(o.is_sky,o.point),n&&this.showMutiple(i),this.statusBg.visible?[2]:[4,new Promise(function(e){egret.Tween.get(s.statusBg).set({scaleX:0,visible:!0}).to({scaleX:1},t),egret.Tween.get(s.statusText).set({scaleX:3,scaleY:3,visible:!0}).to({alpha:1,scaleX:1,scaleY:1},t).call(e)})];case 5:return a.sent(),[2]}})})},e.prototype.showMutiple=function(t){this.mutipleNum=String(t),this.mutiple.visible=!0},e.prototype.getPokerType=function(t){return this["poker_"+t].size},e.prototype.getCardPos=function(t){return this["poker_"+t].localToGlobal()},e.EVT_KEYCARD="evt_keycard",e.EVT_PASS="evt_pass",e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.pokdeng.PokerList")}(e=t.pokdeng||(t.pokdeng={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.GetVirtualDeskTopic=e,__reflect(e.prototype,"topic.GetVirtualDeskTopic");var i;!function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{desk_id:{type:"string"}},required:["desk_id"],type:"object"}},required:["snapshot"],type:"object"}}(i=t.getVirtualDeskTopic||(t.getVirtualDeskTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._allBtn=[],e.ALL_TYPE=["write_4","red_4","write_3_red_1","write_1_red_3","double","single"],e._clickEffAll=[],e._winEffAll=[],e.shot=function(t){egret.callLater(function(){egret.callLater(function(){var i=new egret.RenderTexture;i.drawToTexture(t),e.img_shot.source=i},e)},e)},e}return __extends(e,t),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this._allBtn=[this.btnFourW,this.btnFourR,this.btnThreeW,this.btnThreeR,this.btnDouble,this.btnSingle],this._clickEffAll=[this.clickEffFW,this.clickEffFR,this.clickEffTW,this.clickEffTR,this.clickEffDou,this.clickEffSin],this._winEffAll=[this.winEffFW,this.winEffFR,this.winEffTW,this.winEffTR,this.winEffDou,this.winEffSin],this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i._allBtn[0].touchEnabled||i.dispatchEventWith(e.EVT_SHOW_TIP)},this),this.ALL_TYPE.forEach(function(t,e){i._clickEffAll[e].visible=!1,i._allBtn[e].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.onBet(t)},i),i._allBtn[e].addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){i._clickEffAll[e].visible=!0},i),i._allBtn[e].addEventListener(egret.TouchEvent.TOUCH_END,function(){i._clickEffAll[e].visible=!1},i),mouse.setButtonMode(i._allBtn[e],!0)}),this.init(),this.gp_bg.addEventListener(egret.Event.RESIZE,function(){return i.shot(i.gp_bg)},this),this.gp_bg.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return i.shot(i.gp_bg)},this),this.shot(this.gp_bg)},e.prototype.init=function(){var t=this;this.ALL_TYPE.forEach(function(e,i){egret.Tween.removeTweens(t._winEffAll[i]),t._winEffAll[i].visible=!1,t._clickEffAll[i].visible=!1})},e.prototype.showResult=function(t){var e=this;this.init(),t.forEach(function(t,i){egret.Tween.get(e._winEffAll[t],{loop:!0}).set({visible:!0}).wait(400).set({visible:!1}).wait(400)})},e.prototype.onBet=function(t){this.dispatchEventWith(e.EVT_BET,!1,t)},e.prototype.setEnable=function(t){var e=this;this.ALL_TYPE.forEach(function(i,n){e._allBtn[n].touchEnabled=t})},e.prototype.resetInterface=function(){},e.EVT_BET="evt_bet",e.EVT_SHOW_TIP="evt_show_tip",e}(t.Component);e.BetArea=i,__reflect(i.prototype,"ui.sedie.BetArea")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setChips=function(t){this.com_chipList.setChips(t)},e.prototype.setHead=function(t){this.com_head.setHead(t)},e.prototype.setName=function(t){this.com_head.setName(t)},e.prototype.setBalance=function(t){this.com_head.setBalance(t)},e.prototype.setSurplus=function(t){0===t?this.com_head.showSurplus(!1):this.com_head.showSurplus(!0,t)},e.prototype.getOwnPos=function(){var t=this.com_head.localToGlobal();return{x:t.x+64,y:t.y+64}},e.prototype.showSurplus=function(t,e){this.com_head.showSurplus(t,e)},e.prototype.getCurChipValue=function(){return this.com_chipList.cur_chosen_item.value},e.prototype.showWin=function(t){this.com_head.showWin(t)},e.prototype.updateEnable=function(t){this.com_chipList.updateEnable(t)},e.prototype.betAni=function(t){if(t){var e=0;this.com_head.verticalCenter=e,egret.Tween.get(this.com_head).to({verticalCenter:e-15},80,egret.Ease.quadOut).to({verticalCenter:e},80,egret.Ease.quadIn)}},e.EVT_TOGGLE_PEOPLE="evt_open_people",e}(t.Component);e.BottomPanel=i,__reflect(i.prototype,"ui.sedie.BottomPanel")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.ChipArr=[],t.scale=.76,t.posLong=[{x:624,y:-4},{x:636,y:59},{x:578,y:84},{x:571,y:22},{x:520,y:-2},{x:516,y:83},{x:428,y:-2},{x:436,y:86},{x:366,y:-4},{x:385,y:55},{x:264,y:88},{x:292,y:-9},{x:336,y:88},{x:243,y:29},{x:192,y:-9},{x:143,y:84},{x:127,y:-2},{x:67,y:89},{x:0,y:0},{x:0,y:81}],t.posShortleft=[{x:370,y:118},{x:327,y:82},{x:116,y:90},{x:114,y:29},{x:186,y:40},{x:184,y:94},{x:254,y:47},{x:255,y:104},{x:39,y:22},{x:4,y:108},{x:49,y:82},{x:-4,y:53},{x:382,y:52},{x:329,y:21},{x:372,y:-14},{x:256,y:-14},{x:186,y:151},{x:112,y:147},{x:192,y:-13},{x:0,y:-12}],t.posShortRight=[{x:370,y:-4},{x:338,y:47},{x:260,y:-11},{x:-2,y:86},{x:372,y:89},{x:256,y:60},{x:270,y:123},{x:190,y:118},{x:190,y:-2},{x:120,y:49},{x:182,y:57},{x:41,y:-6},{x:121,y:110},{x:41,y:55},{x:122,y:-10},{x:-10,y:22},{x:315,y:-4},{x:194,y:182},{x:325,y:118},{x:51,y:110}],t}return __extends(i,e),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"test",{get:function(){return this._test},set:function(t){this._test=t,this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),i.prototype.getCurrentState=function(){return this._test},i.prototype.setLeftOrRight=function(t){this.isLeft="leftArea"===t},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.mineChipstack=[],this.otherChipstack=[];for(var i=0;8>i;i++){var n=new t.component.ChipStacked(this.scale);this.otherChipstack.push(n),this.otherGroup.addChild(n)}for(var i=0;3>i;i++){var n=new t.component.ChipStacked(this.scale);this.mineChipstack.push(n),this.mineGroup.addChild(n)}},i.prototype.resetPosition=function(){"longArea"===this._type?this.randPostion(this.posLong):this.randPostion(this.isLeft?this.posShortleft:this.posShortRight)},i.prototype.init=function(){this.mineChipstack.forEach(function(t){t.initChips()}),this.otherChipstack.forEach(function(t){t.initChips()}),this.resetPosition()},i.prototype.initStack=function(t){switch(t){case"all":this.mineChipstack.forEach(function(t){t.initChips()}),this.otherChipstack.forEach(function(t){t.initChips()});break;case"own":this.mineChipstack.forEach(function(t){t.initChips()});break;case"other":this.otherChipstack.forEach(function(t){t.initChips()})}},i.prototype.randPostion=function(t){for(var e=this,i=[],n=0;20>n;n++)i.push(n);for(var o=[],n=0;11>n;n++)o.push(i.splice(Math.floor(Math.random()*i.length),1)[0]);o.forEach(function(i,n){var o;o=8>n?e.otherChipstack[n]:e.mineChipstack[n-8],o.x=t[i].x,o.y=t[i].y})},i.prototype.getRandomPositions=function(t){if(t)return[this.mineChipstack[Math.floor(3*Math.random())].getFlyChipGlobalPos()];
var e=[0,1,2,3,4,5,6,7],i=[];return i.push(e.splice(Math.floor(Math.random()*e.length),1)),i.push(e.splice(Math.floor(Math.random()*e.length),1)),[this.otherChipstack[i[0]].getFlyChipGlobalPos(),this.otherChipstack[i[1]].getFlyChipGlobalPos()]},i.prototype.getRandomChipStack=function(t){if(t)return[this.mineChipstack[Math.floor(3*Math.random())]];var e=[0,1,2,3,4,5,6,7],i=[];return i.push(e.splice(Math.floor(Math.random()*e.length),1)),i.push(e.splice(Math.floor(Math.random()*e.length),1)),[this.otherChipstack[i[0]],this.otherChipstack[i[1]]]},i.prototype.getImages=function(t,e){var i=this,n=[];switch(e){case"all":this.otherChipstack.forEach(function(e){e.cur_show_num&&n.push(i.chipstackCopyImage(e,t))}),this.mineChipstack.forEach(function(e){e.cur_show_num&&n.push(i.chipstackCopyImage(e,t))});break;case"own":this.mineChipstack.forEach(function(e){e.cur_show_num&&n.push(i.chipstackCopyImage(e,t))});break;case"other":this.otherChipstack.forEach(function(e){e.cur_show_num&&n.push(i.chipstackCopyImage(e,t))})}return n},i.prototype.chipstackCopyImage=function(t,e){var i=t.getCopyImg(e);return i.scaleX=i.scaleY=this.scale,i},i.prototype.getAChipStack=function(t){return t?this.mineChipstack[Math.floor(3*Math.random())]:this.otherChipstack[Math.floor(8*Math.random())]},i.prototype.begin=function(t){t.stopPropagation(),this.beginChipPos={x:this.selected.x,y:this.selected.y},this.beginPos={x:t.stageX,y:t.stageY},this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.move,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.end,this)},i.prototype.move=function(t){this.selected&&(this.selected.x=t.stageX-this.beginPos.x+this.beginChipPos.x,this.selected.y=t.stageY-this.beginPos.y+this.beginChipPos.y)},i.prototype.end=function(t){this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.move,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.end,this),this.selected&&(this.selected.x=t.stageX-this.beginPos.x+this.beginChipPos.x,this.selected.y=t.stageY-this.beginPos.y+this.beginChipPos.y,this.selected=void 0)},i.prototype.getPos=function(){var t=[];return this.ChipArr.forEach(function(e){t.push({x:Math.floor(e.x),y:Math.floor(e.y)})}),t},i}(eui.Component);e.ChipArea=i,__reflect(i.prototype,"ui.sedie.ChipArea")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(t,e){var i=this;void 0===e&&(e=!1),this.clearTimer(),util.SoundUtil.destroy(["brnn_stopbet_mp3"]);var n=t-util.TimeUtil.now;n>0&&(this.timer=util.TimeUtil.setInterval(function(){var n=t-util.TimeUtil.now;if(n>=0){i.visible=!0;var o=i.lab_count.text!==Math.round(n/1e3).toString();if(i.lab_count.text=Math.round(n/1e3).toString(),o&&util.SoundUtil.play("time_mp3"),(3===Math.round(n/1e3)||2===Math.round(n/1e3)||1===Math.round(n/1e3))&&e&&o){var r=20,s=18;util.SoundUtil.play("WarningtimeOver_mp3"),egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,egret.Tween.get(i.img_bg,{loop:!0}).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).to({rotation:s},r).to({rotation:0},r).to({rotation:-s},r).to({rotation:0},r).wait(60)}}else egret.Tween.removeTweens(i.img_bg),i.img_bg.rotation=0,i.visible=!1,i.lab_count.text="0",i.clearTimer()},100))},e.prototype.clearTimer=function(){null!=this.timer&&(util.TimeUtil.clearInterval(this.timer),this.timer=null,this.visible=!1,egret.Tween.removeTweens(this.img_bg),this.img_bg.rotation=0)},e}(t.Component);e.CountDown=i,__reflect(i.prototype,"ui.sedie.CountDown")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var Controller=function(){function t(){var t=this;this.bgmArr=[],this.login=function(e){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:ui.dialog.MiniLoadingDialog.instance.show(),i.label=1;case 1:return i.trys.push([1,3,,4]),e?delete params.guest:params.guest="undefined",[4,service.LoginService.instance.connectServer(e)];case 2:return i.sent(),[3,4];case 3:return t=i.sent(),ui.LoginUI.instance.execCommand(Const.UICommand.CMD_SHOW_HINT,t.message),[3,4];case 4:return ui.dialog.MiniLoadingDialog.instance.close(),[2]}})})},this.playBGM=function(e){var i=t.bgmArr[t.bgmArr.length-1],n=e||t.bgmArr[t.bgmArr.length-2];e?t.bgmArr.push(e):t.bgmArr.pop(),n!==i&&(i&&util.SoundUtil.destroy([i],egret.Sound.MUSIC),util.SoundUtil.play(n,0,egret.Sound.MUSIC))},this.beginCheck=function(){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return this.checking?[2]:(this.checking=!0,[4,this.checkRegister()]);case 1:return t=e.sent(),t&&refresh(""+location.origin+location.pathname+"?username="+t.username+"&accessToken="+encodeURIComponent(params.accessToken)+(params.debug?"&debug":"")),[2]}})})},this.endCheck=function(){return t.checking=!1},this.checkRegister=function(){return service.MainService.instance.checkRegister()["catch"](function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){return util.TimeUtil.setTimeout(t,1e3)})];case 1:return t.sent(),[2,Promise.resolve(this.checking?this.checkRegister():null)]}})})})},this.generateNotice=function(t,e){var i="\\[(\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\]",n=function(t){return""+(16>t?"0":"")+Number(t).toString(16).toUpperCase()},o=function(t,e,i,o,r){return"0x"+n(i)+n(o)+n(r)};return util.ObjectUtil.minus(e?e.snapshot.record:null,t.snapshot.record.filter(function(t){var e;if(t.room_type)if(-1===GameConst.game_list.indexOf(t.room_type))e=!1;else{var i=Data.getTopic(Const.Topic.ROOMS+"/"+t.room_type);e=i&&t.room_id?Object.keys(i.snapshot.rooms).some(function(e){return e===t.room_id&&i.snapshot.rooms[e].visible}):!0}else e=!0;return e})).map(function(t){return t.message.match(RegExp("("+i+")?(.(?!"+i+"))*.","g")).map(function(t){var e=t.replace(RegExp("("+i+").*"),o);return{text:t.replace(RegExp(i),""),style:{textColor:e===t?null:Number(e)}}})})}}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o=this;return __generator(this,function(r){switch(r.label){case 0:return this.registerNotify(),resourceTime=Date.now(),[4,RES.loadGroup("preload")];case 1:return r.sent(),resourceTime=Date.now()-resourceTime,this.playBGM("home_bg_"+Const.Config.SKIN+"_mp3"),[4,service.ServiceBase.init()];case 2:return r.sent(),section.style.display="none",document.body.classList.add("skin"+Const.Config.SKIN),this.toggleUI(ui.LoadingUI.instance,!0),resourceTime=Date.now()-resourceTime,[4,ui.MainUI.instance.preLoad(ui.LoadingUI.instance.setProgress)];case 3:return r.sent(),resourceTime=Date.now()-resourceTime,util.LogUtil.warn("[resourceTime] => "+.001*resourceTime+"s"),Const.UserInfo.AVATAR=ui.component.Avatar.generateAvatar(Const.UserInfo.AVATAR),[4,new Promise(function(t){ui.MainUI.instance.addEventListener(eui.UIEvent.CREATION_COMPLETE,t,o),ui.MainUI.instance.visible=!1,Main.instance.addChild(ui.MainUI.instance)})];case 4:return r.sent(),[4,this.initData()];case 5:return r.sent(),this.toggleUI(ui.LoadingUI.instance,!1),[4,this.checkReBackRoom()];case 6:return r.sent(),ui.MainUI.instance.visible=!0,Main.instance.pushStat(),totalTime=Date.now()-totalTime,util.LogUtil.warn("[totalTime] => "+.001*totalTime+"s"),window.addEventListener("message",function(t){return __awaiter(o,void 0,void 0,function(){var e,i,n,o,r;return __generator(this,function(s){switch(s.label){case 0:if(t.source!==window)return[3,4];switch(e=t.data.cmd){case"speed":return[3,1]}return[3,4];case 1:return(i=speed.length)?(o=(n=Data).validate,r=[topic.TimestampTopic.schema],[4,service.LoginService.instance.snapshot(Const.Topic.TIMESTAMP,{speed:speed.splice(0)})]):[3,3];case 2:i=o.apply(n,r.concat([s.sent()])),s.label=3;case 3:return[3,4];case 4:return[2]}})})}),e=(t=Data).validate,i=[topic.TimestampTopic.schema],[4,service.LoginService.instance.snapshot(Const.Topic.TIMESTAMP,{start:loadTime,load:jsTime,init:resourceTime,total:totalTime,speed:speed&&speed.splice(0)})];case 7:return e.apply(t,i.concat([r.sent()])),Const.Config.POOL_NOTIFY&&(n=Object.keys(Const.Config.POOL_NOTIFY).map(function(t){return Const.Config.POOL_NOTIFY[t]}).sort(function(t,e){return t.payout_time-e.payout_time}),n.length&&(n.forEach(function(t){ui.dialog.MiniPoolDialog.instance.show({game:t.type,user_id:Const.UserInfo.USER_ID,username:Const.UserInfo.NICK,payout:t.payout,autoHide:5e3})}),service.MainService.instance.removePoolNotify(n[0].type))),[2]}})})},t.prototype.initData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return util.LogUtil.info("[Controller] game_list => "+JSON.stringify(GameConst.game_list)),GameConst.all_game_data_list.forEach(function(t){-1!==GameConst.game_list.indexOf(t.name)&&(t.dg_item_data.name=t.name,GameConst.valid_game_data_map.set(t.name,t),util.LogUtil.info("[Controller] init data with ["+t.name+","+t+"]"))}),util.LogUtil.info("[Controller] valid_game_data_map => "+JSON.stringify(GameConst.valid_game_data_map)),[4,Promise.all([service.MainService.instance.subscribeOnline(),service.MainService.instance.subscribeWorldMessage(),(ui.component.Pool.visible=!!Const.Config.OPEN_POOL_SWITCHER)&&Promise.all(GameConst.game_list.map(function(t){return service.MainService.instance.subsPool(t)["catch"](function(){return Promise.resolve()})}))])];case 1:return t.sent(),this.registerData(),this.initMainData(),[2]}})})},t.prototype.initMainData=function(){var t=Data.getTopic(Const.Topic.ACCOUNT),e=Data.getTopic(Const.Topic.ONLINE),i=Data.getTopic(Const.Topic.WORLD_MESSAGE);Data.validate(topic.AccountTopic.schema,t),Data.validate(topic.OnlineTopic.schema,e),Data.validate(topic.WorldMessageTopic.schema,i),this.updateOnlinePlayers(e.snapshot),ui.MainUI.instance.setInitData({game_list:GameConst.game_list.filter(function(t){return GameConst.valid_game_data_map.has(t)}),hot_list:GameConst.hot_list.filter(function(t){return GameConst.valid_game_data_map.has(t)}),nick:Const.UserInfo.NICK,avatar:Const.UserInfo.AVATAR,balance:t.snapshot.balance,online:e.snapshot,notice:this.generateNotice(i)})},t.prototype.registerNotify=function(){var t=this;util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_LOGIN,this.login),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BEGIN_CHECK,this.beginCheck),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_END_CHECK,this.endCheck),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BGM,this.playBGM),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_POOL,function(t,e){var i=Data.getTopic(Const.Topic.POOL+"/"+t);e.tween(i&&i.snapshot&&i.snapshot.money||0,0)}),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_CHANGE_AVATAR,function(e){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return t=!params.guest,t?[4,service.MainService.instance.changeAvatar(e)]:[3,2];case 1:t=i.sent(),i.label=2;case 2:return Const.UserInfo.AVATAR=e,ui.MainUI.instance.execCommand(Const.UICommand.CMD_CHANGE_AVATAR,e),ui.dialog.ProfileDialog.instance.close(),[2]}})})}),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_FEEDBACK,function(e){return __awaiter(t,void 0,void 0,function(){var t,i;return __generator(this,function(n){switch(n.label){case 0:ui.dialog.MiniLoadingDialog.instance.show(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,service.MainService.instance.sendFeedback(e)];case 2:return t=n.sent().code,ui.dialog.MessageDialog.instance.showHint(t?"lbl_game_feedbackerror":"lbl_game_feedbacksuccess"),[3,4];case 3:return i=n.sent(),ui.dialog.MessageDialog.instance.showHint("lbl_game_feedbackerror"),[3,4];case 4:return ui.dialog.FeedbackDialog.instance.close(),ui.dialog.MiniLoadingDialog.instance.close(),[2]}})})}),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_RECORD,function(){return __awaiter(t,void 0,void 0,function(){var t,e,i;return __generator(this,function(n){switch(n.label){case 0:ui.dialog.MiniLoadingDialog.instance.show(),n.label=1;case 1:return n.trys.push([1,3,,4]),e=(t=ui.dialog.RecordDialog.instance).show,[4,service.MainService.instance.getRecord()];case 2:return e.apply(t,[n.sent()]),[3,4];case 3:return i=n.sent(),ui.dialog.MessageDialog.instance.showHint("lbl_game_requireerror"),[3,4];case 4:return ui.dialog.MiniLoadingDialog.instance.close(),[2]}})})}),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_TOGGLEUI,this.toggleUI),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_ENTER_SEC_HALL,function(t){return GameCoreController.instance.enterHall(t.type)}),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BACK_PRI_HALL,function(){return GameCoreController.instance.leaveHall()}),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_ENTER_DESK,function(t){return GameCoreController.instance.enterGame(t,void 0)}),util.NotifyUtil.addNotification(Const.UINotify.NOTIFY_BACK_SEC_HALL,function(t){return GameCoreController.instance.leaveGame(t)})},t.prototype.registerData=function(){var t=this;util.NotifyUtil.addNotification("Main.instance.fps",function(t){return ui.MainUI.instance.execCommand(Const.UICommand.CMD_UPDATE_FPS,t)}),util.NotifyUtil.addNotification("topic.account",function(t){Data.validate(topic.AccountTopic.schema,t),ui.MainUI.instance.execCommand(Const.UICommand.CMD_UPDATE_BALANCE,t.snapshot.balance)}),util.NotifyUtil.addNotification("topic.online_players",function(e){Data.validate(topic.OnlineTopic.schema,e),t.updateOnlinePlayers(e.snapshot),ui.MainUI.instance.execCommand(Const.UICommand.CMD_UPDATE_ONLINE,e.snapshot)}),util.NotifyUtil.addNotification("topic.world_message",function(e,i){Data.validate(topic.WorldMessageTopic.schema,e);var n=t.generateNotice(e,i),o=GameConst.valid_game_data_map.get(GameCoreController.instance.cur_game);ui.MainUI.instance.execCommand(Const.UICommand.CMD_UPDATE_WORLD_MESSAGE,n),o&&o.cmpt.room_ui.execCommand(Const.UICommand.CMD_UPDATE_WORLD_MESSAGE,n)}),GameConst.game_list.forEach(function(t){return util.NotifyUtil.addNotification("topic.pool/"+t,function(e,i){if(Data.validate(topic.PoolTopic.schema,e),!util.ObjectUtil.isEqual(i.snapshot.money,e.snapshot.money)&&ui.component.Pool.tween(t,e.snapshot.money),!util.ObjectUtil.isEqual(i.snapshot.last_winner,e.snapshot.last_winner)){var n=e.snapshot.last_winner.user_id===Const.UserInfo.USER_ID,o=GameConst.valid_game_data_map.get(t).cmpt.room_ui.stage;(n||o)&&((n&&o?ui.dialog.PoolDialog:ui.dialog.MiniPoolDialog).instance.show(util.ObjectUtil.merge(e.snapshot.last_winner,{game:t,autoHide:5e3})),n&&service.MainService.instance.removePoolNotify(t))}})})},t.prototype.toggleUI=function(t,e,i){return void 0===i&&(i=!0),__awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return e?(i&&ui.dialog.MiniLoadingDialog.instance.show(),[4,t.preLoad()]):[3,2];case 1:return n.sent(),Main.instance.addChild(t),i&&ui.dialog.MiniLoadingDialog.instance.close(),[3,3];case 2:Main.instance.removeChild(t),n.label=3;case 3:return[2]}})})},t.prototype.updateOnlinePlayers=function(t){util.LogUtil.debug("[Controller] [initMainData] [updateOnlinePlayers] [receive] online => "+JSON.stringify(t)),GameConst.valid_game_data_map.forEach(function(e){var i=(t.base_count[e.name]||0)+(t.game_count[e.name]||0);e.dg_item_data.online_num=i})},t.prototype.checkReBackRoom=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o,r,s,a,l,i;return __generator(this,function(u){switch(u.label){case 0:return t=Data.getTopic(Const.Topic.ACCOUNT).snapshot.lock,e=t&&t.lock_by,util.LogUtil.info("[checkReBackRoom] lock => "+JSON.stringify(t)+" topic => "+JSON.stringify(e)),t&&e?(i=GameConst.all_game_data_list.filter(function(e){return e.name===t.room_type})[0],n=i?i.name:null,util.LogUtil.info("[checkReBackRoom] enterSecHall game_type => "+n),[4,GameCoreController.instance.enterHall(n)["catch"](function(t){util.LogUtil.error(t),Promise.reject(new Error("lbl_game_invisible"))})]):[3,3];case 1:return u.sent(),o=t.room_id,r=GameConst.valid_game_data_map.get(n),s=r.cmpt.controller,a=e.replace(/.*\/([^\/]*)/,"$1"),[4,service.MainService.instance.subscribe(e,t.room_type+"_desk/"+a)["catch"](function(t){var i;try{i=JSON.stringify(t.message,null,4)}catch(t){i=t.message}ui.dialog.MessageDialog.instance.showException(util.LanguageUtil.translate("lbl_game_requesterror","error"),"lbl_game_comfirm",e,i,refresh)})];case 2:if(l=u.sent(),util.LogUtil.info("[checkReBackRoom] desk_topic alias => "+t.room_type+"_desk/"+a),l&&l.snapshot.version)try{Data.validate({type:"object",properties:{snapshot:{type:"object","if":s instanceof MatchDeskGameController,then:{anyOf:[{properties:{stage:{type:"string"}},required:["stage"]},{properties:{desk_info:{type:"object",properties:{stage:{type:"string"}},required:["stage"]}},required:["desk_info"]}]}}},required:["snapshot"]},l,refresh),util.LogUtil.info("[checkReBackRoom] desk_topic => "+JSON.stringify(l)),s.checkReBackRoom(l)&&(util.LogUtil.warn("[checkReBackRoom] ReBackRoom"),GameCoreController.instance.enterGame(o,a))}catch(h){}return[3,4];case 3:if(params.game){if(util.LogUtil.warn("[checkReBackRoom] params.game => "+params.game),"main"!==params.game)return i=GameConst.all_game_data_list.filter(function(t){return t.name===params.game})[0],i?[2,GameCoreController.instance.enterHall(i.name)["catch"](function(t){util.LogUtil.error(t),Promise.reject(new Error("lbl_game_invisible"))})]:[2,Promise.reject(new Error("lbl_game_error"))];delete params.game}u.label=4;case 4:return[2]}})})},t}();__reflect(Controller.prototype,"Controller");var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.imgs=[this.img_1,this.img_2,this.img_3,this.img_4]},e.prototype.dataChanged=function(){var t=this;this.data&&this.data.length&&this.data.forEach(function(e,i){4===i?"single"===e?(t.lb_Count.text=util.LanguageUtil.translate("lbl_game_odd2"),t.lb_Count.textColor=5360613):(t.lb_Count.text=util.LanguageUtil.translate("lbl_game_even2"),t.lb_Count.textColor=15567689):t.imgs[i].source="red"===e?"sd_pic_road_r_png":"sd_pic_road_w_png"})},e}(eui.ItemRenderer);t.LushuItem=e,__reflect(e.prototype,"ui.sedie.LushuItem")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setName=function(t){this.username=t},e.prototype.setBalance=function(t){util.NumberUtil.tweenNumber(this.lb_balance,t)},e.prototype.setHead=function(t){this.avatar=t},e.prototype.showSurplus=function(t,e){var i=this;if(this.lab_surplus.text="0",t)if(e>0){var n=function(){egret.Tween.removeTweens(i.com_head),i.com_head.verticalCenter=0};this.lab_surplus.font="bc_font_win_money_fnt",this.lab_sign.font="bc_font_win_money_fnt",this.lab_sign.text="+",util.SoundUtil.play("win_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,e,1e3),n(),egret.Tween.get(this.com_head).to({verticalCenter:-30},80,egret.Ease.quadOut).to({verticalCenter:0},80,egret.Ease.quadIn).call(n)}else 0>e&&(this.lab_surplus.font="bc_font_lose_money_fnt",this.lab_sign.font="bc_font_lose_money_fnt",this.lab_sign.text="-",util.SoundUtil.play("dissapoint_mp3"),util.NumberUtil.tweenNumber(this.lab_surplus,Math.abs(e),1e3));this.lab_sign.visible=t,this.lab_surplus.visible=t},e.prototype.showWin=function(t){this.mc_win.visible=t},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.sedie.PlayerFrame")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shot=function(){egret.callLater(function(){egret.callLater(function(){e.gp_shots.$children.forEach(function(t){return t.source=null});for(var t=e.roadMap.height,i=2e3,n=e.roadMap.width/i<<0,o=0;n>o;o++){var r=e.getShotsImg(o),s=new egret.RenderTexture,a=new egret.Rectangle(i*o,0,i*(o+1),t);s.drawToTexture(e.roadMap,a),r.source=s}var l=e.getShotsImg(n),u=new egret.RenderTexture;u.drawToTexture(e.roadMap,new egret.Rectangle(n*i,0,e.roadMap.width,t)),l.source=u},e)},e)},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return e.resize()},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return e.scroller.stopAnimation()},this)},e.prototype.updateRoadMap=function(t){if(t&&this.roadMap&&!util.ObjectUtil.isEqual(t.road_map,this.oldRoadMap)){util.LogUtil.debug("[sedie] [RoomRoadMap] [updateRoadMap] write_4=>"+t.result_percent.write_4+" red_4=>"+t.result_percent.red_4+" single=>"+t.result_percent.single+" double=>"+t.result_percent["double"]),this.lb_white.text=t.result_percent.write_4+"%",this.lb_red.text=t.result_percent.red_4+"%",this.lb_single.text=t.result_percent.single+"%",this.lb_double.text=t.result_percent["double"]+"%";var e=util.ObjectUtil.copy(t.road_map);e.length&&void 0!==this.oldRoadMap&&(e[e.length-1].isNew=!0,e[e.length-1].time=util.TimeUtil.now),this.oldRoadMap=util.ObjectUtil.copy(t.road_map),this.roadMap.dataProvider=new eui.ArrayCollection(e),this.resize()}},e.prototype.resize=function(){if(this.oldRoadMap){var t=Math.floor((this.width+2)/54);this.root.width=54*t;var e=54*this.oldRoadMap.length-2;this.img_ligth.x=e>0?e-54:0,this.scroller.viewport.scrollH=e>this.root.width?e-this.root.width:0,this.oldRoadMap.length?(this.shot(),this.blink()):this.img_ligth.visible=!1}},e.prototype.blink=function(){var t=this;egret.callLater(function(){egret.Tween.get(t.img_ligth).to({visible:!0},200).to({visible:!1},200).to({visible:!0},200).to({visible:!1},200).call(function(){t.img_ligth.visible=!0})},this)},e.prototype.getShotsImg=function(t){var e;return t>=this.gp_shots.numChildren?(e=new eui.Image,this.gp_shots.addChild(e)):e=this.gp_shots.getChildAt(t),e},e}(t.Component);e.RoomRoadMap=i,__reflect(i.prototype,"ui.sedie.RoomRoadMap")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var topic;!function(t){t.liengSchema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{fightinfo:{properties:{cards:{maxItems:3,minItems:3,items:{type:"integer",minimum:0,maximum:51}},type:{type:"string"},point:{type:"number"},order:{type:"number"},is_quit:{type:"boolean"}},type:"object"},userinfo:{properties:{user_id:{type:"string"},avatar:{type:"string"},username:{type:"string"},balance:{decimal:!0},position:{pattern:"^[1-6]$",type:"string"}},type:"object"},settleinfo:{properties:{bet:{type:"number"},surplus:{type:"number"}},type:"object"},opinfo:{properties:{raise:{type:"number"},op:{type:"string"}},type:"object"}},type:"object",properties:{snapshot:{type:"object",properties:{room_setting:{type:"object",properties:{type:{type:"string"},room_id:{type:"string"},time:{type:"object",properties:{op:{type:"number"}},required:["op"]},tax:{type:"number"}},required:["type","room_id","time","tax"]},bet_limit:{type:"object",properties:{ante:{type:"number"},admittance:{type:"number"}},required:["ante","admittance"]},max_bet:{type:"number"},stage:{type:"string"},stage_timestamp:{type:"number"},raise_rate_options:{items:{type:"integer"}},user_info:{patternProperties:{"^[1-6]$":{$ref:"#/definitions/userinfo"}},additionalProperties:!1,maxProperties:6,type:"object"},op_info:{type:"object",patternProperties:{"^[1-6]$":{$ref:"#/definitions/opinfo"}},additionalProperties:!1,maxProperties:6},fight:{type:"object",patternProperties:{"^[1-6]$":{$ref:"#/definitions/fightinfo"}},additionalProperties:!1,maxProperties:6},settle:{type:"object",patternProperties:{"^[1-6]$":{$ref:"#/definitions/settleinfo"}},additionalProperties:!1,maxProperties:6}},required:["room_setting","stage","bet_limit","max_bet","user_info","fight","op_info","settle"]}},required:["snapshot"]};var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.LiengDeskTopic=e,__reflect(e.prototype,"topic.LiengDeskTopic")}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.gp_tip.contains(this.gl_pool)&&this.gp_tip.removeChild(this.gl_pool)},e.prototype.show=function(t,e){void 0===e&&(e=!1),t&&(e?(this.img_bg.top=-60,this.img_bg.left=this.img_bg.right=-60,this.img_bg.bottom=-100,!this.gp_tip.contains(this.gl_pool)&&this.gp_tip.addChildAt(this.gl_pool,0)):(this.img_bg.top=this.img_bg.bottom=this.img_bg.left=this.img_bg.right=-15,this.gp_tip.contains(this.gl_pool)&&this.gp_tip.removeChild(this.gl_pool)),egret.Tween.removeTweens(this),this.alpha=0,this.lab_tip.text=t,egret.Tween.get(this).to({alpha:1},500).wait(1e3).to({alpha:0},500))},e}(t.Component);e.Tip=i,__reflect(i.prototype,"ui.sedie.Tip")}(e=t.sedie||(t.sedie={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.Match=0]="Match",t[t.Canle=1]="Canle"}(i=e.MatchEnum||(e.MatchEnum={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.btn_auto_match.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.isSelected=e.btn_auto_match.selected},this),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,function(){e.invalidateState(),e.fixPosition()},this)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.setselected=function(t){this.isSelected=t,this.btn_auto_match.selected=t},e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.addToStage=function(){this.btnMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.btn_auto_match.selected?this.autoMatch():(this.btn_auto_match.selected=this.isSelected,this.changeState(i.Match)),this.fixPosition()},e.prototype.removeFromStage=function(){this.btnMatch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.clearInterval()},e.prototype.match=function(){this.sendMatchNotify(),this.removeMyself()},e.prototype.cancleMatch=function(){this.clearInterval(),this.btn_auto_match.selected=this.isSelected,this.changeState(i.Match)},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e.prototype.autoMatch=function(){var t=this,e=5,n=function(e){e>0?t.lbCount.text=util.LanguageUtil.translate("lbl_game_willmatch",e):(t.clearInterval(),t.parent&&t.parent.removeChild(t),t.match())};this.changeState(i.Canle),n(e--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(e--)},1e3)},e.prototype.changeState=function(t){this.type=t===i.Match?"match":"cancel",!this.visible&&(this.visible=!0)},e.prototype.setVerPosition=function(t,e){this.isTwo=t,this.isVisible=e},e.prototype.fixPosition=function(){switch(this.currentState){case"landscape_match":case"landscape_cancel":break;case"portrait_match":case"portrait_cancel":this.isVisible?this.verticalCenter=this.isTwo?189:379:this.verticalCenter=559}},e}(t.Component);e.AutoMatch=n,__reflect(n.prototype,"ui.thirteenkill.AutoMatch")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(i){var n=e.call(this)||this;return n.parent_container=i,n.boomGroup=new eui.Group,n.img_boom=n.boomGroup.addChild(new eui.Image("thirteen_pic_bom1_png")),n.img_light=n.boomGroup.addChild(new eui.Image("thirteen_pic_bom2_png")),n.boomGroup.width=228,n.boomGroup.height=428,n.img_light.x=70,n.img_light.y=-60,n.touchEnabled=!1,n.touchChildren=!1,n.mc=new t.control.MovieClip("",12,1,0,!1),n.mc.scaleX=n.mc.scaleY=2.2,n.mc.visible=!1,n.mc.horizontalCenter=0,n.mc.verticalCenter=0,n.mc.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.reset,n),n.boomGroup.horizontalCenter=0,n.fontGroup=new eui.Group,n.img_fontlight=n.fontGroup.addChild(new eui.Image("win_light_png")),n.img_font=n.fontGroup.addChild(new eui.Image("thirteen_bomb_png")),n.img_glob1=new eui.Image("win_gold1_png"),n.img_glob2=new eui.Image("win_gold2_png"),n.img_glob3=new eui.Image("win_gold3_png"),n.img_glob4=new eui.Image("win_gold4_png"),n.img_glob5=new eui.Image("win_gold5_png"),n.img_glob6=new eui.Image("win_gold6_png"),n.fontGroup.verticalCenter=n.fontGroup.horizontalCenter=0,n.img_font.verticalCenter=-30,n.img_font.horizontalCenter=0,n.img_fontlight.verticalCenter=n.img_fontlight.horizontalCenter=0,n}return __extends(i,e),i.prototype.size=function(){this.img_boom.width=228,this.img_boom.height=428,this.img_light.width=204,this.img_light.height=201,this.img_fontlight.width=883,this.img_fontlight.height=491,this.mc.width=346,this.mc.height=319,this.img_glob1.width=143,this.img_glob1.height=131,this.img_glob2.width=113,this.img_glob2.height=102,this.img_glob3.width=153,this.img_glob3.height=149,this.img_glob4.width=125,this.img_glob4.height=127,this.img_glob5.width=146,this.img_glob5.height=90,this.img_glob6.width=160,this.img_glob6.height=134},i.prototype.playFontAni=function(){var t=this,e=300;this.parent_container.addChild(this.img_glob1),this.parent_container.addChild(this.img_glob2),this.parent_container.addChild(this.img_glob3),this.parent_container.addChild(this.img_glob4),this.parent_container.addChild(this.img_glob5),this.parent_container.addChild(this.img_glob6),this.parent_container.addChild(this.fontGroup),this.goldAni(this.img_glob1,-320,-80,e,-60),this.goldAni(this.img_glob2,-420,40,e,60),this.goldAni(this.img_glob3,-320,200,e,180),this.goldAni(this.img_glob4,260,-130,e,-110),this.goldAni(this.img_glob5,400,60,e,80),this.goldAni(this.img_glob6,300,200,e,180),egret.Tween.get(this.img_font).set({scaleX:0,scaleY:0}).to({scaleX:1,scaleY:1},e).wait(1500).call(function(){[t.fontGroup,t.img_glob1,t.img_glob2,t.img_glob3,t.img_glob4,t.img_glob5,t.img_glob6].forEach(function(t){t.parent&&t.parent.removeChild(t)})}),egret.Tween.get(this.img_fontlight).set({scaleX:0,scaleY:0}).to({scaleX:1.5,scaleY:1.5},e/3).to({scaleX:1,scaleY:1},e/3)},i.prototype.goldAni=function(t,e,i,n,o){egret.Tween.get(t).set({visible:!0,alpha:0,verticalCenter:0,horizontalCenter:0}).to({alpha:1,verticalCenter:i,horizontalCenter:e},n).to({verticalCenter:o},500).to({verticalCenter:i,horizontalCenter:e},500).to({verticalCenter:o},500).to({verticalCenter:i,horizontalCenter:e},500)},i.prototype.showAni=function(){var t=this;this.parent_container.addChild(this.boomGroup);var e=this.parent_container.height/2+214;egret.Tween.get(this.boomGroup).set({y:this.parent_container.height,scaleX:2,scaleY:2}).to({y:this.parent_container.height/2-214,scaleX:1,scaleY:1},.2*e).call(function(){t.boomGroup.parent&&t.boomGroup.parent.removeChild(t.boomGroup),t.playBoomAni()})},i.prototype.playBoomAni=function(){var t=this;util.SoundUtil.play("kill_bomb_mp3"),this.parent_container.addChild(this.mc),this.mc.currentFrame=0,this.mc.isPlaying=!0,this.mc.playTimes=1,this.mc.group="effect_tk_bomb",this.mc.visible=!0,this.mc.once(egret.Event.COMPLETE,function(){t.playFontAni(),t.mc.parent&&t.mc.parent.removeChild(t.mc)
},this)},i.prototype.reset=function(){this.mc.parent&&(this.mc.parent.removeChild(this.mc),this.mc.isPlaying=!1,this.mc.visible=!1,this.mc.group="",this.mc.source=null)},i}(t.Component);e.BoomAni=i,__reflect(i.prototype,"ui.thirteenkill.BoomAni")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSort=!1,e.portrait={width:440,height:180,overHeight:50},e.landscape={},e.distanceX=35,e.dix=3,e.diy=3,e.disRota=3,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.pokers=[],this.upPokers=[];for(var e=0;24>e;e++){var i=new n;i.anchorOffsetX=130,i.anchorOffsetY=180,i.scaleX=i.scaleY=.5,this.pokers.push(i)}this.lastGroup=this.addChild(new eui.Group),this.nowGroup=this.addChild(new eui.Group),this.lastGroup.x=this.nowGroup.x=0,this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.oprientionChange,this),this.oprientionChange()},e.prototype.oprientionChange=function(){Main.instance.orientation===egret.OrientationMode.PORTRAIT&&(this.lastGroup.width=this.nowGroup.width=this.width=this.portrait.width,this.lastGroup.height=this.nowGroup.height=this.portrait.height,this.height=2*this.portrait.height-this.portrait.overHeight,this.nowGroup.y=this.portrait.height-this.portrait.overHeight)},e.prototype.getAPoker=function(){for(var t=0,e=this.pokers.length;e>t;t++)if(!this.pokers[t].parent)return this.pokers[t];return null},e.prototype.showPokers=function(t){if(void 0===t&&(t=[]),0!==t.length){var e=[],i=this.width/2,n=this.nowGroup.height/2,o=t.length,r=o/2-.5,s=this.distanceX,a=60/(r+1);if(7>o&&(s+=30*Math.random()*(1-o/7)),1===o){var l=100*Math.random()*2-100+i,u=20*Math.random()-10+n,h=120*Math.random()-60;e.push({x:l,y:u,rotation:h})}else for(var c=0;o>c;c++){var l=(c-r)*s+i+Math.random()*this.dix*2-this.dix,u=n+Math.random()*this.diy*2-this.diy,h=8>=o?(c-r)*a+Math.random()*this.disRota*2-this.disRota:0;e.push({x:l,y:u,rotation:h})}this.setPoker(t,e)}},e.prototype.showPoker2=function(t){if(void 0===t&&(t=[]),0!==t.length){for(var e=[],i=this.width/2,n=this.nowGroup.height/2,o=t.length,r=o/2-.5,s=o>4?44:56,a=0;o>a;a++){var l=(a-r)*s+i,u=n;e.push({x:l,y:u,rotation:0})}return this.setPoker(t,e),this.hideUpGroupPoker()}},e.prototype.hideUpGroupPoker=function(){var t=[];return this.upPokers.forEach(function(e){var i=e.localToGlobal();t.push({x:i.x+e.width*e.scaleX/2,y:i.y+e.height*e.scaleY/2}),e.visible=!1}),t},e.prototype.showUpGroupPoker=function(){this.upPokers.forEach(function(t){t.visible=!0})},e.prototype.setPoker=function(t,e){var i=this;0===this.nowGroup.$children.length?0===this.lastGroup.$children.length?this.setPokerOnWhichGroup(this.lastGroup,t,e):(this.upPokers.forEach(function(t){return t.isMask(!0)}),this.setPokerOnWhichGroup(this.nowGroup,t,e)):(this.lastGroup.removeChildren(),this.upPokers.forEach(function(t){i.lastGroup.addChild(t),t.isMask(!0)}),this.setPokerOnWhichGroup(this.nowGroup,t,e))},e.prototype.setPokerOnWhichGroup=function(t,e,i){var n=this;this.upPokers.length=0,e.forEach(function(e,o){var r=t.addChild(n.getAPoker());r.x=i[o].x,r.y=i[o].y,r.rotation=i[o].rotation,r.setCard(e),r.isMask(!1),n.upPokers.push(r)})},e.prototype.clean=function(){this.lastGroup.removeChildren(),this.nowGroup.removeChildren(),this.upPokers.length=0},e}(t.Component);e.DeskPokers=i,__reflect(i.prototype,"ui.thirteenkill.DeskPokers");var n=function(t){function e(){var e=t.call(this)||this;return e.img_poker=new eui.Image,e.poker_mask=new eui.Image("mask_png"),e.addChild(e.img_poker),e.addChild(e.poker_mask),e}return __extends(e,t),e.prototype.setCard=function(t){this.img_poker.source=t+"_png"},e.prototype.isMask=function(t){this.poker_mask.visible=t},e}(eui.Component);__reflect(n.prototype,"Poker")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var topic;!function(t){t.paigowSchema={type:"object",properties:{snapshot:{type:"object",properties:{room_setting:{type:"object",properties:{room_id:{type:"string"},round_time:{type:"number"},time:{type:"object",properties:{dispute:{type:"number"},raise:{type:"number"},prepare:{type:"number"}},required:["dispute","raise","prepare"]}},required:["room_id","time"]},bet_limit:{type:"object",properties:{ante:{type:"number"},admittance:{type:"number"}},required:["ante","admittance"]},desk_info:{type:"object",properties:{round:{type:"number"},timestamp:{type:"number"},stage:{type:"string"},banker_position:{type:"string"},init_dice:{items:{type:"number"}},deal_first:{type:"number"},cards_count:{items:{type:"number"}}},"if":{not:{properties:{stage:{"const":"dispute"}}}},then:{required:["round","banker_position","deal_first","init_dice","stage","timestamp"]},"else":{required:["round","deal_first","init_dice","stage","timestamp"]}},user_info:{type:"object",patternProperties:{"^[1-4]$":{type:"object",properties:{user_id:{type:"string"},avatar:{type:"string"},username:{type:"string"},balance:{decimal:!0},position:{pattern:"^[1-4]$",type:"string"}}}},additionalProperties:!1},dispute:{type:"object",properties:{desk:{type:"object",patternProperties:{"^[1-4]$":{type:"object",properties:{rate:{type:"number"},surplus:{type:"number"},payout:{type:"number"},valid_bet:{type:"number"},user_id:{type:"string"},rate_options:{items:{type:"number"}},is_done:{type:"boolean"},is_banker:{type:"boolean"}}}},additionalProperties:!1},user_status:{type:"string"}}},raise:{type:"object",properties:{desk:{type:"object",patternProperties:{"^[1-4]$":{type:"object",properties:{rate:{type:"number"},surplus:{type:"number"},payout:{type:"number"},valid_bet:{type:"number"},user_id:{type:"string"},rate_options:{items:{type:"number"}},is_done:{type:"boolean"},is_banker:{type:"boolean"}}}},additionalProperties:!1},user_status:{type:"string"}}},settle:{type:"object",properties:{desk:{type:"object",patternProperties:{"^[1-4]$":{type:"object",properties:{rate:{type:"number"},surplus:{type:"number"},payout:{type:"number"},valid_bet:{type:"number"},user_id:{type:"string"},rate_options:{items:{type:"number"}},is_done:{type:"boolean"},is_banker:{type:"boolean"},cards_info:{type:"object",properties:{cards:{items:{type:"number"}},result:{type:"number"},cards_type:{type:"string"}}},timestamp:{type:"number"}}}},additionalProperties:!1},user_status:{type:"string"}}},summary:{type:"object"}},required:["bet_limit","desk_info","dispute","raise","room_setting","settle","summary","user_info"]}},required:["snapshot"]};var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.PaigowDeskTopic=e,__reflect(e.prototype,"topic.PaigowDeskTopic")}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pass=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_POKER_PASS),e.removeMyself()},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onshow,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onhide,this)},e.prototype.onshow=function(){this.passBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pass,this)},e.prototype.onhide=function(){this.passBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.pass,this)},e.prototype.setPlayBtnDisable=function(t){this.playBtn.enabled=t},e.prototype.setPassBtnDisable=function(t){this.passBtn.enabled=t},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e}(t.Component);e.OperatBtns=i,__reflect(i.prototype,"ui.thirteenkill.OperatBtns")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.time_out_id=void 0,t.time_out_id2=void 0,t.time_out_id3=void 0,t.changeGraphics=function(e){t.shape.graphics.beginFill(65535,1),t.shape.graphics.moveTo(0,0),t.shape.graphics.lineTo(0,0),t.shape.graphics.drawArc(0,0,t.radio,e,-Math.PI/2,!1),t.shape.graphics.lineTo(0,0),t.shape.graphics.endFill()},t}return __extends(i,e),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"userInfo",{get:function(){return this._userInfo},set:function(e){if(e){var n=t.component.Avatar.generateAvatar(e.avatar);e.user_id===Const.UserInfo.USER_ID?(e.username=Const.UserInfo.NICK,i.avatarMap.set(e.user_id,Const.UserInfo.AVATAR)):e.avatar!==n&&i.avatarMap.get(e.user_id)||i.avatarMap.set(e.user_id,n),e.avatar=i.avatarMap.get(e.user_id)}this._userInfo=e,this.lb_balance.text=e&&util.NumberUtil.formatNumber(e.balance)},enumerable:!0,configurable:!0}),i.prototype.tweenBalance=function(t){util.NumberUtil.tweenNumber(this.lb_balance,t,1500)},i.prototype.getCurrentState=function(){return""+e.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},i.prototype.initCountDown=function(){this.shape||(this.shape=new egret.Shape,this.shape.x=this.timeLine.width/2,this.shape.y=this.timeLine.height/2,this.timeGroup.addChild(this.shape),this.timeLine.mask=this.shape,this.radio=this.timeLine.width>this.timeLine.height?this.timeLine.width:this.timeLine.height,this.radio*=1.5,this.dix=this.width/2)},i.prototype.init=function(){this.stopCountDown(),this.timeGroup.visible=!1},i.prototype.countDown=function(t,e){var i=this;this.initCountDown(),this.totalTime=e-t,this.time_out_id&&this.stopCountDown(),this.timeGroup.visible=!0;var n=util.TimeUtil.now;this.time_out_id2=util.TimeUtil.setInterval(function(){util.TimeUtil.now<e&&util.SoundUtil.play("time_mp3")},1e3),this.time_out_id3=util.TimeUtil.setInterval(function(){e-util.TimeUtil.now>=900&&(util.SoundUtil.play("WarningtimeOver_mp3"),i.time_out_id3&&util.TimeUtil.clearInterval(i.time_out_id3),i.time_out_id3=void 0)},e-n-1e3),this.time_out_id=util.TimeUtil.setInterval(function(){var n=util.TimeUtil.now-t,o=i.lightMove(n),r=o.x,s=o.y;if(i.light.x=r,i.light.y=s,e-t>n){i.shape.graphics.clear();var a=s-i.shape.y,l=r-i.shape.x,u=Math.asin(a/Math.sqrt(a*a+l*l));r<i.shape.x&&(u=Math.PI-u),i.changeGraphics(u)}else i.stopCountDown()},50,this)},i.prototype.stopCountDown=function(){this.time_out_id&&util.TimeUtil.clearInterval(this.time_out_id),this.time_out_id=void 0,this.time_out_id2&&util.TimeUtil.clearInterval(this.time_out_id2),this.time_out_id2=void 0,this.time_out_id3&&util.TimeUtil.clearInterval(this.time_out_id3),this.time_out_id3=void 0,this.timeGroup.visible=!1},i.prototype.lightMove=function(t){var e=this.width,i=this.height,n=15*Math.PI;this.diy=-2.5;var o=(n+2*this.width-10+2*this.height-10)/this.totalTime;this.dix=this.width/2;var r,s,a=t*o,l=e/2-5,u=l+n/4,h=u+i-10,c=h+n/4,p=c+e-10,_=p+n/4,d=_+i-10,g=d+n/4,m=g+e/2-5;if(l>a)r=t*o+this.dix,s=this.diy;else if(u>a){var f=(a-l)/(n/4)*(Math.PI/2);r=l+this.dix+7.5*Math.sin(f),s=7.5*(1-Math.cos(f))+this.diy}else if(h>a)r=l+7.5+this.dix,s=7.5+a-u+this.diy;else if(c>a){var f=(a-h)/(n/4)*(Math.PI/2);r=l+7.5*Math.cos(f)+this.dix,s=i-2.5+7.5*Math.sin(f)+this.diy}else if(p>a)r=l-(a-c)+this.dix,s=i+5+this.diy;else if(_>a){var f=(a-p)/(n/4)*(Math.PI/2);r=-l-7.5*Math.sin(f)+this.dix,s=i+Math.cos(f)-2.5+this.diy}else if(d>a)r=-l-7.5+this.dix,s=i-2.5-(a-_)+this.diy;else if(g>a){var f=(a-d)/(n/4)*(Math.PI/2);r=-l+this.dix-7.5*Math.cos(f),s=7.5-7.5*Math.sin(f)+this.diy}else m>a?(r=a-g-l+this.dix,s=this.diy):(r=this.dix,s=this.diy);return{x:r,y:s}},i.prototype.setHead=function(t){},i.prototype.shakeAvatar=function(){var t=8;this.avatar.y=t,egret.Tween.removeTweens(this.avatar),egret.Tween.get(this.avatar).to({y:t-15},80,egret.Ease.quadOut).to({y:t},80,egret.Ease.quadIn)},i.avatarMap=new Map,i}(t.Component);e.Player=i,__reflect(i.prototype,"ui.thirteenkill.Player")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;i.pokers=[],i.leftPokers=[],i.topPokers=[],i.rightPokers=[],i.backPokers=[],i.usePoker=0,i.playPoker=[],i.lastPokers=[],i.parent_container=t;for(var n=0;18>n;n++){var o=i.createPoker();o.visible=!1,i.parent_container.addChild(o),i.backPokers.push(o)}for(var r=0;52>r;r++){var o=i.createPoker();o.x=0,o.y=r,i.parent_container.addChild(o),i.pokers.push(o)}for(var r=0;20>r;r++){var o=i.createPoker();o.visible=!1,i.parent_container.addChild(o),i.playPoker.push(o)}return i.pokers=i.pokers.reverse(),i.backPokers=i.backPokers.reverse(),i}return __extends(i,e),i.prototype.createPoker=function(){var e=new t.component.Poker;return e.size=.5,e.once(eui.UIEvent.CREATION_COMPLETE,function(){e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2},this),e},i.prototype.init=function(t){void 0===t&&(t=!0);for(var e=0;52>e;e++){var i=this.pokers[e];i.currentState="back",egret.Tween.removeTweens(i),i.x=0,i.y=e,i.rotation=0,i.visible=t}this.lastPokers.length=0,this.backPokers.forEach(function(t){t.visible=!1}),this.playPoker.forEach(function(t){t.visible=!1}),this.usePoker=0,this.leftPokers.length=0,this.rightPokers.length=0,this.topPokers.length=0},i.prototype.shuffle=function(){for(var t=0;52>t;t++){var e=this.pokers[t];egret.Tween.removeTweens(e),e.x=0,e.y=t,e.visible=!0;var i=util.NumberUtil.getRandom(-1,1),n=util.NumberUtil.getRandom(-1,1),o=util.NumberUtil.getRandom(60,80),r=util.NumberUtil.getRandom(60,80),s=e.x,a=e.y,l=100;egret.Tween.get(e).to({x:i*o,y:a+5*n},l).to({x:s,y:a},l).to({x:n*o,y:a+5*i},l).to({x:s,y:a},l).to({x:i*r,y:a+5*n},l).to({x:s,y:a},l).to({x:n*o,y:a+5*i},l).to({x:s,y:a},l)}},i.prototype.flyCard=function(t,e,i){var n=this,o=this.parent_container.globalToLocal(e.x,e.y),r=this.pokers[this.usePoker],s=100;egret.Tween.get(r).set({x:0,y:this.usePoker}).to({x:o.x/2,y:o.y/2,rotation:180,scaleX:1.1,scaleY:1.1},s/2).to({x:o.x,y:o.y,rotation:360,scaleX:1,scaleY:1},s/2).call(function(){switch(t&&t(),i){case 1:n.leftPokers.length<6?n.leftPokers.push(r):r.visible=!1;break;case 2:n.topPokers.length<6?n.topPokers.push(r):r.visible=!1;break;case 3:n.rightPokers.length<6?n.rightPokers.push(r):r.visible=!1;break;default:r.visible=!1}}),this.usePoker++},i.prototype.allPlay=function(){this.cardsMove(this.leftPokers),this.cardsMove(this.rightPokers),this.cardsMove(this.topPokers)},i.prototype.cardsMove=function(t){var e=t[2],i=e.x,n=e.y,o=500;egret.Tween.get(t[5]).to({x:i-47,y:n-1,rotation:-12},o),egret.Tween.get(t[4]).to({x:i-32,y:n-2,rotation:-8},o),egret.Tween.get(t[3]).to({x:i-15,y:n,rotation:-4},o),egret.Tween.get(t[1]).to({x:i+18,y:n+3,rotation:4},o),egret.Tween.get(t[0]).to({x:i+33,y:n+8,rotation:8},o)},i.prototype.getApoker=function(){for(var t=0;t<this.playPoker.length;t++)if(!this.playPoker[t].visible)return this.playPoker[t];return null},i.prototype.setPos=function(t,e){for(var i=t.x,n=t.y,o=this.parent_container.globalToLocal(i,n),r=[],s=0;6>s;s++){var a=this.backPokers[this.usePoker];a.x=o.x,a.y=o.y,a.visible=!0,r.push(a),this.usePoker++}switch(e){case 1:this.leftPokers=r;break;case 2:this.topPokers=r;break;case 3:this.rightPokers=r}},i.prototype.setNow=function(){this.setGroupNow(this.leftPokers),this.setGroupNow(this.topPokers),this.setGroupNow(this.rightPokers)},i.prototype.setGroupNow=function(t){if(0!==t.length){var e=t[2],i=e.x,n=e.y;t[5].x=i-47,t[5].y=n-1,t[5].rotation=-12,t[4].x=i-32,t[4].y=n-2,t[4].rotation=-8,t[3].x=i-15,t[3].y=n,t[3].rotation=-4,t[1].x=i+18,t[1].y=n+3,t[1].rotation=4,t[0].x=i+33,t[0].y=n+8,t[0].rotation=8}},i.prototype.hidePlayerPoker=function(t){var e;switch(t){case 1:e=this.leftPokers;break;case 2:e=this.topPokers;break;case 3:e=this.rightPokers}e&&e.forEach(function(t){t.visible=!1})},i.prototype.setPokerNumber=function(t,e){var i,n=[5,0,4,1,3,2];switch(t){case 1:i=this.leftPokers;break;case 2:i=this.topPokers;break;case 3:i=this.rightPokers}if(i){i.forEach(function(t){t.visible=!0});for(var o=0;6-e>o;o++)i[n[o]].visible=!1}},i.prototype.GlobalToLocal=function(t){var e=this.parent_container.globalToLocal(t.x,t.y);t.x=e.x,t.y=e.y},i.prototype.playPokers=function(t,e,i,n){var o=this,r=200;this.lastPokers.forEach(function(t){egret.Tween.removeTweens(t),t.visible=!1}),this.lastPokers.length=0,t.forEach(function(t,s){var a=o.getApoker();a.visible=!0,o.lastPokers.push(a),a.num=t,a.currentState="normal",egret.Tween.removeTweens(a),egret.Tween.get(a).set(e[s]).to(i[s],r).call(function(){a.visible=!1,0===s&&n&&n()})})},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.thirteenkill.PokerAni")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e._selected=!1,e._enabled=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setSelect=function(t){this._selected=t,t?(this.poker.verticalCenter=-30,this.img_select.verticalCenter=-30,this.rect_poker.verticalCenter=-30):(this.poker.verticalCenter=0,this.img_select.verticalCenter=0,this.rect_poker.verticalCenter=0),this.img_select.visible=t},e.prototype.isSelected=function(){return this._selected},e.prototype.init=function(){this.rect_mask&&(this.rect_mask.visible=!1),this.img_select&&(this.img_select.visible=!1),this.poker.currentState="back",this.value=0,this.poker_number=-1,this.poker_type=-1,this.sourceNum=-1},e.prototype.showMask=function(){this.rect_mask.visible=!0},e.prototype.enableTap=function(t){this._enabled=t},e.prototype.setCard=function(t){"number"==typeof t?(this.poker.currentState="normal",this.poker.num=t,this.value=t,this.poker_number=t%13,this.poker_type=Math.floor(t/13)):(this.poker.currentState="back",this.value=0,this.poker_number=-1,this.poker_type=-1),this.sourceNum=t},e.prototype.fanmian=function(t){this.poker.num=t,this.value=t,this.poker_number=t%13,this.poker_type=Math.floor(t/13),this.poker.turnCard(200)},e.prototype.getPokerNumber=function(){return this.poker_number},e.prototype.getPokerType=function(){return this.poker_type},e.prototype.getPokerPos=function(){var t=this.poker.localToGlobal();return{x:t.x+this.poker.width/2,y:t.y+this.poker.height/2}},e.prototype.getValue=function(){return this.value},e.prototype.getTapArea=function(){return this.rect_poker},e.prototype.getSourceNum=function(){return this.sourceNum},e}(t.Component);e.PokerGroup=i,__reflect(i.prototype,"ui.thirteenkill.PokerGroup")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.pokers=[],e.selectedPokers=[],e.handPokers=[],e.pokerPositions=[],e}return __extends(i,t),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),i.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},i.prototype.logHandPoker=function(){egret.log(this.handPokers)},i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.createPokers()},i.prototype.init=function(){this.handPokers.length=0,this.selectedPokers.length=0,this.pokerPositions.length=0,this.group_poker1.removeChildren(),this.group_poker2.removeChildren()},i.prototype.addAPoker=function(t){var e=this.handPokers.length;if(!(e>=13)){var i=this.pokers[e];i.setCard(t),6>=e?this.group_poker1.addChild(i):this.group_poker2.addChild(i),this.handPokers.push(t)}},i.prototype.createPokers=function(){for(var t=this.group_poker1.$children.length,e=t-1;e>=0;e--){var i=this.group_poker1.$children[e];this.pokers.push(i),this.group_poker1.removeChild(i),i.init()}},i.prototype.pokersAddEventListener=function(){var t=this;this.pokers.forEach(function(e){e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.isSelected()?(e.setSelect(!1),t.selectedPokers.splice(t.selectedPokers.indexOf(e.getSourceNum()),1)):(e.setSelect(!0),t.selectedPokers.push(e.getSourceNum())),t.dispatchEventWith(i.SELECT_POKER_CHANGE,!1,{pokers:t.selectedPokers,isAllPokers:t.selectedPokers.length===t.handPokers.length})},t)})},i.prototype.isFirst=function(){return-1!==this.handPokers.indexOf(40)},i.prototype.cleanSelectedPoker=function(){this.pokers.forEach(function(t){t.setSelect(!1)}),this.selectedPokers.length=0},i.prototype.setSelectPokers=function(t){var e=this;this.selectedPokers=t,this.pokers.forEach(function(t){t.setSelect(-1!==e.selectedPokers.indexOf(t.getSourceNum()))}),this.dispatchEventWith(i.SELECT_POKER_CHANGE,!1,{pokers:this.selectedPokers,isAllPokers:this.selectedPokers.length===this.handPokers.length})},i.prototype.playPoker=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_POKER_PLAY,util.ObjectUtil.copy(this.selectedPokers))},i.prototype.isTwoLine=function(){return this.handPokers.length>7},i.prototype.showPokerWhichInBack=function(){var t=this;this.pokers.forEach(function(e,i){i>6?e.fanmian(t.handPokers[i-7]):e.fanmian(t.handPokers[i+6])})},i.prototype.setHandPokser=function(t){t&&(this.handPokers=e.PokerUtil.instance.sortPoker(t))},i.prototype.playPokerSuccess=function(t){var e=this;t.forEach(function(t){var i=e.handPokers.indexOf(t);-1!==i&&e.handPokers.splice(i,1)}),this.showPoker(this.handPokers)},i.prototype.sortPoker=function(t){this.showPoker(e.PokerUtil.instance.sortPoker(this.handPokers,t)),this.setSelectPokers(this.selectedPokers)},i.prototype.showPoker=function(t){var e=this;if(t){this.handPokers=t;var i=0,n=t.length;if(this.pokerPositions.length=0,n>7)for(;n-7>i;i++){var o=this.pokers[i];o.setCard(t[i]),this.group_poker2.addChildAt(o,i)}for(;n>i;i++){var o=this.pokers[i];o.setCard(t[i]),this.group_poker1.addChildAt(o,i)}if(13>i)for(;13>i;i++){var o=this.pokers[i];o.parent&&o.parent.removeChild(o)}this.group_poker2.$children.forEach(function(t){var i=t.localToGlobal();e.pokerPositions.push({x:i.x,y:i.y})}),this.group_poker1.$children.forEach(function(t){var i=t.localToGlobal();e.pokerPositions.push({x:i.x,y:i.y})})}},i.prototype.getPokerPostions=function(t){var e=this,i=[];return t.forEach(function(t){-1!==e.handPokers.indexOf(t)&&i.push(e.pokerPositions[e.handPokers.indexOf(t)])}),i},i.SELECT_POKER_CHANGE="POKER_CHANGE",i}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.thirteenkill.PokerList")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e;!function(t){t[t.single=0]="single",t[t.two=1]="two",t[t.three=2]="three",t[t.four=3]="four",t[t.shunzi=4]="shunzi",t[t.threeLianDui=5]="threeLianDui",t[t.fourLianDui=6]="fourLianDui"}(e||(e={}));var i=function(){function t(){this.pokers=[];for(var t=0;24>t;t++)this.pokers.push(new n)}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.sendFourGroupPokers=function(){for(var t=[],e=[],i=0;52>i;i++)t.push(i);for(var i=0;4>i;i++){for(var n=[],o=0;13>o;o++){var r=Math.floor(Math.random()*t.length);n.push(t[r]),t.splice(r,1)}e.push(n)}return e},t.prototype.sortPoker=function(t,e){var i=this;void 0===e&&(e=!1);var n=[],o=[],r=[];return t.forEach(function(t,e){var o=i.pokers[e];o.setValue(t),n.push(o)}),n.sort(function(t,e){return t.getWeight()-e.getWeight()}),o=e?this.sort(n).slice():n,o.forEach(function(t){return r.push(t.getValue())}),r},t.prototype.isFourLianDuiBoom=function(t){var e=this;void 0===t&&(t=[]);var i=[];return t.forEach(function(t,n){var o=e.pokers[n];o.setValue(t),i.push(o)}),i.sort(this.pokerListSort),this.isFourLianDui(i)},t.istwoOrtwotow=function(t){return void 0===t&&(t=[]),1===t.length&&t[0]%13===0||2===t.length&&t[0]%13===0&&t[1]%13===0},t.prototype.sort=function(t){var e;if(this.isHaveShunzi(t)){var i=[];e=this.findShunzi(t,i),i.sort(function(t,e){var i=t.length,n=e.length;return 1e4*n+e[n-1].getWeight()-1e4*i-t[i-1].getWeight()});var n=[];i.forEach(function(t){t.forEach(function(t){n.push(t)})});var o=this.sort(e);return o.forEach(function(t){return n.push(t)}),n}if(this.isHaveThree(t)){var r=[];return e=this.findThree(t,r),e=this.sort(e),e.forEach(function(t){return r.push(t)}),r}if(this.isHaveFour(t)){var s=[];return e=this.findFour(t,s),e=this.sort(e),e.forEach(function(t){return s.push(t)}),s}if(this.isHaveTwo(t)){var a=[];return e=this.findTwo(t,a),e=this.sort(e),e.forEach(function(t){return a.push(t)}),a}return t},t.prototype.findShunzi=function(t,e){for(var i=[],n=[],o=0,r=0,s=t.length;s>r;r++){var a=t[r];if(0===o)i.push(a),o++;else if(i[o-1].getNumber()+1===a.getNumber())o++,i.push(a);else if(i[o-1].getNumber()===a.getNumber())n.push(i.splice(o-1,1)[0]),i.push(a);else{if(o>=3){for(var l=r;s>l;l++)n.push(t[l]);break}i.forEach(function(t){n.push(t)}),o=1,i.length=0,i.push(a)}}return o>=3?e.push(i):i.forEach(function(t){n.push(t)}),n.sort(function(t,e){return t.getWeight()-e.getWeight()}),this.isHaveShunzi(n)?this.findShunzi(n,e):n},t.prototype.findShunZi1=function(t,e){var i=[],n=[];i.push(t[0]);for(var o=1,r=1,s=t.length;s>r;r++){var a=t[r];if(i[o-1].getNumber()+1===a.getNumber()){if(o++,o>3){for(var l=r;s>l;l++)n.push(t[l]);break}i.push(a)}else if(i[o-1].getNumber()===a.getNumber())n.push(i.splice(o-1,1)[0]),i.push(a);else{if(o>=3){for(var l=r;s>l;l++)n.push(t[l]);break}i.forEach(function(t){n.push(t)}),o=1,i.length=0,i.push(a)}}return o>=3?e.push(i):i.forEach(function(t){n.push(t)}),n.sort(function(t,e){return t.getWeight()-e.getWeight()}),this.isHaveShunzi(n)?this.findShunZi1(n,e):n},t.prototype.findThree=function(t,e){for(var i=[],n=[],o=0,r=0,s=t.length;s>r;r++){var a=t[r];if(0===o)i.push(a),o++;else if(i[o-1].getNumber()===a.getNumber())o++,i.push(a),o>3&&(n.push(i.splice(0,1)[0]),o=3);else{if(o>=3){for(var l=r;s>l;l++)n.push(t[l]);break}i.forEach(function(t){n.push(t)}),o=1,i.length=0,i.push(a)}}return o>=3?i.forEach(function(t){e.push(t)}):i.forEach(function(t){n.push(t)}),n.sort(function(t,e){return t.getWeight()-e.getWeight()}),this.isHaveThree(n)?this.findThree(n,e):n},t.prototype.findFour=function(t,e){for(var i=[],n=0,o=t.length;o-3>n;n++){if(t[n].getNumber()===t[n+1].getNumber()&&t[n+1].getNumber()===t[n+2].getNumber()&&t[n+2].getNumber()===t[n+3].getNumber()){e.push(t[n]),e.push(t[n+1]),e.push(t[n+2]),e.push(t[n+3]);for(var r=n+4;o>r;r++)i.push(t[r]);break}i.push(t[n]),n===o-4&&(i.push(t[n+1]),i.push(t[n+2]),i.push(t[n+3]))}return i.sort(function(t,e){return t.getWeight()-e.getWeight()}),this.isHaveFour(i)?this.findFour(i,e):i},t.prototype.findTwo=function(t,e){for(var i=[],n=0,o=t.length;o-1>n;n++){if(t[n].getNumber()===t[n+1].getNumber()){e.push(t[n]),e.push(t[n+1]);for(var r=n+2;o>r;r++)i.push(t[r]);break}i.push(t[n]),n===o-2&&i.push(t[n+1])}return i.sort(function(t,e){return t.getWeight()-e.getWeight()}),this.isHaveTwo(i)?this.findTwo(i,e):i},t.prototype.isHaveShunzi=function(t){if(t.length<3)return!1;for(var e=1,i=t[0].getNumber(),n=1,o=t.length;o>n;n++){var r=t[n];if(i+1===r.getNumber()?(i++,e++):i!==r.getNumber()&&(i=r.getNumber(),e=1),e>=3)return!0}return!1},t.prototype.isHaveThree=function(t){for(var e=0,i=t.length-2;i>e;e++){var n=t[e],o=t[e+1],r=t[e+2];if(n.getNumber()===o.getNumber()&&n.getNumber()===r.getNumber())return!0}return!1},t.prototype.isHaveFour=function(t){for(var e=0,i=t.length-3;i>e;e++){var n=t[e],o=t[e+1],r=t[e+2],s=t[e+3];if(n.getNumber()===o.getNumber()&&n.getNumber()===r.getNumber()&&r.getNumber()===s.getNumber())return!0}return!1},t.prototype.isHaveTwo=function(t){for(var e=0,i=t.length-1;i>e;e++){var n=t[e],o=t[e+1];if(n.getNumber()===o.getNumber())return!0}return!1},t.prototype.pokerListSort=function(t,e){return t.getWeight()-e.getWeight()},t.prototype.sendPoker=function(t,i,n){var o=this;if(void 0===i&&(i=[]),void 0===n&&(n=!1),util.LogUtil.debug("choose poker change! selectedPoker =>"+t+" proPokers =>"+i+" isFirst=>"+n+" "),n&&-1===t.indexOf(40))return!1;var r=[],s=[];t.forEach(function(t,e){var i=o.pokers[e];i.setValue(t),r.push(i)}),i.forEach(function(t,e){var i=o.pokers[o.pokers.length-e-1];i.setValue(t),s.push(i)}),r.sort(this.pokerListSort);var a=this.checkPokerType(r);if(void 0===a)return!1;if(i.length){if(i.length!==r.length)return(1!==s.length||13!==s[0].getNumber()||a!==e.threeLianDui&&a!==e.fourLianDui&&a!==e.four)&&(2!==s.length||13!==s[0].getNumber()||a!==e.fourLianDui&&a!==e.four)?!1:!0;s.sort(this.pokerListSort);var l=this.checkPokerType(s);if(l!==a||r[r.length-1].getWeight()<=s[s.length-1].getWeight())return!1}else if(a===e.threeLianDui||a===e.four||a===e.fourLianDui)return!1;return!0},t.prototype.checkIsBoom=function(t){var i=this,n=[];t.forEach(function(t,e){var o=i.pokers[e];o.setValue(t),n.push(o)}),n.sort(this.pokerListSort);var o=this.checkPokerType(n);return o===e.four||o===e.threeLianDui||o===e.fourLianDui},t.prototype.checkPokerType=function(t){return 1===t.length?e.single:2===t.length&&t[0].getNumber()===t[1].getNumber()?e.two:3===t.length&&t[0].getNumber()===t[1].getNumber()&&t[0].getNumber()===t[2].getNumber()?e.three:4===t.length&&t[0].getNumber()===t[1].getNumber()&&t[0].getNumber()===t[2].getNumber()&&t[0].getNumber()===t[3].getNumber()?e.four:this.isThreeLianDui(t)?e.threeLianDui:this.isFourLianDui(t)?e.fourLianDui:this.isShunZi(t)?e.shunzi:void 0},t.prototype.isShunZi=function(t){if(t.length<3)return!1;for(var e=0,i=t.length;i-1>e;e++)if(t[e].getNumber()+1!==t[e+1].getNumber())return!1;return!0},t.prototype.isThreeLianDui=function(t){return 6===t.length&&t[0].getNumber()===t[1].getNumber()&&t[2].getNumber()===t[3].getNumber()&&t[4].getNumber()===t[5].getNumber()&&t[1].getNumber()+1===t[2].getNumber()&&t[3].getNumber()+1===t[4].getNumber()},t.prototype.isFourLianDui=function(t){return 8===t.length&&t[0].getNumber()===t[1].getNumber()&&t[2].getNumber()===t[3].getNumber()&&t[4].getNumber()===t[5].getNumber()&&t[6].getNumber()===t[7].getNumber()&&t[5].getNumber()+1===t[6].getNumber()&&t[1].getNumber()+1===t[2].getNumber()&&t[3].getNumber()+1===t[4].getNumber()},t}();t.PokerUtil=i,__reflect(i.prototype,"ui.thirteenkill.PokerUtil");var n=function(){function t(){}return t.prototype.setValue=function(t){this.value=t,this.type=(Math.floor(t/13)+1)%4,this.number=t%13||13},t.prototype.getNumber=function(){return this.number},t.prototype.getType=function(){return this.type},t.prototype.getValue=function(){return this.value},t.prototype.getWeight=function(){return 10*this.number+this.type},t}();__reflect(n.prototype,"Poker")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.PokdengDeskTopic=e,__reflect(e.prototype,"topic.PokdengDeskTopic"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{bet_limit:{properties:{admittance:{type:"number"},ante:{type:"number"}},required:["admittance","ante"],type:"object"},fight:{patternProperties:{"^[0-5]$":{properties:{cards:{items:{type:"number",minimum:0,maximum:51},type:"array"},fight_time:{type:"number"},is_done:{type:"boolean"},is_same_number:{type:"boolean"},is_same_suit:{type:"boolean"},is_sky:{type:"boolean"},is_straight:{type:"boolean"},more_card:{type:"boolean"},odds:{type:"number"},point:{type:"number"}},required:["is_done","is_same_number","is_same_suit","is_sky","is_straight","more_card","point"],type:"object"}},additionalProperties:!1,maxProperties:6,minProperties:1},fight_position:{type:"string"},raise:{patternProperties:{"^[0-5]$":{type:"object",properties:{is_done:{type:"boolean"},raise_rate:{type:"number"}},required:["is_done","raise_rate"]}},additionalProperties:!1,maxProperties:6,minProperties:1},raise_rate_options:{items:{type:"number"},type:"array",contains:{type:"number"}},room_setting:{properties:{room_id:{type:"string"},tax:{type:"number"},time:{properties:{op:{type:"number"},raise:{type:"number"}},required:["op","raise"],type:"object"},type:{type:"string"}},required:["room_id","tax","time","type"],type:"object"},settle:{patternProperties:{"^[0-5]$":{properties:{surplus:{type:"number"}},required:["surplus"],type:"object"}},additionalProperties:!1,maxProperties:6,minProperties:1},stage:{type:"string"},stage_timestamp:{type:"number"},stop_decision_ts:{type:"number"},timestamp:{type:"number"},user_info:{patternProperties:{"^[0-5]$":{properties:{avatar:{type:"string"},balance:{decimal:!0},position:{type:"string"},user_id:{type:"string"},username:{type:"string"}},type:"object"}},additionalProperties:!1,maxProperties:6,minProperties:1}},required:["bet_limit","fight","raise","raise_rate_options","room_setting","settle","stage","stage_timestamp","timestamp","user_info"],type:"object","if":{not:{properties:{stage:{"const":"NONE"}}}},then:{properties:{user_info:{patternProperties:{"^[0-5]$":{required:["balance","position","user_id","username"]}}}}}}},required:["snapshot"],type:"object"}
}(e=t.PokdengDeskTopic||(t.PokdengDeskTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSort=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.init=function(){this.isSort=!1,this.setType()},e.prototype.setType=function(){this.bg.source=this.isSort?"thirteen_btn_sortout2_png":"thirteen_btn_sortout_png",this.lb.text="ng_kill_sort",this.lb.visible=!this.isSort,this.lbsoted.visible=this.isSort},e}(t.Component);e.SortBtn=i,__reflect(i.prototype,"ui.thirteenkill.SortBtn")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(i){var n=e.call(this)||this;return n.parent_container=i,n.mc=new t.control.MovieClip("",12,-1,0,!1),n.mc.scaleX=n.mc.scaleY=2.9,n.mc.visible=!1,n.mc.horizontalCenter=0,n.mc.verticalCenter=-630,n.mc.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.reset,n),n.aniGruop=new eui.Group,n.aniGruop.addChild(n.mc),n.img_hua1=n.aniGruop.addChild(new eui.Image("thirteen_pic_king_png")),n.aniGruop.touchEnabled=!1,n.aniGruop.touchChildren=!1,n.img_glob1=n.aniGruop.addChild(new eui.Image("win_gold1_png")),n.img_glob2=n.aniGruop.addChild(new eui.Image("win_gold2_png")),n.img_glob3=n.aniGruop.addChild(new eui.Image("win_gold3_png")),n.img_glob4=n.aniGruop.addChild(new eui.Image("win_gold4_png")),n.img_glob5=n.aniGruop.addChild(new eui.Image("win_gold5_png")),n.img_glob6=n.aniGruop.addChild(new eui.Image("win_gold6_png")),n.img_hua2=n.aniGruop.addChild(new eui.Image("thirteen_pic_king_png")),n.img_font=n.aniGruop.addChild(new eui.Image("thirteen_king_png")),n.img_shine=n.aniGruop.addChild(new eui.Image("thirteen_pic_winlight_png")),n.aniGruop.verticalCenter=100,n.aniGruop.horizontalCenter=0,n.img_font.verticalCenter=66,n.img_font.horizontalCenter=0,n.img_hua1.verticalCenter=n.img_hua1.horizontalCenter=0,n.img_hua2.verticalCenter=n.img_hua2.horizontalCenter=0,n.img_shine.verticalCenter=n.img_shine.horizontalCenter=0,n}return __extends(i,e),i.prototype.size=function(){this.img_hua2.width=this.img_hua1.width=532,this.img_hua2.height=this.img_hua1.height=532,this.img_shine.width=605,this.img_shine.height=1360,this.mc.width=634,this.mc.height=587,this.img_glob1.width=143,this.img_glob1.height=131,this.img_glob2.width=113,this.img_glob2.height=102,this.img_glob3.width=153,this.img_glob3.height=149,this.img_glob4.width=125,this.img_glob4.height=127,this.img_glob5.width=146,this.img_glob5.height=90,this.img_glob6.width=160,this.img_glob6.height=134},i.prototype.showAll=function(){this.mc.group="effect_tk_king_light",this.parent_container.addChild(this.aniGruop),this.mc.isPlaying=!0,this.mc.visible=!0},i.prototype.playAni=function(t){var e=this;void 0===t&&(t=null),this.aniGruop.$children.forEach(function(t){egret.Tween.removeTweens(t)});var i=300;this.mc.group="effect_tk_king_light",this.parent_container.addChild(this.aniGruop),this.mc.isPlaying=!0,this.mc.visible=!0,this.goldAni(this.img_glob1,-320,-80,i,-20,20),this.goldAni(this.img_glob2,-420,40,i,0,-20),this.goldAni(this.img_glob3,-320,200,i,0,20),this.goldAni(this.img_glob4,260,-130,i,0,20),this.goldAni(this.img_glob5,400,60,i,10,-10),this.goldAni(this.img_glob6,300,200,i,20,20),egret.Tween.get(this.img_hua1).set({alpha:1,scaleX:1,scaleY:1}).to({alpha:0,scaleX:2,scaleY:2},i).wait(1500).call(function(){e.aniGruop.parent&&e.aniGruop.parent.removeChild(e.aniGruop),t&&t()}),egret.Tween.get(this.img_font).set({scaleX:0,scaleY:0}).to({scaleX:1,scaleY:1},i)},i.prototype.goldAni=function(t,e,i,n,o,r){egret.Tween.get(t).set({visible:!0,alpha:0,verticalCenter:0,horizontalCenter:0}).to({alpha:1,verticalCenter:i,horizontalCenter:e},n).to({horizontalCenter:e+o,verticalCenter:i+r},500).to({verticalCenter:i,horizontalCenter:e},500).to({horizontalCenter:e+o,verticalCenter:i+r},500)},i.prototype.reset=function(){this.mc.isPlaying=!1,this.mc.visible=!1,this.mc.group="",this.mc.source=null},i}(t.Component);e.TianWangAni=i,__reflect(i.prototype,"ui.thirteenkill.TianWangAni")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setScore=function(t,e){var i=this;void 0===e&&(e=null),t>=0?(this.font="thirteen_win_fnt",this.text="+"+util.NumberUtil.formatNumber(t)):(this.font="thirteen_lose_fnt",this.text=util.NumberUtil.formatNumber(t)),this.timeOutId&&clearTimeout(this.timeOutId),this.timeOutId=void 0,e&&(this.timeOutId=setTimeout(function(){i.text="",i.timeOutId=void 0,e()},2e3))},e.prototype.initview=function(){this.text=""},e.prototype.scoreAni=function(t,e){e>=0?this.font="thirteen_win_fnt":this.font="thirteen_lose_fnt",this.text="",util.NumberUtil.tweenNumber(this,e,t,!0)},e}(t.control.BitmapLabel);e.WinLoseInfo=i,__reflect(i.prototype,"ui.thirteenkill.WinLoseInfo")}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataProvider=new eui.ArrayCollection,e.show=function(){Main.instance.addChild(e,!0)},e.close=function(){return e.stage&&e.dialog&&e.dialog.forceClose()},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.addToStage(),this.data&&this.startBtnState(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.level.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.SoundUtil.play("btn_menu_mp3")},this)},e.prototype.setData=function(t){var e=this;this.levelMax=0,this.selected=0,t.forEach(function(t,i){t.disabled||(e.levelMax=i)}),this.data=t,this.dataProvider.replaceAll(t),this.start&&this.startBtnState()},e.prototype.startBtnState=function(){this.data[0].disabled?(this.start.filters=[Const.grayFilter],this.start.enabled=!1):(this.start.filters=null,this.start.enabled=!0)},e.prototype.addToStage=function(){this.level.value=0,this.level.addEventListener(egret.Event.CHANGE,this.levelChange,this),this.start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},e.prototype.removeFromStage=function(){this.level.removeEventListener(egret.Event.CHANGE,this.levelChange,this),this.start.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},e.prototype.levelChange=function(t){this.level.value>this.levelMax&&(this.level.value=this.levelMax),this.selected=this.level.value,this.dealRateState()},e.prototype.startGame=function(){var t=this.data[this.selected].bet_limit;ThirteenKillController.instance.enter_room_args={ante:t},util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_DESK,this.roomName)},e.prototype.dealRateState=function(){var t=this;this.data.forEach(function(e,i){e.selected=i===t.selected}),this.dataProvider.replaceAll(this.data)},e}(t.DialogBase);e.EnterRoomDialog=i,__reflect(i.prototype,"ui.thirteenkill.dialog.EnterRoomDialog")}(i=e.dialog||(e.dialog={}))}(e=t.thirteenkill||(t.thirteenkill={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"endTime",{get:function(){return this._endTime},set:function(t){this._endTime=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),util.NotifyUtil.addNotification("util.TimeUtil.now",function(t){if(e.stage&&e.visible){var i=e.endTime-t,n=Math.ceil(.001*i);if(0>n||e.time===n)return;e.time=n}})},e}(t.Component);e.Countdown=i,__reflect(i.prototype,"ui.three.Countdown")}(e=t.three||(t.three={}))}(ui||(ui={}));var topic;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskRoomSettingData);e.RoomsTopic=i,__reflect(i.prototype,"topic.sedie.RoomsTopic");var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.StageTopic=n,__reflect(n.prototype,"topic.sedie.StageTopic");var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.JoinDeskStageData);e.StageSnapshot=o,__reflect(o.prototype,"topic.sedie.StageSnapshot");var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.RoadMapTopic=r,__reflect(r.prototype,"topic.sedie.RoadMapTopic");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);e.DeskTopic=s,__reflect(s.prototype,"topic.sedie.DeskTopic");var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.SnapshotBase);e.DeskSnapshot=a,__reflect(a.prototype,"topic.sedie.DeskSnapshot")}(e=t.sedie||(t.sedie={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.init=function(){egret.Tween.removeTweens(t.surplus),t.surplus.text=""},t.showSurplus=function(e,i){return egret.Tween.removeTweens(t.surplus),t.surplus.text="",t.surplus.font="public_"+(0>e?"lose":"win")+"_fnt",i?(egret.Tween.get(t.surplus,{onChange:function(){return t.surplus.bottom=t.surplus._percentBottom+"%"}}).set({_percentBottom:-100}).to({_percentBottom:0},.3*i,egret.Ease.sineOut),util.NumberUtil.tweenNumber(t.surplus,e,i,!0)):(t.surplus.bottom=0,void(t.surplus.text=""+(0>e?"":"+")+util.NumberUtil.formatNumber(e)))},t.sendChip=function(e,n,o,r){if(o){var s=n.addChild(i.chip),a=t.point,l=n.globalToLocal(a.x,a.y),u=e.point,h=n.globalToLocal(u.x,u.y);s.x=l.x,s.y=l.y,egret.Tween.get(s).to({x:h.x,y:h.y},o,egret.Ease.sineOut).call(function(){return n.removeChild(s)}),r&&s.once(egret.Event.REMOVED_FROM_STAGE,r,t)}else r&&r()},t}return __extends(i,e),Object.defineProperty(i,"chip",{get:function(){var t;return this.chipPool.some(function(e){var i=!e.stage;return i&&(t=e),i})||(t=new eui.Image("tf_pic_chip_png"),this.chipPool.push(t)),t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shine",{get:function(){return this._shine},set:function(t){this._shine=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"userInfo",{get:function(){return this._userInfo},set:function(e){if(e){var n=t.component.Avatar.generateAvatar(e.avatar);e.user_id===Const.UserInfo.USER_ID?(e.username=Const.UserInfo.NICK,i.avatarMap.set(e.user_id,Const.UserInfo.AVATAR)):e.avatar!==n&&i.avatarMap.get(e.user_id)||i.avatarMap.set(e.user_id,n),e.avatar=i.avatarMap.get(e.user_id)}this._userInfo=e,this.balance=e&&util.NumberUtil.formatNumber(e.balance)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dispute",{get:function(){return this._dispute},set:function(t){this._dispute=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showBanker",{get:function(){return this._showBanker},set:function(t){this._showBanker=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"point",{get:function(){return this.chipPoint&&this.chipPoint.localToGlobal()},enumerable:!0,configurable:!0}),i.prototype.getCurrentState=function(){return""+e.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},i.avatarMap=new Map,i.chipPool=[],i}(t.Component);e.Player=i,__reflect(i.prototype,"ui.three.Player")}(e=t.three||(t.three={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.initTween=function(){egret.Tween.removeTweens(t.result),egret.Tween.removeTweens(t.text),t.result.scrollEnabled=!0,t.result.percentWidth=0,t.text.alpha=0,t.fightImg&&t.fightTxt&&(egret.Tween.removeTweens(t.fightImg),egret.Tween.removeTweens(t.fightTxt),egret.Tween.removeTweens(t.fightImage),egret.Tween.removeTweens(t.star1),egret.Tween.removeTweens(t.star2),t.star2.alpha=t.star1.alpha=t.fightTxt.alpha=t.fightImg.alpha=0,t.fightImage.visible=!1)},t.init=function(e){t.poker2.visible=t.poker1.visible=t.poker0.visible=!1,t.poker2.currentState=t.poker1.currentState=t.poker0.currentState="back",t.initTween(),t.dealt=0,t.opened=!!e,util.TimeUtil.clearTimeout(t.timeout)},t._deal=function(e,n,o){var r=0===t.dealt?t.poker0:1===t.dealt?t.poker1:t.poker2;if(t.dealt++,o){var s=n.addChild(i.poker),a=e.localToGlobal(),l=n.globalToLocal(a.x,a.y),u=r.localToGlobal(),h=n.globalToLocal(u.x,u.y);return util.SoundUtil.play("sg_send_card_mp3"),s.x=l.x,s.y=l.y,s.size=e.size,egret.Tween.get(s).to({x:h.x,y:h.y,size:r.size},o,egret.Ease.sineOut).call(function(){n.removeChild(s),r.visible=!0})}r.visible=!0},t.deal=function(e,i,n){return __awaiter(t,void 0,void 0,function(){var t=this;return __generator(this,function(o){switch(o.label){case 0:return this.init(this.opened),n?[4,new Promise(function(o){t._deal(e,i,n),t.timeout=util.TimeUtil.setTimeout(function(){t._deal(e,i,n),t.timeout=util.TimeUtil.setTimeout(function(){t._deal(e,i,n).call(o)},.2*n)},.2*n)})]:[3,2];case 1:return o.sent(),[3,3];case 2:this._deal(e,i,n),this._deal(e,i,n),this._deal(e,i,n),o.label=3;case 3:return this.opened&&this.open(null,n),[2]}})})},t.open=function(e,i){return __awaiter(t,void 0,void 0,function(){var t=this;return __generator(this,function(n){switch(n.label){case 0:return this.opened=!0,this.initTween(),e&&(e.point>9&&(e.point=9),this.fight=e,this.poker0.num=e.cards[0],this.poker1.num=e.cards[1],this.poker2.num=e.cards[2],e.odds>2?(this.fightSource="tf_font_"+(3===e.odds?"three_facecard":4===e.odds?"bomb":"bust_nine")+"_png",this.fightImg&&this.fightTxt&&(this.fightImage.source=this.fightEnd.source=this.fightImg.source="tf_pic_"+(3===e.odds?"three_facecard":4===e.odds?"bomb":"bust_nine")+"_png",this.fightTxt.source=this.fightSource.replace(/_png$/,"_b_png")),this.showPoint=!1):e.point?(this.fightSource="tf_font_"+e.odds+"times_png",this.showPoint=!0):(this.fightSource="tf_font_0_png",this.showPoint=!1)),i?(util.SoundUtil.play("sg_send_card_mp3"),[4,this.poker0.turnCard(i)]):[3,4];case 1:return n.sent(),util.SoundUtil.play("sg_send_card_mp3"),[4,this.poker1.turnCard(i)];case 2:return n.sent(),util.SoundUtil.play("sg_send_card_mp3"),[4,this.poker2.turnCard(i)];case 3:return n.sent(),egret.Tween.get(this.result).to({scrollEnabled:!1,percentWidth:100},i).call(function(){e.odds>2?(util.SoundUtil.play("sg_teshupai_mp3"),e.odds<5&&util.SoundUtil.play("sg_"+(3===e.odds?"sg":"dsg")+"_"+(util.NumberUtil.getRandom(0,1)?"boy":"girl")+"_mp3")):util.SoundUtil.play("sg_"+(util.NumberUtil.getRandom(0,1)?"male":"female")+"_"+e.point+"_mp3"),egret.Tween.get(t.text).set({scaleX:3,scaleY:3}).to({alpha:1,scaleX:1,scaleY:1},i)}),e.odds>2&&this.fightImg&&this.fightTxt&&egret.Tween.get(this.fightImg).to({alpha:1},i).call(function(){egret.Tween.get(t.fightTxt).set({scaleX:3,scaleY:3}).to({alpha:1,scaleX:1,scaleY:1},i).wait(3.3333*i).call(function(){var e=t.fightImg.localToGlobal(),n=t.result.globalToLocal(e.x,e.y);t.fightImg.alpha=0,t.fightImage.visible=!0,t.fightImage.x=n.x,t.fightImage.y=n.y,t.fightImage.scaleX=t.fightImg.scaleX,t.fightImage.scaleY=t.fightImg.scaleY,egret.Tween.get(t.fightTxt).to({alpha:0},i),egret.Tween.get(t.fightImage).to({x:t.fightEnd.x,y:t.fightEnd.y,scaleX:t.fightEnd.scaleX,scaleY:t.fightEnd.scaleY},i).call(function(){egret.Tween.get(t.star1).set({scaleX:0,scaleY:0,rotation:0}).to({alpha:1,scaleX:1,scaleY:1,rotation:180},i).to({alpha:0,scaleX:0,scaleY:0,rotation:360},i),egret.Tween.get(t.star2).set({scaleX:0,scaleY:0,rotation:0}).to({alpha:1,scaleX:1,scaleY:1,rotation:180},i).to({alpha:0,scaleX:0,scaleY:0,rotation:360},i)})})}),[3,5];case 4:this.poker0.turnCard(i),this.poker1.turnCard(i),this.poker2.turnCard(i),this.result.scrollEnabled=!1,this.result.percentWidth=100,this.text.alpha=1,this.text.scaleY=this.text.scaleX=1,this.fight.odds>2&&this.fightImg&&this.fightTxt&&(this.fightImage.visible=!0,this.fightImage.x=this.fightEnd.x,this.fightImage.y=this.fightEnd.y,this.fightImage.scaleX=this.fightEnd.scaleX,this.fightImage.scaleY=this.fightEnd.scaleY),n.label=5;case 5:return[2]}})})},t}return __extends(i,e),Object.defineProperty(i,"poker",{get:function(){var e;return this.pokerPool.some(function(t){var i=!t.stage;return i&&(e=t),i})||(e=new t.component.Poker,this.pokerPool.push(e)),e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dispute",{get:function(){return this._dispute},set:function(t){this._dispute=t,this.disputeSource="tf_font_table"+(t&&-1===t.dispute_rate?"_non":"")+"_snatch_png"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"raise",{get:function(){return this._raise},set:function(t){this._raise=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showDispute",{get:function(){return this._showDispute},set:function(t){this._showDispute=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showRaise",{get:function(){return this._showRaise},set:function(t){this._showRaise=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fightImg",{get:function(){return this._fightImg},set:function(t){this._fightImg=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fightTxt",{get:function(){return this._fightTxt},set:function(t){this._fightTxt=t},enumerable:!0,configurable:!0}),i.prototype.getCurrentState=function(){return""+e.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},i.pokerPool=[],i}(t.Component);e.PokerGroup=i,__reflect(i.prototype,"ui.three.PokerGroup")}(e=t.three||(t.three={}))}(ui||(ui={}));var topic;!function(t){t.thirteenkillSchema={$schema:"http://json-schema.org/draft-07/schema#",definitions:{userinfo:{type:"object",properties:{user_id:{type:"string"},username:{type:"string"},avatar:{type:"string"},balance:{decimal:!0},pass:{type:"boolean"},status:{type:"string"},position:{type:"number",minimum:1,maximum:4},card_size:{type:"integer",minimum:0,maximum:13},cards:{items:{type:"integer",minimum:0,maximum:51}},next:{items:{type:"integer",minimum:0,maximum:51}},surplus:{type:"number"},all_kill:{type:"boolean"}}}},type:"object",properties:{snapshot:{type:"object",properties:{room_setting:{type:"object",properties:{type:{type:"string"},room_id:{type:"string"},time:{type:"object",properties:{op:{type:"number"}},required:["op"]},tax:{type:"number"}},required:["type","room_id","time","tax"]},ante:{type:"number"},stage:{type:"string"},stage_timestamp:{type:"number"},decision_position:{type:"number",minimum:1,maximum:4},stop_decision_ts:{type:"number"},card:{items:{type:"integer",minimum:0,maximum:51}},must:{type:"boolean"},desk:{type:"object",properties:{1:{$ref:"#/definitions/userinfo"},2:{$ref:"#/definitions/userinfo"},3:{$ref:"#/definitions/userinfo"},4:{$ref:"#/definitions/userinfo"},card:{items:{type:"integer",minimum:0,maximum:51}},card_type:{type:"string"}},required:["1","2","3","4"]}},required:["room_setting","ante","stage","desk"]}},required:["snapshot"]};var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.ThirteenKillDeskTopic=e,__reflect(e.prototype,"topic.ThirteenKillDeskTopic")}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){e.shine=e.visible=!1,e._fight=e.raise=e.dispute=e.userInfo=null,e.player.init(),e.pokerGroup.init()},e.deal=function(t,i,n){return void 0===n&&(n=300),e.pokerGroup.deal(t,i,n)},e.open=function(t,i){return void 0===i&&(i=300),e._fight=t,t.is_done?(t.odds=Number(t.odds),e.pokerGroup.open(t,i)):void 0},e.showSurplus=function(t,i){return void 0===i&&(i=1e3),e.player.showSurplus(t,i)},e.sendChip=function(t,i,n,o){return void 0===n&&(n=300),e.player.sendChip(t,i,n,o)},e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shine",{get:function(){return this._shine},set:function(t){this._shine=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deskStage",{get:function(){return this._deskStage},set:function(t){this._deskStage=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userInfo",{get:function(){return this._userInfo},set:function(t){this._userInfo=t,this.visible=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dispute",{get:function(){return this._dispute},set:function(t){this._dispute=t,this.showDispute=this.deskStage.DISPUTE&&t&&t.is_done,this.showBanker=!this.deskStage.DISPUTE&&t&&t.is_banker},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"raise",{get:function(){return this._raise},set:function(t){this._raise=t,this.showRaise=t&&t.is_done&&!this.dispute.is_banker},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fight",{get:function(){return this._fight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightImg",{get:function(){return this._fightImg},set:function(t){this._fightImg=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightTxt",{get:function(){return this._fightTxt},set:function(t){this._fightTxt=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"point",{get:function(){return this.player&&this.player.point},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),eui.Watcher.watch(this,["deskStage","DISPUTE"],function(t){e.showDispute=t&&e.dispute&&e.dispute.is_done,e.showBanker=!t&&e.dispute&&e.dispute.is_banker},this)},e}(t.Component);e.Seat=i,__reflect(i.prototype,"ui.three.Seat")}(e=t.three||(t.three={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.Match=0]="Match",t[t.Canle=1]="Canle"}(i=e.MatchEnum||(e.MatchEnum={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.addToStage=function(){this.btnMatch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.btn_auto_match.selected?this.autoMatch():this.changeState(i.Match)},e.prototype.removeFromStage=function(){this.btnMatch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.match,this),this.btnCancle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleMatch,this),this.clearInterval()},e.prototype.match=function(){this.sendMatchNotify(),this.removeMyself()},e.prototype.cancleMatch=function(){this.clearInterval(),this.btn_auto_match.selected=!1,this.changeState(i.Match)},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e.prototype.autoMatch=function(){var t=this,e=5,n=function(e){e>=0?t.lbCount.text=util.LanguageUtil.translate("lbl_game_willmatch",""+e):(t.clearInterval(),t.parent&&t.parent.removeChild(t),t.match())};this.changeState(i.Canle),n(e--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(e--)},1e3)},e.prototype.changeState=function(t){this.type=t===i.Match?"match":"cancel",!this.visible&&(this.visible=!0)},e}(t.Component);e.AutoMatch=n,__reflect(n.prototype,"ui.threeflower.AutoMatch")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clearTimeOut=function(){return util.TimeUtil.clearInterval(e.setIntervalID)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=this.touchChildren=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clearTimeOut,this)},e.prototype.show=function(t,e){var i=this;this.setIntervalID&&this.clearTimeOut();var n=function(){var n=i.calRemainMill(t,e)/1e3<<0;n>=0?i.lb_cd.text=""+n:(i.parent&&i.parent.removeChild(i),i.visible=!1,util.TimeUtil.clearInterval(i.setIntervalID),i.setIntervalID=void 0)};n(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return n()},250)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?-150:-70},e}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ui.threeflower.CountDown")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.ThreeDeskTopic=e,__reflect(e.prototype,"topic.ThreeDeskTopic"),function(e){var i;!function(e){var i;!function(e){var i;!function(e){e.schema={allOf:[t.DeskTopic.FightItem.schema,{properties:{cards:{minItems:3},type:{pattern:"^(SUPREME|EX_PUBLIC|PUBLIC|POINT)$"},point:{type:"number"}},"if":{properties:{is_done:{"const":!0}}},then:{required:["point"]}}]}}(i=e.FightItem||(e.FightItem={}))}(i=e.Fight||(e.Fight={}));var n;!function(e){e.schema={type:"object",patternProperties:{"^[1-5]$":t.DeskTopic.SettleItem.schema},additionalProperties:!1,minProperties:5}}(n=e.Settle||(e.Settle={}))}(i=e.Snapshot||(e.Snapshot={})),e.schema={type:"object",properties:{snapshot:{type:"object",properties:{stage:{type:"string","enum":["NONE","DISPUTE","RAISE","FIGHT","SETTLE"]},stage_timestamp:{type:"number"},room_setting:{type:"object",properties:{time:{type:"object",properties:{dispute:{type:"number"},raise:{type:"number"},op:{type:"number"}},required:["dispute","raise","op"]}},required:["time"]},bet_limit:{type:"object",properties:{ante:{type:"number"}},required:["ante"]},user_info:{type:"object",patternProperties:{"^[1-5]$":{anyOf:[{"const":{}},t.DeskTopic.UserItem.schema]}},additionalProperties:!1,minProperties:5},dispute:{type:"object",patternProperties:{"^[1-5]$":t.DeskTopic.DisputeItem.schema},additionalProperties:!1,minProperties:5},raise_rate_options:{type:"array",items:{type:"number"},minItems:5},raise:{type:"object",patternProperties:{"^[1-5]$":t.DeskTopic.RaiseItem.schema},additionalProperties:!1,minProperties:5},fight:{type:"object",patternProperties:{"^[1-5]$":i.Fight.FightItem.schema},additionalProperties:!1,minProperties:5},settle:i.Settle.schema},required:["stage","stage_timestamp","room_setting","bet_limit","user_info","dispute","raise","fight","settle"]}},required:["snapshot"]}}(e=t.ThreeDeskTopic||(t.ThreeDeskTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.texiao.addEventListener(egret.Event.COMPLETE,function(){return e.texiao.visible=!1},this)},e.prototype.init=function(){this.xiaoguo.visible=!1,this.zhuang.visible=!1},e.prototype.getChipPosition=function(){var t=util.ObjectUtil.copy(this.avatar.localToGlobal());return t.x+=this.avatar.width/2,t.y+=this.avatar.height/2,t},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+this.type},e.prototype.setName=function(t){this.lb_playerId.text=t},e.prototype.setBalance=function(t){this.lb_playerBalance.text=util.NumberUtil.formatNumber(t)},Object.defineProperty(e.prototype,"isBanker",{set:function(t){this.zhuang.visible=t},enumerable:!0,configurable:!0}),e.prototype.getIsBanker=function(){return this.zhuang.visible},e.prototype.setHead=function(t){t&&""!==t&&(this.avatar.source=t)},e.prototype.randonHead=function(){this.avatar.source=""},e.prototype.setXiaoguo=function(t){this.xiaoguo.visible=t},e.prototype.playAnim=function(t){void 0===t&&(t=1),t>0?(this.texiao.playTimes=t,this.texiao.currentFrame=0,this.texiao.visible=!0,this.texiao.isPlaying=!0):(this.texiao.playTimes=-1,this.texiao.currentFrame=0,this.texiao.visible=!0,this.texiao.isPlaying=!0)},e}(t.Component);e.PlayerInfo=i,__reflect(i.prototype,"ui.threeflower.PlayerInfo")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e._selected=!1,e._enabled=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setSelect=function(t){this._selected=t,t?(this.img_poker.verticalCenter=-20,this.img_select.verticalCenter=-20,this.rect_poker.verticalCenter=-20,this.setColor("blue")):(this.img_poker.verticalCenter=0,this.img_select.verticalCenter=0,this.rect_poker.verticalCenter=0,this.setColor())},e.prototype.isSelected=function(){return this._selected},e.prototype.setColor=function(t){switch(t){case"blue":this.img_select.source="3cgf_pic_pokerlight1_png";break;case"yellow":this.img_select.source="3cgf_pic_pokerlight2_png";break;default:this.img_select.source=""}},e.prototype.enableTap=function(t){this._enabled=t},e.prototype.setCard=function(t){"number"==typeof t?(this.img_poker.source=t+"_png",this.value=t,this.poker_number=t%13,this.poker_type=Math.floor(t/13)):(this.img_poker.source="poker_back_png",this.value=0,this.poker_number=-1,this.poker_type=-1)},e.prototype.getPokerNumber=function(){return this.poker_number},e.prototype.getPokerType=function(){return this.poker_type},e.prototype.getPokerSize=function(){return{width:260*this.img_poker.scaleX,height:360*this.img_poker.scaleY}},e.prototype.getPokerPos=function(){return this.img_poker.localToGlobal()},e.prototype.getValue=function(){return this.value},e.prototype.getTapArea=function(){return this.rect_poker},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.threeflower.Poker")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(e){var i=t.call(this)||this;i.pokers=[],i.parent_container=e;for(var n=1;25>=n;n++){var o=new eui.Image("poker_back_png");o.width=65,o.height=90,o.visible=!1,i.parent_container.addChild(o),i.pokers.push(o)}return i}return __extends(e,t),e.prototype.flyCard=function(t,e,i){var n=this;
return new Promise(function(o){for(var r=5*(t-1),s=5*t-1,a=n.parent_container.globalToLocal(e.x,e.y),l=0,u=function(){return util.SoundUtil.play("nn_sendcard_mp3")},h=function(t){egret.Tween.get(n.pokers[t]).wait(l).set({x:0,y:0,scaleX:1,scaleY:1,visible:!0}).call(u).to({x:a.x,y:a.y,scaleX:i.width/n.pokers[t].width,scaleY:i.height/n.pokers[t].height},200).call(function(){t===s&&o()}),l+=50},c=r;s>=c;c++)h(c)})},e.prototype.hidePoker=function(t){if(t)for(var e=5*(t-1),i=5*t-1,n=e;i>=n;n++)this.pokers[n].visible=!1;else this.pokers.forEach(function(t){t.visible=!1})},e}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.threeflower.PokerAni")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectList=[],e.landscape_other_gap=-61,e.landscape_own_gap=20,e.portrait_own_gap=-56,e.portrait_other_gap=-82,e.correctCards=[1,2,3],e.result_sound={three_of_a_kind:["qzwxs_jh_male_6_mp3","qzwxs_jh_female_6_mp3"],straight_flush:["qzwxs_jh_male_5_mp3","qzwxs_jh_female_5_mp3"],golden_flower:["qzwxs_jh_male_4_mp3","qzwxs_jh_female_4_mp3"],straight:["qzwxs_jh_male_3_mp3","qzwxs_jh_female_3_mp3"],two_pairs:["qzwxs_jh_male_2_mp3","qzwxs_jh_female_2_mp3"],high_card:["qzwxs_jh_male_1_mp3","qzwxs_jh_female_1_mp3"]},e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState(),Main.instance.orientation===egret.OrientationMode.PORTRAIT&&(this.horizontalCenter="own"===this._type?140:0)},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.Pokers=[this.poker_1,this.poker_2,this.poker_3,this.poker_4,this.poker_5],this.enabled=!1,this.registerEvent()},e.prototype.setCorrectArr=function(t){this.correctCards=t.slice(),this.correctCards.sort(function(t,e){return t-e})},e.prototype.registerEvent=function(){var t=this;"own"===this.type&&(this.enabled=!0,this.Pokers.forEach(function(i){i.getTapArea().addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.isCantouch&&(i.isSelected()?i.isSelected()&&(i.setSelect(!1),t.selectList.splice(t.selectList.indexOf(i.getValue()),1)):(i.setSelect(!0),3===t.selectList.length&&t.Pokers[t.cards.indexOf(t.selectList.splice(0,1)[0])].setSelect(!1),t.selectList.push(i.getValue())),t.dispatchEventWith(e.EVT_SELECT,!0,t.selectList),t.changePokerColor(!1))},t),mouse.setButtonMode(i.getTapArea(),!0)}))},e.prototype.showBestCards=function(){var t=this;this.isCantouch=!1,this.selectList=this.correctCards.slice(),this.Pokers.forEach(function(t){t.setSelect(!1)}),this.selectList.forEach(function(e){t.Pokers[t.cards.indexOf(e)].setSelect(!0)}),this.changePokerColor(!0)},e.prototype.changePokerColor=function(t){var e=t?"yellow":"blue";this.setColor(e)},e.prototype.getTopCardPos=function(){return this.poker_1.getPokerPos()},e.prototype.getPokerSize=function(){return this.poker_1.getPokerSize()},e.prototype.setCards=function(t){this.cards=t,t.length&&t[0]&&this.cards.sort(function(t,e){return t-e});for(var e=0;5>e;e++){var i=this.Pokers[e];i.setCard(t[e])}},e.prototype.dealCardAni=function(){var t=this;return this.visible=!0,new Promise(function(e){egret.Tween.get(t.group_poker.layout).set({gap:-t.poker_1.width}).to({gap:t[t.currentState+"_gap"]},300).call(e)})},e.prototype.setColor=function(t){this.Pokers.forEach(function(e){e.isSelected()&&e.setColor(t)})},e.prototype.setBack=function(){this.Pokers.forEach(function(t){t.setSelect(!1),t.setCard()})},e.prototype.init=function(){this.Pokers.forEach(function(t){t.setSelect(!1),t.setCard()}),this.selectList=[],this.result.visible=!1,this.isCantouch=!0,this.isShown=!1},e.prototype.isRight=function(){if(this.selectList.length<3)return!1;for(var t=0;3>t;t++)if(this.cards[t]!==this.correctCards[t])return!1;return!0},e.prototype.finish=function(t){this.init(),this.enabled=!1,this.type="other"},e.prototype.getResultSound=function(t){return this.result_sound[""+t][""+util.NumberUtil.getRandom(0,1)]},e.prototype.showResult=function(t,e){var i=this;if(!this.isShown){this.setBack(),this.isShown=!0;var n=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},o=function(){return util.SoundUtil.play(i.getResultSound(e))};return new Promise(function(r){i.type="other",i.Pokers.forEach(function(s,a){var l=Main.instance.orientation===egret.OrientationMode.LANDSCAPE?.5:.66;egret.Tween.get(s.img_poker).wait(50*(a-1)).to({scaleX:0,scaleY:1.1*l},200).call(function(){s.setCard(t[a])}).to({scaleX:l,scaleY:l},200).call(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return 4!==a?[3,2]:(o(),this.result.playAni(e),[4,n(600)]);case 1:t.sent(),r(),t.label=2;case 2:return[2]}})})})})})}},e.EVT_SELECT="evt_select",e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.threeflower.PokerList")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._type="",e.types=["baozi","tonghuashun","jinhua","shunzi","duizi","sanpai"],e.typeServer=["three_of_a_kind","straight_flush","golden_flower","straight","two_pairs","high_card"],e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.getCurrentState=function(){return this._type},Object.defineProperty(e.prototype,"type",{set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.playAni=function(t){this.type=this.types[this.typeServer.indexOf(t)],egret.Tween.get(this).set({scaleX:0,scaleY:1.1,alpha:0,visible:!0}).to({scaleX:1,scaleY:1,alpha:1},200,egret.Ease.circInOut)},e}(t.Component);e.Result=i,__reflect(i.prototype,"ui.threeflower.Result")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i;!function(t){t[t.take_all=0]="take_all",t[t.lose_all=1]="lose_all",t[t.win=2]="win"}(i=e.ResultEnum||(e.ResultEnum={}));var n=function(e){function n(i){var n=e.call(this)||this;return n.parent_container=i,n.touchEnabled=!1,n.touchChildren=!1,n.mc=new t.control.MovieClip("",12,1,0,!1),n.mc.scaleX=n.mc.scaleY=1.6,n.mc.visible=!1,n.mc.horizontalCenter=0,n.mc.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.reset,n),n}return __extends(n,e),n.prototype.show=function(t){var e=this;return new Promise(function(n){switch(e.mc.currentFrame=0,t){case i.take_all:util.SoundUtil.play("sg_tongchi_mp3"),util.SoundUtil.play(["sg_tongchi_boy_mp3","sg_tongchi_girl_mp3"][util.NumberUtil.getRandom(0,1)]),e.mc.group="effect_bull_eatall",e.mc.verticalCenter=Main.instance.orientation===egret.OrientationMode.LANDSCAPE?-290:-200;break;case i.lose_all:e.mc.verticalCenter=Main.instance.orientation===egret.OrientationMode.LANDSCAPE?-220:-240,e.mc.group="effect_bull_compensation";break;case i.win:e.mc.verticalCenter=(Main.instance.orientation===egret.OrientationMode.LANDSCAPE,-190),e.mc.group="effect_0_win"}e.mc.playTimes=1,e.mc.once(egret.Event.COMPLETE,function(){n(),e.reset()},e),e.parent_container.addChild(e.mc),e.mc.isPlaying=!0,e.mc.visible=!0})},n.prototype.reset=function(){this.mc.parent&&(this.mc.parent.removeChild(this.mc),this.mc.isPlaying=!1,this.mc.visible=!1,this.mc.group="",this.mc.source=null)},n.prototype.resetMode=function(t){this.mc.verticalCenter=t===egret.OrientationMode.PORTRAIT?-450:-300},n}(eui.Component);e.ResultMC=n,__reflect(n.prototype,"ui.threeflower.ResultMC")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var topic;!function(t){t.threeflowerSchema={type:"object",properties:{snapshot:{type:"object",properties:{room_setting:{type:"object",properties:{room_id:{type:"string"},tax:{type:"number"},time:{type:"object",properties:{dispute:{type:"number"},op:{type:"number"}},required:["dispute","op"]},type:{type:"string"}},required:["room_id","tax","time","type"]},bet_limit:{type:"object",properties:{ante:{type:"number"},admittance:{type:"number"}},required:["ante","admittance"]},desk_info:{type:"object",properties:{banker_position:{type:"string"},stage:{type:"string"},timestamp:{type:"number"}},required:["stage","timestamp"]},deal:{type:"object",properties:{stage_timestamp:{type:"number"},desk:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{is_done:{type:"boolean"},cards_info:{type:"object",properties:{cards:{items:{type:"number"}},best_cards:{items:{type:"number"}},best_type:{type:"string"}},required:["cards","best_type","best_cards"]}}}},additionalProperties:!1}},required:["stage_timestamp","desk"]},user_info:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{user_id:{type:"string"},avatar:{type:"string"},username:{type:"string"},balance:{decimal:!0},position:{pattern:"^[1-6]$",type:"string"}}}},additionalProperties:!1},dispute:{type:"object",properties:{stage_timestamp:{type:"number"},desk:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{dispute:{type:"number"}}}},additionalProperties:!1}}},settle:{type:"object",properties:{stage_timestamp:{type:"number"},desk:{type:"object",patternProperties:{"^[1-6]$":{type:"object",properties:{surplus:{type:"number"}}}},additionalProperties:!1}}}},required:["bet_limit","deal","desk_info","dispute","room_setting","settle","user_info"]}},required:["snapshot"]};var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.ThreeFlowerDeskTopic=e,__reflect(e.prototype,"topic.ThreeFlowerDeskTopic")}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._sendDispute=function(e){i.dispatchEventWith(t.bull.MultButtonsBase.EVT_SEND_MULT,!1,1),i.removeMyself()},i}return __extends(i,e),i.prototype.getCurrentState=function(){return Main.instance.orientation},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.invalidateState(),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.invalidateState,this)},i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},i.prototype.onAddStage=function(){this.btnCancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.giveup,this),this.btnQiang.addEventListener(egret.TouchEvent.TOUCH_TAP,this._sendDispute,this)},i.prototype.onRemoveStage=function(){this.btnCancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.giveup,this),this.btnQiang.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._sendDispute,this)},i.prototype.giveup=function(){this.dispatchEventWith(t.bull.MultButtonsBase.EVT_SEND_MULT,!1,-1),this.removeMyself()},i.prototype.init=function(t){this.my_position=t},i.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},i}(eui.Component);e.SnatchButtons=i,__reflect(i.prototype,"ui.threeflower.SnatchButtons")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.points=[this.point1,this.point2,this.point3],t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.onAddStage()},e.prototype.onAddStage=function(){"thinking"===this._type&&this.playAnim()},e.prototype.onRemoveStage=function(){this.setIntervalID&&(egret.clearInterval(this.setIntervalID),this.setIntervalID=void 0)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,"thinking"===t?this.playAnim():this.onRemoveStage(),this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+this.type},e.prototype.playAnim=function(){var t=this;this.setIntervalID=egret.setInterval(function(){var e=t.time%4;0===e?t.points.forEach(function(t){return t.visible=!1}):t.points[e-1].visible=!0,t.time++},this,500)},e}(t.Component);e.SnatchInfo=i,__reflect(i.prototype,"ui.threeflower.SnatchInfo")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cards=[],e.correctCards=[],e.sources=["3cgf_font_leopard_png","3cgf_font_straight_flush_png","3cgf_font_golden_flower_png","3cgf_font_straight_png","3cgf_font_pair_png","3cgf_font_high_card_png"],e.poker_alpha=.5,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChange=function(t){this.cards=t.data.slice(),this.showResult()},e.prototype.setPokers=function(){var t=this.cards.length;if(3!==t)for(var e=0;3>e;e++)this.cards.push(void 0);this.setPoker(this.poker1,this.cards[0]),this.setPoker(this.poker2,this.cards[1]),this.setPoker(this.poker3,this.cards[2])},e.prototype.showResult=function(){this.setPokers(),this.showType()&&this.checkTishi()},e.prototype.showType=function(){var t=this.checkType();return void 0!==t?(this.pokerType.visible=!0,this.pokerType.source=this.sources[t],!0):!1},e.prototype.checkTishi=function(){this.tishi.visible=this.isShowTishi()},e.prototype.showBestCards=function(){this.cards=util.ObjectUtil.copy(this.correctCards),this.showResult()},e.prototype.setPoker=function(t,e){t.setCard(e),t.alpha="number"==typeof e?1:this.poker_alpha},e.prototype.init=function(){this.setPoker(this.poker1),this.setPoker(this.poker2),this.setPoker(this.poker3),this.tishi.visible=!1,this.pokerType.visible=!1,this.cards=[],this.correctCards=[]},e.prototype.isShowTishi=function(){if(void 0===this.cards[2])return!1;this.cards.sort(function(t,e){return t-e});for(var t=0;3>t;t++)if(this.cards[t]!==this.correctCards[t])return!0;return!1},e.prototype.isRight=function(){return this.cards.length<3||void 0===this.cards[2]?!1:!this.tishi.visible},e.prototype.setCorrectArr=function(t){this.correctCards=util.ObjectUtil.copy(t),this.correctCards.sort(function(t,e){return t-e})},e.prototype.checkType=function(){if(3===this.cards.length&&"number"==typeof this.cards[2]){var t=!1,e=!1,i=[this.poker1.getPokerType(),this.poker2.getPokerType(),this.poker3.getPokerType()],n=[this.poker1.getPokerNumber(),this.poker2.getPokerNumber(),this.poker3.getPokerNumber()];return n.sort(function(t,e){return t-e}),n[0]===n[1]&&n[1]===n[2]?0:(i[0]===i[1]&&i[1]===i[2]&&(t=!0),((n[0]+1)%13===n[1]&&(n[1]+1)%13===n[2]||0===n[0]&&1===n[1]&&12===n[2])&&(e=!0),e&&t?1:t?2:e?3:n[0]===n[1]||n[1]===n[2]?4:5)}return this.pokerType.visible=!1,void(this.tishi.visible=!1)},e}(t.Component);e.ThreePoker=i,__reflect(i.prototype,"ui.threeflower.ThreePoker")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getCurrentState=function(){return Main.instance.orientation},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.invalidateState(),this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.invalidateState,this)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this)},e.prototype.onAddStage=function(){this.canTouch=!0,this.btnRecommend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.recommend,this),this.btnOpen.addEventListener(egret.TouchEvent.TOUCH_TAP,this.open,this)},e.prototype.onRemoveStage=function(){this.btnRecommend.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.recommend,this),this.btnOpen.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.open,this)},e.prototype.open=function(t){this.canTouch&&this.dispatchEventWith(e.BTN_TOUCH,!0,-1)},e.prototype.recommend=function(){var t=this;this.canTouch&&(this.canTouch=!1,this.dispatchEventWith(e.BTN_TOUCH,!0,1),egret.setTimeout(function(){return t.dispatchEventWith(e.BTN_TOUCH,!0,-1)},this,2e3))},e.prototype.init=function(t){this.my_position=t},e.prototype.removeMyself=function(){this.parent&&this.parent.removeChild(this)},e.BTN_TOUCH="btn_touch",e}(eui.Component);t.WatchButtons=e,__reflect(e.prototype,"ui.threeflower.WatchButtons")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setScore=function(t){t>=0?(this.resultNum.font="public_win_fnt",this.resultNum.text="+"+util.NumberUtil.formatNumber(t)):(this.resultNum.font="public_lose_fnt",this.resultNum.text=util.NumberUtil.formatNumber(t))},e}(t.Component);e.WinLoseInfo=i,__reflect(i.prototype,"ui.threeflower.WinLoseInfo")}(e=t.threeflower||(t.threeflower={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.init,this)},e.prototype.added=function(){var t=this;this.visible=!0,this.result.scrollEnabled=!0,this.result.percentWidth=0,this.start_game_leaves1.visible=!1,this.start_game_leaves2.visible=!1,this.start_game.visible=!1,this.result.alpha=1;var i=125;egret.Tween.get(this.result).to({scrollEnabled:!1,percentWidth:100},2*i).call(function(){t.start_game_leaves1.visible=!0,t.start_game_leaves2.visible=!0,t.start_game.visible=!0,t.start_game_leaves1.alpha=1,t.start_game_leaves2.alpha=1,t.start_game.scaleX=3,t.start_game.scaleY=3,t.start_game.y=-5e3,egret.Tween.get(t.start_game).to({scaleX:1,scaleY:1,y:93.5},3*i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves1).to({y:200},2*i).to({y:186},2*i).to({alpha:.3},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves2).to({y:-14},2*i).to({y:7},2*i).to({alpha:.3},i,egret.Ease.circOut).call(function(){egret.Tween.get(t.result).to({alpha:0},3*i,egret.Ease.circOut)})}),util.TimeUtil.setTimeout(function(){t.parent&&t.parent.removeChild(t),t.dispatchEventWith(e.EVT_SHOW_BTN)},10*i)},e.prototype.init=function(){this.visible=!1,egret.Tween.removeTweens(this.result),egret.Tween.removeTweens(this.start_game),egret.Tween.removeTweens(this.start_game_leaves1),egret.Tween.removeTweens(this.start_game_leaves2)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?156.5:51.5,this.horizontalCenter=t===egret.OrientationMode.PORTRAIT?50.5:63.125},e.EVT_SHOW_BTN="evt_show_btn",e}(eui.Component);t.BeginAni=e,__reflect(e.prototype,"ui.twoeight.BeginAni")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.init,this)},e.prototype.added=function(){var t=this;this.visible=!0,this.result.scrollEnabled=!0,this.result.percentWidth=0,this.start_game_leaves1.visible=!1,this.start_game_leaves2.visible=!1,this.start_game.visible=!1,this.result.alpha=1;var i=125;egret.Tween.get(this.result).to({scrollEnabled:!1,percentWidth:100},2*i).call(function(){t.start_game_leaves1.visible=!0,t.start_game_leaves2.visible=!0,t.start_game.visible=!0,t.start_game_leaves1.alpha=1,t.start_game_leaves2.alpha=1,t.start_game.scaleX=3,t.start_game.scaleY=3,t.start_game.y=-5e3,egret.Tween.get(t.start_game).to({scaleX:1,scaleY:1,y:55.5},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves1).to({y:120},i).to({y:109},i).to({alpha:.3},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves2).to({y:0},i).to({y:11},i).to({alpha:.3},i,egret.Ease.circOut).call(function(){egret.Tween.get(t.result).to({alpha:0},3*i,egret.Ease.circOut)})}),util.TimeUtil.setTimeout(function(){t.parent&&t.parent.removeChild(t),t.dispatchEventWith(e.EVT_SHOW_BTN)},8*i)},e.prototype.init=function(){this.visible=!1,egret.Tween.removeTweens(this.result),egret.Tween.removeTweens(this.start_game),egret.Tween.removeTweens(this.start_game_leaves1),egret.Tween.removeTweens(this.start_game_leaves2)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?236.5:-22.5,this.horizontalCenter=t===egret.OrientationMode.PORTRAIT?41.2:51.5},e.EVT_SHOW_BTN="evt_show_btn",e}(eui.Component);t.BeginBetAni=e,__reflect(e.prototype,"ui.twoeight.BeginBetAni")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.init,this)},e.prototype.added=function(){var t=this;this.visible=!0,this.result.scrollEnabled=!0,this.result.percentWidth=0,this.start_game_leaves1.visible=!1,this.start_game_leaves2.visible=!1,this.start_game.visible=!1,this.result.alpha=1;var i=125;egret.Tween.get(this.result).to({scrollEnabled:!1,percentWidth:100},2*i).call(function(){t.start_game_leaves1.visible=!0,t.start_game_leaves2.visible=!0,t.start_game.visible=!0,t.start_game_leaves1.alpha=1,t.start_game_leaves2.alpha=1,t.start_game.scaleX=3,t.start_game.scaleY=3,t.start_game.y=-5e3,egret.Tween.get(t.start_game).to({scaleX:1,scaleY:1,y:55.5},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves1).to({y:120},i).to({y:109},i).to({alpha:.3},i,egret.Ease.circOut),egret.Tween.get(t.start_game_leaves2).to({y:0},i).to({y:11},i).to({alpha:.3},i,egret.Ease.circOut).call(function(){egret.Tween.get(t.result).to({alpha:0},3*i,egret.Ease.circOut)})}),util.TimeUtil.setTimeout(function(){t.parent&&t.parent.removeChild(t),t.dispatchEventWith(e.EVT_SHOW_BTN)},8*i)},e.prototype.init=function(){this.visible=!1,egret.Tween.removeTweens(this.result),egret.Tween.removeTweens(this.start_game),egret.Tween.removeTweens(this.start_game_leaves1),egret.Tween.removeTweens(this.start_game_leaves2)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?236.5:-22.5,this.horizontalCenter=t===egret.OrientationMode.PORTRAIT?41.2:51.5},e.EVT_SHOW_BTN="evt_show_btn",e}(eui.Component);t.BeginRaiseAni=e,__reflect(e.prototype,"ui.twoeight.BeginRaiseAni")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"chipValue",{get:function(){return this._chipValue},set:function(t){this._chipValue=t},enumerable:!0,configurable:!0}),e}(t.Component);e.Chip=i,__reflect(i.prototype,"ui.twoeight.Chip")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.clearTimeOut=function(){return util.TimeUtil.clearInterval(e.setIntervalID)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e.visible=!1,e.horizontalCenter=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=this.touchChildren=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clearTimeOut,this)},e.prototype.show=function(t,i){var n=this;this.lastSec=-1,this.clearTimeOut();var o=function(){var o=n.calRemainMill(t,i)/1e3<<0;o>0?(n.lb_cd.text=""+o,n.lastSec!==o&&(1===o?util.SoundUtil.play("erba_dingding_mp3"):util.SoundUtil.play("erba_daojishi_di_mp3"),n.lastSec=o)):(n.parent&&n.parent.removeChild(n),n.visible=!1,n.dispatchEventWith(e.EVT_HIDDEN))};o(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return o()},250)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?226:-23},e.EVT_HIDDEN="evt_hidden",e}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ui.twoeight.CountDown")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setChip=function(t){this.chip.text=util.LanguageUtil.translate("lbl_28_bet",t)},e.prototype.setRound=function(t){this.round.text=util.LanguageUtil.translate("lbl_28_game_round",t.toString())},e}(t.Component);e.DeskInfo=i,__reflect(i.prototype,"ui.twoeight.DeskInfo")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.sleep=function(t){return new Promise(function(e){return util.TimeUtil.setTimeout(e,t)})},e.horizontalCenter=0,e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.added(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.added,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.init,this)},e.prototype.added=function(){var t=this;this.x=500,this.y=320,this.visible=!0,this.teb_pic_dice_cup1.rotation=0,this.teb_pic_dice_cup1.horizontalCenter=0,this.teb_pic_dice_cup1.verticalCenter=0,this.teb_pic_dice_cup1.visible=!0,this.teb_pic_dice_cup2.visible=!0,this.dice1.visible=!1,this.dice2.visible=!1,this.dice_group.alpha=1,util.SoundUtil.play("erba_sound_roll_mp3");var i=50;egret.Tween.get(this.dice_group).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).to({rotation:30},i).to({rotation:0},i).to({rotation:-30},i).to({rotation:0},i).call(function(){t.teb_pic_dice_cup1.rotation=60,egret.Tween.get(t.teb_pic_dice_cup1).to({horizontalCenter:250,verticalCenter:-250},125).call(function(){util.SoundUtil.destroy(["erba_sound_roll_mp3"]),egret.Tween.get(t.teb_pic_dice_cup1).to({horizontalCenter:2e3,verticalCenter:-2e3},875,egret.Ease.quintIn),t.dice1.visible=!0,t.dice2.visible=!0,egret.Tween.get(t.dice_group).wait(1500).to({alpha:0},100,egret.Ease.circOut)})}),util.TimeUtil.setTimeout(function(){t.parent&&t.parent.removeChild(t),t.dispatchEventWith(e.EVT_SHOW_BTN)},24*i+2600)},e.prototype.init=function(){this.visible=!1,egret.Tween.removeTweens(this.teb_pic_dice_cup1),egret.Tween.removeTweens(this.dice_group)},e.prototype.setDice=function(t){this.dice1.source="teb_pic_dice"+t[0]+"_png",this.dice2.source="teb_pic_dice"+t[1]+"_png"},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?238.5:-37},e.EVT_SHOW_BTN="evt_show_btn",e}(eui.Component);t.DiceAni=e,__reflect(e.prototype,"ui.twoeight.DiceAni")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.TwoEightDeskTopic=e,__reflect(e.prototype,"topic.TwoEightDeskTopic"),function(t){t.schema={$schema:"http://json-schema.org/draft-07/schema#",properties:{snapshot:{properties:{bet_limit:{properties:{admittance:{type:"number"},ante:{type:"number"}},required:["admittance","ante"],type:"object"},desk_info:{properties:{banker_position:{type:"string"},cards_count:{type:"object"},deal_first:{type:"number"},init_dice:{items:{type:"number"},type:"array"},round:{type:"number"},stage:{type:"string"},total_bet:{type:"number"}},required:["deal_first","init_dice","round","stage","total_bet"],type:"object"},dispute:{properties:{desk:{additionalProperties:{properties:{is_done:{type:"boolean"},payout:{type:"number"},rate:{type:"number"},rate_options:{items:{type:"number"},type:"array"},surplus:{type:"number"},user_id:{type:"string"},valid_bet:{type:"number"}},required:["is_done","payout","rate","surplus","user_id","valid_bet"],type:"object"},maxProperties:4,minProperties:1,type:"object"},stage_timestamp:{type:"number"}},required:["desk","stage_timestamp"],type:"object"},raise:{properties:{desk:{additionalProperties:{properties:{is_done:{type:"boolean"},payout:{type:"number"},rate:{type:"number"},rate_options:{items:{type:"number"},type:"array"},surplus:{type:"number"},user_id:{type:"string"},valid_bet:{type:"number"}},required:["is_done","payout","rate","surplus","user_id","valid_bet"],type:"object"},maxProperties:4,minProperties:1,type:"object"},stage_timestamp:{type:"number"}},required:["desk","stage_timestamp"],type:"object"},room_setting:{properties:{room_id:{type:"string"},time:{properties:{dispute:{type:"number"},raise:{type:"number"}},required:["dispute","raise"],type:"object"}},required:["room_id","time"],type:"object"},settle:{properties:{desk:{additionalProperties:{properties:{cards_info:{properties:{cards:{items:{type:"number"},type:"array"},cards_type:{type:"string"}},required:["cards","cards_type"],type:"object"},is_done:{type:"boolean"},payout:{type:"number"},rate:{type:"number"},surplus:{type:"number"},user_id:{type:"string"},valid_bet:{type:"number"}},required:["is_done","payout","rate","surplus","user_id","valid_bet"],type:"object"},maxProperties:4,minProperties:1,type:"object"},stage_timestamp:{type:"number"},user_status:{type:"string"}},required:["desk","stage_timestamp","user_status"],type:"object"},user_info:{additionalProperties:{properties:{avatar:{type:"string"},balance:{decimal:!0},position:{type:"string"},this_round_bet:{type:"number"},user_id:{type:"string"},username:{type:"string"}},required:["balance","position","this_round_bet","user_id","username"],type:"object"},maxProperties:4,minProperties:1,type:"object"}},required:["bet_limit","desk_info","dispute","raise","room_setting","settle","user_info"],type:"object"}},required:["snapshot"],type:"object"}}(e=t.TwoEightDeskTopic||(t.TwoEightDeskTopic={}))}(topic||(topic={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.has_head=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+t.prototype.getCurrentState.call(this)+(this.type?"_"+this.type:"")},e.prototype.setBet=function(t){var e=this;this.hideBet(),-1===t?(this.img_skip.visible=!0,egret.Tween.get(this.img_skip).to({scaleX:1.5,scaleY:1.5},150).call(function(){egret.Tween.get(e.img_skip).to({scaleX:1,scaleY:1},150)})):(this.group_bankerBet.visible=!0,this.lab_bankerBet.text=String(t),egret.Tween.get(this.group_bankerBet).to({scaleX:1.5,scaleY:1.5},150).call(function(){egret.Tween.get(e.group_bankerBet).to({scaleX:1,scaleY:1},150)}))},e.prototype.setRaise=function(t){var e=this;this.hideBet(),t&&(this.group_bet.visible=!0,this.lab_bet.text=String(t),egret.Tween.get(this.group_bet).to({scaleX:1.5,scaleY:1.5},150).call(function(){egret.Tween.get(e.group_bet).to({scaleX:1,scaleY:1},150)}))},e.prototype.hideBet=function(){this.img_skip.visible=!1,this.group_bankerBet.visible=!1,this.group_bet.visible=!1,this.img_thinking.visible=!1},e.prototype.showBanker=function(t,e){this.group_banker.visible=t,this.img_snatch.visible=t,t&&e&&util.SoundUtil.play("erba_sound_suijiEnd_mp3")
},e.prototype.setName=function(t){this.lab_name.text=t},e.prototype.setBalance=function(t){this.lab_balance.text=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.has_head||(this.has_head=!0,this.img_head.source=t)},e.prototype.initHead=function(){this.has_head=!1},e.prototype.showSurplus=function(t,e){var i=this;e>0?(this.group_lose.visible=!1,this.group_win.visible=!0,this.lab_win.text=util.NumberUtil.formatNumber(e),egret.Tween.removeTweens(this.group_win),egret.Tween.get(this.group_win).to({verticalCenter:-160},1e3).wait(1e3).call(function(){"end"!==t&&(i.group_win.verticalCenter=0,i.group_win.visible=!1,egret.Tween.removeTweens(i.group_win))})):(this.group_win.visible=!1,this.group_lose.visible=!0,this.lab_lose.text=util.NumberUtil.formatNumber(e),egret.Tween.removeTweens(this.group_lose),egret.Tween.get(this.group_lose).to({verticalCenter:-160},1e3).wait(1e3).call(function(){"end"!==t&&(i.group_lose.verticalCenter=0,i.group_lose.visible=!1,egret.Tween.removeTweens(i.group_lose))}))},e.prototype.hideSurplus=function(){this.group_win.verticalCenter=0,egret.Tween.removeTweens(this.group_win),this.group_win.visible=!1,this.group_lose.verticalCenter=0,egret.Tween.removeTweens(this.group_lose),this.group_lose.visible=!1},e.prototype.showSnatch=function(t){this.img_snatch.visible=t},e.prototype.showThinking=function(t){this.img_thinking.visible=t},e.prototype.showBet=function(t){this.group_bankerBet.visible=t,this.img_skip.visible=t},e.prototype.showArrow=function(){var t=this;this.arrow.visible=!0,this.arrow.horizontalCenter="-4",this.arrow.verticalCenter="-180.5",egret.Tween.get(this.arrow).to({verticalCenter:-200},200).to({verticalCenter:-180.5},200).to({verticalCenter:-200},200).to({verticalCenter:-180.5},200).to({verticalCenter:-200},200).to({verticalCenter:-180.5},200).call(function(){t.arrow.visible=!1})},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.twoeight.PlayerFrame")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setCard=function(t){"number"==typeof t?this.img_poker.source="teb_pic_mahjong_"+t+"_png":this.img_poker.source="teb_pic_mahjong_10_png"},e}(t.Component);e.Poker=i,__reflect(i.prototype,"ui.twoeight.Poker")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.enabled=!0},e.prototype.setCardType=function(t,e){var i=this;switch(t){case"ten":Math.random()<.5?util.SoundUtil.play("erba_man_p_0_mp3"):util.SoundUtil.play("erba_lady_p_0_mp3"),this.bg1Group.width=122,this.card_type.source="teb_pic_card_type_bg1_png",this.bg1.source="teb_number_0_png",this.bg2.visible=!1,this.bg3.visible=!1;break;case"two_eight":Math.random()<.5?util.SoundUtil.play("erba_man_p_28_mp3"):util.SoundUtil.play("erba_lady_p_28_mp3"),this.bg1Group.width=182,this.card_type.source="teb_pic_card_type_bg2_png",this.bg1.source="teb_number_28_png",this.bg2.visible=!1,this.bg3.visible=!1;break;case"sky_king":Math.random()<.5?util.SoundUtil.play("erba_man_zhizun_mp3"):util.SoundUtil.play("erba_lady_zhizun_mp3"),this.bg1Group.width=121,this.card_type.source="teb_pic_card_type_bg4_png",this.bg1.source="teb_number_white_png",this.bg2.visible=!1,this.bg3.visible=!1;break;case"two_pairs":Math.random()<.5?util.SoundUtil.play("erba_man_b_"+e[0]+"_mp3"):util.SoundUtil.play("erba_lady_b_"+e[0]+"_mp3"),this.bg1Group.width=60,this.card_type.source="teb_pic_card_type_bg3_png",this.bg1.source="teb_number_"+e[0]+"_png",this.bg2.source="teb_font_a_pair_of_dots_png",this.bg2.visible=!0,this.bg3.visible=!1;break;case"separate":this.bg1Group.width=60,this.card_type.source="teb_pic_card_type_bg2_png";var n=(e[0]+e[1])%10;this.bg1.source="teb_number_"+n+"_png",this.bg2.source="teb_font_points_png",this.bg2.visible=!0,0===e[1]||0===e[0]?(this.bg3.source="teb_number_0.5_png",this.bg3.visible=!0,Math.random()<.5?util.SoundUtil.play("erba_man_p_"+n+"cd_mp3"):util.SoundUtil.play("erba_lady_p_"+n+"cd_mp3")):(this.bg3.visible=!1,Math.random()<.5?util.SoundUtil.play("erba_man_p_"+n+"_mp3"):util.SoundUtil.play("erba_lady_p_"+n+"_mp3"))}this.group_finish.scaleX=0,this.group_finish.scaleY=0,this.fontGroup.alpha=0,this.fontGroup.scaleX=3,this.fontGroup.scaleY=3,egret.Tween.get(this.group_finish).to({scaleX:.7,scaleY:.7},350).call(function(){egret.Tween.get(i.group_finish).to({scaleX:1,scaleY:1},150,egret.Ease.circOut),egret.Tween.get(i.fontGroup).to({scaleX:1,scaleY:1,alpha:1},150)})},e.EVT_SELECT="evt_select",e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.twoeight.PokerList")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var util;!function(t){var e;!function(t){t.getItem=function(t){var e="_"+(params.username||"guest"),i=JSON.parse(localStorage.getItem(e))||{};return void 0===i[t]?null:i[t]},t.setItem=function(t,e){var i="_"+(params.username||"guest"),n=JSON.parse(localStorage.getItem(i))||{};n[t]=e,localStorage.setItem(i,JSON.stringify(n))},t.removeItem=function(t){var e="_"+(params.username||"guest"),i=JSON.parse(localStorage.getItem(e))||{};delete i[t],localStorage.setItem(e,JSON.stringify(i))}}(e=t.UserStorageUtil||(t.UserStorageUtil={}))}(util||(util={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this)},e.prototype.updateMult=function(t){this.mult=t,this.btn.labelDisplay.text=""+t},e.prototype.sendMult=function(){this.dispatchEventWith(e.EVT_SEND_MULT,!0,this.mult)},e.EVT_SEND_MULT="evt_send_mult",e}(eui.Component);t.BetButton=e,__reflect(e.prototype,"ui.twoeight.BetButton")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.init=function(e){var i=this;void 0===e&&(e=[0,1,4,8,11]),this.firstMulBtn.updateMult(e[1]);var n=3-this.gp_mult_btns.numChildren;if(this.canAdd=!0,this.gp_mult_btns.numChildren<3&&this.canAdd){this.canAdd=!1;for(var o=1;n>=o;o++){var r=new t.MultButton;this.gp_mult_btns.addChild(r)}}this.gp_mult_btns.$children.forEach(function(t,n){if(void 0===e[n+2])for(var o=1;o<=5-e.length;o++)i.gp_mult_btns.removeChildAt(i.gp_mult_btns.numChildren-1);else t.updateMult(e[n+2])}),this.visible=!0},i.prototype.registEvent=function(){e.prototype.registEvent.call(this),this.btn_give_up.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this),this.firstMulBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.firstMulBtnHandler,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.btn_give_up.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this),this.firstMulBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.firstMulBtnHandler,this)},i.prototype.sendMult=function(e){e.stopImmediatePropagation();var i=e.target===this.btn_give_up?-1:e.data;this.dispatchEventWith(t.MultButtonsBase.EVT_SEND_MULT,!1,i),this.parent&&this.parent.removeChild(this)},i.prototype.firstMulBtnHandler=function(t){t.stopImmediatePropagation(),this.parent&&this.parent.removeChild(this)},i}(t.MultButtonsBase);t.HogButtons=e,__reflect(e.prototype,"ui.twoeight.HogButtons")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.sendMatchNotify=function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH)},e.horizontalCenter=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addToStage(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},e.prototype.addToStage=function(){this.btn_match.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btn_matchHandler,this)},e.prototype.removeFromStage=function(){this.btn_match.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btn_matchHandler,this)},e.prototype.btn_matchHandler=function(){this.sendMatchNotify(),this.parent&&this.parent.removeChild(this)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?463:113},e}(eui.Component);t.MatchButton=e,__reflect(e.prototype,"ui.twoeight.MatchButton")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMult,this)},e.prototype.updateMult=function(t){this.mult=t,this.btn.labelDisplay.text=""+t},e.prototype.sendMult=function(){this.dispatchEventWith(e.EVT_SEND_MULT,!0,this.mult)},e.EVT_SEND_MULT="evt_send_mult",e}(eui.Component);t.MultButton=e,__reflect(e.prototype,"ui.twoeight.MultButton")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.init=function(e,i,n){var o=this;void 0===e&&(e=[1,4,8,11,15]);var r=3-this.gp_mult_btns.numChildren;if(this.canAdd=!0,this.gp_mult_btns.numChildren<3&&this.canAdd){this.canAdd=!1;for(var s=1;r>=s;s++){var a=new t.BetButton;this.gp_mult_btns.addChild(a)}}if(1===this.gp_mult_btns1.numChildren){var a=new t.BetButton;this.gp_mult_btns1.addChild(a)}this.canRemove=!0,this.gp_mult_btns1.$children.concat(this.gp_mult_btns.$children).forEach(function(t,r){if(void 0===e[r]){if(o.canRemove)for(var s=1;s<=5-e.length;s++)o.canRemove=!1,o.gp_mult_btns.numChildren&&o.gp_mult_btns.removeChildAt(o.gp_mult_btns.numChildren-1);1===e.length&&2===o.gp_mult_btns1.numChildren&&o.gp_mult_btns1.removeChildAt(o.gp_mult_btns1.numChildren-1)}else{var a=e[r];t.updateMult(a),new Decimal(i).mul(a).mul(n).greaterThan(Data.getTopic(Const.Topic.ACCOUNT).snapshot.balance)?(t.enabled=!1,t.filters=[Const.grayFilter]):(t.enabled=!0,t.filters=null)}}),this.visible=!0},i.prototype.registEvent=function(){e.prototype.registEvent.call(this),this.gp_mult_btns1.addEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.gp_mult_btns1.removeEventListener(t.MultButton.EVT_SEND_MULT,this.sendMult,this)},i}(t.MultButtonsBase);t.MultButtons=e,__reflect(e.prototype,"ui.twoeight.MultButtons")}(e=t.twoeight||(t.twoeight={}))}(ui||(ui={}));var ui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.setProgress=function(t,i){return e.value=Math.round(t/i*100)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){this.ani&&this.ani.initUI(),this.link&&(this.link.textFlow=Const.Config.CONNECT_ADDRESS,mouse.setButtonMode(this.link,!0))},e.prototype.initData=function(){},e.prototype.registerEvent=function(){this.ani&&this.ani.registerEvent()},e.prototype.execCommand=function(t,e){},e}(t.UIBase);t.LoadingUI=e,__reflect(e.prototype,"ui.LoadingUI")}(ui||(ui={}));var Const;!function(t){t.TAG="test-de-202011131951-build4",t.OS=egret.Capabilities.os.toLowerCase().replace(/([^ ]*).*/,"$1"),t.SIZE=[2520,1920],t.NUMBER_FACTOR=100;var e=function(){function t(){}return t.CHANNEL_ID=1,t}();t.UserInfo=e,__reflect(e.prototype,"Const.UserInfo"),t.grayFilter=new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0]),t.darkFilter=new egret.ColorMatrixFilter([1,0,0,0,-100,0,1,0,0,-100,0,0,1,0,-100,0,0,0,1,0]),t.maskFilter=new egret.ColorMatrixFilter([.5,0,0,0,0,0,.5,0,0,0,0,0,.5,0,0,0,0,0,1,0]);var i;!function(t){t[t.CMD_TEMP=1e3]="CMD_TEMP"}(i=t.PublicUICommand||(t.PublicUICommand={}));var n;!function(t){t[t.NOTIFY_TEMP=1e3]="NOTIFY_TEMP"}(n=t.PublicUINotify||(t.PublicUINotify={}))}(Const||(Const={}));var Data;!function(t){var e=new Map,i=new Map,n=new Ajv;n.addKeyword("decimal",{validate:function(t,e){return!t||e instanceof Decimal},metaSchema:{type:"boolean"}}),t.updateTopic=function(t,n,o,r){var s=i.get(t)||(o?""+(/^\//.test(o)?o:"/"+o):t.replace(/(\/[^\/]*).*/,"$1")),a=e.get(s),l=n;i.set(t,s),void 0===a?e.set(s,l):n.snapshot&&n.snapshot.addition&&(l=util.ObjectUtil.copy(a),["seq","topic","code","message"].forEach(function(t){return void 0!==n[t]&&(l[t]=n[t])}),l.snapshot.version=n.snapshot.version,n.snapshot.addition.forEach(function(t){Object.keys(t).forEach(function(e){var i="$"===e?l.snapshot:JSONPath.jsonPath(l.snapshot,e)[0],n=t[e],o=n[0],r=n[1],s=n.slice(2);switch(o=o.split("."),o[0]){case"a":switch(o[1]){case"insert":i[r].splice(s[0],0,"balance"===r?new Decimal(s[1]):s[1]);break;case"remove":void 0===s[0]?i[r].splice(0):i[r].splice(s[0],1);break;case"append":i[r].push("balance"===r?new Decimal(s[0]):s[0]);break;default:i[r].splice(s[0],1,"balance"===r?new Decimal(s[1]):s[1])}break;case"o":switch(o[1]){case"remove":delete i[r];break;default:i[r]="balance"===r?new Decimal(s[0]):s[0]}}})})),util.ObjectUtil.notify(a,r?util.ObjectUtil.merge(a,l):l,"topic."+s.replace(/^\/(.*)/,"$1"),n)},t.getTopic=function(t){return util.ObjectUtil.copy(e.get(t))},t.validate=function(t,e,i){for(var o=[],r=3;r<arguments.length;r++)o[r-3]=arguments[r];var s;try{s=n.removeSchema().addSchema(o).validate(t,e)}catch(a){throw util.LogUtil.error(a.message,t),a}if(!s){var l=n.errors.map(function(t){return t.message}).join(", "),u=n.errorsText(),h=l+": "+u,c=void 0;try{c=JSON.stringify(e,null,4)}catch(a){c=e}throw ui.dialog.MessageDialog.instance.showException(util.LanguageUtil.translate("lbl_game_dataerror",l),"lbl_game_comfirm",u,c,i),util.LogUtil.error(h,e),new Error(h)}}}(Data||(Data={}));var Main=function(t){function e(){var i=this,n=e._instance||(e._instance=i=t.call(this)||this);return i.totalTime=0,i.lastTime=0,i.totalTick=0,i.statsArr=[],n}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.uiLayer.$children.concat(this.dialogLayer.$children)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialogNum",{get:function(){return this.dialogLayer.numChildren},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fps",{get:function(){return this._fps},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orientation",{get:function(){return this._orientation},set:function(t){this._orientation=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stats",{get:function(){return 0===this.statsArr.length&&this.pushStat(),this.statsArr.splice(0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameSkin",{get:function(){return GameCoreController.instance.cur_game?GameConst.valid_game_data_map.get(GameCoreController.instance.cur_game).group:Const.Config.SKIN},enumerable:!0,configurable:!0}),e.prototype.createChildren=function(){return __awaiter(this,void 0,void 0,function(){var i,n,o,r,s,a,l,u=this;return __generator(this,function(h){switch(h.label){case 0:t.prototype.createChildren.call(this),util.LogUtil.warn("start"),window.removeEventListener("focus",egret.lifecycle.contexts[0].resume),window.removeEventListener("blur",egret.lifecycle.contexts[0].pause),egret.lifecycle.onPause=function(){egret.ticker.pause(),util.SoundUtil.toggle(!1,null,!1)},egret.lifecycle.onResume=function(){egret.ticker.resume(),util.SoundUtil.toggle(!0,null,!1),u.stage.dispatchEventWith(e.EVT_RE_SHOT)},egret.ImageLoader.crossOrigin="anonymous",egret.registerImplementation("eui.IAssetAdapter",new util.AdapterUtil.AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new util.AdapterUtil.ThemeAdapter),RES.processor.map("text",new util.ProcessorUtil.TextProcessor),RES.processor.map("sound",new util.ProcessorUtil.SoundProcessor),RES.processor.map("zip",new util.ProcessorUtil.ZipProcessor),l=Array.apply(void 0,Array(2)).map(function(){var e=new eui.Group;return e.verticalCenter=e.horizontalCenter=0,e.scrollEnabled=!0,t.prototype.addChild.call(u,e)}),this.uiLayer=l[0],this.dialogLayer=l[1],this.dialogLayer.touchEnabled=!1,params.info&&(params.info=JSON.parse(Base64.decode(params.info)),params.lang&&util.LogUtil.warn("[params.lang] => "+params.lang),util.LogUtil.warn("[cookie.info] => "+JSON.stringify(params.info,null,4)),params.lang=params.lang||params.info.lang,params.callback_url=params.callback_url||params.info.callback_url,params.game=params.game||params.info.game),channel&&(util.LogUtil.warn("[login.js] => "+JSON.stringify(channel,null,4)),Const.Config.DEFAULT_HOST=channel.cdn,Const.UserInfo.CHANNEL_ID=channel.id,Const.Config.SKIN=""+["le","vn"].indexOf(params.skin||params.info&&params.info.skin),Const.Config.LANGUAGE=params.lang||channel.languages.split(",")[0]),!egret.Capabilities.isMobile&&mouse.enable(this.stage),this.resize(),this.addEventListener(egret.Event.RESIZE,function(){return u.resize(!0)},this),util.LogUtil.warn("[Const.Config.SKIN] => "+Const.Config.SKIN),util.LogUtil.warn("[Const.Config.LANGUAGE] => "+Const.Config.LANGUAGE),i="resource/config/"+Const.Config.SKIN+"/"+Const.Config.LANGUAGE+"_default.res.json",n="resource/config/games/"+Const.Config.LANGUAGE+"_default.res.json",o="resource/config/"+Const.Config.SKIN+"/all.thm.json",h.label=1;case 1:return h.trys.push([1,4,,5]),[4,Promise.all([RES.loadConfig(crc32Map[i],"resource/"),RES.loadConfig(crc32Map[n],"resource/")])];case 2:return h.sent(),[4,Promise.all([new Promise(function(t){return new eui.Theme(crc32Map[o],u.stage).addEventListener(egret.Event.COMPLETE,t,u)}),util.LanguageUtil.init()])];case 3:return h.sent(),[3,5];case 4:return r=h.sent(),s=[i,n,o].filter(function(t){return!crc32Map[t]}),a=s.length?"File(s) not found:\n"+s.join("\n"):"Unexpected error",egret.setTimeout(function(){alert(a),refresh()},this,100),util.LogUtil.error(a.replace(/\s/g," ")),[2,Promise.reject(r)];case 5:return this.addEventListener(egret.Event.ENTER_FRAME,function(){var t=egret.getTimer();u.totalTime+=t-u.lastTime,u.lastTime=t,u.totalTick++,u.totalTime>=1e3&&(u._fps=util.ObjectUtil.notify(u.fps,Math.min(1e3*u.totalTick/u.totalTime,u.stage.frameRate).toFixed(2),"Main.instance.fps"),u.totalTick=0,u.totalTime=u.totalTime%1e3)},this),Controller.instance.init()["catch"](function(t){return ui.dialog.MessageDialog.instance.showAlert(t.message,"lbl_game_refresh",refresh,!0),Promise.reject(t)}),[2]}})})},e.prototype.addChild=function(t,e){return e?this.dialogLayer.addChild(t):(this.removeChildren(),this.uiLayer.addChild(t),t.visible&&this.pushStat(),t)},e.prototype.removeChild=function(t){return this.dialogLayer.contains(t)?this.dialogLayer.removeChild(t):this.uiLayer.contains(t)?(1===this.uiLayer.numChildren&&t!==ui.LoginUI.instance&&this.uiLayer.addChild(ui.MainUI.instance),this.uiLayer.removeChild(t)):void 0},e.prototype.removeChildren=function(){var t=this,e=[ui.LoadingUI.instance,ui.dialog.MessageDialog.instance,ui.dialog.MiniLoadingDialog.instance];this.children.forEach(function(i){return-1===e.indexOf(i)&&t.removeChild(i)})},e.prototype.resize=function(t){var i=this,n="1"===this.gameSkin,o=window.innerWidth>window.innerHeight,r=n&&o,s=!n&&o?egret.OrientationMode.LANDSCAPE:egret.OrientationMode.PORTRAIT;this.stage.orientation=egret.Capabilities.isMobile&&n?egret.OrientationMode.PORTRAIT:egret.OrientationMode.AUTO,s===egret.OrientationMode.PORTRAIT?(this.stage.setContentSize(1080,1920),[this.uiLayer,this.dialogLayer].forEach(function(t){t.width=Math.min(i.stage.stageWidth,Const.SIZE[1]/16*(r?9:16)),t.height=Math.min(i.stage.stageHeight,Const.SIZE[0])})):(this.stage.setContentSize(1920,1080),[this.uiLayer,this.dialogLayer].forEach(function(t){t.width=Math.min(i.stage.stageWidth,Const.SIZE[0]),t.height=Math.min(i.stage.stageHeight,Const.SIZE[1])})),this.orientation!==s&&(this.orientation=s,t&&this.stage.dispatchEventWith(e.EVT_ORIENTATION_CHANGE,!1,s))},e.prototype.pushStat=function(t){var e;this.uiLayer.$children.some(function(t){return t instanceof ui.MainUI?(e=t.currentPage,!0):!1}),!e&&(e=this.uiLayer.$children.slice().reverse().filter(function(t){return t.visible})[0]),util.TimeUtil.now&&this.statsArr.push({time:util.TimeUtil.now,fps:Number(this.fps),screen:e?egret.getQualifiedClassName(e):void 0}),t&&this.resize(!0)},e.EVT_ORIENTATION_CHANGE="evt_orientation_change",e.EVT_RE_SHOT="evt_re_shot",e}(eui.UILayer);__reflect(Main.prototype,"Main");var ui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showHint=function(t,i){e.messageGroup.visible=!0,e.message.text=t,e.tipMessage.text=i||t,egret.Tween.removeTweens(e.tipMessageGroup),egret.Tween.get(e.tipMessageGroup).set({alpha:0}).to({alpha:1},500).wait(2e3).to({alpha:0},500)},e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){this.password.text=this.username.text="",this.messageGroup.visible=!1,this.tipMessageGroup.alpha=0,[this.image1,this.image2,this.image3,this.image4,this.image5,this.image6,this.image7,this.image8,this.image9,this.image10,this.image11].forEach(function(t){var e=util.NumberUtil.getRandom(1e3,1500);egret.Tween.get(t,{loop:!0}).set({y:0}).wait(util.NumberUtil.getRandom(0,200)).to({y:util.NumberUtil.getRandom(-30,30)},e).to({y:0},e)})},e.prototype.initData=function(){var t=this;this.fps=Main.instance.fps,channel&&function(){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,RES.getResByUrl((channel.rs_oss_cdn?channel.rs_oss_cdn+"/"+md5Url(channel.login_title_icon):channel.login_title_icon)+"?t="+Date.now(),null,null,RES.ResourceItem.TYPE_IMAGE)];case 1:return t=e.sent(),this.icon.source=t,this.icon.scaleY=this.icon.scaleX=this.icon.parent.height/t.textureHeight,[2]}})})}(),this.register.includeInLayout=this.register.visible=this.data},e.prototype.registerEvent=function(){var t=this;this.login.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.username.text.length?t.password.text.length?(t.messageGroup.visible=!1,util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_LOGIN,{username:t.username.text,password:t.password.text})):t.showHint("lbl_game_usernamempty","lbl_game_input_password"):t.showHint("lbl_game_usernamempty","lbl_game_input_username")},this),this["try"].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_LOGIN)},this),this.addEventListener(egret.Event.RESIZE,function(){return t.icon.texture&&(t.icon.scaleY=t.icon.scaleX=t.icon.parent.height/t.icon.texture.textureHeight)},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return[t.image1,t.image2,t.image3,t.image4,t.image5,t.image6,t.image7,t.image8,t.image9,t.image10,t.image11].forEach(function(t){return egret.Tween.removeTweens(t)})},this)},e.prototype.execCommand=function(t,e){switch(t){case Const.UICommand.CMD_SHOW_HINT:this.showHint(e);break;case Const.UICommand.CMD_UPDATE_FPS:this.fps=e}},e.prototype.onKeyUp=function(t){if("Tab"===t){var e;"function"==typeof Event?e=new Event("click"):(e=document.createEvent("Event"),e.initEvent("click",!1,!1)),this.username.textDisplay.$isTyping?(this.password.textDisplay.setFocus(),egretPlayer.querySelector("canvas").dispatchEvent(e)):(this.username.textDisplay.setFocus(),egretPlayer.querySelector("canvas").dispatchEvent(e))}},e}(t.UIBase);t.LoginUI=e,__reflect(e.prototype,"ui.LoginUI")}(ui||(ui={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"schema",{get:function(){return{type:"object",properties:{snapshot:{type:"object",properties:{type:{type:"string"}},required:["type"],"if":{properties:{type:{"const":"login_successful"}}},then:{properties:{user_id:{type:"string"},username:{type:"string"},avatar:{type:"string"}},required:["user_id"],"if":!!params.guest,then:{required:["username"]}}}},required:["snapshot"]}},enumerable:!0,configurable:!0}),e}(t.TopicBase);t.SystemNotifyTopic=e,__reflect(e.prototype,"topic.SystemNotifyTopic")}(topic||(topic={}));var topic;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.TopicBase);t.TimestampTopic=e,__reflect(e.prototype,"topic.TimestampTopic"),function(t){t.schema={type:"object",properties:{snapshot:{type:"object",properties:{timestamp:{type:"number"}},required:["timestamp"]}},required:["snapshot"]}}(e=t.TimestampTopic||(t.TimestampTopic={}))}(topic||(topic={}));var ui;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.dp_games=new eui.ArrayCollection,t.initList=function(){var e=t.list_games.layout;e.columnAlign=t.dp_games.length<e.requestedColumnCount?eui.ColumnAlign.LEFT:"1"===Main.instance.gameSkin?eui.ColumnAlign.JUSTIFY_USING_WIDTH:eui.ColumnAlign.JUSTIFY_USING_GAP},t}return __extends(i,e),Object.defineProperty(i,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"preloadGroup",{get:function(){return["public"]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPage",{get:function(){return this.hall_layer.$children[0]},enumerable:!0,configurable:!0}),i.prototype.initUI=function(){},i.prototype.initData=function(){var e=[];this.data.game_list.forEach(function(t){return e.push(GameConst.valid_game_data_map.get(t).dg_item_data)}),this.dp_games.replaceAll(e),this.dp_games.refresh(),this.initList(),this.topBar.updateNick(this.data.nick),this.topBar.updateAvatar(this.data.avatar),this.topBar.updateBalance(util.NumberUtil.formatNumber(this.data.balance)),this.topBar.updateOnline(this.data.online),t.component.TopBar.updateNotice(this.data.notice),GameConst.valid_game_data_map.forEach(function(t){return t.dg_item_data.is_db_playing=!0}),this.ani&&this.ani.startAni()},i.prototype.registerEvent=function(){var t=this;this.stage.addEventListener(Main.EVT_ORIENTATION_CHANGE,this.initList,this),this.list_games.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){util.SoundUtil.play("btn_menu_mp3"),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_ENTER_SEC_HALL,{type:t.data.game_list[e.itemIndex],is_send_by_hot:!1})},this)},i.prototype.execCommand=function(e,i){return __awaiter(this,void 0,void 0,function(){var n,o,r;return __generator(this,function(s){switch(s.label){case 0:switch(n=e){case Const.UICommand.CMD_UPDATE_FPS:return[3,1];case Const.UICommand.CMD_UPDATE_BALANCE:return[3,2];case Const.UICommand.CMD_UPDATE_ONLINE:return[3,3];case Const.UICommand.CMD_UPDATE_WORLD_MESSAGE:return[3,4];case Const.UICommand.CMD_ENTER_SEC_HALL:return[3,5];case Const.UICommand.CMD_BACK_PRI_HALL:return[3,7];case Const.UICommand.CMD_CHANGE_AVATAR:return[3,8]}return[3,9];case 1:return t.component.TopBar.updateFps(i),[3,9];case 2:return this.topBar.updateBalance(util.NumberUtil.formatNumber(i)),[3,9];case 3:return this.topBar.updateOnline(i),[3,9];case 4:return t.component.TopBar.updateNotice(i),[3,9];case 5:return util.LogUtil.info("[MainUI] loading => "+i),util.LogUtil.info("[MainUI] valid_game_data_map => "+JSON.stringify(GameConst.valid_game_data_map)),o=GameConst.valid_game_data_map.get(i),util.LogUtil.info("[MainUI] preloading with _game_data: "+o),r=o.cmpt.hall,util.LogUtil.info("[MainUI] preloading with hall: "+r),[4,r.preLoad(null,["common",o.group,o.name])];case 6:return s.sent(),GameConst.valid_game_data_map.forEach(function(t){return t.dg_item_data.is_db_playing=!1}),util.LogUtil.info("[MainUI] foreach playing false"),this.ani&&this.ani.stopAni(),util.LogUtil.info("[MainUI] stopAni"),this.hall_layer.removeChildren(),util.LogUtil.info("[MainUI] removeChildren"),this.hall_layer.addChild(r),util.LogUtil.info("[MainUI] updateHotGames with data.hot_list: "+JSON.stringify(this.data.hot_list)+" "),this.hot_menu.updateHotGames(this.data.hot_list,i),this.topBar.game=o.name,this.topBar.titleSource=o.dg_item_data.title_source,this.list_games.parent.visible=!(this.hot_menu.visible=this.hall_layer.visible=!0),util.LogUtil.info("[MainUI] pushStat"),Main.instance.pushStat(!0),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BGM,o.bgm),[3,9];case 7:return GameConst.valid_game_data_map.forEach(function(t){return t.dg_item_data.is_db_playing=!0}),this.ani&&this.ani.startAni(),this.hall_layer.removeChildren(),this.topBar.game=null,this.topBar.titleSource="",this.list_games.parent.visible=!(this.hot_menu.visible=this.hall_layer.visible=!1),Main.instance.pushStat(!0),util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_BGM),[3,9];case 8:return this.topBar.updateAvatar(i),[3,9];case 9:return[2]}})})},i}(t.UIBase);t.MainUI=e,__reflect(e.prototype,"ui.MainUI")}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.chip=util.NumberUtil.getRandom(1,6),this.icon=Const.Config.CHIP_LOGO||"chip_logo_png"},e}(t.Component);e.Chip=i,__reflect(i.prototype,"ui.baicao.Chip")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.playwarnSound=!1,e.clearTimeOut=function(){return util.TimeUtil.clearInterval(e.setIntervalID)},e.calRemainMill=function(t,e){return e-(util.TimeUtil.now-t)},e.visible=!1,e.horizontalCenter=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=this.touchChildren=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clearTimeOut,this)},e.prototype.show=function(t,i,n){var o=this;this.lastSec=-1,this.clearTimeOut(),this.playwarnSound=!1;var r=function(){var r=o.calRemainMill(t,i)/1e3<<0;o.visible===!1&&(o.clearTimeOut(),util.SoundUtil.destroy(["time_mp3"])),r>0?(o.playwarnSound=!1,r>n/1e3&&(r=n/1e3),o.lb_cd.text=""+r,o.lastSec!==r&&(o.lastSec=r,util.SoundUtil.play("time_mp3"))):(!o.playwarnSound&&util.SoundUtil.play("WarningtimeOver_mp3"),o.playwarnSound=!0,o.visible=!1,o.dispatchEventWith(e.EVT_HIDDEN))};r(),this.visible=!0,this.setIntervalID=util.TimeUtil.setInterval(function(){return r()},250)},e.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?226:-23},e.EVT_HIDDEN="evt_hidden",e}(eui.Component);t.CountDown=e,__reflect(e.prototype,"ui.baicao.CountDown")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setChip=function(t){this.chip.text=t},e}(t.Component);e.DeskInfo=i,__reflect(i.prototype,"ui.baicao.DeskInfo")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var service;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this.getInstance(this)},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.fight=function(t){return this.update(t,{action:"fight"},null,!0)},e}(t.ServiceBase);t.BaicaoService=e,__reflect(e.prototype,"service.BaicaoService")}(service||(service={}));var ui;!function(t){var e;!function(t){var e;!function(t){t[t.Match=0]="Match",t[t.Cancel=1]="Cancel"}(e=t.MatchEnum||(t.MatchEnum={}));var i=function(t){function i(){var e=t.call(this)||this;return e.sendMatchNotify=function(){util.NotifyUtil.sendNotification(Const.UINotify.NOTIFY_CONTINUE_MATCH),e.dispatchEventWith(i.EVT_SHOW_BTN),e.visible=!1
},e.clearInterval=function(){e.time_out_id&&util.TimeUtil.clearInterval(e.time_out_id),e.time_out_id=void 0},e.setAutoMatch=function(t){return e.btn_auto_match&&(e.btn_auto_match.selected=t)},e.visible=!1,e.horizontalCenter=0,e}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),this.btn_auto_match.selected=!0},i.prototype.addToStage=function(){this.visible=!0,this.btn_match_canle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this),this.btn_auto_match.selected?this.autoMatch():this.changeState(e.Match),this.verticalCenter="match"===this.currentState?0:120},i.prototype.cancel=function(){this.visible=!0,this.btn_match_canle.addEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this),this.changeState(e.Match),this.verticalCenter="match"===this.currentState?0:120},i.prototype.removeFromStage=function(){this.clearInterval(),this.visible=!1,this.btn_match_canle.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.matchCanleClick,this)},i.prototype.matchCanleClick=function(){"match"===this.currentState?this.sendMatchNotify():(this.clearInterval(),this.changeState(e.Match))},i.prototype.autoMatch=function(){var t=this,i=5,n=function(e){e>0?t.matchTime="（"+e+"）":(t.clearInterval(),t.sendMatchNotify())};this.changeState(e.Cancel),n(i--),this.clearInterval(),this.time_out_id=util.TimeUtil.setInterval(function(){return n(i--)},1e3)},i.prototype.changeState=function(t){this.currentState=t===e.Match?"match":"cancel",this.verticalCenter="match"===this.currentState?0:120,!this.visible&&(this.visible=!0)},i.prototype.resetMode=function(t){this.verticalCenter=t===egret.OrientationMode.PORTRAIT?430:130},i.EVT_SHOW_BTN="evt_show_btn",i}(eui.Component);t.MatchButton=i,__reflect(i.prototype,"ui.baicao.MatchButton")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),mouse.setButtonMode(this,!0),this.addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){e.onMouse=!0,e.invalidateState()},this),this.addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){e.onMouse=!1,e.invalidateState()},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.SoundUtil.play("btn_menu_mp3")},this)},e.prototype.getCurrentState=function(){var e=t.prototype.getCurrentState.call(this),i=""+e+(this.onMouse?"AndHover":"");return this.skin.hasState(i)?i:e},e}(eui.CheckBox);t.CheckBox=e,__reflect(e.prototype,"ui.control.CheckBox")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.defaultAnimation={show:function(t,e){return t.set({alpha:0}).to({alpha:1},300,egret.Ease.backOut),e.set({scaleX:0,scaleY:0}).to({scaleX:1,scaleY:1},300,egret.Ease.backOut)},close:function(t,e){return t.to({alpha:0},300,egret.Ease.backIn),e.to({scaleX:0,scaleY:0},300,egret.Ease.backIn)}},e.forceClose=function(){var t=e.canClose;e.canClose=!0,e.close(),e.canClose=t},e.showClose=e.canClose=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"canClose",{get:function(){return this._canClose},set:function(t){this._canClose=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showClose",{get:function(){return this._showClose},set:function(t){this._showClose=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onInit",{get:function(){return this._onInit},set:function(t){this._onInit=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeClose",{get:function(){return this._beforeClose},set:function(t){this._beforeClose=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onClose",{get:function(){return this._onClose},set:function(t){this._onClose=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animation",{get:function(){return this._animation},set:function(t){this._animation=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attr",{get:function(){return{left:this.bgImg?this.bgImg.left:0,right:this.bgImg?this.bgImg.right:0,top:this.bgImg?this.bgImg.top:0,bottom:this.bgImg?this.bgImg.bottom:0,titleHeight:this.titleBar?this.titleBar.height:0,titleGap:this.container?this.container.layout.gap:0}},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.percentHeight=this.percentWidth=100,this.rect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this),this.titleDisplay&&this.titleDisplay.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE,function(t){return"text"===t.property&&(e.showTitle=!!e.title)},this)},e.prototype.onCloseButtonClick=function(){this.forceClose()},e.prototype.close=function(){var t=this;!this.flag&&this.canClose&&(this.flag=!0,this.beforeClose&&this.beforeClose(),egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.main),(this.animation||this.defaultAnimation).close(egret.Tween.get(this),egret.Tween.get(this.main)).call(function(){Main.instance.removeChild(t.parent),1===Main.instance.dialogNum&&"block"===div.style.display&&(egretPlayer.style.pointerEvents="none"),t.onClose&&t.onClose(),t.flag=!1}))},e.prototype.init=function(){var e=this;t.prototype.init.call(this),this.flag=!1,this.showTitle=!!this.title,egretPlayer.style.pointerEvents="auto",egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.main),(this.animation||this.defaultAnimation).show(egret.Tween.get(this),egret.Tween.get(this.main)).call(function(){return e.onInit&&e.onInit()})},e}(t.Panel);t.Dialog=e,__reflect(e.prototype,"ui.control.Dialog")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.play=function(t,e,i,n){return __awaiter(this,void 0,void 0,function(){var o,r,s,a,l,u,h,c,s,p,_;return __generator(this,function(d){switch(d.label){case 0:return RES.hasRes(t+"_ske_dbbin")?(l=RES.getRes(t+"_ske_dbbin"),l?[3,2]:[4,RES.getResAsync(t+"_ske_dbbin")]):[3,7];case 1:l=d.sent(),d.label=2;case 2:return o=l,u=RES.getRes(t+"_tex_json"),u?[3,4]:[4,RES.getResAsync(t+"_tex_json")];case 3:u=d.sent(),d.label=4;case 4:return r=u,h=RES.getRes(t+"_tex_png"),h?[3,6]:[4,RES.getResAsync(t+"_tex_png")];case 5:h=d.sent(),d.label=6;case 6:return s=h,a=dragonBones.EgretFactory.factory.getDragonBonesData(t),a||(a=dragonBones.EgretFactory.factory.parseDragonBonesData(o,t),dragonBones.EgretFactory.factory.parseTextureAtlasData(r,s,t)),this.stop(!0),this.armature=dragonBones.EgretFactory.factory.buildArmatureDisplay(a.armatureNames[0],t),this.armature.animation.gotoAndPlayByTime(e||a.getArmature(a.armatureNames[0]).defaultAnimation.name,i,n),this.addChild(this.armature),!this.armature.hasEventListener(egret.Event.COMPLETE)&&this.armature.addEventListener(egret.Event.COMPLETE,this.dispatchEvent,this),!this.armature.hasEventListener(egret.Event.LOOP_COMPLETE)&&this.armature.addEventListener(egret.Event.LOOP_COMPLETE,this.dispatchEvent,this),!this.armature.hasEventListener(dragonBones.EgretEvent.FRAME_EVENT)&&this.armature.addEventListener(dragonBones.EgretEvent.FRAME_EVENT,this.dispatchEvent,this),[2,this.armature];case 7:return RES.hasRes(t+"_ske_dbmv")?(p=RES.getRes(t+"_ske_dbmv"),p?[3,9]:[4,RES.getResAsync(t+"_ske_dbmv")]):[3,12];case 8:p=d.sent(),d.label=9;case 9:return c=p,_=RES.getRes(t+"_tex_png"),_?[3,11]:[4,RES.getResAsync(t+"_tex_png")];case 10:_=d.sent(),d.label=11;case 11:s=_,!dragonBones.hasMovieGroup(t)&&dragonBones.addMovieGroup(c,s,t),this.stop(!0),this.movie=dragonBones.buildMovie(dragonBones.getMovieNames(t)[0],t),this.movie.gotoAndPlay(e,i,n),this.addChild(this.movie),d.label=12;case 12:return[2]}})})},e.prototype.stop=function(t){this.armature&&(this.armature.animation.stop(),this.armature.removeEventListener(egret.Event.COMPLETE,this.dispatchEvent,this),this.armature.removeEventListener(egret.Event.LOOP_COMPLETE,this.dispatchEvent,this),t&&(this.removeChild(this.armature),this.armature.dispose(),this.armature=null)),this.movie&&(this.movie.stop(),t&&(this.removeChild(this.movie),this.movie.dispose(),this.movie=null))},e}(eui.Component);t.DragonBones=e,__reflect(e.prototype,"ui.control.DragonBones")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.has_head=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+(this.type?""+this.type:"")},e.prototype.setName=function(t){this.lab_name.text=t},e.prototype.setBalance=function(t,e){e?util.NumberUtil.tweenNumber(this.lab_balance,Math.abs(t.toNumber()),1e3):this.lab_balance.text=util.NumberUtil.formatNumber(t)},e.prototype.setHead=function(t){this.has_head||(this.has_head=!0,this.img_head.source=t)},e.prototype.initHead=function(){this.has_head=!1},e.prototype.showSurplus=function(t){this.group_surplus.visible=!0,t>=0?(this.lab_surplus.font="bc_font_win_money_fnt",this.lab_surplus.text="+"+util.NumberUtil.formatNumber(t)):(this.lab_surplus.font="bc_font_lose_money_fnt",this.lab_surplus.text=util.NumberUtil.formatNumber(t)),"top"===this.currentState&&(this.topLeft=-this.group_surplus.width-10)&&(this.group_surplus.horizontalCenter=0/0)},e.prototype.hideSurplus=function(){this.group_surplus.visible=!1},e.prototype.scoreAni=function(t,e){this.group_surplus.visible=!0,e>=0?this.lab_surplus.font="bc_font_win_money_fnt":this.lab_surplus.font="bc_font_lose_money_fnt",this.lab_surplus.text="",util.NumberUtil.tweenNumber(this.lab_surplus,e,t,!0)},e}(t.Component);e.PlayerFrame=i,__reflect(i.prototype,"ui.baicao.PlayerFrame")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gradientMatrix=new egret.Matrix,e.draw=function(){e.stage&&e.ready&&(e.strokeLabel.visible=!!e.stroke,e.textFlow?e.label.textFlow=e.strokeLabel.textFlow=util.ObjectUtil.copy(e.textFlow).map(function(t){return t.style&&(t.style.big&&(t.style.size=e.bigSize),delete t.style.big),t}):e.text&&e.bigLength&&e.bigSize&&(e.label.textFlow=e.strokeLabel.textFlow=[{text:e.text.substr(0,e.bigLength),style:{size:e.bigSize}},{text:e.text.substr(e.bigLength)}]),e.shape.graphics.clear(),e.gradientMatrix.createGradientBox(e.width+20,e.height+20,Math.PI/180*(e.direction||0)),e.shape.graphics.beginGradientFill(egret.GradientType.LINEAR,[e.from,e.to],[1,1],[0,127.5,255],e.gradientMatrix),e.shape.graphics.drawRect(-10,-10,e.width+20,e.height+20),e.shape.graphics.endFill(),egret.callLater(function(){var t=new egret.RenderTexture;t.drawToTexture(e.content),e.cache.source=t},e))},e}return __extends(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textFlow",{get:function(){return this._textFlow},set:function(t){this._textFlow=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bigLength",{get:function(){return this._bigLength},set:function(t){this._bigLength=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bigSize",{get:function(){return this._bigSize},set:function(t){this._bigSize=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"from",{get:function(){return this._from},set:function(t){this._from=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"to",{get:function(){return this._to},set:function(t){this._to=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlign",{get:function(){return this._textAlign},set:function(t){this._textAlign=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this._bold},set:function(t){this._bold=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this._italic},set:function(t){this._italic=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{get:function(){return this._stroke},set:function(t){this._stroke=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(t){this._strokeColor=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(t){this._lineSpacing=Number(t),this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFixed",{get:function(){return this._isFixed},set:function(t){this._isFixed=t,this.draw()},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.skinName='<e:Skin xmlns:e="http://ns.egret.com/eui" xmlns:egret="egret.*" xmlns:control="ui.control.*">\n                        <e:Group id="content" left="-10" right="-10" top="-10" bottom="-10" alpha="0">\n                            <e:Group left="10" right="10" top="10" bottom="10">\n                                <control:Label id="strokeLabel" text="{text}" size="{size}" textAlign="{textAlign}"\n                                            verticalAlign="{verticalAlign}" bold="{bold}" italic="{italic}" stroke="{stroke}"\n                                            strokeColor="{strokeColor}" lineSpacing="{lineSpacing}" width="100%" maxWidth="{maxWidth}"\n                                            height="100%" isFixed="{isFixed}" />\n                                <egret:Shape id="shape" />\n                                <control:Label id="label" text="{text}" size="{size}" textAlign="{textAlign}"\n                                            verticalAlign="{verticalAlign}" bold="{bold}" italic="{italic}" lineSpacing="{lineSpacing}"\n                                            width="100%" maxWidth="{maxWidth}" height="100%" isFixed="{isFixed}" />\n                            </e:Group>\n                        </e:Group>\n                        <e:Image id="cache" x="-10" y="-10" includeInLayout="false" />\n                    </e:Skin>',this.shape.mask=this.label,this.ready=!0,this.draw(),this.stage.addEventListener(egret.Event.RESIZE,this.draw,this),this.label.addEventListener(egret.Event.RESIZE,this.draw,this)},e}(eui.Component);t.GradientLabel=e,__reflect(e.prototype,"ui.control.GradientLabel")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bindData={},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),mouse.setButtonMode(this,!0),this.addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){e.onMouse=!0,e.invalidateState()},this),this.addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){e.onMouse=!1,e.invalidateState()},this)},e.prototype.getCurrentState=function(){var e=t.prototype.getCurrentState.call(this),i=""+e+(this.onMouse?"AndHover":"");return this.skin.hasState(i)?i:e},Object.defineProperty(e.prototype,"bindData",{get:function(){return this._bindData},set:function(t){this._bindData=t},enumerable:!0,configurable:!0}),e}(eui.HSlider);t.HSlider=e,__reflect(e.prototype,"ui.control.HSlider")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.init=function(){return!i.hasEventListener(egret.Event.RENDER)&&i.addEventListener(egret.Event.RENDER,i.render,i)},i.reset=function(){return i.hasEventListener(egret.Event.RENDER)&&i.removeEventListener(egret.Event.RENDER,i.render,i)},i.render=function(){var t=1e5===i.maxWidth,e=i.$UIComponent[10],n=i.$TextField[5],o=t?e*i.scaleX:i.maxWidth;i.scaleX=n>o?o/n:1,i.width=t&&e>n?o/i.scaleX:n},i.fontFamily="Microsoft YaHei,PingFang SC,SimHei,SimSun,sans-serif",i}return __extends(e,t),Object.defineProperty(e.prototype,"isFixed",{get:function(){return this._isFixed},set:function(t){this._isFixed=t,this.stage&&(t?this.init:this.reset)()},enumerable:!0,configurable:!0}),e.prototype.$getLinesArr=function(){if(this.isFixed){var e=this.$TextField,i={width:0,height:0,charNum:0,hasNextLine:!1,elements:[]},n=[util.ObjectUtil.copy(i)];return t.prototype.$getLinesArr.call(this).forEach(function(t){var e=n[n.length-1];e.width+=t.width,e.height=Math.max(e.height,t.height),e.charNum+=t.charNum,(o=e.elements).push.apply(o,t.elements),t.hasNextLine&&n.push(util.ObjectUtil.copy(i));var o}),e[5]=Math.max.apply(Math,n.map(function(t){return t.width})),e[6]=n.map(function(t){return t.height}).reduce(function(t,e){return t+e}),e[29]=n.length,n}return t.prototype.$getLinesArr.call(this)},e.prototype.$setText=function(e){return t.prototype.$setText.call(this,util.LanguageUtil.translate(e))},e.prototype.$setStrokeColor=function(e){return t.prototype.$setStrokeColor.call(this,e||0)},e.prototype.$setScaleX=function(e){this.$getScaleX()!==e&&(t.prototype.$setScaleX.call(this,e),this.dispatchEventWith(egret.Event.RESIZE))},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return e.isFixed&&e.init()},this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.reset,this)},e}(eui.Label);t.Label=e,__reflect(e.prototype,"ui.control.Label")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(e,i,n,o,r,s,a){void 0===n&&(n=-1),void 0===o&&(o=0),void 0===r&&(r=!0),void 0===s&&(s=0),void 0===a&&(a=1);var l=t.call(this)||this;return l.group=e,l.frameRate=i,l.playTimes=n,l.currentFrame=o,l.isPlaying=r,l.loopStart=s,l.timeScale=a,l.imgs&&(l.source=RES.getRes(l.imgs.slice(s)[l.currentFrame])),l}return __extends(e,t),Object.defineProperty(e.prototype,"group",{get:function(){return this._group},set:function(t){var e=this;this._group=t,t&&function(){return __awaiter(e,void 0,void 0,function(){var e,i,n;return __generator(this,function(o){switch(o.label){case 0:return this.imgs=null,e=!RES.isGroupLoaded(t),e?[4,RES.loadGroup(t)]:[3,2];case 1:e=o.sent(),o.label=2;case 2:return this._group===t&&(this.imgs=RES.getGroupByName(t).map(function(t){return t.name}).sort(function(t,e){return util.NumberUtil.getNumber(t)-util.NumberUtil.getNumber(e)}),void 0!==this.currentFrame&&(i=this.imgs.slice(this.loopStart),n=this.frameRate>0?Math.floor:Math.ceil,this.currentFrame=(this.currentFrame%i.length+i.length)%i.length,this.source=RES.getRes(i[n(this.currentFrame)]),n(this.currentFrame)===i.length-1?this.currentFrame-=i.length:n(this.currentFrame)===-i.length+1&&(this.currentFrame+=i.length))),[2]}})})}()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playTimes",{get:function(){return this._playTimes},set:function(t){this._playTimes=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this._currentFrame},set:function(t){this._currentFrame=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this._isPlaying},set:function(t){this._isPlaying=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopStart",{get:function(){return this._loopStart},set:function(t){this._loopStart=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"property",{get:function(){var t=this;return new Promise(function(e){var i=function(){t.imgs&&(util.NotifyUtil.removeNotification("util.TimeUtil.now",i),e({frames:t.imgs.length,textureWidth:RES.getRes(t.imgs[t.loopStart]).textureWidth}))};util.NotifyUtil.addNotification("util.TimeUtil.now",i)})},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),util.NotifyUtil.addNotification("util.TimeUtil.now",function(t){var n=i.imgs&&i.imgs.slice(i.loopStart),o=i.frameRate>0?Math.floor:Math.ceil;if(i.stage&&i.lastTime&&n&&i.isPlaying){var r=i.currentFrame%n.length+(t-i.lastTime)*i.timeScale*i.frameRate*.001,s=void 0;i.frameRate>0?(r=Math.min(r,(i.playTimes<0?1/0:i.playTimes)*n.length-1),s=Math.floor((r+1)/n.length)):(r=Math.max(r,(i.playTimes<0?1/0:i.playTimes)*-n.length+1),s=Math.floor(Math.abs((r-1)/n.length)));var a=(o(r)%n.length+n.length)%n.length;i.source=RES.getRes(n[a]),i.dispatchEventWith(e.EVT_FRAME,!1,a),s&&(i.playTimes>0&&(i.playTimes-=s,0===i.playTimes&&(i.isPlaying=!1,s--)),s&&i.dispatchEventWith(egret.Event.LOOP_COMPLETE,!1,s),0===i.playTimes&&i.dispatchEventWith(egret.Event.COMPLETE)),i.currentFrame=r%n.length,o(i.currentFrame)===n.length-1?i.currentFrame-=n.length:o(i.currentFrame)===-n.length+1&&(i.currentFrame+=n.length)}i.lastTime=t})},e.EVT_FRAME="evt_frame",e}(eui.Image);t.MovieClip=e,__reflect(e.prototype,"ui.control.MovieClip")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.pokerIndex=0,i.pokerIndex2=0,i.pokerIndex3=0,i.parent_container=t,i.initPoker(),i}return __extends(i,e),i.prototype.shuffle=function(){var t=this;return util.SoundUtil.play("fp_mp3"),this.initPoker(),new Promise(function(e){for(var i=0;51>i;i++){var n=t.pokers[i];egret.Tween.removeTweens(n),n.visible=!0;var o=util.NumberUtil.getRandom(-1,1),r=util.NumberUtil.getRandom(-1,1),s=util.NumberUtil.getRandom(60,80),a=util.NumberUtil.getRandom(60,80),l=n.x,u=n.y,h=100;egret.Tween.get(n).to({x:o*s,y:u+5*r},h).to({x:l,y:u},h).to({x:r*s,y:u+5*o},h).to({x:l,y:u},h).to({x:o*a,y:u+5*r},h).to({x:l,y:u},h).to({x:r*s,y:u+5*o},h).to({x:l,y:u},h).call(e)}})},i.prototype.flyCard=function(t,e,i){var n=this;return new Promise(function(o){util.SoundUtil.play("bet1_mp3");var r=n.pokers[n.pokerIndex],s=i>3?-360:360;r.size=t,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,n.parent_container.setChildIndex(r,n.parent_container.numChildren);var a=r.globalToLocal(e.x,e.y);egret.Tween.removeTweens(r),egret.Tween.get(r).set({x:0,y:1-n.pokerIndex,visible:!0,rotation:0}).to({x:a.x,y:a.y+1-n.pokerIndex,rotation:s},150).call(o),n.pokerIndex--})},i.prototype.flyCard2=function(){var t=this;return new Promise(function(e){var i=t.pokers[t.pokerIndex2],n=.6===i.size?88:180;egret.Tween.get(i).to({x:i.x-n},100).call(e),t.pokerIndex2--})},i.prototype.flyCard3=function(t){var e=this;return new Promise(function(i){var n=e.pokers[e.pokerIndex3],o=.6===n.size?88:180;egret.Tween.get(n).to({x:n.x+o*(t-1)},100).call(i),e.pokerIndex3--})},i.prototype.initPoker=function(){this.pokers=[],this.parent_container.removeChildren();for(var e=1;52>=e;e++){var i=new t.component.Poker;i.x=0,i.y=1-e,i.size=.6,i.visible=!0,this.parent_container.addChild(i),this.pokers.push(i)}this.pokerIndex=51,this.pokerIndex2=51,this.pokerIndex3=51},i}(t.Component);e.PokerAni=i,__reflect(i.prototype,"ui.baicao.PokerAni")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bindData={},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),mouse.setButtonMode(this,!0),this.addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){e.onMouse=!0,e.invalidateState()},this),this.addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){e.onMouse=!1,e.invalidateState()},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.SoundUtil.play("btn_menu_mp3")},this)},e.prototype.getCurrentState=function(){var e=t.prototype.getCurrentState.call(this),i=""+e+(this.onMouse?"AndHover":"");return this.skin.hasState(i)?i:e},Object.defineProperty(e.prototype,"bindData",{get:function(){return this._bindData},set:function(t){this._bindData=t},enumerable:!0,configurable:!0}),e}(eui.RadioButton);t.RadioButton=e,__reflect(e.prototype,"ui.control.RadioButton")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=!0),void 0===o&&(o=egret.VerticalAlign.TOP);var r=t.call(this)||this;return r.startIndex=0,r.endIndex=0,r._sources=e,r._speed=i,r.isPlaying=n,r.verticalAlign=o,r}return __extends(e,t),Object.defineProperty(e.prototype,"sources",{get:function(){return this._sources},set:function(t){var e=this;this._sources=t,t&&function(){return __awaiter(e,void 0,void 0,function(){var e,i=this;return __generator(this,function(n){switch(n.label){case 0:return this.imgs=null,[4,Promise.all(this._sources.split(",").map(function(t){return RES.getResAsync(t)}))];case 1:return e=n.sent(),this._sources===t&&(this.imgs=e,this.checkItem(),!this.hasEventListener(egret.Event.RESIZE)&&this.addEventListener(egret.Event.RESIZE,function(){i.invalidateDisplayList(),i.validateDisplayList(),i.checkItem()},this)),[2]}})})}()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this._isPlaying},set:function(t){this._isPlaying=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign=t,this.layout&&(this.layout.verticalAlign=t)},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.group=new eui.DataGroup,this.group.useVirtualLayout=!1,this.group.itemRendererSkinName='<e:Skin xmlns:e="http://ns.egret.com/eui"><e:Image source="{data}" /></e:Skin>',this.layout=new eui.HorizontalLayout,this.layout.gap=0,this.layout.verticalAlign=this.verticalAlign,this.rect=new eui.Rect,this.rect.percentHeight=this.rect.percentWidth=100,this.group.layout=this.layout,this.group.mask=this.rect,this.addChild(this.group),this.addChild(this.rect),util.NotifyUtil.addNotification("util.TimeUtil.now",function(t){if(e.stage&&e.lastTime&&e.imgs&&e.isPlaying){for(var i=(e.group.x-(t-e.lastTime)*e.speed*.001)%(e.group.width||1),n=e.imgs[e.startIndex].textureWidth,o=e.imgs[e.endIndex].textureWidth;0>=i+n;)i+=n,e.group.dataProvider.removeItemAt(0),e.startIndex+=e.startIndex===e.imgs.length-1?-e.startIndex:1,n=e.imgs[e.startIndex].textureWidth;for(;i+e.group.width-e.width>=o;)e.group.dataProvider.removeItemAt(e.group.dataProvider.length-1),e.endIndex-=0===e.endIndex?-e.imgs.length+1:1,o=e.imgs[e.endIndex].textureWidth;e.group.x=i,e.checkItem()}e.lastTime=t}),this.group.addEventListener(egret.Event.RESIZE,this.checkItem,this)},e.prototype.checkItem=function(){this.group.x+this.group.width<this.width&&(this.group.dataProvider?this.group.dataProvider.addItem(this.imgs[this.endIndex]):this.group.dataProvider=new eui.ArrayCollection([this.imgs[this.endIndex]]),this.endIndex+=this.endIndex===this.imgs.length-1?-this.endIndex:1),this.group.x>0&&(this.group.dataProvider?this.group.dataProvider.addItemAt(this.imgs[this.startIndex],0):this.group.dataProvider=new eui.ArrayCollection([this.imgs[this.startIndex]]),this.group.x-=this.imgs[this.startIndex].textureWidth,this.startIndex-=0===this.startIndex?-this.imgs.length+1:1)},e}(eui.Component);t.ScrollMap=e,__reflect(e.prototype,"ui.control.ScrollMap")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.init=function(){return t.stage.addEventListener(mouse.MouseEvent.MOUSE_WHEEL,t.wheel,t)},t.wheel=function(e){var i=Math.max(t.viewport.contentHeight-t.viewport.height,0);t.onMouse&&(t.scrollPolicyV===eui.ScrollPolicy.AUTO&&i&&!t.is_draged&&(util.TimeUtil.clearTimeout(t.timeout),t.verticalScrollBar.visible=!0,t.timeout=util.TimeUtil.setTimeout(function(){return t.verticalScrollBar.visible=!1},500)),t.viewport.scrollV+=e.data>0?-80:80,t.viewport.scrollV<0?t.viewport.scrollV=0:t.viewport.scrollV>i&&(t.viewport.scrollV=i))},t}return __extends(i,e),Object.defineProperty(i.prototype,"is_draged",{get:function(){return this._is_draged},set:function(e){this._is_draged=e,this.is_draged&&this.verticalScrollBar&&(this.verticalScrollBar.autoVisibility=!1,this.verticalScrollBar.visible=!0,this.verticalScrollBar instanceof t.VScrollBar&&this.verticalScrollBar.setDrag())},enumerable:!0,configurable:!0}),i.prototype.childrenCreated=function(){var n=this;e.prototype.childrenCreated.call(this),this.is_draged&&this.verticalScrollBar&&(this.verticalScrollBar.autoVisibility=!1,this.verticalScrollBar.visible=!0,this.verticalScrollBar instanceof t.VScrollBar&&this.verticalScrollBar.setDrag()),this.init(),this.viewport.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE,function(t){if(["scrollH","scrollV"].some(function(e){return e===t.property})){if(n.viewport.dispatchEventWith(i.EVT_SCROLL),"scrollV"===t.property){var e=Math.max(n.viewport.contentHeight-n.viewport.height,0);e&&n.viewport.scrollV===e&&n.viewport.dispatchEventWith(i.EVT_SCROLL_BOTTOM)}}else if("contentHeight"===t.property){var e=Math.max(n.viewport.contentHeight-n.viewport.height,0);n.viewport.scrollV<0?n.viewport.scrollV=0:n.viewport.scrollV>e&&(n.viewport.scrollV=e)}},this),this.addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){return n.onMouse=!0},this),this.addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){return n.onMouse=!1},this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return n.stage.removeEventListener(mouse.MouseEvent.MOUSE_WHEEL,n.wheel,n)},this)},i.EVT_SCROLL="evt_scroll",i.EVT_SCROLL_BOTTOM="evt_scroll_bottom",i}(eui.Scroller);t.Scroller=e,__reflect(e.prototype,"ui.control.Scroller")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.init=function(){return e.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,e.hide,e)},e.hide=function(t){return e.button.selected&&!e.contains(t.target)&&(e.button.selected=!1)},e.reset=function(){e.list.selectedIndex=e.selectedIndex,void 0===e.selectedIndex&&(e.button.label=e.label)},e}return __extends(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._contentHeight},set:function(t){this._contentHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){this._selectedIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataProvider",{get:function(){return this._dataProvider
},set:function(t){this._dataProvider=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItem",{get:function(){return this.list&&this.list.selectedItem},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){var i=this;t.prototype.childrenCreated.call(this),this.group.y=-this.group.maxHeight,this.init(),this.list.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE,function(t){"selectedIndex"===t.property&&(i.selectedItem&&(i.button.label=i.selectedItem.label),i.button.selected=!1,i.dispatchEventWith(e.EVT_INDEX_CHANGE,!1,{oldIndex:i.oldIndex,index:i.list.selectedIndex}),i.oldIndex=i.list.selectedIndex)},this),this.button.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE,function(t){"selected"===t.property&&egret.Tween.get(i.group).to({y:i.button.selected?0:-i.group.height},150,egret.Ease.sineOut)},this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){return i.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,i.hide,i)},this)},e.EVT_INDEX_CHANGE="evt_index_change",e}(eui.Component);t.SelectList=e,__reflect(e.prototype,"ui.control.SelectList")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bindData={},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),mouse.setButtonMode(this,!0),this.addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){e.onMouse=!0,e.invalidateState()},this),this.addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){e.onMouse=!1,e.invalidateState()},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.SoundUtil.play("btn_menu_mp3")},this)},e.prototype.getCurrentState=function(){var e=t.prototype.getCurrentState.call(this),i=""+e+(this.onMouse?"AndHover":"");return this.skin.hasState(i)?i:e},Object.defineProperty(e.prototype,"bindData",{get:function(){return this._bindData},set:function(t){this._bindData=t},enumerable:!0,configurable:!0}),e}(eui.ToggleButton);t.ToggleButton=e,__reflect(e.prototype,"ui.control.ToggleButton")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bindData={},e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),mouse.setButtonMode(this,!0),this.addEventListener(mouse.MouseEvent.MOUSE_OVER,function(){e.onMouse=!0,e.invalidateState()},this),this.addEventListener(mouse.MouseEvent.MOUSE_OUT,function(){e.onMouse=!1,e.invalidateState()},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return util.SoundUtil.play("btn_menu_mp3")},this)},e.prototype.getCurrentState=function(){var e=t.prototype.getCurrentState.call(this),i=""+e+(this.onMouse?"AndHover":"");return this.skin.hasState(i)?i:e},Object.defineProperty(e.prototype,"bindData",{get:function(){return this._bindData},set:function(t){this._bindData=t},enumerable:!0,configurable:!0}),e}(eui.ToggleSwitch);t.ToggleSwitch=e,__reflect(e.prototype,"ui.control.ToggleSwitch")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tw_obj={y:0},e}return __extends(e,t),e.prototype.setDrag=function(){var t=this;this.is_init_draged||(this.is_init_draged=!0,this.thumb.source="main_pic_slider_png",this.thumb.width*=1.5,this.thumb.height*=2,this.thumb.horizontalCenter=0/0,this.thumb.right=2,this.visible=!1,this.touchEnabled=this.touchChildren=!0,this.viewport.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE,function(){var e=t.viewport.contentHeight>t.viewport.height;t.visible!==e&&(t.visible=e)},this),this.thumb.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMove,this),this.thumb.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(i){if(!e.is_touch_begin){e.is_touch_begin=!0,t.pre_y=i.stageY,t.pre_x=i.stageX,t.is_touch_cancel=!1;var n=egret.$TempRectangle;t.thumb.getPreferredBounds(n),t.thumbHeight=n.height,t.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMove,t),t.stage.once(egret.TouchEvent.TOUCH_END,function(){t.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMove,t),e.is_touch_begin=!1},t)}},this),this.parent.addChild(this))},e.prototype.clickMove=function(t){var e=this;if(!this.is_touch_cancel){var i=this.thumb.parent.globalToLocal(0,t.stageY).y,n=this.viewport.height,o=this.viewport.contentHeight,r=i-this.thumb.height/2;this.tw_obj.y=this.thumb.y,r=Math.max(0,r),r=Math.min(this.viewport.height-this.thumbHeight,r);var s=r-this.thumb.y;egret.Tween.removeTweens(this.tw_obj),egret.Tween.get(this.tw_obj,{onChange:function(){e.viewport.scrollV=e.tw_obj.y*(o-n)/(n/e.scaleY-e.thumbHeight)}}).to({y:r},s,egret.Ease.circOut)}},e.prototype.touchMove=function(t){if(this.is_touch_cancel||(this.is_touch_cancel=!0),!(Math.abs(t.stageX-this.pre_x)>150)){var e=t.stageY-this.pre_y;this.pre_y=t.stageY;var i=this.viewport.contentHeight,n=this.viewport.height,o=(n/this.scaleY-this.thumbHeight)*this.viewport.scrollV/(i-n);o+=e,o=Math.max(0,o),o=Math.min(this.viewport.height-this.thumbHeight,o),this.viewport.scrollV=o*(i-n)/(n/this.scaleY-this.thumbHeight)}},e}(eui.VScrollBar);t.VScrollBar=e,__reflect(e.prototype,"ui.control.VScrollBar")}(e=t.control||(t.control={}))}(ui||(ui={}));var ui;!function(t){var e;!function(e){var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isWatch=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.invalidateState()},enumerable:!0,configurable:!0}),e.prototype.getCurrentState=function(){return""+(this.type?""+this.type:"")},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.registerEvent(),this.visible=!1},e.prototype.registerEvent=function(){var t=this;this.btn_check.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return t.dispatchEventWith(e.EVT_CHECK)},this)},e.prototype.setCheckButtonVisible=function(t){this.btn_check.visible=t},e.prototype.setBack=function(){for(var t=1;3>=t;t++){var e=this["poker_"+t];e.currentState="back"}this.statusBg.visible=!1,this.statusText.visible=!1},Object.defineProperty(e.prototype,"isWatch",{get:function(){return this._isWatch},enumerable:!0,configurable:!0}),e.prototype.setWatch=function(t){this._isWatch!==t&&(this._isWatch=t)},e.prototype.showStatus=function(t,e){e?(this.cardType="",this.cardstypeImg.source="bc_font_three_facecard_png",this.statusBg.source="bc_pic_card_type_bg2_png"):(this.cardType=t,this.cardstypeImg.source="bc_font_point_png",this.statusBg.source="bc_pic_card_type_bg_png")},e.prototype.showResult=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(o){switch(o.label){case 0:return"normal"===this.poker_1.currentState?[2]:(!i&&util.LogUtil.warn("[showResult] baicao pokerlist:"+i),this.poker_1.num=i[0],this.poker_2.num=i[1],this.poker_3.num=i[2],[4,this.poker_1.turnCard(t)]);case 1:return o.sent(),[4,this.poker_2.turnCard(t)];case 2:return o.sent(),[4,this.poker_3.turnCard(t)];case 3:return o.sent(),this.showStatus(String(e.point),e.is_jqk),[4,new Promise(function(e){egret.Tween.get(n.statusBg).set({scaleX:0,visible:!0}).to({scaleX:1},t),egret.Tween.get(n.statusText).set({scaleX:3,scaleY:3,visible:!0}).to({alpha:1,scaleX:1,scaleY:1},t).call(e)})];case 4:return o.sent(),[2]}})})},e.prototype.playwinAni=function(){var t=this;this.win.currentFrame=0,this.win.playTimes=1,this.win.visible=!0,this.win.isPlaying=!0,this.win.once(egret.Event.COMPLETE,function(){t.win.visible=!1},this)},e.prototype.getPokerType=function(t){return this["poker_"+t].size},e.prototype.getCardPos=function(t){return this["poker_"+t].localToGlobal()},e.EVT_CHECK="evt_check",e}(t.Component);e.PokerList=i,__reflect(i.prototype,"ui.baicao.PokerList")}(e=t.baicao||(t.baicao={}))}(ui||(ui={}));var util;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.getAsset=function(t,e){return __awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(o){switch(o.label){case 0:return-1!==Const.Config.SKIP_ASSET.indexOf(t)?[3,6]:RES.hasRes(t)?(i=RES.getRes(t),n=!i,n?[4,RES.getResAsync(t)]:[3,2]):[3,3];case 1:n=i=o.sent(),o.label=2;case 2:return[3,5];case 3:return[4,RES.getResByUrl(t,null,null,RES.ResourceItem.TYPE_IMAGE)];case 4:i=o.sent(),o.label=5;case 5:return[3,7];case 6:i=null,o.label=7;case 7:return e(i,t),[2]}})})},t}();t.AssetAdapter=e,__reflect(e.prototype,"util.AdapterUtil.AssetAdapter",["eui.IAssetAdapter"]);var i=function(){function t(){}return t.prototype.getTheme=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var n,o,r,s,a,l;return __generator(this,function(u){switch(u.label){case 0:return"undefined"==typeof generateEUI?[3,1]:(egret.callLater(function(){return e(generateEUI)},this),[3,11]);case 1:return"undefined"==typeof generateEUI2?[3,3]:(o=(n=window.JSONParseClass).setData,[4,RES.getResByUrl(crc32Map["resource/gameEui.json"],null,null,RES.ResourceItem.TYPE_JSON)]);case 2:return o.apply(n,[u.sent()]),egret.callLater(function(){return e(generateEUI2)},this),[3,11];case 3:return"undefined"==typeof generateJSON?[3,8]:-1!==t.indexOf(".exml")?[3,4]:(egret.callLater(function(){return e(generateJSON)},this),[3,7]);case 4:return generateJSON.paths[t]?[3,6]:(s=(r=window.JSONParseClass).setData,[4,RES.getResByUrl(t.replace(/((.*\/)*.*)\..*/,"$1_EUI.json"),null,null,RES.ResourceItem.TYPE_JSON)]);case 5:return s.apply(r,[u.sent()]),egret.callLater(function(){return e(generateJSON.paths[t])},this),[3,7];case 6:egret.callLater(function(){return e(generateJSON.paths[t])},this),u.label=7;case 7:return[3,11];case 8:return u.trys.push([8,10,,11]),a=e,[4,RES.getResByUrl(t,null,null,RES.ResourceItem.TYPE_TEXT)];case 9:return a.apply(void 0,[u.sent()]),[3,11];case 10:return l=u.sent(),i(l),[3,11];case 11:return[2]}})})},t}();t.ThemeAdapter=i,__reflect(i.prototype,"util.AdapterUtil.ThemeAdapter",["eui.IThemeAdapter"])}(e=t.AdapterUtil||(t.AdapterUtil={}))}(util||(util={}));var util;!function(t){var e;!function(t){var e,i=this;t.init=function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,RES.getResByUrl(crc32Map["resource/config/"+Const.Config.LANGUAGE+".json"],null,null,RES.ResourceItem.TYPE_JSON)];case 1:return e=t.sent(),[2]}})})},t.translate=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=""+(e&&e[t]||t);return(o&&o.match(/%s/g)||[]).forEach(function(t,e){return o=o.replace(t,i[e]||t)}),o}}(e=t.LanguageUtil||(t.LanguageUtil={}))}(util||(util={}));var util;!function(t){var e;!function(e){var i=function(e,i){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return(i===egret.Logger.ERROR?egret.error:i===egret.Logger.WARN?egret.warn:i===egret.Logger.INFO?egret.log:originalDebug).apply(void 0,["["+t.TimeUtil.format(new Date,"hh:mm:ss.S")+"]["+Const.TAG+"]["+i.toUpperCase()+"] "+e].concat(n))};e.debug=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return i.apply(void 0,[t,egret.Logger.DEBUG].concat(e))},e.info=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return i.apply(void 0,[t,egret.Logger.INFO].concat(e))},e.warn=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return i.apply(void 0,[t,egret.Logger.WARN].concat(e))},e.error=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return i.apply(void 0,[t,egret.Logger.ERROR].concat(e))},e.post=function(t,e){void 0===e&&(e=egret.Logger.INFO);for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return Const.Config.LOG_SWITCHER?(t.forEach(function(t){return i.apply(void 0,[t,e].concat(n))}),service.MainService.instance.postLog(t)):void 0}}(e=t.LogUtil||(t.LogUtil={}))}(util||(util={}));var util;!function(t){var e;!function(e){var i,n=new Map,o=new Set,r=function(t){return Object.keys(t).forEach(function(e){"balance"===e&&"string"==typeof t[e]?t[e]=new Decimal(t[e]):t[e]instanceof Object&&r(t[e])}),t},s=0;e.connect=function(e){return new Promise(function(o,s){var a=function(i){t.LogUtil.error(i.message,e),s(i)};if(i)return void a(new Error("lbl_game_connect"));var l=!0;i=new WebSocket(e),i.onmessage=function(e){var i=new topic.TopicBase(r(JSON.parse(e.data.replace(/("(balance|user_id)"[:,])(-?\d+(\.\d+)?(E\d+)?)/g,'$1"$3"'))));void 0===i.seq?(Data.updateTopic(i.topic,i),service.ServiceBase.onMessage(i.topic,i)):n.forEach(function(e,n){return e===i.seq&&t.NotifyUtil.sendNotification(n,i)})},i.onclose=function(){var n="lbl_game_networkerror",o=Data.getTopic(Const.Topic.SYSTEM);if(o)switch(o.snapshot.type){case"maintenance_start":n="lbl_game_server";break;case"duplicate_login":n="lbl_game_reconnect"}l&&(a(new Error(t.LanguageUtil.translate("lbl_game_connecterror",e))),l=!1),i=null,ui.dialog.MessageDialog.instance.showAlert(n,"lbl_game_refresh",refresh)},i.onopen=function(){l=!1,o()}})},e.disconnect=function(t,e){if(i)try{i.close(t,e)}catch(n){}},e.sendJSON=function(e,o,r,a){return new Promise(function(l,u){var h=function(i){t.LogUtil.error(i.message,e,o),u(i)};if(!i)return void h(new Error("lbl_game_connectlose"));var c;try{c=JSON.stringify(t.ObjectUtil.merge({seq:++s,topic:e},o))}catch(p){return void h(new Error(t.LanguageUtil.translate("lbl_game_dataerror",p.message)))}if(n.has(e))return void h(new Error(t.LanguageUtil.translate("lbl_game_request")+"\n"+c));var _,d=t.TimeUtil.setTimeout(function(){_=!0,ui.dialog.MiniLoadingDialog.instance.show()},3e3),g=t.TimeUtil.setTimeout(function(){t.TimeUtil.clearTimeout(d),t.NotifyUtil.removeNotification(e,m),n["delete"](e),_&&ui.dialog.MiniLoadingDialog.instance.close(),h(new Error(t.LanguageUtil.translate("lbl_game_requesttime",c)))},1e4),m=function(i){t.TimeUtil.clearTimeout(g),t.TimeUtil.clearTimeout(d),n["delete"](e),_&&ui.dialog.MiniLoadingDialog.instance.close(),i.code?h(new Error(JSON.stringify(i))):(Data.updateTopic(e,i,r,a),l(i))};n.set(e,s),t.NotifyUtil.addNotification(e,m,!0),i.send(c)})},e.request=function(i,n,r,s,a){return void 0===s&&(s=egret.HttpResponseType.TEXT),new Promise(function(l,u){var h=function(e){t.LogUtil.error(e.message,i,n),u(e)};if(o.has(n))return void h(new Error(t.LanguageUtil.translate("lbl_game_request")+"\n"+i+" "+n));var c,p=new XMLHttpRequest,_=t.TimeUtil.setTimeout(function(){c=!0,ui.dialog.MiniLoadingDialog.instance.show()},3e3);o.add(n),p.open(i,""+n+(a?(-1===n.indexOf("?")?"?":"&")+"authorization="+e.generateAuth():"")),p.timeout=1e4,p.responseType=s,p.onreadystatechange=function(){p.readyState===XMLHttpRequest.DONE&&(t.TimeUtil.clearTimeout(_),o["delete"](n),c&&ui.dialog.MiniLoadingDialog.instance.close(),[200,201].some(function(t){return t===p.status})?l(p):h([0,500].some(function(t){return t===p.status})?new Error(""+p.status):new Error(p.response||p.status)))},p.onerror=function(){0!==p.status&&(t.TimeUtil.clearTimeout(_),o["delete"](n),c&&ui.dialog.MiniLoadingDialog.instance.close(),h(new Error(t.LanguageUtil.translate("lbl_game_requesterror",n))))},p.ontimeout=function(){0!==p.status&&(t.TimeUtil.clearTimeout(_),o["delete"](n),c&&ui.dialog.MiniLoadingDialog.instance.close(),h(new Error(t.LanguageUtil.translate("lbl_game_requesttime",n))))},p.send(r)})},e.requestWithAuth=function(t,i,n,o){return void 0===o&&(o=egret.HttpResponseType.TEXT),e.request(t,i,n,o,!0)},e.generateAuth=function(){return encodeURIComponent(Base64.encode(JSON.stringify(params.guest?{login_token:Const.UserInfo.TOKEN}:{username:params.username,login_token:Const.UserInfo.TOKEN,channel:Const.UserInfo.CHANNEL_ID})))},e.postMessage=function(t){window.parent.postMessage(t,"*")}}(e=t.NetUtil||(t.NetUtil={}))}(util||(util={}));var util;!function(t){var e;!function(t){var e=new Map;t.addNotification=function(t,i,n){var o=e.get(t);o||(o=[],e.set(t,o)),o.some(function(t){return t.callback===i})||o.push({callback:i,isOnce:n})},t.removeNotification=function(t,i){var n=e.get(t);n&&n.some(function(t,e){return t.callback===i&&!!n.splice(e,1)})},t.sendNotification=function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r=[];(e.get(i)||[]).forEach(function(t){t.isOnce&&r.push(t),t.callback.apply(t,n)}),r.forEach(function(e){return t.removeNotification(i,e.callback)})},t.hasNotification=function(t,i){var n=e.get(t);return n?n.some(function(t){return t.callback===i}):!1}}(e=t.NotifyUtil||(t.NotifyUtil={}))}(util||(util={}));var util;!function(t){var e;!function(t){t.getRandom=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},t.getLottery=function(e){return t.getRandom(0,1e3)<=1e3*e},t.getNumber=function(t){return Number(t.replace(/.*\D+(\d+)\D+/,"$1"))},t.formatNumber=function(e,i){var n=new Decimal(e).div(Const.NUMBER_FACTOR),o=n.toFixed(void 0===i?t.getFractionDigits(e):i).split(".");return o[0]=o[0].replace(/\B(?=(\d{3})+$)/g,","),o.join(".")},t.formatUnit=function(e,i,n,o){void 0===i&&(i=1),void 0===n&&(n=1e3),void 0===o&&(o=["","K"]);var r,s=new Decimal(e).div(Const.NUMBER_FACTOR),a=Math.pow(10,i);return o.some(function(t,e){return r=t,e===o.length-1||s.lt(n)?!0:(s=s.mul(a).div(n).floor().div(a),!1)}),""+(r===o[0]?s.toString():s.toFixed(Math.min(t.getFractionDigits(s.mul(Const.NUMBER_FACTOR)),i)))+r},t.formatUnitEasy=function(e,i){void 0===i&&(i=1);var n,o;switch(Const.Config.LANGUAGE){case"zh_cn":n=1e4,o=["","万"];break;case"zh_hk":case"zh_tw":n=1e4,o=["","萬"];break;default:n=1e3,o=["","K"]}return t.formatUnit(e,i,n,o)},t.getFractionDigits=function(t){var e=new Decimal(t).div(Const.NUMBER_FACTOR).toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return Math.max(0,(e[1]||"").length-Number(e[2]))},t.calBezier=function(t,e,i,n){return Math.pow(1-n,2)*t+2*n*(1-n)*e+Math.pow(n,2)*i},t.calBezierPoint=function(e,i,n,o){return new egret.Point(t.calBezier(e.x,i.x,n.x,o),t.calBezier(e.y,i.y,n.y,o))},t.tweenNumber=function(e,i,n,o){return void 0===n&&(n=300),new Promise(function(r){var s=new Decimal((e.text||"0").replace(/,/g,"")).mul(Const.NUMBER_FACTOR),a=new Decimal(i),l=a.minus(s),u=t.getFractionDigits(a);egret.Tween.get(e,{onChange:function(){var i=s.add(l.mul(e._tweenNumber));e.text=""+(!o||i.isNeg()?"":"+")+t.formatNumber(i,u)}}).set({_tweenNumber:0}).to({_tweenNumber:1},n,egret.Ease.sineOut).call(r)})}}(e=t.NumberUtil||(t.NumberUtil={}))}(util||(util={}));var util;!function(t){var e;!function(e){var i=function(n,o,r,s,a,l){var u,h=!1,c=a?e.copy(n):n;switch([n,o].filter(function(t){return t instanceof Object}).length){case 2:switch([n,o].filter(function(t){return t instanceof Decimal}).length){case 2:u=new Decimal(o.toString()),h=n.cmp(o);break;case 1:u=new Decimal(o.toString()),h=!0;break;default:var p=Object.keys(n),_=Object.keys(o);!r&&n instanceof Array&&o instanceof Array?(u=s?e.copy(n):[],o.forEach(function(t){n.some(function(i){return e.isEqual(i,t)})||(u.push(e.copy(t)),h=!0)})):(u=a?n:s?e.copy(n):o instanceof Array?[]:{},(s?_:p).forEach(function(t){var e=i(n[t],o[t],r,s,a?a+"."+t:null,l);e.flag&&(a&&-1===_.indexOf(t)?delete u[t]:u[t]=e.result,h=!0)}),!s&&_.forEach(function(t){-1===p.indexOf(t)&&(u[t]=e.copy(o[t]),h=!0)}))}break;case 1:u=o instanceof Object?e.copy(o):o,h=!0;break;default:n!==o&&(u=o,h=!0)}return a&&(u instanceof Array&&(u.length=Object.keys(u).length),h&&t.NotifyUtil.sendNotification(a,u,c,l,a)),{result:u,flag:h}};e.pure=function(t,i){void 0===i&&(i=[]);var n;return t instanceof Object?(n=t instanceof Array?[]:{},Object.keys(t).forEach(function(o){return(-1!==i.indexOf(o)||0!==o.indexOf("_"))&&(n[o]=e.pure(t[o]))})):n=t,n},e.minus=function(t,e,n){return i(t,e,n).result},e.merge=function(t,n,o){void 0===o&&(o=!0);var r=i(t,n,o,!0);return r.flag?r.result:e.copy(t)},e.copy=function(t){var i;return t instanceof Decimal?i=new Decimal(t):t instanceof Array?i=t.map(function(t){return e.copy(t)}):t instanceof Object?(i={},Object.keys(t).forEach(function(n){return i[n]=e.copy(t[n])})):i=t,i},e.notify=function(t,e,n,o){var r=i(t,e,!0,!1,n,o);return r.flag?r.result:t},e.isEqual=function(t,e){return!i(t,e,!0).flag},e.isEmpty=function(t,i){return!i||void 0!==t&&null!==t?e.isEqual({},t):!0}}(e=t.ObjectUtil||(t.ObjectUtil={}))}(util||(util={}));var util;!function(t){var e;!function(e){var i=function(){function e(){}return e.prototype.onLoadStart=function(e,i){if(channel&&channel.rs_h5_cdn){var n=t.ObjectUtil.copy(i);return n.root=channel.rs_h5_cdn+"/",n.url=n.url.replace(/(.*\/)*(.*\.)/,"$2"),RES.processor.TextProcessor.onLoadStart(e,n)}return RES.processor.TextProcessor.onLoadStart(e,i)},e.prototype.onRemoveStart=function(t,e){return RES.processor.TextProcessor.onRemoveStart(t,e)},e}();e.TextProcessor=i,__reflect(i.prototype,"util.ProcessorUtil.TextProcessor",["RES.processor.Processor"]);var n=function(){function e(){}return e.prototype.onLoadStart=function(e,i){if(channel&&channel.rs_h5_cdn){var n=t.ObjectUtil.copy(i);return n.root=channel.rs_h5_cdn+"/",n.url=n.url.replace(/(.*\/)*(.*\.)/,"$2"),RES.processor.SoundProcessor.onLoadStart(e,n)}return RES.processor.SoundProcessor.onLoadStart(e,i)},e.prototype.onRemoveStart=function(t,e){return RES.processor.SoundProcessor.onRemoveStart(t,e)},e}();e.SoundProcessor=n,__reflect(n.prototype,"util.ProcessorUtil.SoundProcessor",["RES.processor.Processor"]);var o=function(){function e(){this.zipMap=new Map}return e.prototype.getUrl=function(t){return t.replace(/^resource\//,"")},e.prototype.getKey=function(t){var e=function(t,e,i,n,o,r){return""+(i?"effect/"+e+n:"")+r+"_"};return t.replace(/^timg\/(?!html)[^\/]+\//,"").replace(/([^\/]*\/)?(effect\/(.*\/))?(.*\/)*(.*)\./,e).replace(/\//g,"_")},e.prototype.get=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var n,o,r,s,a,l,u=this;return __generator(this,function(h){switch(h.label){case 0:if(n=this.getUrl(e.name),o=RES.getResourceInfo(this.getKey(n)),r=""+o.root+o.name,!t.state[r])return[3,1];switch(t.state[r]){case 2:return[2,t.get(o)];case 1:return[2,o.promise]}return[3,3];case 1:return t.state[r]=1,o.promise=new Promise(function(r){return __awaiter(u,void 0,void 0,function(){var s,a,l,u,h,c,p,_,d,g,m,f,b,y,v,C,T,E,w,k,U=this;return __generator(this,function(A){switch(A.label){case 0:switch(s=o.type){case RES.ResourceItem.TYPE_IMAGE:return[3,1];case RES.ResourceItem.TYPE_FONT:return[3,3];case RES.ResourceItem.TYPE_JSON:return[3,6];case RES.ResourceItem.TYPE_SHEET:return[3,8];case RES.ResourceItem.TYPE_BIN:return[3,11]}return[3,13];case 1:return a=new egret.Texture,l=a,[4,new Promise(function(t){return __awaiter(U,void 0,void 0,function(){var i,n,o;return __generator(this,function(r){switch(r.label){case 0:return n=(i=egret.BitmapData).create,o=["arraybuffer"],[4,e.async("arraybuffer")];case 1:return[2,n.apply(i,o.concat([r.sent(),t]))]}})})})];case 2:return l.bitmapData=A.sent(),r(a),[3,13];case 3:return[4,e.async("text")];case 4:u=A.sent(),p=void 0;try{h=JSON.parse(u),c=RES.processor.getRelativePath(n,h.file)}catch(D){h=u,c=n.replace(/(.*\/)*.*/,"$1"+h.replace(/[\s\S]*file="(.*)"[\s\S]*/,"$1"))}return d=(_=egret.BitmapFont).bind,[4,this.get(t,i.file("resource/"+c),i)];case 5:return p=new(d.apply(_,[void 0,A.sent(),h])),p.$resourceInfo=RES.getResourceInfo(this.getKey(c)),r(p),[3,13];case 6:return g=r,f=(m=JSON).parse,[4,e.async("text")];case 7:return g.apply(void 0,[f.apply(m,[A.sent()])]),[3,13];case 8:return T=(C=JSON).parse,[4,e.async("text")];case 9:return b=T.apply(C,[A.sent()]),y=RES.processor.getRelativePath(n,b.file),w=(E=egret.SpriteSheet).bind,[4,this.get(t,i.file("resource/"+y),i)];case 10:return v=new(w.apply(E,[void 0,A.sent()])),v.$resourceInfo=RES.getResourceInfo(this.getKey(y)),Object.keys(b.frames).forEach(function(t){var e=b.frames[t],i=v.createTexture(t,e.x,e.y,e.w,e.h,e.offX,e.offY,e.sourceW,e.sourceH);if(e.scale9grid){var n=e.scale9grid.split(",");i.scale9Grid=new egret.Rectangle(Number(n[0]),Number(n[1]),Number(n[2]),Number(n[3]))}}),r(v),[3,13];case 11:return k=r,[4,e.async("arraybuffer")];case 12:return k.apply(void 0,[A.sent()]),[3,13];case 13:return[2]}})})}),a=(s=t).save,l=[o],[4,o.promise];case 2:return a.apply(s,l.concat([h.sent()])),[2,t.get(o)];case 3:return[2]}})})},e.prototype.onLoadStart=function(e,i){return __awaiter(this,void 0,void 0,function(){var n,o,r,s,a,l,u=this;return __generator(this,function(h){switch(h.label){case 0:return n=e.resourceConfig.config.groups,o=[],[4,new Promise(function(n){getFromDB(i.url,function(o){return __awaiter(u,void 0,void 0,function(){var r;return __generator(this,function(s){switch(s.label){case 0:return o?(n(o),[3,6]):[3,1];case 1:return channel&&channel.rs_h5_cdn?(r=t.ObjectUtil.copy(i),r.root=channel.rs_h5_cdn+"/",r.url=r.url.replace(/(.*\/)*(.*\.)/,"$2"),[4,RES.processor.BinaryProcessor.onLoadStart(e,r)]):[3,3];case 2:return o=s.sent(),[3,5];case 3:return[4,RES.processor.BinaryProcessor.onLoadStart(e,i)];case 4:o=s.sent(),s.label=5;case 5:n(o),putToDB(i.url,o),s.label=6;case 6:return[2]}})})})})];case 1:return r=h.sent(),[4,JSZip.loadAsync(r)];case 2:return s=h.sent(),a=0,l=Object.keys(s.files).length,this.zipMap.set(i.name,s),[4,Promise.all(s.filter(function(t,e){return!e.dir}).map(function(n){return o.push(u.getKey(u.getUrl(n.name))),u.get(e,n,s).then(function(){return t.NotifyUtil.sendNotification("zip."+i.groupNames[0],++a,l)})}))];case 3:return h.sent(),Object.keys(n).some(function(t){var e=n[t].join()===i.name;return e&&(n[t]=o),e}),[2,r]}})})},e.prototype.onRemoveStart=function(t,e){var i=this;return this.zipMap.get(e.name).forEach(function(e,n){return!n.dir&&t.unload(RES.getResourceInfo(i.getKey(i.getUrl(n.name))))}),this.zipMap["delete"](e.name),RES.processor.BinaryProcessor.onRemoveStart(t,e)},e}();e.ZipProcessor=o,__reflect(o.prototype,"util.ProcessorUtil.ZipProcessor",["RES.processor.Processor"])}(e=t.ProcessorUtil||(t.ProcessorUtil={}))}(util||(util={}));var util;!function(t){var e;!function(t){var e=this,i=new Map,n=[];t.active="false"!==localStorage.getItem("active"),t.music=localStorage.getItem("music")?Number(localStorage.getItem("music")):1,t.effect=localStorage.getItem("effect")?Number(localStorage.getItem("effect")):1;var o=function(){function e(e,i,n){void 0===i&&(i=1),void 0===n&&(n=1),this.channel=e,this._priority=i,this.volume=n,this.active=!egret.ticker.isPaused&&t.active}return Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.active&&(this.vol=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(t){this._active=t,this.vol=t?this.volume:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vol",{set:function(t){try{this.channel.volume=t}catch(e){}},enumerable:!0,configurable:!0}),e.prototype.forcePlay=function(){i.has(this)&&(this.channel.audio&&this.channel.audio.play(),i.get(this).play().stop())},e.prototype.destroy=function(){i.has(this)&&(this.channel.stop(),i["delete"](this))},e.prototype.once=function(t,e,i,n){this.channel?this.channel.once(t,e,null,i,n):e()},e}();t.SoundChannel=o,__reflect(o.prototype,"util.SoundUtil.SoundChannel"),t.play=function(r,s,a,l){void 0===s&&(s=1),void 0===a&&(a=egret.Sound.EFFECT),void 0===l&&(l=1);try{i.forEach(function(t,e){if(e.priority>l)throw new Error})}catch(u){return Promise.resolve(new o(null))}for(;n.some(function(t,e){var i=t[0]===r&&t[1]===a;return i&&n.splice(e,1),i}););return new Promise(function(u,h){return __awaiter(e,void 0,void 0,function(){var e,c,p,_;return __generator(this,function(d){switch(d.label){case 0:e=RES.getRes(r),d.label=1;case 1:return d.trys.push([1,4,,5]),p=!e,p?[4,RES.getResAsync(r)]:[3,3];case 2:p=e=d.sent(),d.label=3;case 3:return n.some(function(t){return t[0]===r&&t[1]===a})?u(new o(null)):e?(e.type=a,c=new o(e.play(0,s),l,a===egret.Sound.MUSIC?t.music:t.effect),Main.instance.once(egret.TouchEvent.TOUCH_TAP,c.forcePlay,c),c.once(egret.Event.SOUND_COMPLETE,function(){return i["delete"](c)}),i.set(c,e),u(c)):h(new Error("数据源 '"+r+"' 无效")),[3,5];case 4:return _=d.sent(),u(new o(null)),[3,5];case 5:return[2]}})})})},t.destroy=function(t,e){void 0===e&&(e=egret.Sound.EFFECT);var o=[];t.forEach(function(t){var r;i.forEach(function(i,n){r=e===i.type&&RES.getRes(t)===i,r&&o.push(n)}),!r&&n.push([t,e])}),o.forEach(function(t){return t.destroy()})},t.toggle=function(e,n,o){if(void 0===n&&(n=egret.Sound.EFFECT),void 0===o&&(o=!0),o)if("number"==typeof e){try{n===egret.Sound.MUSIC?(t.music=e,localStorage.setItem("music",""+e)):(t.effect=e,localStorage.setItem("effect",""+e))}catch(r){}i.forEach(function(t,i){return n===t.type&&(i.volume=e)})}else{try{t.active=e,localStorage.setItem("active",""+e)}catch(r){}i.forEach(function(t,i){return i.active=e})}else(!e||t.active)&&i.forEach(function(t,i){return i.active=!!e})}}(e=t.SoundUtil||(t.SoundUtil={}))}(util||(util={}));var util;!function(t){var e;!function(e){var i,n=this,o=new Map,r=[],s=[],a=[];e.init=function(){e.startTick("util.TimeUtil.init",function(o){return function(){return __awaiter(n,void 0,void 0,function(){var e,i;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e=1e3/60>o%3e4,e?[4,service.LoginService.instance.keepAlive()]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return[3,4];case 3:return i=n.sent(),-1!==i.message.indexOf("超时")&&t.NetUtil.disconnect(3e3,"心跳丢失"),[3,4];case 4:return[2]}})})}(),1e3/60>o%5e3&&Main.instance.pushStat(),e.now=t.ObjectUtil.notify(e.now,e.now+o-i,"util.TimeUtil.now"),i=o,!1})},e.setTime=function(t){e.now=t,i=egret.getTimer()},e.reBoot=function(){o.forEach(function(t){return egret.stopTick(t,e)}),r.forEach(function(t){return t.stop()}),s.forEach(function(t){return egret.clearTimeout(t)}),a.forEach(function(t){return egret.clearInterval(t)}),o.clear(),r.splice(0),s.splice(0),a.splice(0)},e.startTick=function(t,i){o.has(t)||(egret.startTick(i,e),o.set(t,i))},e.stopTick=function(t){var i=o.get(t);i&&egret.stopTick(i,e),o["delete"](t)},e.Timer=function(t,e){var i=new egret.Timer(t,e);return r.push(i),i},e.setTimeout=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=egret.setTimeout(t,null,e,i);return s.push(o),o},e.clearTimeout=function(t){var e=s.indexOf(t);-1!==e&&s.splice(e,1),egret.clearTimeout(t)},e.setInterval=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=egret.setInterval(t,null,e,i);return a.push(o),o},e.clearInterval=function(t){var e=a.indexOf(t);-1!==e&&a.splice(e,1),egret.clearInterval(t)},e.format=function(t,e){"number"==typeof t&&(t=new Date(t));var i=""+t.getFullYear(),n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};return e=e.replace(/(y+)/,function(t,e){return i.substr(4-e.length)}),Object.keys(n).forEach(function(t){return e=e.replace(RegExp("("+t+")"),function(e,i){return 1===i.length?n[t]:("00"+n[t]).substr((""+n[t]).length)})}),e},e.diff=function(t,e,i){void 0===i&&(i=!0),i&&t>e&&(e=t);var n,o,r=e-t,s=r%864e5,a=Math.floor(r/864e5),l=Math.floor(s/36e5);return s%=36e5,n=Math.floor(s/6e4),o=Math.round(s%6e4/1e3),""+(a?a+"天 ":"")+(10>l?"0":"")+l+":"+(10>n?"0":"")+n+":"+(10>o?"0":"")+o}}(e=t.TimeUtil||(t.TimeUtil={}))}(util||(util={}));var ui;!function(t){var e;!function(e){var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.betBtnList=[],t.clickLightList=[],t.winLightList=[],t.winEffList=[],t.betLabelBgList=[],t.betLabelList=[],t.ALL_TYPE=["fish","shrimp","gourd","copper","crab","cock","combination_fish_shrimp","combination_fish_gourd","combination_fish_copper","combination_fish_crab","combination_fish_cock","combination_shrimp_gourd","combination_shrimp_copper","combination_shrimp_crab","combination_shrimp_cock","combination_gourd_copper","combination_gourd_crab","combination_gourd_cock","combination_copper_crab","combination_copper_cock","combination_crab_cock","pair_fish","pair_shrimp","pair_gourd","pair_copper","pair_crab","pair_cock","triple_fish","triple_copper","triple_shrimp","triple_crab","triple_gourd","triple_cock","triple","one_red","one_blue","one_green","two_red","two_blue","two_green","three_red","three_blue","three_green","three"],t.timerArr=[],t.oldBetAreaIndex=-1,t.callbacks=new Map,t.shot=function(e){egret.callLater(function(){egret.callLater(function(){var i=new egret.RenderTexture;
i.drawToTexture(e),t.img_shot.source=i},t)},t)},t}return __extends(i,e),i.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.languageArea.addEventListener(egret.Event.RESIZE,function(){return t.shot(t.languageArea)},this),this.languageArea.addEventListener(egret.Event.ADDED_TO_STAGE,function(){return t.shot(t.languageArea)},this),this.shot(this.languageArea)},i.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.betBtnArea.$children.forEach(function(e,i){e.height=e.height;var n=new t.component.ChipStacked(.8),o=new t.component.ChipStacked(.8);n.name="other",o.name="own",n.left=o.right=-8;var r=0;r=6>i?-40:21>i?-32:27>i?-45:34>i?-22:-16,n.verticalCenter=o.verticalCenter=r,e.addChildAt(n,5),e.addChildAt(o,5)})},i.prototype.init=function(){var t=this.betBtnArea.numChildren;this.betBtnList.length=0;for(var e=0;t>e;e++){var i=this.betBtnArea.getChildAt(e);this.betBtnList.push(i);var n=i.getChildAt(0),o=this.betBtnArea3.getChildAt(e).getChildAt(0),r=i.getChildAt(3),s=i.getChildByName("img_lb"),a=i.getChildByName("lb_bet");this.show(r,!1),this.show(o,!1),n.clearWinEff(),this.show(s,!1),this.show(a,!1),this.clickLightList.push(r),this.winLightList.push(o),this.winEffList.push(n),this.betLabelBgList.push(s),this.betLabelList.push(a)}this.addEvent()},i.prototype.resetBetAreaUI=function(){var t=this;this.removeTw(),this.initChips(),this.callbacks.clear(),this.betBtnList.forEach(function(e,i){t.winLightList[i].visible=!1,t.betLabelBgList[i].visible=!1,t.betLabelList[i].visible=!1,t.winEffList[i].clearWinEff()})},i.prototype.initChips=function(){this.betBtnArea.$children.forEach(function(t){["own","other"].forEach(function(e){t.getChildByName(e).initChips()})})},i.prototype.addEvent=function(){var t=this;this.betBtnList.forEach(function(e){e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.btnTouchBegin,t),e.removeEventListener(egret.TouchEvent.TOUCH_END,t.btnTouchEnd,t),e.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.btnTouchOutside,t)}),this.betBtnList.forEach(function(e){e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.btnTouchBegin,t),e.addEventListener(egret.TouchEvent.TOUCH_END,t.btnTouchEnd,t),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.btnTouchOutside,t)})},i.prototype.btnTouchBegin=function(t){this.betBtnList[0]&&this.betBtnList[0].touchEnabled&&this.showClickLight(t.currentTarget)},i.prototype.btnTouchEnd=function(t){this.btnTouchOutside(t),this.btnTouchTap(t)},i.prototype.btnTouchOutside=function(t){this.showClickLight(t.currentTarget,!1)},i.prototype.btnTouchTap=function(t){if(this.betBtnList[0]&&this.betBtnList[0].touchEnabled){var e=this.betBtnList.indexOf(t.currentTarget),n=this.ALL_TYPE[e];-1!==e&&this.dispatchEventWith(i.EVT_BET,!1,{type:n,index:e})}else this.dispatchEventWith(i.EVT_SHOW_TIP)},i.prototype.showClickLight=function(t,e){void 0===e&&(e=!0);var i=this.betBtnList.indexOf(t);if(-1!==i){var n=this.clickLightList[i];this.show(n,e)}},i.prototype.showWinLight=function(t){var e=this,i=[],n=[];t.forEach(function(t){i.push(e.winLightList[t]),n.push(e.winEffList[t])}),this.timerArr.forEach(function(t){util.TimeUtil.clearTimeout(t)}),i.forEach(function(t){t&&(t.visible=!0)}),n.forEach(function(t){t&&t.startWinEff()})},i.prototype.show=function(t,e){void 0===e&&(e=!0),t.visible=e},i.prototype.setEnable=function(t){this.betBtnList.forEach(function(e){e.touchEnabled=!!t})},i.prototype.updateAreaBetNumber=function(t,e,i){var n=this;void 0===e&&(e=!1),void 0===i&&(i=0),Object.keys(t).forEach(function(o){var r=n.ALL_TYPE.indexOf(o);if(t[o]<=0?(n.betLabelBgList[r].visible=!1,n.betLabelList[r].visible=!1):(n.betLabelBgList[r].visible=!0,n.betLabelList[r].visible=!0),n.betLabelList[r].text=util.NumberUtil.formatNumber(t[o]),e&&-1!==i){var s=void 0;n.oldBetAreaIndex===i?s=n._oy||n.betLabelList[i].y:n._oy=n.betLabelList[i].y,s=n._oy||n.betLabelList[i].y,egret.Tween.get(n.betLabelList[i]).to({scaleX:1.5,scaleY:1.5,y:s-10},70).to({scaleX:1,scaleY:1,y:s},50)}})},i.prototype.flyChip=function(e,i,n,o,r,s){var a=this;return void 0===o&&(o=!0),void 0===r&&(r=1),void 0===s&&(s=null),new Promise(function(s){var l=a.betBtnArea.getChildAt(n).getChildByName(1===r||3===r?"own":"other"),u=l.getFlyChipGlobalPos(),h=i.localToGlobal();e.x=h.x,e.y=h.y,1===r?h=i.localToGlobal(i.x,i.y):2===r&&(h.x+=i.width/2,h.y+=i.height/2),e.scaleX=.5,e.scaleY=.5;var c=a.chipArea.globalToLocal(h.x,h.y);e.x=c.x,e.y=c.y,a.chipArea.addChild(e);var p=function(){a.callbacks["delete"](e),t.component.SChip.returnChip(e),l.addChip(e.value,e.type),s(void 0)};if(a.callbacks.set(e,p),o){var _=a.chipArea.globalToLocal(u.x,u.y);egret.Tween.get(e).to({x:_.x,y:_.y,scaleX:.8,scaleY:.8},4===r?50*util.NumberUtil.getRandom(6,8):50*util.NumberUtil.getRandom(4,10),egret.Ease.sineOut).call(function(){return p()})}else p()})},i.prototype.showChipResultPos=function(){this.callbacks.forEach(function(t,e){egret.Tween.removeTweens(e),t()})},i.prototype.flyChips=function(e,i,n,o){var r=this,s=!1;this.betBtnArea.$children.forEach(function(n){var a=n.getChildByName(o);if(a.cur_show_num>0){var l=a.getCopyImg(r.chipArea);a.initChips();var u=void 0;"own"===o?u=e.localToGlobal():(u=i.localToGlobal(),u.x+=i.width/2,u.y+=i.height/2);var h=r.chipArea.globalToLocal(u.x,u.y);s||(util.SoundUtil.play("payout_chips_mp3"),s=!0),egret.Tween.get(l).to({x:h.x,y:h.y,scaleX:.5,scaleY:.5},500,egret.Ease.sineIn).call(function(){return t.component.ChipStacked.returnImg(l)})}})},i.prototype.removeSomeChips=function(t){var e=this;t.forEach(function(t){var i=e.betBtnArea.getChildAt(t);["own","other"].forEach(function(t){i.getChildByName(t).initChips()}),e.betLabelBgList[t].visible=!1,e.betLabelList[t].visible=!1})},i.prototype.removeTw=function(){this.chipArea.$children.forEach(function(e){egret.Tween.removeTweens(e),e.scaleX=e.scaleY=1,e instanceof t.component.SChip?t.component.SChip.returnChip(e):e instanceof eui.Image&&t.component.ChipStacked.returnImg(e)})},i.EVT_BET="evt_bet",i.EVT_SHOW_TIP="evt_show_tip",i}(t.Component);e.BetArea=i,__reflect(i.prototype,"ui.fish.BetArea")}(e=t.fish||(t.fish={}))}(ui||(ui={}));